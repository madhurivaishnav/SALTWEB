IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_ImportPreview]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_ImportPreview]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_ImportPreview]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/****** Object:  StoredProcedure [dbo].[prcUser_ImportPreview]    Script Date: 07/15/2008 12:42:55 ******/

/*
Summary: Uploads the details from an XML document to the tblUser table
Parameters:
@userXML text The XML document containing the User data.
@ID Integer ID of either the Organisation or Unit
@hierachy VarChar(12) hierachy where the call to upload useres was made from. can only be Organisation or Unit.
@userID Integer = null -- ID of user inporting the xmlData
Returns:
two Result sets

One: The first result set has the totals for the Upload
Total of Records in the XML File
Total of Successfully Inserted Records
Total of Already Existing Records
Total of  Records with error details

Two: The second result set holds the detail of the records that failed to insert.
RecordNumber
Username
Password
Firstname
Lastname
Email
ExternalID
ClassificationName
ClassificationOption

Called By:
User.cs
Calls:
sp_xml_preparedocument -- system stored procedure to ALTER  an internal representation of the XML document.
sp_xml_removedocument -- system stored procesure to remove the previously created representation of the XML document.

Remarks: The XML document must be well formed otherwise the process will fail.

Process
--1. Get the Organisation ID and unit ID
--2. Get a list of users that will be imported
--3. Data Validation
any other validation???
--4. Insert valid user data to user  and  user classification tables
--5. Get the summary report of the imported users
--6. Get all records with details of errors found in the data records

Author: Peter Vranich
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date		Description
#1	Peter Kneale	23/2/04		Changed name from prcImportUsers to prcUser_Import
#2	jack Liu	9/03/04		Reorganize the process and put comments
#3	Peter Kneale	2/12/2004	An empty Extenal ID is now treated as a null value.
#4	Jack Liu	14/09/2005	Validate UnitID, the unitID must be inside the specified organisation
UserName is unique per organisation
#5  Li Zhang	Jul	2008	added unique field for updating existing user data
#5  						the actual function of insert/update to the user data are not perform in this stored procedure
#5							it''s used to prepare preview user data record before importing user data records to tblUser

Test:
exec prcUser_Import @userXMLData = ''<BDWUserUpload><User Username="imported22" Firstname="Imported" Lastname="User1" Email="imported.user1@bdw.com" ExternalID="IU1">
<CustomClassifications><CustomClassification Name="State" Option="NSW"/></CustomClassifications>
</User>
<User Username="imported22" Firstname="Imported" Lastname="User2" Email="imported.user2@bdw.com" ExternalID="IU2">
<CustomClassifications><CustomClassification Name="State" Option="ACT"/></CustomClassifications>
</User></BDWUserUpload>'', @ID = 18, @hierachy = ''Organisation'', @userID = 1100
*/

CREATE    Procedure [prcUser_ImportPreview]
(
@userXMLData nText = null, 	-- XML document
@ID Integer = null,		-- ID
@hierachy nVarChar(12) = null, 	-- hierachy where the call to upload useres was made from.
--can only be Organisation or Unit.
@userID Integer = null, 		-- ID of user importing the xmlData
@uniqueField Integer = null
)

As

Set NoCount On

Set Xact_Abort On
Begin Transaction


--Declarations
-- OrganisationID of the Unit that the Users are being imported too.
Declare @intOrganisationID Integer
Declare @intUnitID Integer

Declare @hdoc Integer 			-- Is the document handle of the internal representation of an XML document.
Declare @strRowPattern Varchar(19) 	-- The row pattern to be used with the OPENXML statement.
Declare @intRecordCountTotal Integer 	-- Number of rows inserted
-- Set the rowpattern for the Openxml statement.
Set @strRowPattern = ''/BDWUserUpload/User''

Declare @constant_EmailAddress int
Declare @constant_UserName int

set @constant_EmailAddress  = 1
set @constant_UserName = 2

--1. Get the Organisation ID and unit ID
If(@hierachy = ''Unit'')
Begin
set @intUnitID = @ID
-- Get the OrganisationID for this Unit.
Select
@intOrganisationID = OrganisationID
From
tblUnit
Where
UnitID = @ID
end
else
begin
set @intUnitID = null
set @intOrganisationID = @ID
end

--2. Get a list of users that will be imported
-- Create a temp table to hold the values from the XML document
Create Table #xmlUserData
(
TempUserID				Integer Identity(1, 1),
UnitID					int default(null),
Username				nVarchar(50)  COLLATE database_default Not Null,
Password				nVarchar(50)  COLLATE database_default Not Null,
Firstname				nVarchar(50) COLLATE database_default,
Lastname				nVarchar(50) COLLATE database_default,
Email					nVarchar(50)COLLATE database_default  Not Null,
ExternalID				nVarchar(50)  COLLATE database_default,
ClassificationName		nVarchar(50) COLLATE database_default,
ClassificationOption	Varchar(50)  COLLATE database_default,
Status					int  default(Null),-- ErrorFound:1, Updated:2, Added:3
Reason					varchar(1000)  COLLATE database_default,
ErrField				varchar(255) default(Null),
Archive					varchar (1) default(''2''),
NotifyUnitAdmin			nVarchar(1) COLLATE database_default,
NotifyOrgAdmin			nVarchar(1) COLLATE database_default,
ManagerNotification		nVarchar(1) COLLATE database_default,
ManagerToNotify			nVarchar(50) COLLATE database_default
)


Exec sp_xml_preparedocument @hdoc Output, @userXMLData

-- Get the records from the XML file and insert them into the temp table.

Insert Into #xmlUserData
(
UnitID,
Username,
Password,
Firstname,
Lastname,
Email,
ExternalID,
Archive,
ClassificationName,
ClassificationOption,
NotifyUnitAdmin,
NotifyOrgAdmin,
ManagerNotification,
ManagerToNotify

)
Select
*
From
OpenXml(@hdoc, @strRowPattern)
With
(
UnitID					int		''@UnitID'',
Username				nVarchar(50) ''@Username'',
Password				nVarchar(50) ''@Password'',
Firstname				nVarchar(50) ''@Firstname'',
Lastname				nVarchar(50) ''@Lastname'',
Email					nVarchar(50) ''@Email'',
ExternalID				nVarchar(50) ''@ExternalID'',
Archive					nVarchar (1)		''@Archive'',
ClassificationName		Varchar(50) ''CustomClassifications/CustomClassification/@Name'',
ClassificationOption	Varchar(50) ''CustomClassifications/CustomClassification/@Option'',
NotifyUnitAdmin			nVarchar (1)		''@NotifyUnitAdmin'',
NotifyOrgAdmin			nVarchar (1)		''@NotifyOrgAdmin'',
ManagerNotification		nVarchar (1)		''@ManagerNotification'',
ManagerToNotify			nVarchar (50)		''@ManagerToNotify''

)


-- Ensure that any values that should be null havent been cast to 0 instead of NULL
Update
#xmlUserData
Set
UnitID = null
Where
UnitID = 0

Update
#xmlUserData
Set
ErrField = ''''

--======================================================--
-- SECURITY												--
--======================================================--
Declare @UserType int	-- the type of the user

-- Get user type
Select @UserType = UserTypeID from tblUser Where UserID = @UserID

-- Salt Administrator
-----------------------------
--IF (@UserType = 1)
-- This user is allowed to perform any action


-- Organisation Administrator
-----------------------------
IF (@UserType = 2)
Begin
-- See if any units in the temp table are not found in this organisation
Update
#xmlUserData
Set
Status = 1,
Reason = ''Reason1'',
ErrField = '';6''
Where
UnitID is not null
and
UnitID not in (select UnitID from tblUnit Where OrganisationID = @intOrganisationID)
End

-- Unit Administrator
IF (@UserType = 3)
Begin
-- A table of units that this user can administer
Create Table #AdministerableUnits
(
UnitID int
)

-- populate the list
Insert into
#AdministerableUnits
select
u.UnitID
from
tblUnit as u
inner join tblUnitAdministrator as ua
on (u.unitID=ua.unitID)
and (ua.userID = @userID)

-- update rows that arent present in the users list of administerbale units.
Update
#xmlUserData
Set
Status = 1,
Reason = ''Reason2'',
ErrField = #xmlUserData.ErrField + '';6''
Where
UnitID is not null
and
UnitID not in (select UnitID from #AdministerableUnits)

Drop table #AdministerableUnits
End

-- Normal User
if (@UserType = 4)
Begin
Select ''Status1'' as ''Status''
Select *, 0 as ''RecordNumber'' from #xmlUserData
Rollback
return
End
--======================================================--
-- SECURITY FINISHED									--
--======================================================--


-- Get the total number of records to be processed.
Set @intRecordCountTotal = @@Rowcount
if ((select count(1) from #xmlUserData) > 1000)
Begin
Select ''Status2'' as ''Status''
Select *, 0 as ''RecordNumber'' from #xmlUserData
Rollback
return
End
-- remove the internal representation of the XML Document.
Exec sp_xml_removedocument @hdoc

--3. Data Validation

-- Validate that specified units exist (not active or not in this organisation).
-- and the unitID must be inside the specified organisation -#4
Update
#xmlUserData
Set
Status = 1,
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason3'',
ErrField = '';6''
Where	UnitID is not null
And
UnitID not in (select UnitID from tblUnit Where Active=1 and OrganisationID = @intOrganisationID)


-- Get a list of users whose user names already exist
-- when unique field is username, and username is found in database, update record

Update
#xmlUserData
Set
Status = CASE @uniqueField WHEN @constant_UserName
THEN
ISNULL(#xmlUserData.Status,2)
ELSE
case when usr.email = #xmlUserData.Email
then
ISNULL(#xmlUserData.Status,2)
else
1
end
END,
Reason = CASE @uniqueField WHEN @constant_UserName
THEN
#xmlUserData.Reason
ELSE
case when usr.email = #xmlUserData.Email
then
#xmlUserData.Reason
else
isNull(#xmlUserData.Reason+''; '','''')+ ''Reason4''
end
END,
ErrField = CASE @uniqueField WHEN @constant_UserName
THEN
#xmlUserData.ErrField
ELSE
case when usr.email = #xmlUserData.Email
then
#xmlUserData.ErrField
else
#xmlUserData.ErrField+'';1''
end
END
From
#xmlUserData
inner Join tblUser As usr
On #xmlUserData.Username = usr.Username and (usr.OrganisationID = @intOrganisationID or usr.OrganisationID is null)


-- Get a list of users whose email addresses already exist
-- Business logic changed:
--when unique field is email address, and email address is exists, update record
Update
#xmlUserData
Set
Reason = CASE @uniqueField WHEN @constant_EmailAddress
THEN
case when  (@intOrganisationID = usr.organisationid)
then
#xmlUserData.Reason
else
isNull(#xmlUserData.Reason+''; '','''')+ ''Reason5''
end
ELSE
case when #xmlUserData.Email = usr.Email and @intOrganisationID = usr.organisationid
then
#xmlUserData.Reason
else
isNull(#xmlUserData.Reason+''; '','''')+ ''Reason5''
end
END,
Status = CASE @uniqueField WHEN @constant_EmailAddress
THEN
case when  (@intOrganisationID = usr.organisationid)
then
ISNULL(#xmlUserData.Status,2)
else
1
end
ELSE
case when #xmlUserData.Email = usr.Email and @intOrganisationID = usr.organisationid
then
ISNULL(#xmlUserData.Status,2)
else
1
end
END,
ErrField = CASE @uniqueField WHEN @constant_EmailAddress
THEN
case when  (@intOrganisationID = usr.organisationid)
then
#xmlUserData.ErrField
else
#xmlUserData.ErrField + '';5''
end

ELSE
case when #xmlUserData.Email = usr.Email and @intOrganisationID = usr.organisationid
then
#xmlUserData.ErrField
else
#xmlUserData.ErrField + '';5''
end
END
From
#xmlUserData
inner Join tblUser As usr
On #xmlUserData.Email = usr.Email

--Get a list of users whose user name are duplicated in this batch
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason6'',
Status = 1,
ErrField = #xmlUserData.ErrField + '';1''
From
#xmlUserData
inner  join #xmlUserData u2
On #xmlUserData.Username = u2.Username
and u2.TempUserID>#xmlUserData.TempUserID

-- This adds the reason code to the other records with the duplicated user name
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason6'',
Status = 1,
ErrField = #xmlUserData.ErrField + '';1''
From
#xmlUserData
inner  join #xmlUserData u2
On #xmlUserData.Username = u2.Username
and u2.TempUserID<#xmlUserData.TempUserID
and #xmlUserData.TempUserID not in
(select u3.TempUserID from
#xmlUserData u3
inner  join #xmlUserData u4
On u3.Username = u4.Username
and u4.TempUserID>u3.TempUserID)

--Get a list of users whos username is the same as their password
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason7'',
Status = 1,
ErrField = #xmlUserData.ErrField + '';1;2''
From
#xmlUserData
Where
UserName = Password

--Get a list of users whose email addresses are duplicated in this batch
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason8'',
Status = 1,
ErrField = #xmlUserData.ErrField + '';5''
From
#xmlUserData
inner  join #xmlUserData u2
On #xmlUserData.Email = u2.Email
and u2.TempUserID>#xmlUserData.TempUserID

-- This adds the reason code to the other records with the duplicated emails
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason8'',
Status = 1,
ErrField = #xmlUserData.ErrField + '';5''
From
#xmlUserData
inner  join #xmlUserData u2
On #xmlUserData.Email = u2.Email
and u2.TempUserID<#xmlUserData.TempUserID
and #xmlUserData.TempUserID not in
(select u3.TempUserID from
#xmlUserData u3
inner  join #xmlUserData u4
On u3.Email = u4.Email
and u4.TempUserID>u3.TempUserID)


-- Get a list of users who are missing a first or last name
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason9'',
Status = 1,
ErrField = #xmlUserData.ErrField +'';3''
Where
len(FirstName) = 0
and Status <> 2 -- allow empty value with update user

-- Get a list of users who are missing a first or last name
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason9'',
Status = 1,
ErrField = #xmlUserData.ErrField +'';4''
Where
len(LastName) = 0
and Status <> 2 -- allow empty value with update user

-- check that the archive bit has been set
Update
#xmlUserData
Set
Reason = isNull(#xmlUserData.Reason+''; '','''')+ ''Reason11'',
Status = 1,
ErrField = #xmlUserData.ErrField +'';7'',
Archive = null
Where
Archive = 2

-- Change made for consistancy - see bug ID 269 for further info.
-- Empty string values for External ID should be NULLs
UPDATE #xmlUserData
SET
[ExternalID]=NULL
WHERE
[ExternalID]=''''

UPDATE #xmlUserData
SET
Status = 3
--Reason = ''Add User''
WHERE
Status is null
and
Reason is null

Select
''Status'' = ''Status5''
Select
tmp.TempUserID As ''RowNumber'',
tmp.Username,
tmp.Password,
tmp.Firstname,
tmp.Lastname,
tmp.Email,
UnitID,
tmp.Status,
tmp.Reason as Reason,
tmp.ClassificationOption,
tmp.ClassificationName,
tmp.ExternalID,
tmp.ErrField,
tmp.Archive,
tmp.NotifyUnitAdmin,
tmp.NotifyOrgAdmin,
tmp.ManagerNotification,
tmp.ManagerToNotify
From
#xmlUserData As tmp

drop table #xmlUserData
commit

SET ANSI_NULLS ON
' 
END
GO





IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ReportStartDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF_tblReportSchedule_ReportStartDate]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ParamLangCode]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF_tblReportSchedule_ParamLangCode]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF__tblReport__Param__082CD432]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF__tblReport__Param__082CD432]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ParamProfilePeriodID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF_tblReportSchedule_ParamProfilePeriodID]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_OnceOnly]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF_tblReportSchedule_OnceOnly]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_Now]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] DROP CONSTRAINT [DF_tblReportSchedule_Now]
END

GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblReportSchedule]') AND type in (N'U'))
DROP TABLE [tblReportSchedule]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblReportSchedule]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblReportSchedule](
	[ScheduleID] [int] IDENTITY(1,1) NOT NULL,
	[UserID] [int] NOT NULL,
	[ReportID] [int] NOT NULL,
	[LastRun] [datetime] NULL,
	[NextRun] [datetime] NULL,
	[ReportDuration] [int] NOT NULL,
	[ReportDurationPeriod] [char](1) NOT NULL,
	[ReportStartDate] [datetime] NOT NULL,	
	[ReportEndDate] [datetime] NULL,
	[NumberOfReports] [int] NULL,
	[ReportFrequency] [int] NOT NULL,
	[ReportFrequencyPeriod] [char](1) NOT NULL,
	[DocumentType] [char](1) NOT NULL,
	[CCList] [varchar](max) NULL,
	[OnceOnly] [bit] NOT NULL,
	[Now] [bit] NOT NULL,
	[ReportTitle] [nvarchar](100) NULL,
	[ParamOrganisationID] [int] NOT NULL,
	[ParamCompleted] [char](1) NULL,
	[ParamStatus] [char](1) NULL,
	[ParamFailCount] [int] NULL,
	[ParamCourseIDs] [nvarchar](800) NULL,
	[ParamHistoricCourseIDs] [nvarchar](800) NULL,
	[ParamAllUnits] [char](1) NULL,
	[ParamTimeExpired] [int] NULL,
	[ParamTimeExpiredPeriod] [char](1) NULL,
	[ParamQuizStatus] [char](1) NULL,
	[ParamGroupBy] [char](1) NULL,
	[ParamGroupingOption] [int] NULL,
	[ParamFirstName] [nvarchar](200) NULL,
	[ParamLastName] [nvarchar](200) NULL,
	[ParamUserName] [nvarchar](200) NULL,
	[ParamEmail] [nvarchar](200) NULL,
	[ParamIncludeInactive] [char](1) NULL,
	[ParamSubject] [nvarchar](200) NULL,
	[ParamBody] [nvarchar](200) NULL,
	[ParamProfileID] [int] NULL,
	[ParamOnlyUsersWithShortfall] [char](1) NULL,
	[ParamEffectiveDate] [datetime] NULL,
	[ParamSortBy] [char](1) NULL,
	[ParamClassificationID] [int] NULL,
	[ParamUnitIDs] [nvarchar](max) NULL,
	[ParamLangCode] [nvarchar](10) NULL,
	[ParamDateTo] [datetime] NULL,
	[ParamDateFrom] [datetime] NULL,
	[ParamLicensingPeriod] [int] NULL,
	[ParamProfilePeriodID] [int] NOT NULL,
	[ReportPeriodType] [int] NULL,
	[ReportFromDate] [datetime] NULL
) ON [PRIMARY]
END
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ReportStartDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF_tblReportSchedule_ReportStartDate]  DEFAULT (getutcdate()) FOR [ReportStartDate]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ParamLangCode]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF_tblReportSchedule_ParamLangCode]  DEFAULT (N'en-AU') FOR [ParamLangCode]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF__tblReport__Param__082CD432]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF__tblReport__Param__082CD432]  DEFAULT ((0)) FOR [ParamLicensingPeriod]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_ParamProfilePeriodID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF_tblReportSchedule_ParamProfilePeriodID]  DEFAULT ((1)) FOR [ParamProfilePeriodID]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_OnceOnly]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF_tblReportSchedule_OnceOnly]  DEFAULT ((0)) FOR [OnceOnly]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportSchedule_Now]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportSchedule] ADD  CONSTRAINT [DF_tblReportSchedule_Now]  DEFAULT ((0)) FOR [Now]
END

GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblExpiredNewContent]') AND type in (N'U'))
DROP TABLE [tblExpiredNewContent]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblExpiredNewContent]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblExpiredNewContent](
	[ExpiredContentID] [int] IDENTITY(1,1) NOT NULL,
	[ModuleID] [int] NOT NULL,
	[OrganisationID] [int] NOT NULL,
	[UserID] [int] NOT NULL,
 CONSTRAINT [PK_tblExpiredNewContent] PRIMARY KEY CLUSTERED 
(
	[ExpiredContentID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblQuizExpiryAtRisk]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblQuizExpiryAtRisk](
	[UserID] [int] NOT NULL,
	[ModuleID] [int] NOT NULL,
	[DaysToExpiry] [int] NULL,
	[OrganisationID] [int] NOT NULL,
    Notified bit NOT NULL CONSTRAINT DF_tblQuizExpiryAtRisk_Notified DEFAULT 0

 CONSTRAINT [PK_tblQuizExpiryAtRisk] PRIMARY KEY CLUSTERED 
(
	[UserID] ASC,
	[ModuleID] ASC,
	[OrganisationID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO




IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblTimeZone]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblTimeZone](
	[TimeZoneID] [int] IDENTITY(1,1) NOT NULL,
	[WrittenName] [nvarchar](60) NOT NULL,
	[OffsetUTC] [int] NOT NULL,
	[FLB_Name] [nchar](60) NULL,
	[Active] [bit] NOT NULL,
 CONSTRAINT [PK_tblTimeZone] PRIMARY KEY CLUSTERED 
(
	[TimeZoneID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZone_Active]') AND type = 'D')
BEGIN
ALTER TABLE [tblTimeZone] ADD  CONSTRAINT [DF_tblTimeZone_Active]  DEFAULT ((1)) FOR [Active]
END

GO






IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblTimeZoneDaylightSavingRules]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblTimeZoneDaylightSavingRules](
	[TimezoneID] [int] NOT NULL,
	[start_year] [smallint] NULL,
	[end_year] [smallint] NULL,
	[offset_mins] [int] NULL,
	[hours_start] [smallint] NULL,
	[day_start] [tinyint] NULL,
	[week_start] [tinyint] NULL,
	[month_start] [tinyint] NULL,
	[hours_end] [smallint] NULL,
	[day_end] [tinyint] NULL,
	[week_end] [tinyint] NULL,
	[month_end] [tinyint] NULL,
	[first_start_date] [datetime] NOT NULL,
	[last_end_date] [datetime] NOT NULL,
	[Last_updated] [datetime] NOT NULL,
 CONSTRAINT [PK_tblTimeZoneDaylightSavingRules] PRIMARY KEY CLUSTERED 
(
	[TimezoneID] ASC,
	[first_start_date] ASC,
	[last_end_date] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZoneDaylightSavingRules_Last_updated]') AND type = 'D')
BEGIN
ALTER TABLE [tblTimeZoneDaylightSavingRules] ADD  CONSTRAINT [DF_tblTimeZoneDaylightSavingRules_Last_updated]  DEFAULT (getdate()) FOR [Last_updated]
END

GO







if (0 = (SELECT COUNT (*) FROM tblTimeZone)) 
begin
	INSERT INTO tblTimeZone ([WrittenName] ,[OffsetUTC],FLB_Name)
		VALUES
           ('AUS Eastern Standard Time',600,'(GMT+10:00) Canberra, Melbourne, Sydney')
	

end




if not exists (select * from sysobjects o, syscolumns c 
        where o.id = c.id and o.type = 'U'and o.name = 'tblOrganisation'
				and c.name = 'TimeZoneID'
        )
        begin
			ALTER TABLE dbo.tblOrganisation ADD	
			    TimeZoneID int NOT NULL DEFAULT 1,
	            CourseStatusLastUpdated datetime NOT NULL CONSTRAINT DF_tblOrganisation_CourseStatusLastUpdated DEFAULT '1 jan 2001',
	            DelinquencyPeriod int NOT NULL CONSTRAINT DF_tblOrganisation_DelinquencyPeriod DEFAULT -1,
	            DelinquencyReminderPeriod int NOT NULL CONSTRAINT DF_tblOrganisation_DelinquencyReminderPeriod DEFAULT 0,
	            NumberOfReminders int NOT NULL CONSTRAINT DF_tblOrganisation_NumberOfReminders DEFAULT 0,
	            DelinquenciesLastNotified datetime NOT NULL CONSTRAINT DF_tblOrganisation_DelinquenciesLastNotified DEFAULT '1 jan 2001',
	            DaysWarningBeforeExpiry int NULL CONSTRAINT DF_tblOrganisation_DaysWarningBeforeExpiry DEFAULT 30,
	            IncludeLogoOnCorrespondence bit NOT NULL CONSTRAINT DF_tblOrganisation_IncludeLogoOnCorrespondence DEFAULT 0,
	            QuizDueDate datetime NOT NULL DEFAULT dateadd(dayofyear,(1),getdate()) 
	     

           


		end
go

if not exists (select * from sysobjects o, syscolumns c 
        where o.id = c.id and o.type = 'U'and o.name = 'tblUser'
				and c.name = 'TimeZoneID'
        )
begin
	ALTER TABLE dbo.tblUser ADD	
	TimeZoneID int NULL,
	DelinquencyManagerEmail nvarchar(100) NULL,
	NotifyOfPendingDelinquencies bit NOT NULL CONSTRAINT DF_tblUser_NotifyOfPendingDelinquencies DEFAULT 1,
	NewStarter bit NOT NULL CONSTRAINT DF_tblUser_NewStarter DEFAULT 0


end




 SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetTimeZone]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE Procedure [prcOrganisation_GetTimeZone]
(
	@OrganisationID int
)

As

select TimeZoneID from tblOrganisation where organisationID = @OrganisationID

' 
END
GO

SET QUOTED_IDENTIFIER ON
GO






IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_NumberOfDelinquencyNotifications]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] DROP CONSTRAINT [DF_tblUserCourseDetails_NumberOfDelinquencyNotifications]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_AtRiskQuizList]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] DROP CONSTRAINT [DF_tblUserCourseDetails_AtRiskQuizList]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_NotifiedAtRiskQuizList]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] DROP CONSTRAINT [DF_tblUserCourseDetails_NotifiedAtRiskQuizList]
END

GO

IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_LastDelNoteToMgr]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] DROP CONSTRAINT [DF_tblUserCourseDetails_LastDelNoteToMgr]
END

GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblUserCourseDetails]') AND type in (N'U'))
DROP TABLE [tblUserCourseDetails]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblUserCourseDetails]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblUserCourseDetails](
	[UserID] [int] NOT NULL,
	[CourseID] [int] NOT NULL,
	[NumberOfDelinquencyNotifications] [int] NOT NULL,
	[NewStarterFlag] [bit] NULL,
	[AtRiskQuizList] [nvarchar](max) NOT NULL,
	[NotifiedModuleList] [nvarchar](max) NOT NULL,
	[LastDelinquencyNotification] [datetime] NULL,
	[UserCourseStatusID] [int] NOT NULL,
	[LastDelNoteToMgr] [bit] NOT NULL,
 CONSTRAINT [PK_tblUserCourseDetails] PRIMARY KEY CLUSTERED 
(
	[UserCourseStatusID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_NumberOfDelinquencyNotifications]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] ADD  CONSTRAINT [DF_tblUserCourseDetails_NumberOfDelinquencyNotifications]  DEFAULT ((0)) FOR [NumberOfDelinquencyNotifications]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_AtRiskQuizList]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] ADD  CONSTRAINT [DF_tblUserCourseDetails_AtRiskQuizList]  DEFAULT ('') FOR [AtRiskQuizList]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_NotifiedAtRiskQuizList]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] ADD  CONSTRAINT [DF_tblUserCourseDetails_NotifiedAtRiskQuizList]  DEFAULT ('') FOR [NotifiedModuleList]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseDetails_LastDelNoteToMgr]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCourseDetails] ADD  CONSTRAINT [DF_tblUserCourseDetails_LastDelNoteToMgr]  DEFAULT ((0)) FOR [LastDelNoteToMgr]
END

GO






IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[ToUTC]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [ToUTC]
(
		@LocalTime DateTime		
)
RETURNS DateTime
AS
BEGIN
	IF (@LocalTime is null) RETURN null
	
	DECLARE @DSTTime datetime
	DECLARE @UTC_Offset int
	DECLARE @Timezone datetime
	DECLARE @offset_mins int, @hours_start int, @day_start int, @week_start int, @month_start int, @hours_end int, @day_end int, @week_end int, @month_end int, @year_end int , @year_start int
	SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
	FROM tblTimeZone TZ 
	INNER JOIN tblAppConfig App ON  App.Value=TZ.WrittenName
	--WHERE TZ.TimeZoneID = Org.TimeZoneID
	IF (@UTC_Offset IS NULL) 
	BEGIN
		Set @DSTTime = ''1 Jan 1900'' --  create an "error" that will be apparent in Report
	END
	ELSE
	BEGIN
		Set @DSTTime = DATEADD(minute,-@UTC_Offset,@LocalTime )
		SELECT  @offset_mins = offset_mins, --get definition of the (at most) 1 definition that may cover the datetime
				@hours_start = hours_start, --overlapping definitions removed by GUI so only 1 result returned
				@day_start = day_start,
				@week_start = week_start,
				@month_start = month_start,
				@hours_end = hours_end,
				@day_end = day_end,
				@week_end = week_end,
				@month_end = month_end
		FROM tblTimeZoneDaylightSavingRules 
		WHERE  TimezoneID = @Timezone
		AND @LocalTime >= first_start_date
		AND @LocalTime <= last_end_date  
		Set @year_start = year(@LocalTime) --now calculate the exact start and end dates and times for the year under consideration
		
		DECLARE @Period_start datetime, @period_end datetime		
		Set @year_start = year(@LocalTime) 
		set @year_end = year(@LocalTime)
		
		if (month(@LocalTime) <= @month_end) and (@month_start > @month_end) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
		
		IF(@month_start > @month_end) and (month(@LocalTime) >= @month_start) set @year_end = @year_start + 1  -- rule spans december 31 so adjust
		
		--IF(@month_start > @month_end) set @year_end = @year_start + 1 else set @year_end = @year_start
		--DECLARE @Period_start datetime, @period_end datetime
		
		set @Period_start = ''1 jan 2000'' -- start with a known datetime
		set @year_start = @year_start - 2000
		Set @Period_start = DATEADD(year,@year_start,@Period_start) -- then set the year correctly
		-- Then move to the correct month
		Set @Period_start = DATEADD(month,@month_start-1,@Period_start)
		-- Then move to the correct week (let week 5 slide to the next month for now)
		Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
		-- Now move FORWARD to the correct day (say) the 5th sunday of february
		Declare @day_offset int
		if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
		Set @Period_start = DATEADD(day,@day_offset,@Period_start)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_start) > @month_start) set @Period_start = DATEADD(week,-1,@Period_start)
		Set @Period_start = DATEADD(minute,@hours_start,@Period_start)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end

		set @Period_end = ''1 jan 2000'' -- start with a known datetime
		set @year_end = @year_end - 2000
		Set @Period_end = DATEADD(year,@year_end,@Period_end) -- then adjust it to match the definition
		Set @Period_end = DATEADD(month,@month_end-1,@Period_end)
		Set @Period_end = DATEADD(week,@week_end-1,@Period_end)
		if (@day_end >=  DatePart(weekday,@Period_end) ) set @day_offset = @day_end -  DatePart(weekday,@Period_end) else  set @day_offset = @day_end -  DatePart(weekday,@Period_end) + 7
		Set @Period_end = DATEADD(day,@day_offset,@Period_end)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_end) > @month_end) set @Period_end = DATEADD(week,-1,@Period_end)
		Set @Period_end = DATEADD(minute,@hours_end,@Period_end)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end
		--Set @Period_end = DATEADD(minute,-@offset_mins,@Period_end) -- end time is quoted with daylight savings included
		
		
		IF (@LocalTime >= @Period_start) 
		AND (@LocalTime < @Period_end) set @DSTTime = DATEADD(minute,-@offset_mins,@DSTTime)
	END
	RETURN @DSTTime
END
' 
END

GO







IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserQuizStatus_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserQuizStatus_Update]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserQuizStatus_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/* 

CALLS prcUserQuizStatus_Update_Quick

**/
CREATE   Procedure [prcUserQuizStatus_Update]
AS
Set Nocount On
declare @intHistoryID int

insert into tblModuleStatusUpdateHistory(startTime) values(getutcdate());
set @intHistoryID = @@identity


declare @cursor_OrgID	    int

DECLARE OrgList CURSOR
FOR
	SELECT OrganisationID 
	from tblOrganisation 
	WHERE DATEDIFF (d,CourseStatusLastUpdated,dbo.udfUTCtoDaylightSavingTime(getutcdate(),OrganisationID)) > 0
	order by OrganisationID desc
	
	Open OrgList

		FETCH NEXT FROM OrgList
		Into
		@cursor_OrgID

		WHILE @@FETCH_STATUS = 0
		BEGIN
		
			exec prcUserQuizStatus_Update_Quick @cursor_OrgID
			exec prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick @cursor_OrgID
			print ''Completed Organisation: '' + Cast(@cursor_OrgID as varchar)

			FETCH NEXT FROM OrgList Into @cursor_OrgID
		END

	CLOSE OrgList
DEALLOCATE OrgList



update tblModuleStatusUpdateHistory
set FinishTime = getutcdate()
where ModuleStatusUpdateHistoryID = @intHistoryID
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetNextReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_GetNextReport]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetNextReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcReport_GetNextReport]

AS
BEGIN

SET NOCOUNT ON
DECLARE @ScheduleID int
SELECT @ScheduleID = MIN (ScheduleID)
FROM tblReportSchedule
INNER JOIN tblReportInterface ON tblReportSchedule.ReportID = tblReportInterface.ReportID
INNER JOIN tblUser ON tblReportSchedule.UserID = tblUser.UserID
INNER JOIN tblOrganisation ON tblOrganisation.OrganisationID = tblReportSchedule.ParamOrganisationID
WHERE  CourseStatusLastUpdated > dbo.udfGetSaltOrgMidnight(tblUser.OrganisationID)
AND ((tblUser.Active = 1) AND ((LastRun IS NULL) AND ReportStartDate < dbo.udfDaylightSavingTimeToUTC(GETUTCDATE(),tblReportSchedule.ParamOrganisationID))
OR ((ReportFrequencyPeriod=''Y'') AND (GETUTCDATE() > DATEADD(YEAR,ReportFrequency,LastRun)) AND (tblUser.Active = 1))
OR  ((ReportFrequencyPeriod=''M'') AND (GETUTCDATE() > DATEADD(MONTH,ReportFrequency,LastRun))AND (tblUser.Active = 1))
OR  ((ReportFrequencyPeriod=''W'') AND (GETUTCDATE() > DATEADD(WEEK,ReportFrequency,LastRun))AND (tblUser.Active = 1))
OR  ((ReportFrequencyPeriod=''D'') AND (GETUTCDATE() > DATEADD(DAY,ReportFrequency,LastRun))AND (tblUser.Active = 1))
OR  ((ReportFrequencyPeriod=''H'') AND (GETUTCDATE() > DATEADD(HOUR,ReportFrequency,LastRun))AND (tblUser.Active = 1)))

DECLARE @LastRun datetime
SELECT @LastRun = 
CASE 
WHEN ReportFrequencyPeriod=''H'' THEN dateadd(hh,datediff(hh,COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)),GETUTCDATE()),COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)))
WHEN ReportFrequencyPeriod=''D'' THEN dateadd(dd,datediff(dd,COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)),GETUTCDATE()),COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID))) -- eg if the report is run after 3.015 days just increment the ''Nextrun'' to 3 days after it was last run
WHEN ReportFrequencyPeriod=''W'' THEN dateadd(ww,datediff(ww,COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)),GETUTCDATE()),COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)))
WHEN ReportFrequencyPeriod=''M'' THEN dateadd(mm,datediff(mm,COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)),GETUTCDATE()),COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)))
WHEN ReportFrequencyPeriod=''Y'' THEN dateadd(yy,datediff(yy,COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)),GETUTCDATE()),COALESCE(LastRun,dbo.udfDaylightSavingTimeToUTC(ReportStartDate,tblReportSchedule.ParamOrganisationID)))
END FROM tblReportSchedule WHERE ScheduleID = @ScheduleID



UPDATE tblReportSchedule SET LastRun = @Lastrun WHERE ScheduleID = @ScheduleID

SET NOCOUNT OFF
SELECT TOP (1) [ScheduleID]
,RS.UserID
,RS.ReportID
,[LastRun]
,[ReportDuration]
,[ReportDurationPeriod]
,[ReportStartDate]
,[ReportFrequency]
,[ReportFrequencyPeriod]
,[DocumentType]
,[ParamOrganisationID]
,[ParamCompleted]
,[ParamStatus]
,[ParamFailCount]
,[ParamCourseIDs]
,[ParamHistoricCourseIDs]
,[ParamAllUnits]
,[ParamTimeExpired]
,[ParamTimeExpiredPeriod]
,[ParamQuizStatus]
,[ParamGroupBy]
,[ParamGroupingOption]
,[ParamFirstName]
,[ParamLastName]
,[ParamUserName]
,[ParamEmail]
,[ParamIncludeInactive]
,[ParamSubject]
,[ParamBody]
,[ParamProfileID]
,[ParamOnlyUsersWithShortfall]
,[ParamEffectiveDate]
,[ParamSortBy]
,[ParamClassificationID]
, case   
 when tblReportinterface.ReportID = 26 then (select coalesce(LangEntryValue,''Missing Localisation'') from tblLangValue where tblLangValue.LangID = (SELECT LangID FROM tblLang where tblLang.LangCode = RS.ParamLangCode) and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = ''/Reporting/Admin/AdministrationReport.aspx'') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = ''lblPageTitle.2''))   
 when tblReportinterface.ReportID = 27 then (select coalesce(LangEntryValue,''Missing Localisation'') from tblLangValue where tblLangValue.LangID = (SELECT LangID FROM tblLang where tblLang.LangCode = RS.ParamLangCode) and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = ''/Reporting/Admin/AdministrationReport.aspx'') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = ''lblPageTitle.2''))   
 when tblReportinterface.ReportID = 3 then (select coalesce(LangEntryValue,''Missing Localisation'') from tblLangValue where tblLangValue.LangID = (SELECT LangID FROM tblLang where tblLang.LangCode = RS.ParamLangCode) and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = ''/Reporting/Admin/AdministrationReport.aspx'') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = ''lblPageTitle.1''))   
  when tblReportinterface.ReportID = 6 then (select coalesce(LangEntryValue,''Missing Localisation'') from tblLangValue where tblLangValue.LangID = (SELECT LangID FROM tblLang where tblLang.LangCode = RS.ParamLangCode) and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = ''/Reporting/Admin/AdministrationReport.aspx'') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = ''lblPageTitle.1''))   
  else coalesce(tblLangValue.LangEntryValue,''Missing Localisation'')   
  end as ReportName
,tblReportInterface.RDLname
,tblUser.FirstName
,tblUser.LastName
,tblUser.Email
,ParamUnitIDs
,paramOrganisationID
,tblUser.EmailInOrgDomain
,RS.ParamLangCode
,ParamLangCode
,ParamLicensingPeriod
,RS.ReportEndDate
,RS.ReportTitle
,RS.NumberOfReports
,RS.ReportFromDate
,RS.CCList
,RS.OnceOnly
,RS.Now
,RS.ReportPeriodType




   
  FROM 
  tblReportinterface     
  inner join tblReportSchedule RS  on tblReportinterface.ReportID = RS.ReportID     
  INNER JOIN tblUser ON RS.UserID = tblUser.UserID
  LEFT OUTER JOIN tblLang ON tblLang.LangCode = RS.ParamLangCode 
  LEFT OUTER JOIN tblLangInterface ON  paramlanginterfacename = tblLangInterface.langinterfacename 
  LEFT OUTER JOIN tblLangResource ON  tblLangResource.langresourcename = ''rptreporttitle''
  LEFT OUTER JOIN tblLangValue ON tblLang.LangID = tblLangValue.LangID   AND (tblLangValue.Active = 1) and tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID and tblLangValue.LangResourceID = tblLangResource.LangResourceID 
  
WHERE ScheduleID = @ScheduleID


END
' 
END
GO










IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfGetSaltOrgDate]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_OrganisationsToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_OrganisationsToNotify]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetTimeZoneStandardName]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOrganisation_GetTimeZoneStandardName]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOvernightJobPreprocessOneOrg]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOvernightJobPreprocessOneOrg]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetTimeZoneID]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTimeZone_GetTimeZoneID]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetTimeZoneBySessionID]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_GetTimeZoneBySessionID]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[GetSaltDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [GetSaltDate]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUnit_GetAdministratorsEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfUnit_GetAdministratorsEmailAddress]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUnit_GetAdministratorsEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'




create function [udfUnit_GetAdministratorsEmailAddress]
(
	@unitID	int
)
Returns varchar(100)
AS
BEGIN
DECLARE @Email VARCHAR(100)
SELECT @Email = coalesce(
-- try to get the closest unit admin then search further afield
(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
and u.unitID=@unitID
and u.Email is not null),


(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
	and u.Email is not null),

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 2
and Email is not null),
	

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 1
and Email is not null),

--all else failed so get the salt admin
(Select top 1	u.Email
from tblUser u 
where UserTypeID = 1
and Email is not null))
	


return @Email
END' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblReportType]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblReportType](
	[Type] [varchar](20) NULL,
	[Name] [varchar](200) NULL,
	[Description] [varchar](200) NULL,
	[ServerVersion] [varchar](200) NULL
) ON [PRIMARY]
END
GO
SET ANSI_PADDING OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[GetSaltDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [GetSaltDate]
(

)
RETURNS DateTime
AS
BEGIN

	DECLARE @UTCDate datetime

	SELECT @UTCDate = dbo.getUTCdate()


	RETURN @UTCDate

END
' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetTimeZoneBySessionID]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_GetTimeZoneBySessionID]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetTimeZoneBySessionID]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


CREATE Procedure [prcUser_GetTimeZoneBySessionID]
(
	@SessionID varchar(50) 		-- Session ID of the user we are looking for.
)

As

	Set NoCount On

	-- Declarations
	Declare @userID Integer
	
	-- Validation
	If (@SessionID Is Null)
	Begin
		Raiserror(''The Parameter @SessionID was null.  @SessionID does not accept Null values.'', 16, 1)
		Return
	End

	-- Logic
	Set @userID= dbo.udfGetUserIDBySessionID(@SessionID)
	
	
	Select
	coalesce(USR.TimeZoneID,ORG.TimeZoneID) as TimeZone
	From
    tblOrganisation ORG 
	inner join tblUser USR on ORG.OrganisationID = USR.OrganisationID
	inner join tblLessonSession LS on LS.UserID = USR.UserID
	WHERE LessonSessionID = ltrim(rtrim(@sessionID))

	

	Select 
		@UserID as ''UserID''


' 
END
GO





IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetTimeZoneID]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE Procedure [prcTimeZone_GetTimeZoneID]
(
	@WrittenName varchar(60),
	@TimeZoneID int output
)

As

select @TimeZoneID = coalesce(TimeZoneID,1) from tblTimeZone where upper(WrittenName) = upper(@WrittenName)
select @TimeZoneID

' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOvernightJobPreprocessOneOrg]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Procedure [prcOvernightJobPreprocessOneOrg]
AS
BEGIN


declare @cursor_OrgID	    int
-- get the next OrgID (prcOvernightJobGetNextPreprocessingOrg remembers the last OrgID to be preprocessed)
exec @cursor_OrgID = dbo.prcOvernightJobGetNextPreprocessingOrg	

-- update the UserLessonStatus for this org (handles the administrative changes to modules assigned to students) 
--(originally this appears to have been done by triggers but it appears that the triggers slowed the ASP.NET WebPage too much and were replaced by the overnight job)
exec prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick @cursor_OrgID



END' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetTimeZoneStandardName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


Create Procedure [prcOrganisation_GetTimeZoneStandardName]
(
	@OrgID int 		-- Organisation ID 
)

As

	Set NoCount On

	-- Declarations
	Declare @userID Integer
	
	-- Validation
	If (@OrgID Is Null)
	Begin
		Raiserror(''The Parameter @OrgID was null.  @OrgID does not accept Null values.'', 16, 1)
		Return
	End

	-- Logic
	
	Select
	WrittenName
	From
    tblOrganisation ORG 
	inner join tblTimeZone TZ on ORG.TimeZoneID = TZ.TimeZoneID

	WHERE ORG.OrganisationID = @OrgID

	
' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_OrganisationsToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE   Procedure [prcAutomatedEmails_OrganisationsToNotify]
AS
Set Nocount On



declare @OrgID	    int

	SELECT @OrgID = cast(coalesce((SELECT top 1 OrganisationID 
	from tblOrganisation 
	WHERE DelinquenciesLastNotified < CourseStatusLastUpdated) ,-1) as varchar(50))
	
update tblOrganisation set DelinquenciesLastNotified = CourseStatusLastUpdated where @OrgID = OrganisationID

select @OrgID
return @OrgID


' 
END
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE FUNCTION [udfGetSaltOrgDate]
(
		@OrgID int

)
RETURNS DateTime
AS
BEGIN

	DECLARE @ORGDate datetime

	SELECT @ORGDate = CAST(convert( varchar(11), dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(),@OrgID),113) AS DateTime)


	RETURN @ORGDate

END

' 
END
GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserQuizStatus_Update_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/****** Object:  Stored Procedure dbo.prcUserQuizStatus_Update_Quick    Script Date: 3/05/2004 10:56:48 AM ******/

/* Summary:
Update quiz status for each user

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user quiz status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''Not started''.
If a module is unassigned from a user, the status will be ''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''unassinged''

All user-module pair need to be re-evaluated, as compliance rules may be changed since the user''s last toolbook activity.

------------ Decision Processes -------------

1. Get Current User Quiz status
-----------------------------------
1.1  Get all modules that are currently assigned to each users (CurrentAssignedModules)
and compliance rules

1.2. Get the last quiz activity for each user and module pair (StartedModules)

1.3. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
a) Get a list of modules that is in the quiz status table that the last statuses are not Unassigned (0)(PreviousAssignedModules)
b) Get rid off all modules that are currently assigned to the users (from step 1)
c)All modules left are Unassigned(0)

1.4. Not Started Modules (1) (CurrentAssignedModules- StartedModules)
All currently assigned modules that don''t have any activity is Not Started (1)

1.5. Started Modules
a)If the last quiz is inactive, the status is Expired (New Content)(5)
b)If the last quiz is past the current quiz date/frequency, the status is Expired (Time Expired)(4)
c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
If user Failed the quiz, the status is Failed (3)
If user Passed the quiz, the status is Passed (2)

2. Update User Quiz status
----------------------------
If the last quiz status for each user is not the same as the current status, add the new status



------------ Data need to be recorded -------------

QuizFrequency	QuizPassMark	QuizScore
0  Unassigned:  		-		-		-
1  Not Started: 		Y		Y		-
2  Passed: 	 		Y		Y		Y
3  Failed: 	 		Y		Y		Y
4  Expired (Time Elapsed): 	Y		Y		-
5  Expired (New Content): 	Y		Y		-


Author: Jack Liu
Date Created: 20 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added logic for new fields LessonCompletionStatus & QuizCompletionStatus
#2	mikev		9/5/2007		Added course completion logic. If a module is marked active or not active; to calculate if the course is complete.
#3	Mark Donald	21/9/2009		Added OrganisationName (control character) to License Warning emails

prcUserQuizStatus_Update_Quick

**/
ALTER   Procedure [prcUserQuizStatus_Update_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On
declare @intHistoryID int

insert into tblModuleStatusUpdateHistory(startTime) values(getUTCdate());
set @intHistoryID = @@identity

--1. Get Current User Quiz status
--mikev : added QuizCompletionDate
/* UNITTEST: CurrentAssignedModules */
CREATE TABLE #tblCurrentUserQuizStatus
(
UserID int NOT NULL ,
ModuleID int NOT NULL ,
QuizStatusID int not NULL ,
QuizFrequency int NULL ,
QuizPassMark int NULL ,
QuizCompletionDate DateTime NULL,
QuizScore int NULL,
QuizSessionID uniqueidentifier NULL
)


/*
1.1  Get all modules that are currently assigned to each users (CurrentAssignedModules)
and current compliance rules
*/
-- mikev(1): added completion date

select
um.UserID,
um.ModuleID,
umr.QuizFrequency,
umr.QuizPassMark,
umr.QuizCompletionDate
into
#tblCurrentAssignedModules
from
(
Select
tU.UserID
, tU.FirstName
, tU.LastName
, tU.UnitID
, tU.OrganisationID
, tM.ModuleID
, tM.CourseID
, tC.Name ''CourseName''
, tM.Name
, tM.Sequence
, tM.Description
From
dbo.tblUser tU
--< get the courses a user has access to >--
Inner Join dbo.tblOrganisationCourseAccess tOCA
On  tOCA.OrganisationID = tU.OrganisationID
--< get the course details >--
Inner join dbo.tblCourse tC
On tC.CourseID = tOCA.GrantedCourseID
--< get the Active modules in a course >--
inner join dbo.tblModule tM
On tM.CourseID = tC.CourseID
and tM.Active = 1
--< get the details on which moduels a user is configured to access >--
Left Outer join dbo.tblUserModuleAccess tUsrMA
On  tUsrMA.UserID = tU.UserID
And tUsrMA.ModuleID = tM.ModuleID
--< get the details on which moduels a user''s Unit is excluded from  >--
Left Outer Join dbo.tblUnitModuleAccess tUnitMA
On  tUnitMA.UnitID = tU.UnitID
And tUnitMA.DeniedModuleID = tM.ModuleID
Where
tU.OrganisationID = @OrgID AND
tU.Active = 1
--< Active users only >--
and tu.UnitID is not null
--< Get the modules that the user''s Unit is not denied >--
and (tUnitMA.DeniedModuleID  is null
--<  and the user does not have special access to  it>--
And tUsrMA.ModuleID is null)
--< or Get modules that the user has been specially  granted
or tUsrMA.Granted=1
) um
inner join
(
Select 	u.UnitID,
m.CourseID,
m.ModuleID,
m.Name,
case
when ur.unitID is null then cast(1 as bit)
else cast(0 as bit)
end as UsingDefault,
case
when (ur.LessonFrequency is null and ur.LessonCompletionDate is null and o.DefaultLessonCompletionDate is null) then
o.DefaultLessonFrequency
else
ur.LessonFrequency
end
as LessonFrequency,
case
when (ur.QuizFrequency is null and ur.QuizCompletionDate is null and o.DefaultQuizCompletionDate is null) then
o.DefaultQuizFrequency
else
ur.QuizFrequency
end
as QuizFrequency,
isNull(ur.QuizPassMark, o.DefaultQuizPassMark) as QuizPassMark,
case
when (ur.LessonFrequency is null and ur.LessonCompletionDate is null and not(o.DefaultLessonCompletionDate is null)) then
o.DefaultLessonCompletionDate
else
ur.LessonCompletionDate
end
as LessonCompletionDate,
case
when (ur.QuizFrequency is null and ur.QuizCompletionDate is null and not(o.DefaultQuizCompletionDate is null)) then
o.DefaultQuizCompletionDate
else
ur.QuizCompletionDate
end
as QuizCompletionDate
From tblOrganisationCourseAccess c
inner join tblModule m
on m.CourseID = c.GrantedCourseID
inner join tblOrganisation o  -- Get default compliance rules
on o.OrganisationID = c.OrganisationID
inner join tblUnit u
on u.OrganisationID = c.OrganisationID
left join tblUnitRule ur --Get the unit specific rules
on ur.ModuleID = m.ModuleID
and ur.UnitID=u.unitID
WHERE o.OrganisationID = @OrgID
) umr
on
umr.ModuleID  = um.ModuleID
and umr.UnitID = um.UnitID
and um.UnitID in (select UnitID from tblUnit where OrganisationID = @OrgID)
and um.UserID IN (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: CurrentAssignedModules */

-- select * from #tblCurrentAssignedModules
/*
1.2. Get the last quiz activity for each user and module pair (StartedModules)
*/
/* UNITTEST: StartedModules */
select
um.userID,
um.moduleID,
q.active,
qs.QuizScore,
qs.QuizSessionID,
qs.DateTimeCompleted
into
#tblStartedModules
from
#tblCurrentAssignedModules um
inner join
(
select
um.userID, um.moduleID, max(DateTimeCompleted)  as DateTimeCompleted
from
#tblCurrentAssignedModules um
inner join tblQuiz q
on q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted is not null
group by um.userID, um.moduleID
)
as LastQuizDate

on
LastQuizDate.userID = um.userID
and LastQuizDate.ModuleID = um.ModuleID

inner join tblQuiz q
on
q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted  = LastQuizDate.DateTimeCompleted
/* /UNITTEST: StartedModules */


-- select * from #tblStartedModules

/*
1.3. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
a) Get a list of modules that is in the quiz status table that the last statuses are not Unassigned (0)(PreviousAssignedModules)
b) Get rid off all modules that are currently assigned to the users (from step 1)
c)All modules left are Unassigned(0)
*/

/* UNITTEST: Status_Unassigned */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID
)
select
uqs.UserID,
uqs.ModuleID,
0  as QuizStatusID --Unassigned (0)
from
(
select
QuizStatus.UserQuizStatusID
, QuizStatus.UserID
, QuizStatus.ModuleID
, m.CourseID
, QuizStatus.QuizStatusID
, QuizStatus.QuizFrequency
, QuizStatus.QuizPassMark
, QuizStatus.QuizSessionID
, QuizStatus.QuizScore
, QuizStatus.DateCreated

from
tblUserQuizStatus QuizStatus
inner join tblModule m on m.ModuleID = QuizStatus.ModuleID
inner join
(
select
max(UserQuizStatusID) UserQuizStatusID --UserQuizStatusID is identity
from
tblUserQuizStatus
WHERE
tblUserQuizStatus.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
group by
UserID,moduleID
) currentStatus
on QuizStatus.UserQuizStatusID = currentStatus.UserQuizStatusID
where m.active = 1
) uqs
left join
#tblCurrentAssignedModules cam
on
cam.UserID = uqs.UserID
and cam.ModuleID = uqs.ModuleID
where
uqs.QuizStatusID<>0 --not Unassigned (0)
and cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_Unassigned */

/*
1.4. Not Started Modules (1) (CurrentAssignedModules- StartedModules)
All currently assigned modules that don''t have any activity is Not Started (1)
*/
-- mikev(1): added QuizCompletionDate
/* UNITTEST: Status_NotStarted */
insert into
#tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate
)
select
cam.UserID,
cam.ModuleID,
1  as QuizStatusID, --Not Started (1)
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate
from
#tblCurrentAssignedModules cam
left join
#tblStartedModules sm
on
sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
sm.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_NotStarted */
/*
EXPIRED NEW CONTENT IS NOW A MANUAL PROCESS
1.5. Started Modules
a)If the last quiz is inactive, the status is Expired (New Content)(5)
b)If the last quiz is past the current quiz frequency, the status is Expired (Time Expired)(4)
c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
If user Failed the quiz, the status is Failed (3)
If user Passed the quiz, the status is Passed (2)
*/

--	  	a)If the last quiz is inactive, the status is Expired (New Content)(5)


--		b)If the last quiz is past the current quiz frequency, the status is Expired (Time Expired)(4)
-- mikev(1): added QuizCompletionDate. Added criteria
/* UNITTEST: Status_TimeExpired */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as QuizStatusID, --  Expired (Time Expired)(4)
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate
from #tblCurrentAssignedModules cam
inner join #tblStartedModules sm
on sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
(
(
cam.QuizCompletionDate is null
and DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID))) <= 0
)
or
(
isnull(DateDiff(day, getutcdate(), cam.QuizCompletionDate), 1) <= 0
)
)
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_TimeExpired */

--		c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
--			If user Failed the quiz, the status is Failed (3)
--			If user Passed the quiz, the status is Passed (2)

-- mikev(1): added QuizCompletionDate and changed logic of criteria to use the date before the frequency
/* UNITTEST: Status_PassFail */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate,
QuizScore,
QuizSessionID
)
select cam.UserID,
cam.ModuleID,
case
when sm.QuizScore>=cam.QuizPassMark then 2 -- Passed (2)
else	3  --Failed (3)
end  as QuizStatusID,
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate,
sm.QuizScore,
sm.QuizSessionID
from #tblCurrentAssignedModules cam
inner join #tblStartedModules sm
on sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
not (
cam.QuizCompletionDate is null
and DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID))) <= 0
)
and cam.QuizCompletionDate is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
and (select top 1 QuizStatusID from tblUserQuizStatus where ModuleID = cam.ModuleID and UserID = cam.UserID order by UserQuizStatusID Desc) NOT IN (5)

/* /UNITTEST: Status_PassFail */
/*
2. Update User Quiz status
----------------------------
If the last quiz status for each user is not the same as the current status, add the new status
*/


/* UNITTEST: CourseStatus */
-- mikev(1): added cursor for quizcompletiondate
declare @cursor_UserID 	        int
declare @cursor_ModuleID 	    int
declare @cursor_QuizStatusID 	int
declare @cursor_QuizFrequency 	int
declare @cursor_QuizPassMark	int
declare @cursor_QuizCompletionDate	DateTime
declare @cursor_QuizScore	    int
declare @cursor_QuizSessionID   varchar(50)
declare @cursor_UserQuizStatusID int

-- mikev(1): added quizcompletiondate
declare @LastUser int
declare @LastCourse int
declare @LastQuizStatusID int
declare @cursor_CourseID int
set @LastUser = -1
set @LastCourse = -1
set @LastQuizStatusID = -1
DECLARE CurrentUserQuizStatus CURSOR
FOR


select
cs.UserID,
cs.ModuleID,
cs.QuizStatusID,
cs.QuizFrequency,
cs.QuizPassMark,
cs.QuizCompletionDate,
cs.QuizScore,
cs.QuizSessionID,
s.UserQuizStatusID,
Module.CourseID
from -- Any UserModules with current access but no tblUserQuizStatus record
#tblCurrentUserQuizStatus cs
inner join tblModule Module on module.moduleID = cs.ModuleID
left join
(  -- The UserModule quiz status for the latest quiz attempt 
	select
	QuizStatus.UserQuizStatusID
	, QuizStatus.UserID
	, QuizStatus.ModuleID
	, m.CourseID
	, QuizStatus.QuizStatusID
	, QuizStatus.QuizFrequency
	, QuizStatus.QuizPassMark
	, QuizStatus.QuizSessionID
	, QuizStatus.QuizScore
	, QuizStatus.DateCreated

	from
	tblUserQuizStatus QuizStatus
	inner join tblModule m on m.ModuleID = QuizStatus.ModuleID
	inner join
	(
		select
		max(UserQuizStatusID) UserQuizStatusID --UserQuizStatusID is identity
		from
		tblUserQuizStatus
		WHERE
		tblUserQuizStatus.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
		group by
		UserID,moduleID
	) currentStatus
	on QuizStatus.UserQuizStatusID = currentStatus.UserQuizStatusID
	where m.active = 1
) s
on cs.userID = s.UserID
and cs.ModuleID = s.ModuleID
and cs.QuizStatusID = s.QuizStatusID
where
s.UserQuizStatusID is null
order by cs.UserID, cs.QuizStatusID, Module.CourseID
-- ordered so we can update course status on the last module in the course rather than for every module in the course

Open CurrentUserQuizStatus



FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizCompletionDate,@cursor_QuizScore,@cursor_QuizSessionID, @cursor_UserQuizStatusID, @cursor_CourseID
set @LastCourse = @cursor_CourseID
set @LastUser = @cursor_UserID
set @LastQuizStatusID = @cursor_QuizStatusID
WHILE @@FETCH_STATUS = 0
BEGIN

insert into tblUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate,
QuizScore,
QuizSessionID
)
values
(
@cursor_UserID,
@cursor_ModuleID,
@cursor_QuizStatusID,
@cursor_QuizFrequency,
@cursor_QuizPassMark,
@cursor_QuizCompletionDate,
@cursor_QuizScore,
@cursor_QuizSessionID
)


-- don''t update the course status for every module in the course - once per course is enough
-- do update the course status on every change in QuizStatus
if (@LastCourse != @cursor_CourseID) or (@LastUser != @cursor_UserID) or (@LastQuizStatusID != @cursor_QuizStatusID) EXEC prcUserQuizStatus_UpdateCourseStatus @cursor_UserID, @cursor_ModuleID

set @LastCourse = @cursor_CourseID
set @LastUser = @cursor_UserID
set @LastQuizStatusID = @cursor_QuizStatusID

FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizCompletionDate,@cursor_QuizScore,@cursor_QuizSessionID, @cursor_UserQuizStatusID, @cursor_CourseID


END
-- final course may not be done so update just to be safe
if (@LastUser != -1 ) EXEC prcUserQuizStatus_UpdateCourseStatus @cursor_UserID, @cursor_ModuleID

-- Finished CurrentUserQuizStatus
CLOSE CurrentUserQuizStatus
DEALLOCATE CurrentUserQuizStatus




--***********************************************************************************************************
--              AT RISK OF EXPIRY
--***********************************************************************************************************


DECLARE @DaysWarningBeforeExpiry int
SELECT @DaysWarningBeforeExpiry = DaysWarningBeforeExpiry FROM tblOrganisation where OrganisationID = @OrgID
IF (@DaysWarningBeforeExpiry IS NULL)
BEGIN
	DECLARE @QuizExpiryDate DateTime
	SELECT @QuizExpiryDate = dateadd(d,-30,QuizDueDate) FROM tblOrganisation where OrganisationID = @OrgID
	
	delete from tblQuizExpiryAtRisk where OrganisationID = @OrgID
	and not exists (select @OrgID,cam.UserID,
	cam.ModuleID, DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and dbo.udfGetSaltOrgDate(@OrgID) < @QuizExpiryDate
		and tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID
	))



	insert into tblQuizExpiryAtRisk
	(
	OrganisationID,
	UserID,
	ModuleID,
	DaysToExpiry
	)
	select @OrgID,cam.UserID,
	cam.ModuleID, 30
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and dbo.udfGetSaltOrgDate(@OrgID) < @QuizExpiryDate
	)
	and not exists
	(SELECT * FROM tblQuizExpiryAtRisk 
	where 	tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID)
END





IF (@DaysWarningBeforeExpiry IS NOT NULL)
BEGIN
	delete from tblQuizExpiryAtRisk where OrganisationID = @OrgID
	and not exists (select @OrgID,cam.UserID,
	cam.ModuleID, DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and DateDiff(day, dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)),dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID)) <= @DaysWarningBeforeExpiry
		and tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID
	))



	insert into tblQuizExpiryAtRisk
	(
	OrganisationID,
	UserID,
	ModuleID,
	DaysToExpiry
	)
	select @OrgID,cam.UserID,
	cam.ModuleID, DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and DateDiff(day, dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)),dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID)) <= @DaysWarningBeforeExpiry
	)
	and not exists
	(SELECT * FROM tblQuizExpiryAtRisk 
	where 	tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID)
END

--***********************************************************************************************************





drop table  #tblCurrentUserQuizStatus

drop table #tblCurrentAssignedModules

drop table #tblStartedModules
/* /UNITTEST: CourseStatus */


/* UNITTEST: Licensing */
EXEC prcDatabaseMail_SetupProfile -- incase email address etc has changed, re-setup.

-- Check who is missing license for current period, includes period turn over
declare @lic_CourseLicensingID int, @lic_UserID int
DECLARE LicensingLoop CURSOR
FOR
SELECT DISTINCT tblCourseLicensing.CourseLicensingID, vwUserModuleAccess.UserID
FROM tblCourseLicensing
INNER JOIN vwUserModuleAccess ON tblCourseLicensing.CourseID = vwUserModuleAccess.CourseID
AND tblCourseLicensing.OrganisationID = vwUserModuleAccess.OrganisationID
INNER JOIN tblUser ON vwUserModuleAccess.UserID = tblUser.UserID
LEFT OUTER JOIN	tblCourseLicensingUser ON tblCourseLicensing.CourseLicensingID = tblCourseLicensingUser.CourseLicensingID
WHERE tblCourseLicensing.DateStart <= GETUTCDATE()
AND tblCourseLicensing.DateEnd >= GETUTCDATE()
AND tblCourseLicensingUser.CourseLicensingID IS NULL
AND tblUser.Active = 1
AND vwUserModuleAccess.OrganisationID = @OrgID
Open LicensingLoop
FETCH NEXT FROM LicensingLoop
Into
@lic_CourseLicensingID, @lic_UserID
WHILE @@FETCH_STATUS = 0
BEGIN
IF NOT EXISTS(SELECT CourseLicensingID FROM tblCourseLicensingUser WHERE CourseLicensingID = @lic_CourseLicensingID and UserID = @lic_UserID)
BEGIN
INSERT INTO tblCourseLicensingUser(CourseLicensingID, UserID) VALUES (@lic_CourseLicensingID, @lic_UserID)
END
FETCH NEXT FROM LicensingLoop
Into
@lic_CourseLicensingID, @lic_UserID
END

CLOSE LicensingLoop
DEALLOCATE LicensingLoop



-- WARNING EMAILS
-- License Warning
declare @licenseWarnEmail nvarchar(4000)
declare @licenseWarnEmail_Subject nvarchar(4000)
declare @emailLicenseWarnLicRecipients nvarchar(512)
declare @warn_lic_CourseName nvarchar(200),
@warn_lic_CourseLicensingID int,
@warn_lic_LicenseNumber int,
@warn_lic_LicenseWarnNumber int,
@warn_lic_RepNameSalt nvarchar(200),
@warn_lic_RepEmailSalt nvarchar(200),
@warn_lic_RepNameOrg nvarchar(200),
@warn_lic_RepEmailOrg nvarchar(200),
@warn_lic_LangCode nvarchar(10),
@warn_lic_LicensesUsed int,
@warn_lic_LicenseWarnEmail bit,
@warn_lic_OrganisationName nvarchar(50)

DECLARE LicenceNumberLoop CURSOR
FOR
SELECT
c.Name, l.CourseLicensingID, l.LicenseNumber, l.LicenseWarnNumber, l.RepNameSalt, l.RepEmailSalt,
l.RepNameOrg, l.RepEmailOrg, l.LangCode, COUNT(u.CourseLicensingUserID) AS LicensesUsed,
l.LicenseWarnEmail, OrganisationName
FROM
tblCourseLicensing l
INNER JOIN tblCourseLicensingUser u ON l.CourseLicensingID = u.CourseLicensingID
INNER JOIN tblCourse c ON l.CourseID = c.CourseID
LEFT JOIN tblOrganisation o ON l.OrganisationID = o.OrganisationID
WHERE
l.OrganisationID = @OrgID
GROUP BY
OrganisationName, l.CourseLicensingID, l.RepNameSalt, l.RepEmailSalt, l.RepNameOrg, l.RepEmailOrg, c.Name, l.LicenseNumber,
l.LicenseWarnNumber, l.LicenseWarnEmail, l.LangCode
HAVING
COUNT(u.CourseLicensingUserID) >= l.LicenseWarnNumber
AND l.LicenseWarnEmail = 1

Open LicenceNumberLoop
FETCH NEXT FROM LicenceNumberLoop
Into @warn_lic_CourseName,
@warn_lic_CourseLicensingID,
@warn_lic_LicenseNumber,
@warn_lic_LicenseWarnNumber,
@warn_lic_RepNameSalt,
@warn_lic_RepEmailSalt,
@warn_lic_RepNameOrg,
@warn_lic_RepEmailOrg,
@warn_lic_LangCode,
@warn_lic_LicensesUsed,
@warn_lic_LicenseWarnEmail,
@warn_lic_OrganisationName

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get License Warning text in desired language.
SELECT     @licenseWarnEmail = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_lic_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_LicenseWarn'') AND (tblLangValue.Active = 1)

SELECT     @licenseWarnEmail_Subject = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_lic_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_LicenseWarn_Subject'') AND (tblLangValue.Active = 1)

-- {0} is receipient name, {1} is the license warning amount, {2} course name, {3} license limit, {4} name of contact person
-- {5} is organisation name
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{0}'', @warn_lic_RepNameOrg)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{1}'', @warn_lic_LicenseWarnNumber)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{2}'', @warn_lic_CourseName)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{3}'', @warn_lic_LicenseNumber)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{4}'', @warn_lic_RepNameSalt)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{5}'', @warn_lic_OrganisationName)

set @licenseWarnEmail_Subject = REPLACE(@licenseWarnEmail_Subject, ''{0}'', @warn_lic_CourseName)
set @licenseWarnEmail_Subject = REPLACE(@licenseWarnEmail_Subject, ''{1}'', @warn_lic_OrganisationName)

select @emailLicenseWarnLicRecipients = @warn_lic_RepEmailOrg +'';''+@warn_lic_RepEmailSalt

--EXEC msdb.dbo.sp_send_dbmail
--@recipients = @emailLicenseWarnLicRecipients,
--@body = @licenseWarnEmail,
--@subject = @licenseWarnEmail_Subject,
--@profile_name = ''Salt_MailAccount''

-- Log emails sent
--exec prcEMail_LogSentEmail @toEmail = @warn_lic_RepEmailOrg, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @licenseWarnEmail_Subject, @body = @licenseWarnEmail, @organisationID = @OrgID
--exec prcEMail_LogSentEmail @toEmail = @warn_lic_RepEmailSalt, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @licenseWarnEmail_Subject, @body = @licenseWarnEmail, @organisationID = @OrgID

print ''queued numLics warning mail to : '' + @emailLicenseWarnLicRecipients

-- Unset flag and record date email sent
UPDATE tblCourseLicensing SET DateLicenseWarnEmailSent = getutcdate(), LicenseWarnEmail = 0 WHERE CourseLicensingID = @warn_lic_CourseLicensingID

FETCH NEXT FROM LicenceNumberLoop
Into @warn_lic_CourseName,
@warn_lic_CourseLicensingID,
@warn_lic_LicenseNumber,
@warn_lic_LicenseWarnNumber,
@warn_lic_RepNameSalt,
@warn_lic_RepEmailSalt,
@warn_lic_RepNameOrg,
@warn_lic_RepEmailOrg,
@warn_lic_LangCode,
@warn_lic_LicensesUsed,
@warn_lic_LicenseWarnEmail,
@warn_lic_OrganisationName
END

CLOSE LicenceNumberLoop
DEALLOCATE LicenceNumberLoop
-- /License Warning


-- Expiry Warning
declare @expiryWarnEmail nvarchar(4000)
declare @expiryWarnEmail_Subject nvarchar(4000)
declare @emailLicenseWarnExpRecipients nvarchar(512)
DECLARE @warn_exp_CourseLicensingID int,
@warn_exp_CourseName nvarchar(200),
@warn_exp_DateWarn datetime,
@warn_exp_ExpiryWarnEmail bit,
@warn_exp_DateEnd datetime,
@warn_exp_RepNameSalt nvarchar(200),
@warn_exp_RepEmailSalt nvarchar(200),
@warn_exp_RepNameOrg nvarchar(200),
@warn_exp_RepEmailOrg nvarchar(200),
@warn_exp_LangCode nvarchar(10),
@warn_exp_OrganisationName nvarchar(50)

DECLARE LicenceExpiryLoop CURSOR
FOR
SELECT
l.CourseLicensingID, c.Name, l.DateWarn, l.ExpiryWarnEmail, l.DateEnd, l.RepNameSalt,
l.RepEmailSalt, l.RepNameOrg, l.RepEmailOrg, l.LangCode, OrganisationName
FROM
tblCourseLicensing l
INNER JOIN tblCourse c ON l.CourseID = c.CourseID
LEFT JOIN tblOrganisation o ON l.OrganisationID = o.OrganisationID
WHERE
l.DateWarn < GETUTCDATE()
AND l.ExpiryWarnEmail = 1
AND l.OrganisationID = @OrgID

Open LicenceExpiryLoop
FETCH NEXT FROM LicenceExpiryLoop
Into @warn_exp_CourseLicensingID,
@warn_exp_CourseName,
@warn_exp_DateWarn,
@warn_exp_ExpiryWarnEmail,
@warn_exp_DateEnd,
@warn_exp_RepNameSalt,
@warn_exp_RepEmailSalt,
@warn_exp_RepNameOrg,
@warn_exp_RepEmailOrg,
@warn_exp_LangCode,
@warn_exp_OrganisationName

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get Expiry Warning text in desired language.
SELECT     @expiryWarnEmail = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_exp_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_ExpiryWarn'') AND (tblLangValue.Active = 1)

SELECT     @expiryWarnEmail_Subject = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_exp_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_ExpiryWarn_Subject'') AND (tblLangValue.Active = 1)

-- {0} Receipient Name, {1} number days till expiry, {2} course name, {3} expiry date, {4} Salt rep name
-- {5} Organisation Name
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{0}'', @warn_exp_RepNameOrg)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{1}'', DATEDIFF(dd,dbo.udfUTCtoDaylightSavingTime(getUTCdate(),@OrgID),dbo.udfUTCtoDaylightSavingTime(@warn_exp_DateEnd,@OrgID)))
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{2}'', @warn_exp_CourseName)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{3}'', CONVERT(CHAR(10), dbo.udfUTCtoDaylightSavingTime(@warn_exp_DateEnd,@OrgID), 103))
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{4}'', @warn_exp_RepNameSalt)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{5}'', @warn_exp_OrganisationName)

set @expiryWarnEmail_Subject = REPLACE(@expiryWarnEmail_Subject, ''{0}'', @warn_exp_CourseName)
set @expiryWarnEmail_Subject = REPLACE(@expiryWarnEmail_Subject, ''{1}'', @warn_exp_OrganisationName)

select @emailLicenseWarnExpRecipients = @warn_exp_RepEmailOrg +'';''+@warn_exp_RepEmailSalt

--EXEC msdb.dbo.sp_send_dbmail
--@recipients = @emailLicenseWarnExpRecipients,
--@body = @expiryWarnEmail,
--@subject = @expiryWarnEmail_Subject,
--@profile_name = ''Salt_MailAccount''

-- Log emails sent
--exec prcEMail_LogSentEmail @toEmail = @warn_exp_RepEmailOrg, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @expiryWarnEmail_Subject, @body = @expiryWarnEmail, @organisationID = @OrgID
--exec prcEMail_LogSentEmail @toEmail = @warn_exp_RepEmailSalt, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @expiryWarnEmail_Subject, @body = @expiryWarnEmail, @organisationID = @OrgID

print ''queued expiry mail to : '' + @emailLicenseWarnExpRecipients
-- Unset flag and record date email sent
UPDATE tblCourseLicensing SET DateExpiryWarnEmailSent = getutcdate(), ExpiryWarnEmail = 0 WHERE CourseLicensingID = @warn_exp_CourseLicensingID


FETCH NEXT FROM LicenceExpiryLoop
Into @warn_exp_CourseLicensingID,
@warn_exp_CourseName,
@warn_exp_DateWarn,
@warn_exp_ExpiryWarnEmail,
@warn_exp_DateEnd,
@warn_exp_RepNameSalt,
@warn_exp_RepEmailSalt,
@warn_exp_RepNameOrg,
@warn_exp_RepEmailOrg,
@warn_exp_LangCode,
@warn_exp_OrganisationName
END

CLOSE LicenceExpiryLoop
DEALLOCATE LicenceExpiryLoop
-- /Expiry Warning
/* /UNITTEST: Licensing */


/* UNITTEST: ModuleNightly */
-- START Course status reconcile. If a module has been made active or inactive to run through all user and ensure that their course status is correct.
-- AS PER BUSINESS requirement
-- Get all changed modules
declare @c_CourseID int, @c_ModuleID int
DECLARE UpdatedModuleLOOP CURSOR
FOR
SELECT CourseID, ModuleID FROM tblModule WHERE(DateUpdated > GETUTCDATE() - 2)
Open UpdatedModuleLOOP

FETCH NEXT FROM UpdatedModuleLOOP
Into
@c_CourseID, @c_ModuleID

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get all users related to this module
declare @c_UserID int
DECLARE UserLOOP CURSOR
FOR
SELECT UserID FROM tblUserModuleAccess WHERE ModuleID = @c_ModuleID
Open UserLOOP


FETCH NEXT FROM UserLOOP
Into
@c_UserID

WHILE @@FETCH_STATUS = 0
BEGIN
EXEC prcUserQuizStatus_UpdateCourseStatus @c_UserID, @c_ModuleID
FETCH NEXT FROM UserLOOP
Into
@c_UserID
END

CLOSE UserLOOP
DEALLOCATE UserLOOP

FETCH NEXT FROM UpdatedModuleLOOP
Into
@c_CourseID, @c_ModuleID
END

CLOSE UpdatedModuleLOOP
DEALLOCATE UpdatedModuleLOOP
/* /UNITTEST: ModuleNightly */




/* UNITTEST: ExtendComplianceDate */
update tblOrganisation
set DefaultQuizCompletionDate = dateadd(year, 1, [DefaultQuizCompletionDate])
where DefaultQuizCompletionDate < getutcdate() and OrganisationID = @OrgID

update tblUnitRule
set QuizCompletionDate = dateadd(year, 1, [QuizCompletionDate])
where QuizCompletionDate < getutcdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
/* /UNITTEST: ExtendComplianceDate */


-- END Course status reconcile.


update tblOrganisation set CourseStatusLastUpdated = dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID) where OrganisationID = @OrgID

update tblModuleStatusUpdateHistory
set FinishTime = getutcdate()
where ModuleStatusUpdateHistoryID = @intHistoryID


SET QUOTED_IDENTIFIER OFF

' 
END



SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetTimeZoneWrittenName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


Create Procedure [prcOrganisation_GetTimeZoneWrittenName]
(
	@OrgID int 		-- Organisation ID 
)

As

	Set NoCount On

	-- Declarations
	Declare @userID Integer
	
	-- Validation
	If (@OrgID Is Null)
	Begin
		Raiserror(''The Parameter @OrgID was null.  @OrgID does not accept Null values.'', 16, 1)
		Return
	End

	-- Logic
	
	Select
	WrittenName
	From
    tblOrganisation ORG 
	inner join tblTimeZone TZ on ORG.TimeZoneID = TZ.TimeZoneID

	WHERE ORG.OrganisationID = @OrgID

	
' 
END
GO






IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
BEGIN
	DROP procedure [prcOrganisation_GetOne]
END
GO



BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets othe details of one Organisation
Parameters: @orgID integer
Returns: OrganisationID, OrganisationName,  Logo, Notes, DefaultLessonFrequency, DefaultQuizFrequency, DefaultQuizPassMark, CreatedBy, DateCreated,  UpdatedBy, DateUpdated

Called By: Organisation.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Peter Vranich
Date Created: 4th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	aaronc		May 2008		Added retrieval of CPDReportName
#2	aaronc		June2008		Added retrieval of AllocatedDiskSpace
*/

CREATE procedure [prcOrganisation_GetOne]
(
@LangCode nvarchar(10),
@orgID Integer = null -- OrganisationID
)

As

If @orgID Is Null
Begin
Raiserror(''The Parameter @orgID was null.  @orgID does not accept Null values.'', 16, 1)
Return
End

Select
o.OrganisationID,
o.OrganisationName,
o.Logo,
orgN.Notes,
o.DefaultLessonFrequency,
o.DefaultQuizFrequency,
o.DefaultQuizPassMark,
o.DefaultLessonCompletionDate,
o.DefaultQuizCompletionDate,
o.AdvancedReporting,
o.CreatedBy,
o.DateCreated,
o.UpdatedBy,
o.DateUpdated,
o.CPDReportName,
o.AllocatedDiskSpace,
o.IncludeCertificateLogo,
o.PasswordLockout,
o.TimeZoneID
From
tblOrganisation o
left join tblOrganisationNotes orgN
on o.OrganisationID = orgN.OrganisationID
left join tblLang l
on orgN.LanguageID = l.LangID
Where
o.OrganisationID = @orgID
and l.LangCode = @LangCode
' 
END 
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTimeZone_add]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE procedure [prcTimeZone_add]
(
	@WrittenName nvarchar(60),
	@OffsetUTC int,
	@FLB_Name nvarchar(60)
)
as
DELETE FROM tblTimeZone
      WHERE WrittenName = @WrittenName
DECLARE @TimezoneID int
exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
DELETE FROM tblTimeZoneDaylightSavingRules
      WHERE TimezoneID = @TimezoneID
INSERT INTO tblTimeZone
           (WrittenName
           ,OffsetUTC
           ,FLB_Name
           ,Active)
     VALUES
           (@WrittenName
           ,@OffsetUTC
           ,@FLB_Name
           ,''true'')
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTimeZone_GetList]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Procedure [prcTimeZone_GetList]

As

SELECT TimeZoneID
      ,WrittenName
      ,OffsetUTC
  FROM tblTimeZone


' 
END
GO











IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetTimeZoneWrittenName]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTimeZone_GetTimeZoneWrittenName]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetTimeZoneWrittenName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



CREATE Procedure [prcTimeZone_GetTimeZoneWrittenName]
(
	@TimeZoneID int
)

As

select WrittenName from tblTimeZone where TimeZoneID = @TimeZoneID




' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTimeZoneRule_add]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcTimeZoneRule_add]
(
@WrittenName NVarChar(60), 
@OffsetDaylight Int, 
@year_start Int, 
@year_end  Int, 
@StartTimeOfDay Int, 
@day_start Int, 
@week_start Int, 
@StartMonth Int, 
@EndTimeOfDay Int, 
@EndDayOfWeek Int, 
@EndWeek Int, 
@EndMonth Int,
@Error bit out
)
AS
BEGIN

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?

	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)

			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)


	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE ((first_start_date < @Period_end) AND (last_end_date > @Period_start))
	AND TimezoneID = @TimezoneID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		INSERT INTO tblTimeZoneDaylightSavingRules
			   ([TimezoneID]
			   ,[offset_mins]
			   ,[start_year]
			   ,[end_year]
			   ,[hours_start]
			   ,[day_start]
			   ,[week_start]
			   ,[month_start]
			   ,[hours_end]
			   ,[day_end]
			   ,[week_end]
			   ,[month_end]
			   ,[first_start_date]
			   ,[last_end_date]
		)
		 VALUES
			   (@TimezoneID,
				@OffsetDaylight,
				@year_start,
				@year_end,
				@StartTimeOfDay,
				@day_start,
				@week_start , 
				@StartMonth , 
				@EndTimeOfDay , 
				@EndDayOfWeek , 
				@EndWeek , 
				@EndMonth, 
				@Period_start,
				@Period_end
			   )
		SET @Error = 0
	END


	
END
' 
END
GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfUTCtoDaylightSavingTime]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [udfUTCtoDaylightSavingTime]
(
		@UTC DateTime,
		@OrgID int
)
RETURNS DateTime
AS
BEGIN
	
	IF (@UTC is null) RETURN null
	DECLARE @OrgLocalTime datetime
	DECLARE @UTC_Offset int
	DECLARE @Timezone datetime
	DECLARE @offset_mins int, @hours_start int, @day_start int, @week_start int, @month_start int, @hours_end int, @day_end int, @week_end int, @month_end int, @year_end int , @year_start int
	SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
	FROM tblTimeZone TZ 
	INNER JOIN tblOrganisation Org ON TZ.TimeZoneID = Org.TimeZoneID 
	WHERE Org.OrganisationID = @OrgID
	IF (@UTC_Offset IS NULL) 
	BEGIN
		Set @OrgLocalTime = ''1 Jan 1900'' -- all results are displayed by Reporting Services so create an "error" that will be apparent in Reporting Services
	END
	ELSE
	BEGIN
		Set @OrgLocalTime = DATEADD(minute,@UTC_Offset,@UTC )
		SELECT  @offset_mins = offset_mins, --get definition of the (at most) 1 definition that may cover the datetime
				@hours_start = hours_start, --overlapping definitions removed by GUI so only 1 result returned
				@day_start = day_start,
				@week_start = week_start,
				@month_start = month_start,
				@hours_end = hours_end,
				@day_end = day_end,
				@week_end = week_end,
				@month_end = month_end
		FROM tblTimeZoneDaylightSavingRules 
		WHERE  TimezoneID = @Timezone
		AND @OrgLocalTime >= first_start_date
		AND @OrgLocalTime <= last_end_date 
		
		-- start with a period (@Period_start datetime, @period_end datetime) that just has the correct year digits
        DECLARE @Period_start datetime, @period_end datetime        
        Set @year_start = year(@OrgLocalTime) 
        set @year_end = year(@OrgLocalTime)
            
        if (month(@OrgLocalTime) <= @month_end) and (@month_start > @month_end) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
            
        IF(@month_start > @month_end) and (month(@OrgLocalTime) >= @month_start) set @year_end = @year_start + 1  -- rule spans december 31 so adjust
            
 
		--Set @year_start = year(@OrgLocalTime) --now calculate the exact start and end dates and times for the year under consideration
		--IF(@month_start > @month_end) set @year_end = @year_start+1 else set @year_end = @year_start
		--DECLARE @Period_start datetime, @period_end datetime
		
		set @Period_start = ''1 jan 2000'' -- start with a known datetime
		set @year_start = @year_start - 2000
		Set @Period_start = DATEADD(year,@year_start,@Period_start) -- then set the year correctly
		-- Then move to the correct month
		Set @Period_start = DATEADD(month,@month_start-1,@Period_start)
		-- Then move to the correct week (let week 5 slide to the next month for now)
		Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
		-- Now move FORWARD to the correct day (say) the 5th sunday of february
		Declare @day_offset int
		if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
		Set @Period_start = DATEADD(day,@day_offset,@Period_start)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_start) > @month_start) set @Period_start = DATEADD(week,-1,@Period_start)
		Set @Period_start = DATEADD(minute,@hours_start,@Period_start)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end

		set @Period_end = ''1 jan 2000'' -- start with a known datetime
		set @year_end = @year_end - 2000
		Set @Period_end = DATEADD(year,@year_end,@Period_end) -- then adjust it to match the definition
		Set @Period_end = DATEADD(month,@month_end-1,@Period_end)
		Set @Period_end = DATEADD(week,@week_end-1,@Period_end)
		if (@day_end >=  DatePart(weekday,@Period_end) ) set @day_offset = @day_end -  DatePart(weekday,@Period_end) else  set @day_offset = @day_end -  DatePart(weekday,@Period_end) + 7
		Set @Period_end = DATEADD(day,@day_offset,@Period_end)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_end) > @month_end) set @Period_end = DATEADD(week,-1,@Period_end)
		Set @Period_end = DATEADD(minute,@hours_end,@Period_end)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end
		Set @Period_end = DATEADD(minute,-@offset_mins,@Period_end) -- end time is quoted with daylight savings included
		
		
		IF (@OrgLocalTime >= @Period_start) 
		AND (@OrgLocalTime < @Period_end) set @OrgLocalTime = DATEADD(minute,@offset_mins,@OrgLocalTime)
	END
	RETURN @OrgLocalTime
END
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfDaylightSavingTimeToUTC]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfDaylightSavingTimeToUTC]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfDaylightSavingTimeToUTC]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [udfDaylightSavingTimeToUTC]
(
		@LocalTime DateTime,
		@OrgID int
)
RETURNS DateTime
AS
BEGIN
	-- trap error condition
	IF (@LocalTime is null) RETURN null
	
	DECLARE @OrgLocalTime datetime
	DECLARE @UTC_Offset int
	DECLARE @Timezone datetime
	DECLARE @offset_mins int, @hours_start int, @day_start int, @week_start int, @month_start int, @hours_end int, @day_end int, @week_end int, @month_end int, @year_end int , @year_start int
	
	
	SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
	FROM tblTimeZone TZ 
	INNER JOIN tblOrganisation Org ON TZ.TimeZoneID = Org.TimeZoneID 
	WHERE Org.OrganisationID = @OrgID
	IF (@UTC_Offset IS NULL) 
	BEGIN
		Set @OrgLocalTime = ''1 Jan 1900'' 	-- create an "error" that will be apparent in Report (The timezone does not exist so create an error that will draw attention to the problem)
	END
	ELSE
	BEGIN
	--*********************************************************************************************************************************
	-- get the daylight saving rules of the (at most) 1 definition that may cover the datetime
	--overlapping definitions are removed by the GUI so a maximum of 1 result can be returned
	--*********************************************************************************************************************************
		Set @OrgLocalTime = DATEADD(minute,-@UTC_Offset,@LocalTime )
		SELECT  @offset_mins = offset_mins, 
				@hours_start = hours_start, 
				@day_start = day_start,
				@week_start = week_start,
				@month_start = month_start,
				@hours_end = hours_end,
				@day_end = day_end,
				@week_end = week_end,
				@month_end = month_end
		FROM tblTimeZoneDaylightSavingRules 
		WHERE  TimezoneID = @Timezone
		AND @LocalTime >= first_start_date
		AND @LocalTime <= last_end_date 
		
    	-- the first_start_date and last_end_date may cover a period of decades so we now have to decide if the rule is applied at the datetime given		
		-- so calculate the exact start and end dates and times for the relevant daylight saving period (in the year being considered)
		
		
		-- start with a period (@Period_start datetime, @period_end datetime) that just has the correct year digits
		DECLARE @Period_start datetime, @period_end datetime		
		Set @year_start = year(@LocalTime) 
		set @year_end = year(@LocalTime)
		
		if (month(@LocalTime) <= @month_end) and (@month_start > @month_end) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
		
		IF(@month_start > @month_end) and (month(@LocalTime) >= @month_start) set @year_end = @year_start + 1  -- rule spans december 31 so adjust
		
		
		set @Period_start = ''1 jan 2000'' 
		set @year_start = @year_start - 2000
		Set @Period_start = DATEADD(year,@year_start,@Period_start) 
		-- ok year digit ok (for @Period_start) so move on
		
		
		
		-- Then set the month digit correctly
		Set @Period_start = DATEADD(month,@month_start-1,@Period_start)
		
		
		-- Then move to the correct week (let week 5 slide to the next month for now)
		Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
		
		-- Now move FORWARD to the correct day (say) the 5th sunday of february
		Declare @day_offset int
		if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
		Set @Period_start = DATEADD(day,@day_offset,@Period_start)
		
		-- now fix up the week = 5 rule - week=5 means "last week in the month" not "add 5 weeks"
		-- (We may have jumped to the next month if week = 5 so step back a week if necessary)
		if (DatePart(month,@Period_start) > @month_start) set @Period_start = DATEADD(week,-1,@Period_start)
		
		
		-- now add the hours part of the rule - i.e. rule starts at 02:00 
		Set @Period_start = DATEADD(minute,@hours_start,@Period_start)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end




		-- we have calculated the start of the Daylight saving rule (to the hour) for the year in question 
		-- no do exactly the same for the end time of the daylight saving rule for the year in question:
		set @Period_end = ''1 jan 2000'' 
		set @year_end = @year_end - 2000
		Set @Period_end = DATEADD(year,@year_end,@Period_end) 
		Set @Period_end = DATEADD(month,@month_end-1,@Period_end)
		Set @Period_end = DATEADD(week,@week_end-1,@Period_end)
		if (@day_end >=  DatePart(weekday,@Period_end) ) set @day_offset = @day_end -  DatePart(weekday,@Period_end) else  set @day_offset = @day_end -  DatePart(weekday,@Period_end) + 7
		Set @Period_end = DATEADD(day,@day_offset,@Period_end)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_end) > @month_end)
		BEGIN
				set @Period_end = DATEADD(week,-1,@Period_end)
		END
		Set @Period_end = DATEADD(minute,@hours_end,@Period_end)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end
		--Set @Period_end = DATEADD(minute,-@offset_mins,@Period_end) -- end time is quoted with daylight savings included
		
		-- now all we have to do is check if the rule applied to the timestamp in question
		IF (@LocalTime >= @Period_start) 
		AND (@LocalTime < @Period_end) 
		BEGIN
			-- it did so apply the daylight saving offset 
			set @OrgLocalTime = DATEADD(minute,-@offset_mins,@OrgLocalTime)
		END
		
	END
	RETURN @OrgLocalTime
	--RETURN @PERIOD_END

END
' 
END

GO














IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_ActiveInactive]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_ActiveInactive]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_ActiveInactive]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Procedure [prcReport_ActiveInactive]
(
	@FromDate	datetime,
	@ToDate		datetime,
	@CourseIDs	varchar(8000),
	@OrganisationID int,
	@IncludeInactive int
)
AS

/******************************************************************************
**		File:
**		Name: dbo.prcReport_ActiveInactive
**		Desc:
**
**		This template can be customized:
**
**		Return values:
**
**		Called by:   Active INactive Users Report
**
**		Parameters:
**		Input							Output
**     ----------							-----------
**		Comma separated course id''s
**
**		Auth: Serguei Chkaroupine
**		Date: 5/01/2006
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		23/03/07	Yoppy Suwanto			Added a new colum Unit Pathway and sorted by it
**		21/07/09	Mark Donald				Order by LastName, FirstName
**		24/03/11	John Hedlefs			Timezone conversions
*******************************************************************************/

BEGIN

	SELECT distinct 
		tblUnitHierarchy.HierarchyName as UnitPathway,
		uma.[UserID],
		uma.[LastName],
		uma.[FirstName],
		CASE
			WHEN tblUser.Active <> 1 THEN ''(i)''
			ELSE ''''
		END as Flag
		,tblUser.[ExternalID]
		,tblUser.[Email]
		,tblUser.[UserName]
		,[CourseName]
		-- used to count inactive users (RS does not counts nulls)
		,CASE
			WHEN Active = 0 THEN 1
			ELSE NULL
		END as Active,
		dbo.udfUTCtoDaylightSavingTime(tblUser.DateCreated,@OrganisationID) as ''DateCreated'',
		dbo.udfUTCtoDaylightSavingTime(case when Active = 0 then coalesce(tblUser.DAteArchived,tblUser.DateUpdated) end,@OrganisationID) as ''DateArchived''
	FROM
	-- derived table UserModuleAccess
		(SELECT 
			tU.UserID, 
			tU.FirstName, 
			tU.LastName, 
			tU.UnitID, 
			tU.OrganisationID, 
			tM.ModuleID, 
			tM.CourseID, 
			tC.Name AS CourseName

		FROM         
			dbo.tblUser AS tU INNER JOIN
			dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
			dbo.tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
			dbo.tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
			dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
			dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID

		WHERE   
			(tU.UnitID IS NOT NULL) AND 
			(tUnitMA.DeniedModuleID IS NULL) AND 
			(tUsrMA.ModuleID IS NULL) OR 
			(tUsrMA.Granted = 1)
		)
		as uma -- end derived table UserModuleAccess
		LEFT JOIN tblUser on uma.UserID = tblUser.UserID
		LEFT JOIN tblUnitHierarchy on tblUnitHierarchy.UnitID = tblUser.UnitID

	WHERE 
		uma.OrganisationID = @OrganisationID
		AND CourseID in (SELECT * FROM dbo.udfCsvToInt(@CourseIDs))
		AND tblUser.DateCreated between do.udfDaylightSavingTimeToUTC(@FromDate,@OrganisationID) and dbo.udfDaylightSavingTimeToUTC(@ToDate,@OrganisationID)
		and tblUser.Active = (case when @includeinactive =0 then 1 else tbluser.active end )

	ORDER BY
		UnitPathway,
		uma.[LastName],
		uma.[FirstName]

	--Order By CourseName


END


' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfGetSaltDate]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltDate]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'
CREATE FUNCTION [udfGetSaltDate]
(

)
-- This function should be called by all Stored Procedures in SALT that use getdate() or getUTCdate()
-- By directing all calls through this function it is easy to perform testing on date related business rules - for 
-- example by changing the function call (below) to	SELECT @UTCDate = DATEADD(YEAR,1,dbo.getUTCdate()) it is possible to enter test data through the WebSite that is 1 year old

RETURNS DateTime
AS
BEGIN

	DECLARE @UTCDate datetime

	SELECT @UTCDate = dbo.getUTCdate()


	RETURN @UTCDate

END
' 
END

GO








SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcUser_GetOne]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
BEGIN
DROP Procedure [prcUser_GetOne]
END 
GO

BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [prcUser_GetOne]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

Select
	UserID,
	FirstName,
	LastName,
	UserName,
	Password,
	Email,
	ExternalID,
	OrganisationID,
	UnitID,
	UserTypeID,
	Active,
	CreatedBy,
	DateCreated,
	UpdatedBy,
	DateUpdated,
	LastLogin,
	TimeZoneID,
	DelinquencyManagerEmail,
	NotifyOfPendingDelinquencies
From
	tblUser
Where
	UserID = @userID
' 
END
GO




IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcOrganisation_Update]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
DROP PROCEDURE [prcOrganisation_Update]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcOrganisation_Update]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcOrganisation_Update] (
@LangCode nvarchar(10),
@organisationID Integer = Null, -- ID of the organisation to update.
@organisationName nVarChar(50) = Null, -- The name of the organisation.
@notes nVarChar(4000) = Null, -- The notes for the organisation.
@logo VarChar(100) = Null, -- The name of the organisation logo image.
@lessonFrequency Integer = Null, -- Default Lesson frequency for the organisation.
@quizFrequency Integer = Null, -- Default Quiz frequency for the organisation.
@quizPassMark Integer = Null, -- Default Quiz pass mark for the organisation.
@lessonCompletionDate DateTime = Null, -- Default Lesson completion date
@quizCompletionDate DateTime = Null, -- Default Quiz completion date
@advancedReporting bit = 0,
@actionUserID Integer = Null, -- ID of the User that is making the changes.
@originalDateUpdated DateTime, -- original Date of the record.
@CPDReportName nvarchar(255) = Null, -- CPD Report Name
@AllocatedDiskSpace int = Null,
@inclLogo bit = 0,	-- include certificate logo
@PasswordLockout bit,
@TimeZoneID int = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

-- Declarations
Declare @strErrorMessage Varchar(200) -- Holds the error message
Declare @intErrorNumber Integer -- Holds the error number
Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.
Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.

-- Initialise variables
Set @strErrorMessage = ''''
Set @intErrorNumber = 0
Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''
Select @dtCurrentDateUpdated = DateUpdated From tblOrganisation Where OrganisationID = @organisationID

-- Validation Routines
If(@actionUserID Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If Not Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID <= @intUserTypeOrgAdmin)
Begin
Set @intErrorNumber = 6
Set @strErrorMessage = ''You do not have access to modify this Organisation.''
Goto Finalise
End

If(@organisationID Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@organisationName Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @organisationName in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If Exists(Select * From tblOrganisation Where OrganisationName = @organisationName And OrganisationID != @organisationID)
Begin
Set @intErrorNumber = 4
Set @strErrorMessage = ''The Organisation Name '' + @organisationName + '' already exists please choose another name for your Organisation.''
Goto Finalise
End

If(@notes Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @notes in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@logo Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @logo in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@lessonFrequency Is Null and @lessonCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @lessonFrequency, @lessonCompletionDate in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@quizFrequency Is Null and @quizCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizFrequency, @quizCompletionDate in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@quizPassMark Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizPassMark in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@originalDateUpdated != @dtCurrentDateUpdated)
Begin
Set @intErrorNumber = 7
Set @strErrorMessage = ''The organisation''''s details have been updated by another user, you will need to refresh the organisation''''s details and re-enter your changes.  Click here to refresh.''
Goto Finalise
End

If Exists(Select * From tblOrganisation Where OrganisationID = @organisationID)
Begin
Update tblOrganisation
Set
OrganisationName = @organisationName,
Logo = @logo,
DefaultLessonFrequency = @lessonFrequency,
DefaultQuizFrequency = @quizFrequency,
DefaultQuizPassMark = @quizPassMark,
DefaultLessonCompletionDate = @lessonCompletionDate,
DefaultQuizCompletionDate = @quizCompletionDate,
advancedReporting = IsNull(@advancedReporting,advancedReporting),
UpdatedBy = @actionUserID,
DateUpdated = GetDate(),
CPDReportName = @CPDReportName,
AllocatedDiskSpace = @AllocatedDiskSpace,
IncludeCertificateLogo = @inclLogo,
PasswordLockout = @PasswordLockout,
TimeZoneID = @TimeZoneID
Where
OrganisationID = @organisationID

update tblOrganisationNotes
set
Notes = @notes
where OrganisationID = @OrganisationID
and LanguageID = (select LangID from tblLang where LangCode = @LangCode)
End
Else
Begin
Set @intErrorNumber = 1
Set @strErrorMessage = ''Record not found in stored procedure prcOrganisation_Update''
Goto Finalise
End

Finalise:
If(@intErrorNumber > 0)
Begin
Rollback Transaction
Select
@intErrorNumber As ''ErrorNumber'',
@strErrorMessage As ''ErrorMessage''
End
Else
Begin
Commit Transaction
Select
@intErrorNumber As ''ErrorNumber'',
''Successfully Updated'' As ''ErrorMessage''
End


' 
END
GO





IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamCompleted]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamCompleted]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamStatus]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamStatus]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamFailCount]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamFailCount]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamCurrentCourseIDs]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamCurrentCourseIDs]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamHistoricCourseIDs]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamHistoricCourseIDs]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamUnitIDs]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamUnitIDs]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamAllUnits]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamAllUnits]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamTimeExpired]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamTimeExpired]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamTimeExpiredPeriod]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamTimeExpiredPeriod]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamQuizStatus]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamQuizStatus]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamGroupBy]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamGroupBy]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamGroupingOption]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamGroupingOption]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamFirstName]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamFirstName]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamLastName]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamLastName]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamUserName]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamUserName]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamEmail]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamEmail]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamIncludeInactive]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamIncludeInactive]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamSubject]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamSubject]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamBody]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamBody]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamDateTo]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamDateTo]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamDateFrom]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamDateFrom]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamProfileID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamProfileID]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamOnlyUsersWithShortfall]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamOnlyUsersWithShortfall]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamEffectiveDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamEffectiveDate]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamSortBy]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamSortBy]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamClassificationID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamClassificationID]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamOrganisationID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamOrganisationID]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamServerURL]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamServerURL]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamFromDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamFromDate]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamToDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamToDate]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF__tblReport__Requi__7519FFBE]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF__tblReport__Requi__7519FFBE]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamProfilePeriodID]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamProfilePeriodID]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamPolicyIDs]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamPolicyIDs]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_RequiresParamAcceptanceStatus]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_RequiresParamAcceptanceStatus]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_Active]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_Active]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_lastupdated]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_lastupdated]
END
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblReportInterface_lastupdBy]') AND type = 'D')
BEGIN
ALTER TABLE [tblReportInterface] DROP CONSTRAINT [DF_tblReportInterface_lastupdBy]
END
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblReportInterface]') AND type in (N'U'))
DROP TABLE [tblReportInterface]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblReportInterface]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblReportInterface](
	[ReportID] [int] IDENTITY(1,1) NOT NULL,
	[ReportName] [nvarchar](200) NOT NULL,
	[RDLname] [nvarchar](200) NOT NULL,
	[RequiresParamCompleted] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamCompleted]  DEFAULT ((0)),
	[RequiresParamStatus] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamStatus]  DEFAULT ((0)),
	[RequiresParamFailCount] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamFailCount]  DEFAULT ((0)),
	[RequiresParamCourseIDs] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamCurrentCourseIDs]  DEFAULT ((0)),
	[RequiresParamCourseID] [bit] NOT NULL,
	[RequiresParamHistoricCourseIDs] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamHistoricCourseIDs]  DEFAULT ((0)),
	[RequiresParamUnitIDs] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamUnitIDs]  DEFAULT ((0)),
	[RequiresParamAllUnits] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamAllUnits]  DEFAULT ((0)),
	[RequiresParamTimeExpired] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamTimeExpired]  DEFAULT ((0)),
	[RequiresParamTimeExpiredPeriod] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamTimeExpiredPeriod]  DEFAULT ((0)),
	[RequiresParamQuizStatus] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamQuizStatus]  DEFAULT ((0)),
	[RequiresParamGroupBy] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamGroupBy]  DEFAULT ((0)),
	[RequiresParamGroupingOption] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamGroupingOption]  DEFAULT ((0)),
	[RequiresParamFirstName] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamFirstName]  DEFAULT ((0)),
	[RequiresParamLastName] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamLastName]  DEFAULT ((0)),
	[RequiresParamUserName] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamUserName]  DEFAULT ((0)),
	[RequiresParamEmail] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamEmail]  DEFAULT ((0)),
	[RequiresParamIncludeInactive] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamIncludeInactive]  DEFAULT ((0)),
	[RequiresParamSubject] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamSubject]  DEFAULT ((0)),
	[RequiresParamBody] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamBody]  DEFAULT ((0)),
	[RequiresParamDateTo] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamDateTo]  DEFAULT ((0)),
	[RequiresParamDateFrom] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamDateFrom]  DEFAULT ((0)),
	[RequiresParamProfileID] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamProfileID]  DEFAULT ((0)),
	[RequiresParamOnlyUsersWithShortfall] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamOnlyUsersWithShortfall]  DEFAULT ((0)),
	[ParamLangInterfaceName] [varchar](200) NOT NULL,
	[RequiresParamEffectiveDate] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamEffectiveDate]  DEFAULT ((0)),
	[RequiresParamSortBy] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamSortBy]  DEFAULT ((0)),
	[RequiresParamClassificationID] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamClassificationID]  DEFAULT ((0)),
	[RequiresParamOrganisationID] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamOrganisationID]  DEFAULT ((0)),
	[RequiresParamServerURL] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamServerURL]  DEFAULT ((0)),
	[RequiresParamFromDate] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamFromDate]  DEFAULT ((0)),
	[RequiresParamToDate] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamToDate]  DEFAULT ((0)),
	[RequiresParamUserID] [bit] NOT NULL,
	[RequiresParamAdminUserID] [bit] NOT NULL,
	[RequiresParamLicensingPeriod] [bit] NOT NULL DEFAULT ((0)),
	[RequiresParamProfilePeriodID] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamProfilePeriodID]  DEFAULT ((0)),
	[RequiresParamPolicyIDs] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamPolicyIDs]  DEFAULT ((0)),
	[RequiresParamAcceptanceStatus] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_RequiresParamAcceptanceStatus]  DEFAULT ((0)),
	[Active] [bit] NOT NULL CONSTRAINT [DF_tblReportInterface_Active]  DEFAULT ((0)),
	[lastupdated] [datetime] NOT NULL CONSTRAINT [DF_tblReportInterface_lastupdated]  DEFAULT (getutcdate()),
	[lastupdBy] [int] NOT NULL CONSTRAINT [DF_tblReportInterface_lastupdBy]  DEFAULT ((1))
) ON [PRIMARY]
END
GO
SET IDENTITY_INSERT [tblReportInterface] ON
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (36, N'Policy Builder Report', N'Policies', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, N'Report.Policies', 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (2, N'Active / Inactive Users Report', N'ActiveInactiveReport', 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.ActiveInactive', 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (3, N'Current Admin Report', N'CurrentAdminReport', 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, N'Report.Administration', 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (6, N'Current Admin Report', N'CurrentAdminReportByCourse', 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, N'Report.Administration', 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (7, N'Unit Administrator Report', N'UnitAdministratorReport', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.UnitAdministratorReport', 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (10, N'Summary Report', N'SummaryReportStackedBar', 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.SummaryReportStackedBar', 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (16, N'Unit Compliance Report', N'UnitComplianceReport', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.UnitComplianceReport', 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (17, N'Completed Users Report', N'CompletedUsersReport', 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.CompletedUser', 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (14, N'At Risk Report', N'AtRiskReport', 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, N'Report.AtRisk', 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (18, N'Completed Users Report', N'CompletedUsersReportDetails', 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.IncompleteUserWithDetails', 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (19, N'Course Status Report', N'CourseStatusReport', 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, N'Report.CourseStatus', 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (20, N'Licensing Report', N'LicensingReport', 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.Licensing', 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (21, N'Progress Report', N'ProgressReport', 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.Progress', 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (22, N'Summary Report ', N'SummaryReport', 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.Summary', 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (23, N'Summary Report', N'SummaryReportPie', 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.SummaryReportPie', 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (24, N'Summary Report', N'SummaryReportStackedColumn', 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.Summary', 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (25, N'Trend Report', N'TrendReport', 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.Trend', 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (26, N'Historic Admin Report', N'CurrentAdminReport', 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, N'Report.Administration', 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (27, N'Historic Admin Report', N'CurrentAdminReportByCourse', 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, N'Report.Administration', 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (30, N'Continuing Professional Development', N'CPDReport', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, N'Report.CPDReport', 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (29, N'Warning Report', N'WarningReport', 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, N'Report.Warning', 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (31, N'Unit Path Report', N'UnitAdministratorReport', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.UnitPathway', 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
INSERT [tblReportInterface] ([ReportID], [ReportName], [RDLname], [RequiresParamCompleted], [RequiresParamStatus], [RequiresParamFailCount], [RequiresParamCourseIDs], [RequiresParamCourseID], [RequiresParamHistoricCourseIDs], [RequiresParamUnitIDs], [RequiresParamAllUnits], [RequiresParamTimeExpired], [RequiresParamTimeExpiredPeriod], [RequiresParamQuizStatus], [RequiresParamGroupBy], [RequiresParamGroupingOption], [RequiresParamFirstName], [RequiresParamLastName], [RequiresParamUserName], [RequiresParamEmail], [RequiresParamIncludeInactive], [RequiresParamSubject], [RequiresParamBody], [RequiresParamDateTo], [RequiresParamDateFrom], [RequiresParamProfileID], [RequiresParamOnlyUsersWithShortfall], [ParamLangInterfaceName], [RequiresParamEffectiveDate], [RequiresParamSortBy], [RequiresParamClassificationID], [RequiresParamOrganisationID], [RequiresParamServerURL], [RequiresParamFromDate], [RequiresParamToDate], [RequiresParamUserID], [RequiresParamAdminUserID], [RequiresParamLicensingPeriod], [RequiresParamProfilePeriodID], [RequiresParamPolicyIDs], [RequiresParamAcceptanceStatus], [Active], [lastupdated], [lastupdBy]) VALUES (32, N'User Detail Report', N'UserDetail', 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, N'Report.UserDetail', 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, CAST(0x00009F4A016A0676 AS DateTime), 1)
SET IDENTITY_INSERT [tblReportInterface] OFF



SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblAppConfig]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblAppConfig](
	[Name] [nvarchar](50) NOT NULL,
	[Value] [nvarchar](4000) NOT NULL,
 CONSTRAINT [PK_tblAppConfig] PRIMARY KEY CLUSTERED 
(
	[Name] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
END
GO


BEGIN
IF NOT EXISTS (SELECT * FROM tblAppConfig WHERE Name = 'SSL') INSERT [tblAppConfig] ([Name], [Value]) VALUES (N'SSL', N'true')
END
GO



BEGIN
IF NOT EXISTS (SELECT * FROM tblAppConfig WHERE Name = 'TimeZone') INSERT [tblAppConfig] ([Name], [Value]) VALUES (N'TimeZone', N'AUS Eastern Standard Time')
END
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblEmailQueue]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblEmailQueue](
	[EmailQueueID] [bigint] IDENTITY(1,1) NOT NULL,
	[organisationID] [int] NULL,
	[AddressTo] [nvarchar](255) NULL,
	[Subject] [nvarchar](255) NULL,
	[Body] [nvarchar](max) NULL,
	[QueuedTime] [datetime] NOT NULL,
	[SendStarted] [datetime] NULL,
	[AddressSender] [nvarchar](255) NULL,
	[AddressFrom] [nvarchar](255) NULL,
	[IsHTML] [bit] NULL,
	[AddressBccs] [nvarchar](max) NULL
) ON [PRIMARY]
END
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblEmailQueue_QueuedTime]') AND type = 'D')
BEGIN
ALTER TABLE [tblEmailQueue] ADD  CONSTRAINT [DF_tblEmailQueue_QueuedTime]  DEFAULT (getutcdate()) FOR [QueuedTime]
END

GO





SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblEmailQueueLinkedResource]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblEmailQueueLinkedResource](
	[EmailQueueID] [bigint] NOT NULL,
	[ContentID] [nvarchar](100) NOT NULL,
	[ByteStream] [varbinary](max) NULL
) ON [PRIMARY]
END
GO

SET ANSI_PADDING OFF
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_GetNext]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_GetNext]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_GetNext]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcEmail_GetNext]
AS
BEGIN
DECLARE  @EmailQueueID INT
SELECT @EmailQueueID = MIN (EmailQueueID)
FROM tblEmailQueue
WHERE ((SendStarted is NULL) OR (DATEADD(DAY,1,SendStarted) < GETUTCDATE()))
-- A SINGLE INSTANCE  WILL BE UPDATING THE TABLE SO DO NO MULTIUSER CODE
SELECT TOP (1) EmailQueueID,OrganisationID,AddressTo,AddressBCCs,[Subject],body,AddressSender,AddressFrom,IsHTML,CASE WHEN DATEDIFF(d,QueuedTime,GETUTCDATE()) > 1 THEN 1 ELSE 0 END AS Retry
FROM tblEmailQueue  WHERE @EmailQueueID =  EmailQueueID
UPDATE tblEmailQueue SET SendStarted = GETUTCDATE()  WHERE @EmailQueueID =  EmailQueueID

END
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_GetAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_GetAttachments]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_GetAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcEmail_GetAttachments]
@EmailQueueID INT
AS
BEGIN
	SELECT ContentID,ByteStream FROM tblEmailQueueLinkedResource WHERE EmailQueueID = @EmailQueueID


END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_RemoveMessage]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_RemoveMessage]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_RemoveMessage]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcEmail_RemoveMessage]

	@EmailQueueID int

AS
BEGIN

	 DELETE FROM tblEmailQueue WHERE EmailQueueID = @EmailQueueID
	 DELETE FROM tblEmailQueueLinkedResource WHERE EmailQueueID = @EmailQueueID
END
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_AdminMashup]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCourse_AdminMashup]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_AdminMashup]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary:		Compiles a bunch of info based on the selected units/courses then filters it based on administrator selection
Parameters:		Comma separated list of userID:courseID, comma separated list of adminID (unit administrators)
Returns:		table (lastname firstname userid email course_names)
		
Called By:		BusinessServices.Course.GetAdminMashup in Course.cs
Calls:			None

Remarks:		None

Author:			Mark Donald
Date Created:	20 Jan 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [prcCourse_AdminMashup]
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@input_csv varchar(8000),
	@adminids varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
AS
BEGIN
	SET NOCOUNT ON;

--*********

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @mashup TABLE (userid int, courseid int)
	DECLARE @selectedadmin TABLE (adminid int)
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

INSERT INTO
		@selectedadmin
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@adminids)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, A.UnitID
			FROM
				(SELECT
					A.UserID, D.UnitID
					FROM
						(SELECT
							A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
							FROM
								tblUserCourseStatus A, @CoursesWithAccess B
							WHERE
								A.DateCreated < DATEADD(DD, 1, @quizDateTo)
								and A.CourseID = B.CourseID
							GROUP BY
								A.UserID, A.CourseID
						) A, @Users B, tblUserCourseStatus C, tblUser D
					WHERE
						A.UserID = B.UserID
						AND B.UserID = C.UserID
						AND A.LatestCourseStatus = C.UserCourseStatusID
						AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
						AND C.CourseStatusID = case @courseModuleStatus
													when @CONST_COMPLETE then 2   -- Complete
													when @CONST_INCOMPLETE then 1 -- InComplete
													end
						AND A.UserID = D.UserID
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
				AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
			ORDER BY
				A.UserID, A.UnitID
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, UnitID
				FROM 
					(select
						distinct userid, moduleid
						from
							@UsersQuizStatusNOTSTARTED
					) A, tblUser B, tblModule D
				WHERE 
					A.UserID = B.UserID
					AND A.ModuleID = D.ModuleID
					AND D.Active = 1
				ORDER BY
					A.UserID, UnitID
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT 
				A.UserID, UnitID
				FROM
					(SELECT
						DISTINCT A.UserID, B.UnitID
						FROM 
							(SELECT
								DISTINCT userid, moduleid
								FROM
									@UsersQuizStatusNOTSTARTED
							) A, tblUser B, tblModule D
						WHERE 
							A.UserID = B.UserID
							AND A.ModuleID = D.ModuleID
							AND D.Active = 1
					) A
					LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
						AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				WHERE
					--If classification is Any (0), This will find users of any Custom Classification
					@classificationID =0 OR tblUserClassification.classificationID = @classificationID
				ORDER BY
					A.UserID, UnitID

	end --/ Not started - Any


insert into @tblUnit(UnitID)
select distinct UnitID
from @tblUserUnit

---If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the users Units.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, ua.UserID
from @tblUnit u
	inner join tblUnitAdministrator ua
		on ua.UnitID = u.UnitID
	inner join tblUser us
		on us.UserID = ua.UserID and us.UserTypeID = 3 --Unit Administrator

--If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, us.UserID
from tblUser us
	cross join @tblUnit u
where us.OrganisationID = @organisationID
	and us.UserTypeID = 2 -- Organisation Administrator
	and u.UnitID not in (select UnitID from @tblUnitAdministrator)
	and us.Active = 1

--*********

	-- clean up the input so it resembles ''userid:courseid,userid:courseid,''
	SELECT @input_csv = replace(rtrim(ltrim(replace(replace(replace(@input_csv,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip input_csv
	WHILE patindex(''%,%'', @input_csv) <> 0
		BEGIN
			SELECT @pos = patindex(''%,%'', @input_csv)
			SELECT @temp = left(@input_csv, @pos - 1)
			SELECT @colon_pos = patindex(''%:%'', @input_csv)
			INSERT @mashup VALUES (
				cast(substring(@temp, 1, @colon_pos - 1) AS int),
				cast(substring(@temp, @colon_pos + 1, len(@temp)) AS int)
			)
			SELECT @input_csv = substring(@input_csv, @pos + 1, len(@input_csv))
		END

	-- join @mashup, @tblunitadministrator & @selectedadmin tables & sort results by adminid and courseid
	SELECT
		adminid, a.email, a.firstname, a.lastname, m.courseid, [name] coursename, u.firstname, u.lastname
		FROM
			@mashup m,
			@tblunitadministrator n,
			@selectedadmin s,
			tbluser a,
			tblcourse c,
			tbluser u
		WHERE
			u.userid = m.userid
			AND n.unitid = u.unitid
			AND a.userid = adminid
			AND adminid = adminuserid
			AND c.courseid = m.courseid
		ORDER BY
			adminid, m.courseid
			
END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_Users]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_Users]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_Users]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Returns: result set (active users in the csv list of units)
	
Author: Mark Donald
Date Created: 04 Aug 2009

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

exec dbo.prcEmail_Users 109, ''4463''
**/

CREATE PROC [prcEmail_Users]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX)
)
AS
SET NOCOUNT ON

BEGIN
	SELECT DISTINCT
		u.userid, firstname, lastname, email
	FROM
		tblUser u, tblunit t
	WHERE
		u.unitid = t.unitid
		AND u.organisationid = @organisationID
		AND t.unitid IN (SELECT * FROM dbo.udfCsvToInt(@unitIDs))
		AND u.Active = 1
		AND t.Active = 1
END

' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_AdminMashup]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcPolicy_AdminMashup]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_AdminMashup]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary:		Compiles a bunch of info based on the selected units/policies then filters it based on administrator selection
Parameters:		Comma separated list of userID:policyID, comma separated list of adminID (unit administrators)
Returns:		table (lastname firstname userid email policy_names)
		
Called By:		BusinessServices.policy.GetAdminMashup in policy.cs
Calls:			None

Remarks:		None

Author:			Mark Donald
Date Created:	20 Jan 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [prcPolicy_AdminMashup]
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@policyIDs 			varchar(8000),
	@input_csv varchar(8000),
	@adminids varchar(8000),
	@classificationID 	int,
	@policyStatus	int,
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@includeInactive	int
AS
BEGIN
	SET NOCOUNT ON;

--*********

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_NOT_ACCEPTED     int,
	@CONST_ACCEPTED     	int,
	@CONST_UNKNOWN          int


	set @CONST_NOT_ACCEPTED	= 0
	set @CONST_ACCEPTED	    = 1
	set @CONST_UNKNOWN		= 2


	DECLARE @Units TABLE (UnitID INT)
	DECLARE @policies TABLE (policyID INT)
	DECLARE @policiesWithAccess TABLE (policyID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @mashup TABLE (userid int, policyid int)
	DECLARE @selectedadmin TABLE (adminid int)
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50)

	INSERT INTO
		@policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policyIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

INSERT INTO
		@selectedadmin
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@adminids)

	if @policyStatus = @CONST_ACCEPTED
	BEGIN
		SELECT

		untadm.UserID, usr.Email, adm.FirstName, adm.LastName, pol.policyID, pol.PolicyName, usr.FirstName, usr.LastName 
			FROM
				@policies ps 
				INNER JOIN tblPolicy pol ON ps.policyID = pol.policyID 
				INNER JOIN tblUserPolicyAccepted polacp ON polacp.policyID = pol.policyID AND polacp.Accepted = ''True'' AND COALESCE(polacp.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom AND COALESCE(polacp.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo
				INNER JOIN tblUserPolicyAccess polacs ON polacs.policyID = pol.policyID AND polacs.Granted = ''True'' AND polacp.userID = polacs.userID
				INNER JOIN tblUser usr ON usr.userID = polacp.userID
				INNER JOIN tblUnitAdministrator untadm ON untadm.UnitID = usr.UserID
				INNER JOIN tblUser adm ON adm.UserID = untadm.UserID
				WHERE pol.organisationID = @organisationID;
	END
	else
	BEGIN
		SELECT

		untadm.UserID, usr.Email, adm.FirstName, adm.LastName, pol.policyID, pol.PolicyName, usr.FirstName, usr.LastName 
			FROM
				@policies ps 
				INNER JOIN tblPolicy pol ON ps.policyID = pol.policyID 
				INNER JOIN tblUserPolicyAccepted polacp ON polacp.policyID = pol.policyID AND polacp.Accepted = ''False'' 
				INNER JOIN tblUserPolicyAccess polacs ON polacs.policyID = pol.policyID AND polacs.Granted = ''True'' AND polacp.userID = polacs.userID
				INNER JOIN tblUser usr ON usr.userID = polacp.userID
				INNER JOIN tblUnitAdministrator untadm ON untadm.UnitID = usr.UserID
				INNER JOIN tblUser adm ON adm.UserID = untadm.UserID
				WHERE pol.organisationID = @organisationID;
				
	END
			
END




' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDEmail_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCPDEmail_Report]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDEmail_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE procedure [prcCPDEmail_Report] 
	(
	@ProfileID  int,
	@UnitIDs varchar(MAX)
	)
as
	select  distinct pf.profileid
		, u.userid
		, u.lastname
		, u.firstname
		,hierarchyname = dbo.udfGetUnitPathway(u.UnitID)
		,u.email as useremail
	from tblProfile pf
		join tblprofileperiod pp on pp.profileid = pf.profileid
		join tbluserprofileperiodaccess upa on upa.profileperiodid = pp.profileperiodid 
			and granted = 1
		join tbluser  u on u.userid = upa.userid
		left join tblusercpdpoints upt on upt.userid = u.userid
	where pf.profileid = @ProfileID and 
		pp.profileperiodactive = 1 and
		getdate() between pp.datestart and dateadd(d,1,pp.dateend) and 
		pp.points > coalesce(upt.points,0) and 
		u.unitid in (select IntValue from dbo.udfCsvToInt(@UnitIDs)) and
		u.userid in
		(-- users for a course
			select distinct uma.userid from
			tblProfile p
			join tblProfilePeriod pp 
			on p.profileid = pp.profileid
			join tblProfilePoints ppts
			on pp.profileperiodid = ppts.profileperiodid
			join tblModule m on ppts.typeid = m.moduleid
			join vwUserModuleAccess uma on uma.courseid = m.courseid and u.userid=uma.userid
			where p.profileid = @profileid
			and pp.profileperiodactive = 1
			and ppts.profilepointstype = ''M'')
' 
END
GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfReport_HistoricAdminSummaryOptimised]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'/****** Object:  User Defined Function dbo.udfReport_HistoricAdminSummary    Script Date: 20/04/2004 8:25:58 AM ******/
/*Summary:
Get the Current or historic user module status  based on the search criteria
See the remarks below.
Returns: table
Called By: Current historic Admin Report
Calls:
Remarks:
1. Get User and course List based on search criteria
1.1 Get Unit List
1.1.1 If unit ids are passed in, convert the CSV format to a table
1.1.2 If no unit is selected, get a list of of all units that the admin user has permission to access
1.2 Get User list Based on the first name and last name in the search cirteria
1.3 Get Course list Based on the selected course in the search criteria and Used can select multiple Courses
2. Get the User Quiz and Lesson status up to the effective date
2.1 If there is no effective date is passed in, get the current module status
2.2 If there is effective date, get the module status up to the effective date
3.  Get a list of the user''s quiz and lesson historic status
Author: Jack Liu
Date Created: 1 Mar 2004
Modification History
-----------------------------------------------------------
v#	Author		Date				Description
#1.1	Usman Tjiudri	10/11/2005	Performance tuning:
- use temp-table to populate Unit Pathway
- join the temp-table to populate tblResult
instead of using udfGetUnitPathway function in the join.
#2.0	Serguei Chkaroupine 28/02/06 -New insert statement for histric admin report
- it will insert all lessons that match current quizmodule pair
- Current admin report performance fix. Added WHERE statement to
most of the insert statements.
#3	Mark Donald	27/07/2009			add userName and userEmail params

select * from dbo.udfReport_HistoricAdminSummary(3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',4)
--------------------
**/

CREATE             Function [udfReport_HistoricAdminSummaryOptimised]
(
	@organisationID 	Int,
	@unitIDs			Varchar(MAX),
	@courseIDs			Varchar(8000),
	@userFirstName		Varchar(50),
	@userLastName		Varchar(50),
	@userName			Varchar(100),
	@userEmail			Varchar(100),
	@effectiveDate 		Datetime,
	@adminUserID		Int,
	@classificationID 	Int,
	@defaultDate		DateTime,
	@inclInactive		int
)
Returns @tblResult Table
(
	-- General
	Unit			nVarchar(200),
	[User]			nVarchar(100),
	Course			nVarchar(100),
	Module			nVarchar(100),
	[Sequence]		Int,
	-- Quiz Specific
	QuizStatus		Varchar(50),
	QuizScore		Int,
	QuizStatusDate	Datetime,
	-- Lesson Specific
	LessonStatus	Varchar(50),
	-- Hidden
	UnitID			Int,
	UserID			Int,
	UserName		nVarchar(100),
	ExternalID		nVarchar(50),
	CourseID		Int,
	ModuleID		Int,
	Active	int
)
As Begin

	--Variables declarations
	DECLARE @UserTypeID 	INT
	DECLARE @tblUnit 				Table(UnitID INT PRIMARY KEY(UnitID))
	DECLARE @tblUser 				Table(UserID INT, UnitID INT, Active INT)
	DECLARE @tblCourse 				Table(CourseID INT, [Name] NVARCHAR(100) PRIMARY KEY(CourseID))
	DECLARE @CoursesWithAccess 		TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @UserModuleWithAccess 	TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules 			TABLE(ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @tblUserQuizStatus 		Table
									(
										[UserQuizStatusID] [int] Not Null,
										[UserID] [int] Not Null,
										[ModuleID] [int] Not Null,
										[QuizStatusID] [int] Not Null,
										[QuizScore] [int] Null,
										[DateCreated] [datetime] Not Null
									)
	DECLARE @tblUserLessonStatus 	Table
									(
										[UserLessonStatusID] [int] ,
										[UserID] [int] ,
										[ModuleID] [int] ,
										[LessonStatusID] [int] ,
										[DateCreated] [datetime]
									)
	DECLARE @vwUserModuleAccess table
	(
		UserID INT not null,
		FirstName varchar(255),
		LastName varchar(255),
		UnitID INT,
		OrganisationID INT,
		ModuleID INT,
		CourseID INT,
		CourseName nvarchar(100),
		[Name] nvarchar(100),
		Sequence INT,
		Description nvarchar(1000)
	)

	DECLARE @tblOrganisationCourseAccess table
	(
		OrganisationID int,
		GrantedCourseID int
	)
	---------------------------------------------------------------------------------------------

	--set the default date depending on effective date
	set @defaultdate = coalesce (@effectivedate,@defaultdate)
	---------------------------------------------------------------------------------------------

	--Check If Unit ID is specified
	IF @unitIDs IS NULL
		BEGIN
			--Check User Type
			SELECT 
				@UserTypeID = UserTypeID
			FROM
				tblUser
			WHERE UserID = @adminUserID

			--Get all units in Organisation if user is Salt Admin(1) or Org admin (2)
			IF (@UserTypeID = 1 Or @UserTypeID = 2)
			BEGIN
				INSERT INTO 
					@tblUnit (UnitID)
					SELECT 
						UnitID
					FROM 
						tblUnit
					WHERE OrganisationID = @OrganisationID
			END

			--Get units that the user is admministrator if user is Unit Admin(3)
			IF (@UserTypeID = 3)
			BEGIN
				INSERT INTO 
					@tblUnit (UnitID)
					SELECT 
						U.UnitID
					FROM 
						tblUnit U INNER JOIN tblUnitAdministrator UA ON 
							UA.UnitID = U.UnitID AND 
							UA.UserID = @adminUserID
						WHERE 
							U.OrganisationID = @OrganisationID
			END
		END
	ELSE
		BEGIN
			--Seperate comma seperated values as Table rows
			INSERT INTO @tblUnit SELECT * FROM  dbo.udfCsvToInt(@unitIDs)
		END
	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	--FirstName, Last Name, etc specified in search criteria
	IF (@userFirstName IS NULL) 	SET @userFirstName = ''''
	IF (@userLastName IS NULL) 		SET @userLastName = ''''
	IF (@userName IS NULL) 			SET @userName = ''''
	IF (@userEmail IS NULL) 		SET @userEmail = ''''

	INSERT INTO 
		@tblUser (UserID, UnitID, Active)
		SELECT DISTINCT	
			U.UserID, U.UnitID, U.Active
		FROM 
			tblUser U INNER JOIN @tblUnit UN ON	U.UnitID = UN.UnitID 
				and datediff(day,U.datecreated,@defaultdate)>=0-- created on or b4 specified date
			LEFT JOIN tblUserClassification UC ON UC.UserID  = U.UserID
		WHERE 
			U.FirstName Like ''%'' + @userFirstName + ''%'' AND
			LastName Like ''%'' + @userLastName + ''%'' AND
			UserName Like ''%'' + @userName + ''%'' AND
			Email Like ''%'' + @userEmail + ''%'' AND
		 	--AND have the Custom Classification option
			--If classification is Any (0), This will find users of any Custom Classification
			((@classificationID = 0) OR (UC.classificationID = @classificationID)) AND
			--inclInactive = 0: do not include inactive user
			--inclInactive = 1: include inactive user
			(U.Active = CASE @inclInactive WHEN 0 THEN 1 ELSE U.Active END) AND
			(U.OrganisationID = @OrganisationID)
			
	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	-- Search criteria contains Course ID''s
	INSERT INTO 
		@tblCourse (CourseID, [Name])
		SELECT 
			C.CourseID, C.[Name]
		FROM 
			dbo.udfCsvToInt(@courseIDs) CA INNER JOIN tblCourse C ON 
				CA.intValue = C.CourseID AND C.Active = 1
	
	-- added to deal with past courses - adds past course to intermediate @tblOrganisationCourseAccess table
	-- to mimic it being a current course so results will be returned
	insert into 
		@tblOrganisationCourseAccess (OrganisationID, GrantedCourseID)
		select
			@Organisationid, C.CourseID
		from
			dbo.udfCsvToInt(@courseIDs) CA inner join tblCourse C on
				CA.intValue = C.CourseID and C.Active = 1

	INSERT INTO @vwUserModuleAccess   SELECT   tU.UserID, tU.FirstName, tU.LastName, tU.UnitID, tU.OrganisationID, tM.ModuleID, tM.CourseID, tC.Name AS CourseName, tM.Name, tM.Sequence, 
	                      tM.Description 
	FROM         tblUser AS tU INNER JOIN
						  @tblUser tbU on tbU.UserID = tU.UserID
						  inner join	
	                      @tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
	                      tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
	                      tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
	                      tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
	                      tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID
	WHERE     tM.CourseID in (SELECT courseid from @tblCourse ) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
	                      (tUsrMA.Granted = 1)
	--select * from @vwUserModuleAccess where UnitID is null 

	INSERT INTO @UserModuleWithAccess
	SELECT DISTINCT UserID, ModuleID, UnitID FROM @vwUserModuleAccess where UnitID is not null   

	INSERT INTO @tblUserQuizStatus
		(
			[UserQuizStatusID],
			[UserID],
			[ModuleID],
			[QuizStatusID],
			[QuizScore],
			[DateCreated]
		)
		SELECT
			A.[UserQuizStatusID],
			A.[UserID],
			A.[ModuleID],
			A.[QuizStatusID],
			A.[QuizScore],
			A.[DateCreated]
		FROM
			(
				SELECT 
					A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
				FROM 
					@UserModuleWithAccess A, tblUserQuizStatus B 
				WHERE
					A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND B.QuizStatusID <> 0 
					--AND DateDiff(day, B.DateCreated, @effectiveDate)=0
				GROUP BY
					A.UserID, A.ModuleID
			) B, tblUserQuizStatus A, @tblUser C
		WHERE
			A.UserQuizStatusID = B.LatestQuizID AND B.UserID = C.UserID AND A.UserID = C.UserID
-- li June 2008:		
-- User who has access to a module but doesn''t have a record in tblUserQuizStatus is a new user 
-- this logic will include new user in the current and historic admin report before user quiz status
-- is updated by overnight job

		INSERT INTO @tblUserQuizStatus
		(
			[UserQuizStatusID],
			[UserID],
			[ModuleID],
			[QuizStatusID],
			[QuizScore],
			[DateCreated]
		)
		SELECT
			0, -- UserQuizStatusID
			A.[UserID],
			A.[ModuleID],
			1, -- QuizStatus: Not Started
			null, -- QuizScore
			@defaultDate -- DateCreated (here set to @defaultdate which is passed in as getDate())
		FROM @UserModuleWithAccess A
		join  @tblUser B on A.UserID = B.UserID
		-- User doesn''t have quiz activities
		where  A.UserID  + ''-'' + A.MODULEID NOT IN 
			(	Select D.UserID + ''-'' + D.Moduleid 
				from @tblUserQuizStatus D 
				where datediff(day, d.datecreated, @defaultdate)>=0)			 
-- end logic for including new user''s quiz status 

	Insert Into @tblUserLessonStatus
	(
		[UserLessonStatusID],
		[UserID],
		[ModuleID],
		[LessonStatusID],
		[DateCreated]
	)
	Select
		A.[UserLessonStatusID],
		A.[UserID],
		A.[ModuleID],
		A.[LessonStatusID],
		A.[DateCreated]
	FROM
		(
			SELECT
				B.UserID, B.ModuleID, MAX(B.UserLessonStatusID) AS ''LatestLessonStatusID''
			FROM
				@UserModuleWithAccess A, tblUserLessonStatus B
			WHERE
				A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
				--DateDiff(day, B.DateCreated, @effectiveDate)>=0 AND
				B.LessonStatusID <> 0 --Unassigned
			GROUP BY
				B.UserID, B.ModuleID
		) B, tblUserLessonStatus A, @tblUser C
	WHERE
		A.UserLessonStatusID = B.LatestLessonStatusID AND B.UserID = C.UserID AND A.UserID = C.UserID

-- start logic for including new user''s lesson status
		INSERT INTO @tblUserLessonStatus
		(
			[UserLessonStatusID],
			[UserID],
			[ModuleID],
			[LessonStatusID],
			[DateCreated]
		)
		SELECT
			0, -- UserLessonStatusID
			A.[UserID],
			A.[ModuleID],
			1, -- LessonStatus: Not Started
			@defaultDate -- DateCreated (here set to @defaultdate which is passed in as getDate())
		FROM @UserModuleWithAccess A
		join  @tblUser B on A.UserID = B.UserID
		where 
		-- User doesn''t have lesson activities for the date entered
		A.UserID + ''-'' + A.Moduleid NOT IN
		(	Select D.UserID + ''-'' + D.Moduleid  
			from @tblUserLessonStatus D 
			where datediff(day, d.datecreated, @defaultdate)>=0 )
-- end logic for including new user''s lesson status

	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	-- This part fixes migration issue (note this will affect historic admin report only as it does supply effective date)
	-- It will insert userid, moduleid and earliest lesson status for each quiz that does not have lesson record yet
	-- into @tblUserLessonStatus
	Insert Into @tblUserLessonStatus
	(
		[UserLessonStatusID],
		[UserID],
		[ModuleID],
		[LessonStatusID],
		[DateCreated]
	)
	SELECT 1,
		A.[UserID],
		A.[ModuleID],
		B.LessonStatusID,
		A.DateCreated
	FROM (
	SELECT 
		A.UserID, A.ModuleID, MIN(A.DateCreated) AS ''DateCreated''
	FROM
		tblUserLessonStatus A, @tblUser B 
	WHERE
		A.UserID = B.UserID
	GROUP BY
		A.UserID, A.ModuleID
	) A , tblUserLessonStatus B WHERE 

		A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND A.DateCreated = B.DateCreated AND
		(CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)))
	NOT IN (SELECT CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)) FROM @tblUserLessonStatus)


	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	Insert Into @tblResult
	(
		Unit,
		[User],
		Course,
		Module,
		[Sequence],
		QuizStatus,
		QuizStatusDate,	-- These columns have been reordered
		QuizScore,	    -- These columns have been reordered
		LessonStatus,
		UnitID,
		UserID,
		UserName,
		ExternalID,
		CourseID,
		ModuleID
	)
	Select distinct 
		-- General
		up.HierarchyName 				As Unit, -- Unit Name
		[User] = CASE u.Active when 0 then u.LastName + '' '' + u.FirstName + ''(i)'' ELSE u.LastName + '' '' + u.FirstName End , -- User Full Name
		c.Name			  				As Course, -- Course Name
		m.Name			  				As Module, -- Module Name
		m.Sequence						As Sequence,
		-- Quiz Specific
		qs.Status						As QuizStatus,
		uqs.DateCreated 			    as QuizStatusDate,	-- These columns have been reordered
		uqs.QuizScore 				    as QuizScore,		-- These columns have been reordered
		-- Lesson Specific
		ls.status 						As LessonStatus,
		-- Hidden
		u.UnitID						As UnitID,
		u.UserID						As UserID,
		u.UserName						As UserName,
		u.ExternalID						As ExternalID,
		c.CourseID						As CourseID,
		m.ModuleID						As ModuleID
		--u.Active						As Active
	From @tblUserQuizStatus uqs
		Inner Join tblQuizStatus qs On qs.QuizStatusID = uqs.QuizStatusID
		inner Join @tblUser us 	On us.UserID = uqs.UserID
		Inner Join tblUser u On u.UserID = us.UserID
		INNER Join tblUnitHierarchy up On up.UnitID = u.UnitID
		INNER Join tblModule m On m.ModuleID = uqs.ModuleID
		INNER Join @tblCourse c On c.CourseID = m.CourseID
		INNER Join @tblUserLessonStatus uls On uls.UserID = u.UserID And uls.ModuleID = m.ModuleID
		INNER Join tblLessonStatus ls On ls.LessonStatusID = uls.LessonStatusID
	where @effectivedate is null or (datediff(day,uqs.datecreated,@effectivedate)>=0 and datediff(day, uls.datecreated, @effectivedate)>=0)
	RETURN
END





' 
END

GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_AdminSummaryReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_AdminSummaryReport]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_AdminSummaryReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	This will show the Current or historic Admin Report

	See the remarks below.

Returns:
		
Called By: Current Admin Report
Calls:

Remarks:

	1. Get the Current or historic user module status  based on the search criteria

	2.  Group and sort the result
	2.1    Group by Unit_User
		 Columns output:	
			Unit,
			[User],
			Course,
			Module,
			QuizStatus,
			QuizScore,
			QuizStatusDate,
			LessonStatus
	
	2.2    Group by Course
		 Columns output:	
			Course,
			Module,
			Unit,
			[User],
			QuizStatus,
			QuizScore,
			QuizStatusDate,
			LessonStatus
	
		then sorted by, either: 
		   QuizScore
		   Last Name
		   QuizStatusDate	
			

Author: Jack Liu
Date Created: 1 Mar 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Mark Donald	27/07/2009		add userName and userEmail params


prcReport_AdminSummaryReport 3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',''Unit_User'','''',4
prcReport_AdminSummaryReport 3, '''', ''1,2,3,4'','''','''',NULL,NULL,null,''Course'',''QuizDate'',4

--------------------

**/

CREATE      procedure [prcReport_AdminSummaryReport]
(
@organisationID 	int,
@unitIDs		Varchar(MAX),
@courseIDs		Varchar(8000),
@userFirstName		nVarchar(50),
@userLastName		nVarchar(50),
@userName			nVarchar(100),
@userEmail			nVarchar(100),
@effectiveDate 		datetime,
@groupBy		nVarchar(50),
@sortBy			nVarchar(50),
@adminUserID		int,
@classificationID 	int,
@inclInactive	int -- Flag for including inactive user or not
					--@inclInactive = 0: do not include inactive users
					--@inclInactive = 1: include inactive users
)
As
set nocount on
/*
1. Get the Current or historic user module status  based on the search criteria
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus,
UnitID,
UserID,
CourseID,
ModuleID
*/

DECLARE @defaultDate DATETIME
SET @defaultDate = getdate()

if  not ( @sortBy  = ''QUIZ_SCORE'' or @sortBy  = ''QUIZ_DATE'' or @sortBy  = ''LAST_NAME'')
Begin
-- sort order is not QUIZ_SCORE, QUIZ_DATE or LAST_NAME
set @sortBy = ''LAST_NAME''
End
Declare @tblResult TABLE
(
-- General
Unit		nVarchar(200),
[User]		nVarchar(100),
Course		nVarchar(100),
Module		nVarchar(100),
[Sequence]  Int,
-- Quiz Specific
QuizStatus	nvarchar(50),
QuizScore	Int,
QuizStatusDate	DateTime,
-- Lesson Specific
LessonStatus	nvarchar(50),
-- Hidden
UnitID		Int,
UserID		Int,
UserName	nvarchar(100),
ExternalID	nvarchar(50),
CourseID	Int,
ModuleID	Int,
Active		Int,
ClassificationName nvarchar(50),  -- This may need to be changed when multiple classifications become needed.
ClassificationValue nvarchar(50)
)
Insert Into
@tblResult
select
Results.*,
tblClassificationType.Name,
tblClassification.Value
from
dbo.udfReport_HistoricAdminSummaryOptimised(@organisationID,@unitIDs,@courseIDs,@userFirstName,@userLastName,@userName,@userEmail,@effectiveDate,@adminUserID,@classificationID,@defaultDate,@inclInactive)
as Results
left join
tblUserClassification on tblUserClassification.UserID = Results.UserID
left join
tblClassification on tblClassification.ClassificationID = tblUserClassification.ClassificationID
left join
tblClassificationType on tblClassification.ClassificationTypeID = tblClassificationType.ClassificationTypeID
/*
2.  Group and sort the result
2.1    Group by Unit/User
Columns output:
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus
*/
if (@groupBy = ''Unit_User'')
begin
select
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus,
UnitID,
UserID,
UserName,
ExternalID,
CourseID,
ModuleID,
Active,
ClassificationName,
ClassificationValue
from @tblResult
order by Unit, UnitID, [User], userID,  Course, CourseID, [Sequence]
end
/*
2.2    Group by Course
Columns output:
Course,
Module,
Unit,
[User],
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus
then sorted by, either:
QuizScore
Last Name
QuizStatusDate
*/
else -- (@groupBy = ''Course'')
begin
if (@sortBy = ''QUIZ_SCORE'')
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, QuizScore desc,[user]
end
else if (@sortBy = ''QUIZ_DATE'')
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, QuizStatusDate desc,[user]
end
else -- order by ''LAST_NAME''
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, [user]
end
end


' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfCsvToInt]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfCsvToInt]
GO

SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfCsvToInt]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'

/****** Object:  User Defined Function dbo.udfCsvToInt    Script Date: 20/04/2004 8:25:57 AM ******/


/*
Summary:
user Defined Function converts a comma seperated string into a table
Returns:
table
Called By:
dbo.prcOrganisation_SaveCourseAccess
dbo.prcReport_CurrentAdminSummary
dbo.prcReport_EmailReportToAdministrators
dbo.prcReport_EmailReportUserSearch
dbo.prcReport_HistoricPointAdminSummaryReport
dbo.prcReport_HistoricRangeAdminLessonSummaryReport
dbo.prcReport_HistoricRangeAdminQuizSummaryReport
dbo.prcReport_Trend
dbo.prcUnit_Search
dbo.prcUser_ClassificationUpdate
dbo.prcUser_GetEmailAddress
dbo.prcUser_SaveModuleAccess
dbo.prcUser_Search
dbo.udfReport_CompletUsers_logic
dbo.udfReport_HistoricAdminSummary
dbo.udfReport_IncompletUsers_logic
Calls:
null
Remarks:
bassed on several examples found at http://www.sqlteam.com/

Author:
Stephen Kennedy Clark
Date Created:
Monday 16 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1

use:

select * from dbo.udfCsvToInt('''')
select * from dbo.udfCsvToInt('',,,,,1'')
select * from dbo.udfCsvToInt(''1,,,,,,'')
select * from dbo.udfCsvToInt(''1,,3,,34534534,,'')

**/

CREATE   Function [udfCsvToInt]
(
@commaSepperatedList varchar(MAX) = '''' -- Input string, comma seperated list of integers to be returned as a table
)
returns @tblIntTable table
(IntValue int)
AS
begin
if @commaSepperatedList <> ''''
begin
-- get rid of spaces
while CHARINDEX('' '' , @commaSepperatedList) <> 0
begin
set @commaSepperatedList = replace(@commaSepperatedList,'' '','''')
end

-- get rid of "null" values
while CHARINDEX('',,'' , @commaSepperatedList) <> 0
begin
set @commaSepperatedList = replace(@commaSepperatedList,'',,'','','')
end

set @commaSepperatedList = replace(@commaSepperatedList,'',,'','','')

-- get rid of leading and trailing commas
if @commaSepperatedList like('',%'')
begin
set @commaSepperatedList = right(@commaSepperatedList,len(@commaSepperatedList)-1)
end
if @commaSepperatedList like(''%,'')
begin
set @commaSepperatedList = left(@commaSepperatedList,len(@commaSepperatedList)-1)
end

declare @sep char(1)
set @sep = '',''

declare @intPos int
declare @strTemp varchar(500)

set @commaSepperatedList = @commaSepperatedList + '',''

while patindex(''%,%'' , @commaSepperatedList) <> 0
begin

select @intPos =  patindex(''%,%'' , @commaSepperatedList)
select @strTemp = left(@commaSepperatedList, @intPos - 1)

Insert @tblIntTable
Values (Cast(@strTemp as int))

select @commaSepperatedList = stuff(@commaSepperatedList, 1, @intPos, '''')
end
end
return
end






' 
END

GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_CompleteUsersLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfReport_CompleteUsersLogic]
GO

SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_CompleteUsersLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'


/****** Object:  User Defined Function dbo.udfReport_CompleteUsersLogic    Script Date: 20/04/2004 8:25:58 AM ******/

/*Summary:
Selects User details for users that have not Completed their training

Parameters:
@organisationID Integer,
@unitIDs	string		(Mandatory)
@courseID	int		(Mandatory)
@effectiveDate	datetime	(optional)
Returns:


Called By:
prcReport_CompletedUsers

Calls:
fn dbo.udfGetUnitPathway( UnitID )
fn udfReport_incompleteUsers()
fn udfCsvToInt( csv )


Remarks:


Author: Stephen Kennedy-Clark
Date Created: 18 February 2004

Execution:


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	27/02/2004 		Change the "in" criteria to left join, this will improve performance
Fix the unit id bug
#2	Stephen Clark	1/4/2004		change the function to use the underlying table
#3	Peter Kneale	7/4/2004		Added function for effective date style reports
#4	Liz Dionisio(UW)	8/11/2005		Added Username, Email and ExternalID to returned recordset
#5	Yoppy Suwanto	22/08/2007		Replace the udfGetUnitPathway function with the tblUnitHierarchy usage.  This will improve perfomance
**/
CREATE   function [udfReport_CompleteUsersLogic]
(
@organisationID Integer,	-- Organisation of the user running the report
@unitIDs Varchar(MAX),		-- string of unit id''s
@courseID Int, 			-- course ID to restrict search to
@effectiveDate datetime = null	-- effective date of report
)

-------------------------------------------------------------------
Returns @tblReturn Table
(
	UserID		Int,
	UnitID		Int,
	FirstName		nVarchar(255),
	LastName 	nVarchar(255),
	UnitPathway 	nVarchar(4000),
	[Date]		Datetime,
	Username	nvarchar(100),
	Email		nvarchar(100),
	ExternalID	nvarchar(50)
)

as
Begin --1
if (@unitIDs is null)
begin --2
----------------------------------------------------
--- Report on all units
----------------------------------------------------
if (@effectiveDate is null)
begin --4
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, vUCS.DateCreated as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join vwUserCourseStatus vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end --/4
else
begin --5

----------------------------------------------------
--- Report on the historic date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, vUCS.DateCreated as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end  --/5
end --/2
else
begin --3
----------------------------------------------------
--- Report on specified units
----------------------------------------------------
if (@effectiveDate is null)
Begin --6
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, vUCS.DateCreated as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit on
		tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join vwUserCourseStatus vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join dbo.udfCsvToInt(@unitIDs) tU
		on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end  --/6
else
Begin  --7
----------------------------------------------------
--- Report on the historic date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, vUCS.DateCreated as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join dbo.udfCsvToInt(@unitIDs) tU
		on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
End  --/7
end --/3
return
end -- /1


' 
END

GO








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_EmailReportUserSearch]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
The e-mail report allows an administrator to e-mail users
who have failed or not completed their quizzes.
It can also email administrators notifying them of
users that they are responsible for who have failed or not
completed their quizzes.

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
CREATE        Proc [prcReport_EmailReportUserSearch]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
)
AS
------------------------------------------
	Set Nocount On
	DECLARE @quizDateFromOrg 		datetime
	DECLARE @quizDateToOrg 		datetime
	SET @quizDateFromOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateFrom,@OrganisationID)
	SET @quizDateToOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateTo,@OrganisationID)
	
	
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(A.courseid AS varchar(10)) userid
		FROM
			(SELECT
				A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
				D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
				FROM
					(SELECT
						A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
						FROM
							tblUserCourseStatus A, @CoursesWithAccess B
						WHERE
							A.DateCreated < DATEADD(DD, 1, @quizDateToOrg)
							and A.CourseID = B.CourseID
						GROUP BY
							A.UserID, A.CourseID
					) A, @Users B, tblUserCourseStatus C, tblUser D
				WHERE
					A.UserID = B.UserID
					AND B.UserID = C.UserID
					AND A.LatestCourseStatus = C.UserCourseStatusID
					AND (C.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)
					AND C.CourseStatusID = case @courseModuleStatus
												when @CONST_COMPLETE then 2   -- Complete
												when @CONST_INCOMPLETE then 1 -- InComplete
											end
					AND A.UserID = D.UserID
			) A
			LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
				AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
		WHERE
			--If classification is Any (0), This will find users of any Custom Classification
			(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
			AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		SELECT
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM 
				(select
					distinct userid, moduleid
					from
						@UsersQuizStatusNOTSTARTED
				) A, tblUser B, tblModule D, tblUnitHierarchy C
			WHERE 
				A.UserID = B.UserID
				AND B.UnitID = C.UnitID
				AND A.ModuleID = D.ModuleID
				AND D.Active = 1
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM
				(SELECT
					DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, 
			dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived,
					courseid
					FROM 
						(SELECT
							DISTINCT userid, moduleid
							FROM
								@UsersQuizStatusNOTSTARTED
						) A, tblUser B, tblModule D
					WHERE 
						A.UserID = B.UserID
						AND A.ModuleID = D.ModuleID
						AND D.Active = 1
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				@classificationID =0 OR tblUserClassification.classificationID = @classificationID

	end --/ Not started - Any
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportDistinctUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_EmailReportDistinctUsers]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportDistinctUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Used to build the CC list on step 2 of the report

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
CREATE        Proc [prcReport_EmailReportDistinctUsers]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
)
AS
------------------------------------------
	Set Nocount On

	DECLARE @quizDateFromOrg 		datetime
	DECLARE @quizDateToOrg 		datetime
	SET @quizDateFromOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateFrom,@OrganisationID)
	SET @quizDateToOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateTo,@OrganisationID)




	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		SELECT 
			DISTINCT A.UserID, F.HierarchyName, A.FirstName, A.LastName, A.DateCreated, A.DAteArchived
		FROM
			(SELECT
				A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
				D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
				FROM
					(SELECT
						A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
						FROM
							tblUserCourseStatus A, @CoursesWithAccess B
						WHERE
							A.DateCreated < DATEADD(DD, 1, @quizDateToOrg)
							and A.CourseID = B.CourseID
						GROUP BY
							A.UserID, A.CourseID
					) A, @Users B, tblUserCourseStatus C, tblUser D
				WHERE
					A.UserID = B.UserID
					AND B.UserID = C.UserID
					AND A.LatestCourseStatus = C.UserCourseStatusID
					AND (C.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)
					AND C.CourseStatusID = case @courseModuleStatus
												when @CONST_COMPLETE then 2   -- Complete
												when @CONST_INCOMPLETE then 1 -- InComplete
											end
					AND A.UserID = D.UserID
			) A
			LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
				AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
		WHERE
			--If classification is Any (0), This will find users of any Custom Classification
			(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
			AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
		ORDER BY
			F.HierarchyName, A.LastName, A.FirstName
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		SELECT
			DISTINCT A.UserID, C.HierarchyName, B.FirstName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
			dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived
			FROM 
				(select
					distinct userid, moduleid
					from
						@UsersQuizStatusNOTSTARTED
				) A, tblUser B, tblModule D, tblUnitHierarchy C
			WHERE 
				A.UserID = B.UserID
				AND B.UnitID = C.UnitID
				AND A.ModuleID = D.ModuleID
				AND D.Active = 1
			ORDER BY
				C.HierarchyName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end, B.FirstName
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		SELECT 
			DISTINCT A.UserID, B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end as ''LastName'', 
			A.FirstName, 
			dbo.udfUTCtoDaylightSavingTime(A.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(A.DateArchived, @OrganisationID) as DateArchived
			FROM
				(SELECT
					DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, B.DateCreated, B.DateArchived, courseid
					FROM 
						(SELECT
							DISTINCT userid, moduleid
							FROM
								@UsersQuizStatusNOTSTARTED
						) A, tblUser B, tblModule D
					WHERE 
						A.UserID = B.UserID
						AND A.ModuleID = D.ModuleID
						AND D.Active = 1
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				@classificationID =0 OR tblUserClassification.classificationID = @classificationID
			ORDER BY
				B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end, A.FirstName

	end --/ Not started - Any
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportToAdministrators]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_EmailReportToAdministrators]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportToAdministrators]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
	Get a list of users that will appear in the administrtors email list

Returns:
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name

  order by AdminUserID,UserUnitID	

Called By: Email report
Calls:

Remarks:

Sending to Administrators	
If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the user''s Units.

If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.

Only one email will be sent to each administrator.

Within the body of the email for each administrator will be the list of users who are in the Units which they administer. (See Appendix A).  
The list will group the users into Units and have the Unit name as the heading for each group.


	
Author:Jack Liu
Date Created: 27 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

prcReport_EmailReportToAdministrators 3, ''42,48,11''

select * from tbluser where userID = 42

--------------------

**/

CREATE Proc [prcReport_EmailReportToAdministrators]
(
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
)

AS

Set Nocount On

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, A.UnitID
			FROM
				(SELECT
					A.UserID, D.UnitID
					FROM
						(SELECT
							A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
							FROM
								tblUserCourseStatus A, @CoursesWithAccess B
							WHERE
								A.DateCreated < DATEADD(DD, 1, @quizDateTo)
								and A.CourseID = B.CourseID
							GROUP BY
								A.UserID, A.CourseID
						) A, @Users B, tblUserCourseStatus C, tblUser D
					WHERE
						A.UserID = B.UserID
						AND B.UserID = C.UserID
						AND A.LatestCourseStatus = C.UserCourseStatusID
						AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
						AND C.CourseStatusID = case @courseModuleStatus
													when @CONST_COMPLETE then 2   -- Complete
													when @CONST_INCOMPLETE then 1 -- InComplete
													end
						AND A.UserID = D.UserID
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
				AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
			ORDER BY
				A.UserID, A.UnitID
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, UnitID
				FROM 
					(select
						distinct userid, moduleid
						from
							@UsersQuizStatusNOTSTARTED
					) A, tblUser B, tblModule D
				WHERE 
					A.UserID = B.UserID
					AND A.ModuleID = D.ModuleID
					AND D.Active = 1
				ORDER BY
					A.UserID, UnitID
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT 
				A.UserID, UnitID
				FROM
					(SELECT
						DISTINCT A.UserID, B.UnitID
						FROM 
							(SELECT
								DISTINCT userid, moduleid
								FROM
									@UsersQuizStatusNOTSTARTED
							) A, tblUser B, tblModule D
						WHERE 
							A.UserID = B.UserID
							AND A.ModuleID = D.ModuleID
							AND D.Active = 1
					) A
					LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
						AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				WHERE
					--If classification is Any (0), This will find users of any Custom Classification
					@classificationID =0 OR tblUserClassification.classificationID = @classificationID
				ORDER BY
					A.UserID, UnitID

	end --/ Not started - Any


insert into @tblUnit(UnitID)
select distinct UnitID
from @tblUserUnit

---If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the users Units.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, ua.UserID
from @tblUnit u
	inner join tblUnitAdministrator ua
		on ua.UnitID = u.UnitID
	inner join tblUser us
		on us.UserID = ua.UserID and us.UserTypeID = 3 --Unit Administrator

--If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, us.UserID
from tblUser us
	cross join @tblUnit u
where us.OrganisationID = @organisationID
	and us.UserTypeID = 2 -- Organisation Administrator
	and u.UnitID not in (select UnitID from @tblUnitAdministrator)
	and us.Active = 1


-- Tidy up the results
SELECT
	DISTINCT adminuserid userid, hierarchyname, lastname, firstname, datecreated, datearchived, NULL courseid
	FROM
		@tblunitadministrator a
		INNER JOIN tbluser u ON userid = a.adminuserid 
		INNER JOIN tblunithierarchy h ON h.unitid = u.unitid
	WHERE
		u.active = 1
	ORDER BY
		hierarchyname, adminuserid

' 
END
GO


IF NOT EXISTS( SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tblUser' 
		AND  COLUMN_NAME = 'EmailInOrgDomain')
BEGIN
	alter table tblUser add EmailInOrgDomain nvarchar(100) null
END

GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueueMessage]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_QueueMessage]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueueMessage]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcEmail_QueueMessage] 
	-- Add the parameters for the stored procedure here
           @organisationID int,
           @AddressTo nvarchar(255),
           @Subject nvarchar(255),
           @Body nvarchar(max),
           @AddressSender nvarchar(255),
           @AddressFrom nvarchar(255),
           @IsHTML bit,
           @AddressBccs nvarchar(max)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    DECLARE @TEMP datetime
    DECLARE @QueuedTime datetime
    SET @TEMP = DATEADD(YEAR,1,getUTCdate())
    SET @QueuedTime = getUTCdate()
INSERT INTO tblEmailQueue
           ([organisationID]
           ,[AddressTo]
           ,[Subject]
           ,[Body]
           ,[QueuedTime]
           ,[SendStarted]
           ,[AddressSender]
           ,[AddressFrom]
           ,[IsHTML]
           ,[AddressBccs])
     VALUES
           (@organisationID,
           @AddressTo,
           @Subject, 
           @Body,
           @QueuedTime, 
           @TEMP,
           @AddressSender, 
           @AddressFrom,
           @IsHTML,
           @AddressBccs)
           
           
           SELECT EmailQueueID from tblEmailQueue
           WHERE
				[organisationID] = @organisationID
				AND	[AddressTo] = @AddressTo
				AND [Subject]  = @Subject
				AND [Body] = @Body
				AND [QueuedTime] = @QueuedTime
				AND [SendStarted] = @TEMP
				AND [AddressSender] = @AddressSender
				AND [AddressFrom] = @AddressFrom
				AND [IsHTML] = @IsHTML
				AND [AddressBccs] = @AddressBccs
END				
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_EnableQueuedMessage]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_EnableQueuedMessage]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_EnableQueuedMessage]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcEmail_EnableQueuedMessage] 

@EmailQueueID bigint
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    UPDATE tblEmailQueue
	SET [SendStarted] = NULL
	WHERE EmailQueueID = @EmailQueueID
END				
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueuedMessageAttachments]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_QueuedMessageAttachments]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueuedMessageAttachments]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcEmail_QueuedMessageAttachments]

@EmailQueueID bigint,
@ContentID nvarchar(100),
@Content varbinary(max)
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;


INSERT INTO tblEmailQueueLinkedResource
([EmailQueueID]
,[ContentID]
,[ByteStream])
VALUES
(@EmailQueueID
,@ContentID
,@Content)
END
' 
END
GO








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetReportRequiredParameters]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_GetReportRequiredParameters]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF  NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetReportRequiredParameters]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcReport_GetReportRequiredParameters]
@ReportID int
AS
BEGIN
SELECT [ReportID]
,[ReportName]
,[RDLname]
,[RequiresParamCompleted]
,[RequiresParamStatus]
,[RequiresParamFailCount]
,[RequiresParamCourseIDs]
,[RequiresParamHistoricCourseIDs]
,[RequiresParamUnitIDs]
,[RequiresParamAllUnits]
,[RequiresParamTimeExpired]
,[RequiresParamTimeExpiredPeriod]
,[RequiresParamQuizStatus]
,[RequiresParamGroupBy]
,[RequiresParamGroupingOption]
,[RequiresParamFirstName]
,[RequiresParamLastName]
,[RequiresParamUserName]
,[RequiresParamEmail]
,[RequiresParamIncludeInactive]
,[RequiresParamSubject]
,[RequiresParamBody]
,[RequiresParamDateTo]
,[RequiresParamDateFrom]
,[RequiresParamProfileID]
,[RequiresParamProfilePeriodID]
,[RequiresParamOnlyUsersWithShortfall]
,[ParamLangInterfaceName]
,[RequiresParamEffectiveDate]
,[RequiresParamSortBy]
,[RequiresParamClassificationID]
,[RequiresParamServerURL]
,[RequiresParamToDate]
,[RequiresParamFromDate]
,[RequiresParamUserID]
,[RequiresParamAdminUserID]
,[RequiresParamOrganisationID]

FROM tblReportInterface
WHERE ReportID = @ReportID
end
' 
END
GO








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_NO_TRIGGER_Quick]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/* Summary:
Update lesson status for each user
This schedule task only updates three status:
Unassigned Modules (0)
New Assigned Modules (Not Started(1))
Expired Modules (Time Elapsed)(4)

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user lesson status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''''Not started''''.
If a module is unassigned from a user, the status will be ''''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''''unassinged''''

------------ Decision Processes -------------

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules

1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)

2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)

2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson date/frequency, the new status is Expired (Time Expired)(4)



------------ Data need to be recorded -------------

LessonFrequency
0  Unassigned:  		-
1  Not Started: 		Y
4  Expired (Time Elapsed): 	Y


Author: Jack Liu
Date Created: 21 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate

prcUserLessonStatus_Update

**/
create Procedure [prcUserLessonStatus_Update_NO_TRIGGER_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On



--##################################################################################################################
/*
2. Add New lesson status

2.1.     N O T      A S S I G N E D      M O D U L E S
(0) (PreviousAssignedModules - CurrentAssignedModules)
Add record of 0 (unassigned) to tblUserLessonStatus for each User-Module that has been started but now has no Course access or is specifically excluded at unit/user level
*/
--##################################################################################################################
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID
)
select pam.UserID,
pam.ModuleID,
0  as QuizStatusID --Unassigned (0)
from  (
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  tblUser inner join dbo.tblUserLessonStatus AS LessonStatus on tbluser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID INNER JOIN
					   dbo.tblModule AS m ON m.ModuleID = LessonStatus.ModuleID INNER JOIN
						   (SELECT MAX(UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus
							GROUP BY UserID, ModuleID) AS currentStatus ON LessonStatus.UserLessonStatusID = currentStatus.UserLessonStatusID
		WHERE ((LessonStatus.Excluded = 0) or (LessonStatus.Excluded is null)) AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
) pam   --   PREVIOUS ASSIGNED MODULES
 

left join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam -- Current Assigned Modules
               
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)



--##################################################################################################################
/*
2.2.      N E W     A S S I G N E D     M O D U L E S
(Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)
*/
--##################################################################################################################


insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
1  as LessonStatusID,--Not Started(1)
cam.LessonFrequency, 
cam.LessonCompletionDate
from 
(
		SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
		FROM  dbo.tblUser AS tU INNER JOIN
		tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)
 ) cam 
left join 
(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  tblUser inner join dbo.tblUserLessonStatus AS LessonStatus on tbluser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID INNER JOIN
					   dbo.tblModule AS m ON m.ModuleID = LessonStatus.ModuleID INNER JOIN
						   (SELECT MAX(UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus
							GROUP BY UserID, ModuleID) AS currentStatus ON LessonStatus.UserLessonStatusID = currentStatus.UserLessonStatusID
		WHERE ((LessonStatus.Excluded = 0) or (LessonStatus.Excluded is null)) AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where pam.moduleID is null



--##################################################################################################################
/*
2.3.       E X P I R E D    M O D U L E S
 (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson frequency, the new status is Expired (Time Expired)(4)
*/
--##################################################################################################################




insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as LessonStatusID, --(Time Elapsed)(4)
cam.LessonFrequency, cam.LessonCompletionDate
from (
	select 	max(LastStarted.UserLessonStatusID) LastStartedStatusID
	from tblUserLessonStatus LastStarted
	inner join 
	(
		SELECT LessonStatus.UserLessonStatusID, LessonStatus.UserID, LessonStatus.ModuleID, m.CourseID, LessonStatus.LessonStatusID, LessonStatus.LessonFrequency, 
					   LessonStatus.DateCreated
		FROM  dbo.tblUserLessonStatus AS LessonStatus INNER JOIN
					   dbo.tblModule AS m ON m.ModuleID = LessonStatus.ModuleID INNER JOIN
						   (SELECT MAX(UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus inner join tblUser on tblUser.UserID = tblUserLessonStatus.UserID and tblUser.OrganisationID = @OrgID 
							GROUP BY tblUserLessonStatus.UserID, ModuleID) AS currentStatus ON LessonStatus.UserLessonStatusID = currentStatus.UserLessonStatusID
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
	) CurrentStatus
	on  LastStarted.UserID = CurrentStatus.UserID
	and  LastStarted.ModuleID = CurrentStatus.ModuleID
	and CurrentStatus.LessonStatusID in (2,3)
	where LastStarted.LessonStatusID = 2
	and LastStarted.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
	group by LastStarted.UserID, LastStarted.moduleID
) lss
inner join tblUserLessonStatus uls
on uls.UserLessonStatusID = lss.LastStartedStatusID
inner join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblUnit AS u ON u.OrganisationID = tU.OrganisationID and u.UnitID = tU.UnitID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam
on cam.UserID = uls.UserID
and cam.ModuleID = uls.ModuleID
where
	(
		cam.LessonCompletionDate is null 
		and DateDiff(day,getutcdate(), dateadd(month, cam.LessonFrequency, uls.DateCreated)) <= 0
	)
	or 
	(
		isnull(DateDiff(day, getutcdate(), cam.LessonCompletionDate), 1) <= 0
	)
	and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
--Expired





--##################################################################################################################
-- Extend completion dates
	update tblOrganisation 
		set DefaultLessonCompletionDate = dateadd(year, 1, [DefaultLessonCompletionDate])
		where DefaultLessonCompletionDate < getutcdate() and OrganisationID = @OrgID

--##################################################################################################################
	update tblUnitRule
		set LessonCompletionDate = dateadd(year, 1, [LessonCompletionDate])
		where LessonCompletionDate < getutcdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
-- /Extend completion dates
--##################################################################################################################
	
	
	

SET QUOTED_IDENTIFIER ON
' 
END
GO









IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
DROP PROCEDURE [prcUserLessonStatus_Update_NO_TRIGGER]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
BEGIN
EXEC dbo.sp_executesql @statement = N'

create Procedure [prcUserLessonStatus_Update_NO_TRIGGER]
AS
Set Nocount On


declare @cursor_OrgID	    int

DECLARE OrgList CURSOR
FOR
SELECT OrganisationID from tblOrganisation order by OrganisationID desc

Open OrgList

FETCH NEXT FROM OrgList
Into
@cursor_OrgID

WHILE @@FETCH_STATUS = 0
BEGIN

exec prcUserLessonStatus_Update_NO_TRIGGER_Quick @cursor_OrgID

FETCH NEXT FROM OrgList Into @cursor_OrgID
END

CLOSE OrgList
DEALLOCATE OrgList


' 
END
GO

































IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcUserQuizStatus_Update_Quicker]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
DROP PROCEDURE [prcUserQuizStatus_Update_Quicker]
GO

















IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[prcUserQuizStatus_Update_New]') AND OBJECTPROPERTY(id,N'IsProcedure') = 1)
DROP PROCEDURE [prcUserQuizStatus_Update_New]
GO





SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblUserCurrentLessonStatus](
	[UserLessonStatusID] int NOT NULL,
	[UserID] [int] NOT NULL,
	[ModuleID] [int] NOT NULL,
	[LessonStatusID] [int] NOT NULL,
	[LessonFrequency] [int] NULL,
	[DateCreated] [datetime] NOT NULL,
	[LessonCompletionDate] [datetime] NULL,
	[Excluded] [bit] NULL,
 CONSTRAINT [PK_tblUserCurrentLessonStatus] PRIMARY KEY NONCLUSTERED 
(
	[UserLessonStatusID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
END
GO


IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]') AND name = N'IX_tblUserCurrentLessonStatus')
CREATE CLUSTERED INDEX [IX_tblUserCurrentLessonStatus] ON [tblUserCurrentLessonStatus] 
(
	[UserID] ASC,
	[ModuleID] ASC,
	[UserLessonStatusID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
GO

IF NOT EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblLessonStatus]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus]  WITH CHECK ADD  CONSTRAINT [FK_tblUserCurrentLessonStatus_tblLessonStatus] FOREIGN KEY([LessonStatusID])
REFERENCES [tblLessonStatus] ([LessonStatusID])
GO

IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblLessonStatus]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus] CHECK CONSTRAINT [FK_tblUserCurrentLessonStatus_tblLessonStatus]
GO

IF NOT EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblModule]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus]  WITH CHECK ADD  CONSTRAINT [FK_tblUserCurrentLessonStatus_tblModule] FOREIGN KEY([ModuleID])
REFERENCES [tblModule] ([ModuleID])
GO

IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblModule]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus] CHECK CONSTRAINT [FK_tblUserCurrentLessonStatus_tblModule]
GO

IF NOT EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblUser]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus]  WITH CHECK ADD  CONSTRAINT [FK_tblUserCurrentLessonStatus_tblUser] FOREIGN KEY([UserID])
REFERENCES [tblUser] ([UserID])
GO

IF  EXISTS (SELECT * FROM sys.foreign_keys WHERE object_id = OBJECT_ID(N'[FK_tblUserCurrentLessonStatus_tblUser]') AND parent_object_id = OBJECT_ID(N'[tblUserCurrentLessonStatus]'))
ALTER TABLE [tblUserCurrentLessonStatus] CHECK CONSTRAINT [FK_tblUserCurrentLessonStatus_tblUser]
GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCurrentLessonStatus_EffectiveDate]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCurrentLessonStatus] ADD  CONSTRAINT [DF_tblUserCurrentLessonStatus_EffectiveDate]  DEFAULT (getdate()) FOR [DateCreated]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCurrentLessonStatus_Excluded]') AND type = 'D')
BEGIN
ALTER TABLE [tblUserCurrentLessonStatus] ADD  CONSTRAINT [DF_tblUserCurrentLessonStatus_Excluded]  DEFAULT ((0)) FOR [Excluded]



INSERT INTO [dbo].[tblUserCurrentLessonStatus]
           ([UserLessonStatusID],
           [UserID]
           ,[ModuleID]
           ,[LessonStatusID]
           ,[LessonFrequency]
           ,[DateCreated]
           ,[LessonCompletionDate]
           ,[Excluded])
SELECT [UserLessonStatusID]
      ,[UserID]
      ,[ModuleID]
      ,[LessonStatusID]
      ,[LessonFrequency]
      ,[DateCreated]
      ,[LessonCompletionDate]
      ,[Excluded]
  FROM [dbo].[tblUserLessonStatus]
WHERE UserLessonStatusID IN(



SELECT MAX(UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus inner join tblUser on tblUser.UserID = tblUserLessonStatus.UserID 
							GROUP BY tblUserLessonStatus.UserID, ModuleID)

END

GO
							
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



/* Summary:
Update lesson status for each user
This schedule task only updates three status:
Unassigned Modules (0)
New Assigned Modules (Not Started(1))
Expired Modules (Time Elapsed)(4)

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user lesson status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''''Not started''''.
If a module is unassigned from a user, the status will be ''''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''''unassinged''''

------------ Decision Processes -------------

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules

1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)

2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)

2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson date/frequency, the new status is Expired (Time Expired)(4)



------------ Data need to be recorded -------------

LessonFrequency
0  Unassigned:  		-
1  Not Started: 		Y
4  Expired (Time Elapsed): 	Y


Author: Jack Liu
Date Created: 21 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate

prcUserLessonStatus_Update

**/
CREATE Procedure [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On



--##################################################################################################################
/*
2. Add New lesson status

2.1.     N O T      A S S I G N E D      M O D U L E S
(0) (PreviousAssignedModules - CurrentAssignedModules)
Add record of 0 (unassigned) to tblUserLessonStatus for each User-Module that has been started but now has no Course access or is specifically excluded at unit/user level
*/
--##################################################################################################################
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID
)
select pam.UserID,
pam.ModuleID,
0  as QuizStatusID --Unassigned (0)
from  

(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
 

left join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam -- Current Assigned Modules
               
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)



--##################################################################################################################
/*
2.2.      N E W     A S S I G N E D     M O D U L E S
(Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)
*/
--##################################################################################################################


insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
1  as LessonStatusID,--Not Started(1)
cam.LessonFrequency, 
cam.LessonCompletionDate
from 
(
		SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
		FROM  dbo.tblUser AS tU INNER JOIN
		tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)
 ) cam 
left join 
(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where pam.moduleID is null



--##################################################################################################################
/*
2.3.       E X P I R E D    M O D U L E S
 (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson frequency, the new status is Expired (Time Expired)(4)
*/
--##################################################################################################################




insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as LessonStatusID, --(Time Elapsed)(4)
cam.LessonFrequency, cam.LessonCompletionDate
from (
	select 	max(LastStarted.UserLessonStatusID) LastStartedStatusID
	from tblUserLessonStatus LastStarted
	inner join 
	(
		SELECT LessonStatus.UserLessonStatusID, LessonStatus.UserID, LessonStatus.ModuleID, m.CourseID, LessonStatus.LessonStatusID, LessonStatus.LessonFrequency, 
					   LessonStatus.DateCreated
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		inner join tblModule m on m.ModuleID = LessonStatus.ModuleID
							
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
	) CurrentStatus
	on  LastStarted.UserID = CurrentStatus.UserID
	and  LastStarted.ModuleID = CurrentStatus.ModuleID
	and CurrentStatus.LessonStatusID in (2,3)
	where LastStarted.LessonStatusID = 2
	and LastStarted.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
	group by LastStarted.UserID, LastStarted.moduleID
) lss
inner join tblUserLessonStatus uls
on uls.UserLessonStatusID = lss.LastStartedStatusID
inner join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblUnit AS u ON u.OrganisationID = tU.OrganisationID and u.UnitID = tU.UnitID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam
on cam.UserID = uls.UserID
and cam.ModuleID = uls.ModuleID
where
	(
		cam.LessonCompletionDate is null 
		and DateDiff(day,getdate(), dateadd(month, cam.LessonFrequency, uls.DateCreated)) <= 0
	)
	or 
	(
		isnull(DateDiff(day, getdate(), cam.LessonCompletionDate), 1) <= 0
	)
	and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
--Expired





--##################################################################################################################
-- Extend completion dates
	update tblOrganisation 
		set DefaultLessonCompletionDate = dateadd(year, 1, [DefaultLessonCompletionDate])
		where DefaultLessonCompletionDate < getdate() and OrganisationID = @OrgID

--##################################################################################################################
	update tblUnitRule
		set LessonCompletionDate = dateadd(year, 1, [LessonCompletionDate])
		where LessonCompletionDate < getdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
-- /Extend completion dates
--##################################################################################################################
	
	
	

SET QUOTED_IDENTIFIER ON 


' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE Procedure [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus]
AS
Set Nocount On


declare @cursor_OrgID	    int

DECLARE OrgList CURSOR
FOR
SELECT OrganisationID from tblOrganisation order by OrganisationID desc

Open OrgList

FETCH NEXT FROM OrgList
Into
@cursor_OrgID

WHILE @@FETCH_STATUS = 0
BEGIN

exec prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick @cursor_OrgID

FETCH NEXT FROM OrgList Into @cursor_OrgID
END

CLOSE OrgList
DEALLOCATE OrgList


' 
END
GO



				
				
				
				
IF  EXISTS (SELECT * FROM sys.triggers WHERE object_id = OBJECT_ID(N'[prc_tblUserLessonCurrentStatus_Update]'))
DROP TRIGGER [prc_tblUserLessonCurrentStatus_Update]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.triggers WHERE object_id = OBJECT_ID(N'[prc_tblUserLessonCurrentStatus_Update]'))
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE TRIGGER [prc_tblUserLessonCurrentStatus_Update]
   ON [tblUserLessonStatus]
   AFTER  INSERT,UPDATE
AS 
BEGIN
	SET NOCOUNT ON;
	--###################################################################
	--  I N S E R T S     A N D     U P D A T E S
	--###################################################################
	delete from tblUserCurrentLessonStatus  where UserLessonStatusID in
	(select C.UserLessonStatusID from tblUserCurrentLessonStatus C inner join inserted I on I.UserID = C.UserID and I.ModuleID = C.ModuleID)
INSERT INTO tblUserCurrentLessonStatus
           ([UserLessonStatusID],
           [UserID]
           ,[ModuleID]
           ,[LessonStatusID]
           ,[LessonFrequency]
           ,[DateCreated]
           ,[LessonCompletionDate]
           ,[Excluded])
SELECT [UserLessonStatusID]
      ,[UserID]
      ,[ModuleID]
      ,[LessonStatusID]
      ,[LessonFrequency]
      ,[DateCreated]
      ,[LessonCompletionDate]
      ,[Excluded]
  FROM [dbo].[tblUserLessonStatus]
WHERE UserLessonStatusID IN(



SELECT MAX(LS.UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus LS inner join
							inserted I on I.ModuleID = LS.ModuleID and i.UserID = LS.UserID
							group by LS.UserID, LS.ModuleID)

	--###################################################################
	--                         D E L E T E S 
	--###################################################################
 
	delete from tblUserCurrentLessonStatus  where UserLessonStatusID in
	(select C.UserLessonStatusID from tblUserCurrentLessonStatus C inner join deleted d on d.UserID = C.UserID and d.ModuleID = C.ModuleID)
INSERT INTO tblUserCurrentLessonStatus
           ([UserLessonStatusID],
           [UserID]
           ,[ModuleID]
           ,[LessonStatusID]
           ,[LessonFrequency]
           ,[DateCreated]
           ,[LessonCompletionDate]
           ,[Excluded])
SELECT [UserLessonStatusID]
      ,[UserID]
      ,[ModuleID]
      ,[LessonStatusID]
      ,[LessonFrequency]
      ,[DateCreated]
      ,[LessonCompletionDate]
      ,[Excluded]
  FROM [dbo].[tblUserLessonStatus]
WHERE UserLessonStatusID IN(



SELECT MAX(LS.UserLessonStatusID) AS UserLessonStatusID
							FROM   dbo.tblUserLessonStatus LS inner join
							deleted d on d.ModuleID = LS.ModuleID and d.UserID = LS.UserID
							group by LS.UserID, LS.ModuleID)

END
' 
GO


		
		
		


		
		
		
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_TRIGGER_CurrentStatus_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_TRIGGER_CurrentStatus_Quick]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

	
	
	
	


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prc_cpu_percent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prc_cpu_percent]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prc_cpu_percent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prc_cpu_percent]


AS
BEGIN

	DECLARE @CPU_percent int

	DECLARE @CPU_BUSY int, @IDLE int
	SELECT @CPU_BUSY = @@CPU_BUSY, @IDLE = @@IDLE WAITFOR DELAY ''000:00:01''
	SET @CPU_percent = (@@CPU_BUSY - @CPU_BUSY)/((@@IDLE - @IDLE + @@CPU_BUSY - @CPU_BUSY) *1.00) *100 


	RETURN @CPU_percent

END
' 
END
GO




IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblCounters]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblCounters](
	[OvernightJobCurrentOrg] [int] NULL
) ON [PRIMARY]
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOvernightJobGetNextPreprocessingOrg]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOvernightJobGetNextPreprocessingOrg]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOvernightJobGetNextPreprocessingOrg]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcOvernightJobGetNextPreprocessingOrg]

AS
BEGIN
	IF (0 = (SELECT COUNT(*) FROM tblCounters))
	begin
		DECLARE @Org INT
		SELECT @Org = OrganisationID  FROM tblOrganisation order by OrganisationID 
		INSERT tblCounters (OvernightJobCurrentOrg) VALUES (@Org )
	end
	DECLARE @MaxOrg INT
	SELECT @MaxOrg = OrganisationID  FROM tblOrganisation order by OrganisationID 
	DECLARE @LastOrg INT
	SELECT @LastOrg = COALESCE(OvernightJobCurrentOrg,1) FROM tblCounters
	IF (@LastOrg = @MaxOrg)
	BEGIN
		SELECT @Org = OrganisationID  FROM tblOrganisation order by OrganisationID DESC
		UPDATE tblCounters SET OvernightJobCurrentOrg = @Org 
	END
	ELSE
	BEGIN
		SELECT @Org = OrganisationID  FROM tblOrganisation WHERE OrganisationID > @LastOrg order by OrganisationID DESC 
		UPDATE tblCounters SET OvernightJobCurrentOrg = @Org 
	END

	SELECT @Org = COALESCE(OvernightJobCurrentOrg,1) FROM tblCounters
	SELECT @org
	RETURN @org
END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prc_cpu_percent]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prc_cpu_percent]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prc_cpu_percent]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prc_cpu_percent]


AS
BEGIN

	DECLARE @CPU_percent int

	DECLARE @CPU_BUSY int, @IDLE int
	SELECT @CPU_BUSY = @@CPU_BUSY, @IDLE = @@IDLE WAITFOR DELAY ''000:00:01''
	SET @CPU_percent = (@@CPU_BUSY - @CPU_BUSY)/((@@IDLE - @IDLE + @@CPU_BUSY - @CPU_BUSY) *1.00) *100 

	SELECT @CPU_percent
	RETURN @CPU_percent

END
' 
END
GO





SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOvernightJobPreprocessOneOrg]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

ALTER Procedure [prcOvernightJobPreprocessOneOrg]
AS
BEGIN


declare @cursor_OrgID	    int
-- get the next OrgID (prcOvernightJobGetNextPreprocessingOrg remembers the last OrgID to be preprocessed)
exec @cursor_OrgID = dbo.prcOvernightJobGetNextPreprocessingOrg	

-- update the UserLessonStatus for this org (handles the administrative changes to modules assigned to students) 
--(originally this appears to have been done by triggers but it appears that the triggers slowed the ASP.NET WebPage too much and were replaced by the overnight job)
exec prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick @cursor_OrgID



END' 
END




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_ActiveInactive]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_ActiveInactive]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_ActiveInactive]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Procedure [prcReport_ActiveInactive]
(
	@FromDate	datetime,
	@ToDate		datetime,
	@CourseIDs	varchar(8000),
	@OrganisationID int,
	@IncludeInactive int
)
AS

/******************************************************************************
**		File:
**		Name: dbo.prcReport_ActiveInactive
**		Desc:
**
**		This template can be customized:
**
**		Return values:
**
**		Called by:   Active INactive Users Report
**
**		Parameters:
**		Input							Output
**     ----------							-----------
**		Comma separated course id''s
**
**		Auth: Serguei Chkaroupine
**		Date: 5/01/2006
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		23/03/07	Yoppy Suwanto			Added a new colum Unit Pathway and sorted by it
**		21/07/09	Mark Donald				Order by LastName, FirstName
**		24/03/11	John Hedlefs			Timezone conversions
*******************************************************************************/

BEGIN

	SELECT distinct 
		tblUnitHierarchy.HierarchyName as UnitPathway,
		uma.[UserID],
		uma.[LastName],
		uma.[FirstName],
		CASE
			WHEN tblUser.Active <> 1 THEN ''(i)''
			ELSE ''''
		END as Flag
		,tblUser.[ExternalID]
		,tblUser.[Email]
		,tblUser.[UserName]
		,[CourseName]
		-- used to count inactive users (RS does not counts nulls)
		,CASE
			WHEN Active = 0 THEN 1
			ELSE NULL
		END as Active,
		dbo.udfUTCtoDaylightSavingTime(tblUser.DateCreated,@OrganisationID) as ''DateCreated'',
		dbo.udfUTCtoDaylightSavingTime(case when Active = 0 then coalesce(tblUser.DAteArchived,tblUser.DateUpdated) end,@OrganisationID) as ''DateArchived''
	FROM
	-- derived table UserModuleAccess
		(SELECT 
			tU.UserID, 
			tU.FirstName, 
			tU.LastName, 
			tU.UnitID, 
			tU.OrganisationID, 
			tM.ModuleID, 
			tM.CourseID, 
			tC.Name AS CourseName

		FROM         
			dbo.tblUser AS tU INNER JOIN
			dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
			dbo.tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
			dbo.tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
			dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
			dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID

		WHERE   
			(tU.UnitID IS NOT NULL) AND 
			(tUnitMA.DeniedModuleID IS NULL) AND 
			(tUsrMA.ModuleID IS NULL) OR 
			(tUsrMA.Granted = 1)
		)
		as uma -- end derived table UserModuleAccess
		LEFT JOIN tblUser on uma.UserID = tblUser.UserID
		LEFT JOIN tblUnitHierarchy on tblUnitHierarchy.UnitID = tblUser.UnitID

	WHERE 
		uma.OrganisationID = @OrganisationID
		AND CourseID in (SELECT * FROM dbo.udfCsvToInt(@CourseIDs))
		AND tblUser.DateCreated between dbo.udfDaylightSavingTimeToUTC(@FromDate,@OrganisationID) and dbo.udfDaylightSavingTimeToUTC(@ToDate,@OrganisationID)
		and tblUser.Active = (case when @includeinactive =0 then 1 else tbluser.active end )

	ORDER BY
		UnitPathway,
		uma.[LastName],
		uma.[FirstName]

	--Order By CourseName


END
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'/****** Object:  User Defined Function dbo.udfReport_HistoricAdminSummary    Script Date: 20/04/2004 8:25:58 AM ******/
/*Summary:
Get the Current or historic user module status  based on the search criteria
See the remarks below.
Returns: table
Called By: Current historic Admin Report
Calls:
Remarks:
1. Get User and course List based on search criteria
1.1 Get Unit List
1.1.1 If unit ids are passed in, convert the CSV format to a table
1.1.2 If no unit is selected, get a list of of all units that the admin user has permission to access
1.2 Get User list Based on the first name and last name in the search cirteria
1.3 Get Course list Based on the selected course in the search criteria and Used can select multiple Courses
2. Get the User Quiz and Lesson status up to the effective date
2.1 If there is no effective date is passed in, get the current module status
2.2 If there is effective date, get the module status up to the effective date
3.  Get a list of the user''s quiz and lesson historic status
Author: Jack Liu
Date Created: 1 Mar 2004
Modification History
-----------------------------------------------------------
v#	Author		Date				Description
#1.1	Usman Tjiudri	10/11/2005	Performance tuning:
- use temp-table to populate Unit Pathway
- join the temp-table to populate tblResult
instead of using udfGetUnitPathway function in the join.
#2.0	Serguei Chkaroupine 28/02/06 -New insert statement for histric admin report
- it will insert all lessons that match current quizmodule pair
- Current admin report performance fix. Added WHERE statement to
most of the insert statements.
#3	Mark Donald	27/07/2009			add userName and userEmail params
**		24/03/11	John Hedlefs			Timezone conversions

select * from dbo.udfReport_HistoricAdminSummary(3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',4)
--------------------
**/

ALTER             Function [udfReport_HistoricAdminSummaryOptimised]
(
	@organisationID 	Int,
	@unitIDs			Varchar(MAX),
	@courseIDs			Varchar(8000),
	@userFirstName		Varchar(50),
	@userLastName		Varchar(50),
	@userName			Varchar(100),
	@userEmail			Varchar(100),
	@effectiveDateOrg 		Datetime,
	@adminUserID		Int,
	@classificationID 	Int,
	@defaultDateOrg		DateTime,
	@inclInactive		int
)
Returns @tblResult Table
(
	-- General
	Unit			nVarchar(200),
	[User]			nVarchar(100),
	Course			nVarchar(100),
	Module			nVarchar(100),
	[Sequence]		Int,
	-- Quiz Specific
	QuizStatus		Varchar(50),
	QuizScore		Int,
	QuizStatusDate	Datetime,
	-- Lesson Specific
	LessonStatus	Varchar(50),
	-- Hidden
	UnitID			Int,
	UserID			Int,
	UserName		nVarchar(100),
	ExternalID		nVarchar(50),
	CourseID		Int,
	ModuleID		Int,
	Active	int
)
As Begin

	--Variables declarations
	DECLARE	@effectiveDate Datetime
	DECLARE	@defaultDate	DateTime
	DECLARE @UserTypeID 	INT
	DECLARE @tblUnit 				Table(UnitID INT PRIMARY KEY(UnitID))
	DECLARE @tblUser 				Table(UserID INT, UnitID INT, Active INT)
	DECLARE @tblCourse 				Table(CourseID INT, [Name] NVARCHAR(100) PRIMARY KEY(CourseID))
	DECLARE @CoursesWithAccess 		TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @UserModuleWithAccess 	TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules 			TABLE(ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @tblUserQuizStatus 		Table
									(
										[UserQuizStatusID] [int] Not Null,
										[UserID] [int] Not Null,
										[ModuleID] [int] Not Null,
										[QuizStatusID] [int] Not Null,
										[QuizScore] [int] Null,
										[DateCreated] [datetime] Not Null
									)
	DECLARE @tblUserLessonStatus 	Table
									(
										[UserLessonStatusID] [int] ,
										[UserID] [int] ,
										[ModuleID] [int] ,
										[LessonStatusID] [int] ,
										[DateCreated] [datetime]
									)
	DECLARE @vwUserModuleAccess table
	(
		UserID INT not null,
		FirstName varchar(255),
		LastName varchar(255),
		UnitID INT,
		OrganisationID INT,
		ModuleID INT,
		CourseID INT,
		CourseName nvarchar(100),
		[Name] nvarchar(100),
		Sequence INT,
		Description nvarchar(1000)
	)

	DECLARE @tblOrganisationCourseAccess table
	(
		OrganisationID int,
		GrantedCourseID int
	)
	
	--**************************************************************************************
	--****************************  change report params from ORG timezone to UTC **********
	set	@effectiveDate = dbo.udfDaylightSavingTimeToUTC(@effectiveDateOrg,@OrganisationID)
	set	@defaultDate = dbo.udfDaylightSavingTimeToUTC(@defaultDate,@OrganisationID)
	--**************************************************************************************
	
	
	---------------------------------------------------------------------------------------------

	--set the default date depending on effective date
	set @defaultdate = coalesce (@effectivedate,@defaultdate)
	---------------------------------------------------------------------------------------------

	--Check If Unit ID is specified
	IF @unitIDs IS NULL
		BEGIN
			--Check User Type
			SELECT 
				@UserTypeID = UserTypeID
			FROM
				tblUser
			WHERE UserID = @adminUserID

			--Get all units in Organisation if user is Salt Admin(1) or Org admin (2)
			IF (@UserTypeID = 1 Or @UserTypeID = 2)
			BEGIN
				INSERT INTO 
					@tblUnit (UnitID)
					SELECT 
						UnitID
					FROM 
						tblUnit
					WHERE OrganisationID = @OrganisationID
			END

			--Get units that the user is admministrator if user is Unit Admin(3)
			IF (@UserTypeID = 3)
			BEGIN
				INSERT INTO 
					@tblUnit (UnitID)
					SELECT 
						U.UnitID
					FROM 
						tblUnit U INNER JOIN tblUnitAdministrator UA ON 
							UA.UnitID = U.UnitID AND 
							UA.UserID = @adminUserID
						WHERE 
							U.OrganisationID = @OrganisationID
			END
		END
	ELSE
		BEGIN
			--Seperate comma seperated values as Table rows
			INSERT INTO @tblUnit SELECT * FROM  dbo.udfCsvToInt(@unitIDs)
		END
	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	--FirstName, Last Name, etc specified in search criteria
	IF (@userFirstName IS NULL) 	SET @userFirstName = ''''
	IF (@userLastName IS NULL) 		SET @userLastName = ''''
	IF (@userName IS NULL) 			SET @userName = ''''
	IF (@userEmail IS NULL) 		SET @userEmail = ''''

	INSERT INTO 
		@tblUser (UserID, UnitID, Active)
		SELECT DISTINCT	
			U.UserID, U.UnitID, U.Active
		FROM 
			tblUser U INNER JOIN @tblUnit UN ON	U.UnitID = UN.UnitID 
				and datediff(day,U.datecreated,@defaultdate)>=0-- created on or b4 specified date
			LEFT JOIN tblUserClassification UC ON UC.UserID  = U.UserID
		WHERE 
			U.FirstName Like ''%'' + @userFirstName + ''%'' AND
			LastName Like ''%'' + @userLastName + ''%'' AND
			UserName Like ''%'' + @userName + ''%'' AND
			Email Like ''%'' + @userEmail + ''%'' AND
		 	--AND have the Custom Classification option
			--If classification is Any (0), This will find users of any Custom Classification
			((@classificationID = 0) OR (UC.classificationID = @classificationID)) AND
			--inclInactive = 0: do not include inactive user
			--inclInactive = 1: include inactive user
			(U.Active = CASE @inclInactive WHEN 0 THEN 1 ELSE U.Active END) AND
			(U.OrganisationID = @OrganisationID)
			
	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	-- Search criteria contains Course ID''s
	INSERT INTO 
		@tblCourse (CourseID, [Name])
		SELECT 
			C.CourseID, C.[Name]
		FROM 
			dbo.udfCsvToInt(@courseIDs) CA INNER JOIN tblCourse C ON 
				CA.intValue = C.CourseID AND C.Active = 1
	
	-- added to deal with past courses - adds past course to intermediate @tblOrganisationCourseAccess table
	-- to mimic it being a current course so results will be returned
	insert into 
		@tblOrganisationCourseAccess (OrganisationID, GrantedCourseID)
		select
			@Organisationid, C.CourseID
		from
			dbo.udfCsvToInt(@courseIDs) CA inner join tblCourse C on
				CA.intValue = C.CourseID and C.Active = 1

	INSERT INTO @vwUserModuleAccess   SELECT   tU.UserID, tU.FirstName, tU.LastName, tU.UnitID, tU.OrganisationID, tM.ModuleID, tM.CourseID, tC.Name AS CourseName, tM.Name, tM.Sequence, 
	                      tM.Description 
	FROM         tblUser AS tU INNER JOIN
						  @tblUser tbU on tbU.UserID = tU.UserID
						  inner join	
	                      @tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
	                      tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
	                      tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
	                      tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
	                      tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID
	WHERE     tM.CourseID in (SELECT courseid from @tblCourse ) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
	                      (tUsrMA.Granted = 1)
	--select * from @vwUserModuleAccess where UnitID is null 

	INSERT INTO @UserModuleWithAccess
	SELECT DISTINCT UserID, ModuleID, UnitID FROM @vwUserModuleAccess where UnitID is not null   

	INSERT INTO @tblUserQuizStatus
		(
			[UserQuizStatusID],
			[UserID],
			[ModuleID],
			[QuizStatusID],
			[QuizScore],
			[DateCreated]
		)
		SELECT
			A.[UserQuizStatusID],
			A.[UserID],
			A.[ModuleID],
			A.[QuizStatusID],
			A.[QuizScore],
			dbo.udfUTCtoDaylightSavingTime(A.[DateCreated],@OrganisationID)
		FROM
			(
				SELECT 
					A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
				FROM 
					@UserModuleWithAccess A, tblUserQuizStatus B 
				WHERE
					A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND B.QuizStatusID <> 0 
					--AND DateDiff(day, B.DateCreated, @effectiveDate)=0
				GROUP BY
					A.UserID, A.ModuleID
			) B, tblUserQuizStatus A, @tblUser C
		WHERE
			A.UserQuizStatusID = B.LatestQuizID AND B.UserID = C.UserID AND A.UserID = C.UserID
-- li June 2008:		
-- User who has access to a module but doesn''t have a record in tblUserQuizStatus is a new user 
-- this logic will include new user in the current and historic admin report before user quiz status
-- is updated by overnight job

		INSERT INTO @tblUserQuizStatus
		(
			[UserQuizStatusID],
			[UserID],
			[ModuleID],
			[QuizStatusID],
			[QuizScore],
			[DateCreated]
		)
		SELECT
			0, -- UserQuizStatusID
			A.[UserID],
			A.[ModuleID],
			1, -- QuizStatus: Not Started
			null, -- QuizScore
			@defaultDateOrg -- DateCreated (here set to @defaultdate which is passed in as getDate())
		FROM @UserModuleWithAccess A
		join  @tblUser B on A.UserID = B.UserID
		-- User doesn''t have quiz activities
		where  A.UserID  + ''-'' + A.MODULEID NOT IN 
			(	Select D.UserID + ''-'' + D.Moduleid 
				from @tblUserQuizStatus D 
				where datediff(day, d.datecreated, @defaultdate)>=0)			 
-- end logic for including new user''s quiz status 

	Insert Into @tblUserLessonStatus
	(
		[UserLessonStatusID],
		[UserID],
		[ModuleID],
		[LessonStatusID],
		[DateCreated]
	)
	Select
		A.[UserLessonStatusID],
		A.[UserID],
		A.[ModuleID],
		A.[LessonStatusID],
		dbo.udfUTCtoDaylightSavingTime(A.[DateCreated],@OrganisationID)

	FROM
		(
			SELECT
				B.UserID, B.ModuleID, MAX(B.UserLessonStatusID) AS ''LatestLessonStatusID''
			FROM
				@UserModuleWithAccess A, tblUserLessonStatus B
			WHERE
				A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
				--DateDiff(day, B.DateCreated, @effectiveDate)>=0 AND
				B.LessonStatusID <> 0 --Unassigned
			GROUP BY
				B.UserID, B.ModuleID
		) B, tblUserLessonStatus A, @tblUser C
	WHERE
		A.UserLessonStatusID = B.LatestLessonStatusID AND B.UserID = C.UserID AND A.UserID = C.UserID

-- start logic for including new user''s lesson status
		INSERT INTO @tblUserLessonStatus
		(
			[UserLessonStatusID],
			[UserID],
			[ModuleID],
			[LessonStatusID],
			[DateCreated]
		)
		SELECT
			0, -- UserLessonStatusID
			A.[UserID],
			A.[ModuleID],
			1, -- LessonStatus: Not Started
			@defaultDateOrg -- DateCreated (here set to @defaultdate which is passed in as getDate())
		FROM @UserModuleWithAccess A
		join  @tblUser B on A.UserID = B.UserID
		where 
		-- User doesn''t have lesson activities for the date entered
		A.UserID + ''-'' + A.Moduleid NOT IN
		(	Select D.UserID + ''-'' + D.Moduleid  
			from @tblUserLessonStatus D 
			where datediff(day, d.datecreated, @defaultdate)>=0 )
-- end logic for including new user''s lesson status

	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	-- This part fixes migration issue (note this will affect historic admin report only as it does supply effective date)
	-- It will insert userid, moduleid and earliest lesson status for each quiz that does not have lesson record yet
	-- into @tblUserLessonStatus
	Insert Into @tblUserLessonStatus
	(
		[UserLessonStatusID],
		[UserID],
		[ModuleID],
		[LessonStatusID],
		[DateCreated]
	)
	SELECT 1,
		A.[UserID],
		A.[ModuleID],
		B.LessonStatusID,
		A.DateCreated
	FROM (
	SELECT 
		A.UserID, A.ModuleID, MIN(A.DateCreated) AS ''DateCreated''
	FROM
		tblUserLessonStatus A, @tblUser B 
	WHERE
		A.UserID = B.UserID
	GROUP BY
		A.UserID, A.ModuleID
	) A , tblUserLessonStatus B WHERE 

		A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND A.DateCreated = B.DateCreated AND
		(CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)))
	NOT IN (SELECT CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)) FROM @tblUserLessonStatus)


	---------------------------------------------------------------------------------------------
	---------------------------------------------------------------------------------------------
	Insert Into @tblResult
	(
		Unit,
		[User],
		Course,
		Module,
		[Sequence],
		QuizStatus,
		QuizStatusDate,	-- These columns have been reordered
		QuizScore,	    -- These columns have been reordered
		LessonStatus,
		UnitID,
		UserID,
		UserName,
		ExternalID,
		CourseID,
		ModuleID
	)
	Select distinct 
		-- General
		up.HierarchyName 				As Unit, -- Unit Name
		[User] = CASE u.Active when 0 then u.LastName + '' '' + u.FirstName + ''(i)'' ELSE u.LastName + '' '' + u.FirstName End , -- User Full Name
		c.Name			  				As Course, -- Course Name
		m.Name			  				As Module, -- Module Name
		m.Sequence						As Sequence,
		-- Quiz Specific
		qs.Status						As QuizStatus,
		dbo.udfUTCtoDaylightSavingTime(uqs.DateCreated,@OrganisationID) 			    as QuizStatusDate,	-- These columns have been reordered
		uqs.QuizScore 				    as QuizScore,		-- These columns have been reordered
		-- Lesson Specific
		ls.status 						As LessonStatus,
		-- Hidden
		u.UnitID						As UnitID,
		u.UserID						As UserID,
		u.UserName						As UserName,
		u.ExternalID						As ExternalID,
		c.CourseID						As CourseID,
		m.ModuleID						As ModuleID
		--u.Active						As Active
	From @tblUserQuizStatus uqs
		Inner Join tblQuizStatus qs On qs.QuizStatusID = uqs.QuizStatusID
		inner Join @tblUser us 	On us.UserID = uqs.UserID
		Inner Join tblUser u On u.UserID = us.UserID
		INNER Join tblUnitHierarchy up On up.UnitID = u.UnitID
		INNER Join tblModule m On m.ModuleID = uqs.ModuleID
		INNER Join @tblCourse c On c.CourseID = m.CourseID
		INNER Join @tblUserLessonStatus uls On uls.UserID = u.UserID And uls.ModuleID = m.ModuleID
		INNER Join tblLessonStatus ls On ls.LessonStatusID = uls.LessonStatusID
	where @effectivedate is null or (datediff(day,uqs.datecreated,@effectivedate)>=0 and datediff(day, uls.datecreated, @effectivedate)>=0)
	RETURN
END





' 
END








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_AdminSummaryReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	This will show the Current or historic Admin Report

	See the remarks below.

Returns:
		
Called By: Current Admin Report
Calls:

Remarks:

	1. Get the Current or historic user module status  based on the search criteria

	2.  Group and sort the result
	2.1    Group by Unit_User
		 Columns output:	
			Unit,
			[User],
			Course,
			Module,
			QuizStatus,
			QuizScore,
			QuizStatusDate,
			LessonStatus
	
	2.2    Group by Course
		 Columns output:	
			Course,
			Module,
			Unit,
			[User],
			QuizStatus,
			QuizScore,
			QuizStatusDate,
			LessonStatus
	
		then sorted by, either: 
		   QuizScore
		   Last Name
		   QuizStatusDate	
			

Author: Jack Liu
Date Created: 1 Mar 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Mark Donald	27/07/2009		add userName and userEmail params
#2  J hedlefs   09/06/2011      timezone


prcReport_AdminSummaryReport 3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',''Unit_User'','''',4
prcReport_AdminSummaryReport 3, '''', ''1,2,3,4'','''','''',NULL,NULL,null,''Course'',''QuizDate'',4

--------------------

**/

ALTER      procedure [prcReport_AdminSummaryReport]
(
@organisationID 	int,
@unitIDs		Varchar(MAX),
@courseIDs		Varchar(8000),
@userFirstName		nVarchar(50),
@userLastName		nVarchar(50),
@userName			nVarchar(100),
@userEmail			nVarchar(100),
@effectiveDateOrg 		datetime,
@groupBy		nVarchar(50),
@sortBy			nVarchar(50),
@adminUserID		int,
@classificationID 	int,
@inclInactive	int -- Flag for including inactive user or not
					--@inclInactive = 0: do not include inactive users
					--@inclInactive = 1: include inactive users
)
As
set nocount on
/*
1. Get the Current or historic user module status  based on the search criteria
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus,
UnitID,
UserID,
CourseID,
ModuleID
*/

DECLARE @defaultDate DATETIME
SET @defaultDate = getUTCdate()

if  not ( @sortBy  = ''QUIZ_SCORE'' or @sortBy  = ''QUIZ_DATE'' or @sortBy  = ''LAST_NAME'')
Begin
-- sort order is not QUIZ_SCORE, QUIZ_DATE or LAST_NAME
set @sortBy = ''LAST_NAME''
End
Declare @tblResult TABLE
(
-- General
Unit		nVarchar(200),
[User]		nVarchar(100),
Course		nVarchar(100),
Module		nVarchar(100),
[Sequence]  Int,
-- Quiz Specific
QuizStatus	nvarchar(50),
QuizScore	Int,
QuizStatusDate	DateTime,
-- Lesson Specific
LessonStatus	nvarchar(50),
-- Hidden
UnitID		Int,
UserID		Int,
UserName	nvarchar(100),
ExternalID	nvarchar(50),
CourseID	Int,
ModuleID	Int,
Active		Int,
ClassificationName nvarchar(50),  -- This may need to be changed when multiple classifications become needed.
ClassificationValue nvarchar(50)
)
Insert Into
@tblResult
select
Results.*,
tblClassificationType.Name,
tblClassification.Value
from
-- ***************************** Timezone conversion is done in the UDF **********************************************
dbo.udfReport_HistoricAdminSummaryOptimised(@organisationID,@unitIDs,@courseIDs,@userFirstName,@userLastName,@userName,@userEmail,@effectiveDateOrg,@adminUserID,@classificationID,@defaultDate,@inclInactive)
-- *******************************************************************************************************************
as Results
left join
tblUserClassification on tblUserClassification.UserID = Results.UserID
left join
tblClassification on tblClassification.ClassificationID = tblUserClassification.ClassificationID
left join
tblClassificationType on tblClassification.ClassificationTypeID = tblClassificationType.ClassificationTypeID
/*
2.  Group and sort the result
2.1    Group by Unit/User
Columns output:
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus
*/
if (@groupBy = ''Unit_User'')
begin
select
Unit,
[User],
Course,
Module,
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus,
UnitID,
UserID,
UserName,
ExternalID,
CourseID,
ModuleID,
Active,
ClassificationName,
ClassificationValue
from @tblResult
order by Unit, UnitID, [User], userID,  Course, CourseID, [Sequence]
end
/*
2.2    Group by Course
Columns output:
Course,
Module,
Unit,
[User],
QuizStatus,
QuizScore,
QuizStatusDate,
LessonStatus
then sorted by, either:
QuizScore
Last Name
QuizStatusDate
*/
else -- (@groupBy = ''Course'')
begin
if (@sortBy = ''QUIZ_SCORE'')
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, QuizScore desc,[user]
end
else if (@sortBy = ''QUIZ_DATE'')
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, QuizStatusDate desc,[user]
end
else -- order by ''LAST_NAME''
begin
select
*
from @tblResult
order by Course, CourseID, [Sequence], Unit, UnitID, [user]
end
end


' 
END





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_AtRisk]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		File: 
**		Name: prcReport_AtRisk
**		Desc: Returns a list of users who have failed a quiz the specified
**				of times.
**
**		Auth: Mark Donald
**		Date: 23 Dec 2009
**
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**      09/06/2011	j hedlefs			timezone
*******************************************************************************/


ALTER       Procedure [prcReport_AtRisk]
(
	@organisationID int,
	@unitIDs varchar(8000),
	@courseIDs varchar(8000),
	@failCounter int,
	@dateFrom datetime,
	@dateTo datetime,
	@classificationID int
)
AS
	SET NOCOUNT ON

	DECLARE @Units TABLE (UnitID INT PRIMARY KEY(UnitID))
	DECLARE @Courses TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))

	INSERT INTO @Courses SELECT * FROM dbo.udfCsvToInt(@courseIDs)
	INSERT INTO @Units SELECT * FROM  dbo.udfCsvToInt(@unitIDs)

	--Get All the users for all specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD 
			FROM 
				tblUser A 
				JOIN @Units B ON A.UnitID = B.UnitID
				JOIN tblUnit C ON B.UnitID = C.UnitID AND C.Active = 1
				LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
			WHERE
				A.Active = 1
				AND ((@classificationID =0) OR (classificationID = @classificationID))
				--If classification is Any (0), This will find users of any Custom Classification

	BEGIN
		SELECT
			s.userid, s.moduleid, hierarchyname as unitpathway, lastname, firstname, externalid, email, username, c.[name] as coursename, m.[name] as modulename, failnumber, [status] as currentstatus
			FROM
				(SELECT
					q.userid, moduleid,
					sum(CASE quizstatusid WHEN 3 THEN 1 ELSE 0 END) AS failnumber,
					max(userquizstatusid) AS currentstatusid
					FROM
						tbluserquizstatus q, tbluser u
					WHERE
						q.userid = u.userid
						AND organisationid = @organisationID
						AND q.datecreated BETWEEN dbo.udfDaylightSavingTimeToUTC(@dateFrom,@OrganisationID) AND dateadd(dd, 1, dbo.udfDaylightSavingTimeToUTC(@dateTo,@OrganisationID))
					GROUP BY
						q.userid, moduleid
					HAVING
						sum(CASE quizstatusid WHEN 3 THEN 1 ELSE 0 END) >= @failCounter) s
				LEFT JOIN tblusermoduleaccess a ON
					a.userid = s.userid AND a.moduleid = s.moduleid
				JOIN tbluser u ON
					u.userid = s.userid
				LEFT JOIN tblunitmoduleaccess n ON
					n.unitid = u.unitid AND s.moduleid = deniedmoduleid,
				tbluserquizstatus uq,
				@Users x,
				@Courses w,
				tblmodule m,
				tblcourse c,
				tblquizstatus q,
				tblunithierarchy h
			WHERE
				(
					(deniedmoduleid IS NULL AND a.moduleid IS NULL)
					OR a.granted = 1
				)
				AND uq.userquizstatusid = s.currentstatusid
				AND x.userid = s.userid
				AND m.moduleid = s.moduleid
				AND c.courseid = m.courseid
				AND w.courseid = m.courseid
				AND q.quizstatusid = uq.quizstatusid
				AND h.unitid = u.unitid
			ORDER BY 
				unitpathway, lastname, firstname
	END

' 
END



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_AtRiskGrandTotal]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		File: 
**		Name: prcReport_AtRisk
**		Desc: Returns a list of users who have failed a quiz the specified
**				of times.
**
**		Auth: Mark Donald
**		Date: 23 Dec 2009
**
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**    09/06/2011	j hedlefs			timezone
*******************************************************************************/


ALTER       Procedure [prcReport_AtRiskGrandTotal]
(
	@organisationID int,
	@unitIDs varchar(8000),
	@courseIDs varchar(8000),
	@failCounter int,
	@dateFrom datetime,
	@dateTo datetime,
	@classificationID int
)
AS
	SET NOCOUNT ON

	DECLARE @Units TABLE (UnitID INT PRIMARY KEY(UnitID))
	DECLARE @Courses TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))

	INSERT INTO @Courses SELECT * FROM dbo.udfCsvToInt(@courseIDs)
	INSERT INTO @Units SELECT * FROM  dbo.udfCsvToInt(@unitIDs)

	--Get All the users for all specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD 
			FROM 
				tblUser A 
				JOIN @Units B ON A.UnitID = B.UnitID
				JOIN tblUnit C ON B.UnitID = C.UnitID AND C.Active = 1
				LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
			WHERE
				A.Active = 1
				AND ((@classificationID =0) OR (classificationID = @classificationID))
				--If classification is Any (0), This will find users of any Custom Classification

	BEGIN
		SELECT
			count(DISTINCT s.userid) AS TotalDistinctUsers
			FROM
				(SELECT
					q.userid, moduleid,
					sum(CASE quizstatusid WHEN 3 THEN 1 ELSE 0 END) AS failnumber,
					max(userquizstatusid) AS currentstatusid
					FROM
						tbluserquizstatus q, tbluser u
					WHERE
						q.userid = u.userid
						AND organisationid = @organisationID
						AND q.datecreated BETWEEN dbo.udfDaylightSavingTimeToUTC(@dateFrom,@OrganisationID) AND dateadd(dd, 1, dbo.udfDaylightSavingTimeToUTC(@dateTo,@OrganisationID))
					GROUP BY
						q.userid, moduleid
					HAVING
						sum(CASE quizstatusid WHEN 3 THEN 1 ELSE 0 END) >= @failCounter) s
				LEFT JOIN tblusermoduleaccess a ON
					a.userid = s.userid AND a.moduleid = s.moduleid
				JOIN tbluser u ON
					u.userid = s.userid
				LEFT JOIN tblunitmoduleaccess n ON
					n.unitid = u.unitid AND s.moduleid = deniedmoduleid,
				tbluserquizstatus uq,
				@Users x,
				@Courses w,
				tblmodule m,
				tblcourse c,
				tblquizstatus q,
				tblunithierarchy h
			WHERE
				(
					(deniedmoduleid IS NULL AND a.moduleid IS NULL)
					OR a.granted = 1
				)
				AND uq.userquizstatusid = s.currentstatusid
				AND x.userid = s.userid
				AND m.moduleid = s.moduleid
				AND c.courseid = m.courseid
				AND w.courseid = m.courseid
				AND q.quizstatusid = uq.quizstatusid
				AND h.unitid = u.unitid

	END

' 
END








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_CompleteUsersLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'


/****** Object:  User Defined Function dbo.udfReport_CompleteUsersLogic    Script Date: 20/04/2004 8:25:58 AM ******/

/*Summary:
Selects User details for users that have not Completed their training

Parameters:
@organisationID Integer,
@unitIDs	string		(Mandatory)
@courseID	int		(Mandatory)
@effectiveDateOrg	datetime	(optional) (in Organisations Timezone)
Returns:


Called By:
prcReport_CompletedUsers

Calls:
fn dbo.udfGetUnitPathway( UnitID )
fn udfReport_incompleteUsers()
fn udfCsvToInt( csv )


Remarks:


Author: Stephen Kennedy-Clark
Date Created: 18 February 2004

Execution:


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	27/02/2004 		Change the "in" criteria to left join, this will improve performance
Fix the unit id bug
#2	Stephen Clark	1/4/2004		change the function to use the underlying table
#3	Peter Kneale	7/4/2004		Added function for effective date style reports
#4	Liz Dionisio(UW)	8/11/2005		Added Username, Email and ExternalID to returned recordset
#5	Yoppy Suwanto	22/08/2007		Replace the udfGetUnitPathway function with the tblUnitHierarchy usage.  This will improve perfomance
#5	j hedlefs		09/06/2011		Timezone
**/
ALTER   function [udfReport_CompleteUsersLogic]
(
@organisationID Integer,	-- Organisation of the user running the report
@unitIDs Varchar(MAX),		-- string of unit id''s
@courseID Int, 			-- course ID to restrict search to
@effectiveDateOrg datetime = null	-- effective date of report in Org timezone
)

-------------------------------------------------------------------
Returns @tblReturn Table
(
	UserID		Int,
	UnitID		Int,
	FirstName		nVarchar(255),
	LastName 	nVarchar(255),
	UnitPathway 	nVarchar(4000),
	[Date]		Datetime,
	Username	nvarchar(100),
	Email		nvarchar(100),
	ExternalID	nvarchar(50)
)

as
Begin --1
DECLARE @effectiveDate DateTime
SET @effectiveDate = dbo.udfDaylightSavingTimeToUTC(@effectiveDateOrg,@OrganisationID)

if (@unitIDs is null)
begin --2
----------------------------------------------------
--- Report on all units
----------------------------------------------------
if (@effectiveDate is null)
begin --4
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join vwUserCourseStatus vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end --/4
else
begin --5

----------------------------------------------------
--- Report on the historic date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end  --/5
end --/2
else
begin --3
----------------------------------------------------
--- Report on specified units
----------------------------------------------------
if (@effectiveDate is null)
Begin --6
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit on
		tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join vwUserCourseStatus vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join dbo.udfCsvToInt(@unitIDs) tU
		on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
end  --/6
else
Begin  --7
----------------------------------------------------
--- Report on the historic date
----------------------------------------------------
Insert into
@tblReturn
SELECT
	tU1.userID
	, tU1.UnitID
	, tU1.FirstName
	, tU1.LastName
	--, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
	, tUH.HierarchyName as ''UnitPathway''
	, dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
	, tU1.Username as ''Username''
	, tU1.Email as ''Email''
	, tU1.ExternalID as ''ExternalID''
FROM
	tblUser tU1
	inner join tblUnit
		on tU1.UnitID = tblUnit.UnitID
		and tblUnit.organisationID = @organisationID
		and tU1.Active = 1 --< only want active users >--
		and tu1.userTypeID <> 1 --< not interested in saltadmins >--
	inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
		on vUCS.UserID = tU1.userID
		and vUCS.CourseStatusID = 2 --< only want completed users >--
		and vUCS.CourseID = @courseID
	inner join dbo.udfCsvToInt(@unitIDs) tU
		on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
	inner join tblUnitHierarchy tUH
		on tU1.UnitID = tUH.UnitID
End  --/7
end --/3
return
end -- /1


' 
END





SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_IncompleteCourseLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'


/****** Object:  User Defined Function dbo.udfReport_IncompleteCourseLogic ******/
/*Summary:
Selects Users that have not Completed their training

Parameters:
@organisationID	int		(optional)
@unitIDs	string		(optional)
@courseID	int		(Mandatory)
@effectiveFromDate	datetime	(optional)
@effectiveToDate	datetime	(optional)
Returns:
Table

Called By:
dbo.prcReport_CourseStatusReport

Calls:
fn dbo.udfGetUnitPathway( UnitID )
fn udfCsvToInt( csv )
fn udfReport_HistoricUserCourseStatusWithinRange
Remarks:


Author: 
Date Created: 16 March 2006

Execution:


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	j hedlefs		09/06/2011		Timezone
**/

ALTER                function [udfReport_IncompleteCourseLogic]
(
@organisationID		Integer=null,		-- Organisation ID to search if the unit is empty
@unitIDs 		varchar(8000) = null,	-- string of unit id''s
@courseIDs		varchar(8000) = null,		-- course ID to restrict search to
@effectiveFromDateOrg 	datetime = null,	-- effective date of report From
@effectiveToDateOrg	datetime = null		-- effective date of report To
)

-------------------------------------------------------------------
Returns @tblReturn table
(
UserID		Int,
UnitID		Int,
FirstName		nvarchar(255),
LastName 	nvarchar(255),
UnitPathway 	nvarchar(4000),
Username		nvarchar(100),
Email		nvarchar(100),
ExternalID		nvarchar(50),
CourseName	nvarchar(200)
)

as
Begin --1
DECLARE @effectiveFromDate DateTime
SET @effectiveFromDate = dbo.udfDaylightSavingTimeToUTC(@effectiveFromDateOrg,@OrganisationID)
DECLARE @effectiveToDate DateTime
SET @effectiveToDate = dbo.udfDaylightSavingTimeToUTC(@effectiveToDateOrg,@OrganisationID)

if (@effectiveFromDate is null)
Begin
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
if (@unitIDs is null)
begin --2
----------------------------------------------------
--- Report on the current date on all units
----------------------------------------------------
Insert into
@tblReturn
SELECT
tU1.userID
, tU1.UnitID
, tU1.FirstName
, tU1.LastName
, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
, tU1.Username as ''Username''
, tU1.Email as ''Email''
, tU1.ExternalID as ''ExternalID''
, tC.Name as ''CourseName''
FROM
tblUser tU1
inner join tblUnit on
tU1.UnitID = tblUnit.UnitID
and tblUnit.organisationID = @organisationID
and tU1.Active = 1 --< only want active users >--
and tu1.userTypeID <> 1 --< not interested in saltadmins >--
inner join vwUserCourseStatus vUCS
on vUCS.UserID = tU1.userID
and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
inner join dbo.udfCsvToInt(@courseIDs) tR
on tR.IntValue = vUCS.CourseID
inner join dbo.tblCourse as tC
on tR.IntValue = tC.CourseID
end --/2
else
begin --3
----------------------------------------------------
--- Report on the current date on a specific unit
----------------------------------------------------
Insert into
@tblReturn
SELECT
tU1.userID
, tU1.UnitID
, tU1.FirstName
, tU1.LastName
, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
, tU1.Username as ''Username''
, tU1.Email as ''Email''
, tU1.ExternalID as ''ExternalID''
, tC.Name as ''CourseName''
FROM
tblUser tU1
inner join tblUnit on
tU1.UnitID = tblUnit.UnitID
and tblUnit.organisationID = @organisationID
and tU1.Active = 1 --< only want active users >--
and tu1.userTypeID <> 1 --< not interested in saltadmins >--
inner join vwUserCourseStatus vUCS
on vUCS.UserID = tU1.userID
and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
--and vUCS.CourseID = @courseID--
inner join dbo.udfCsvToInt(@courseIDs) tR
on tR.IntValue = vUCS.CourseID
inner join dbo.udfCsvToInt(@unitIDs) tU
on tU.IntValue = tblUnit.UnitID
inner join dbo.tblCourse as tC
on tR.IntValue = tC.CourseID --< restrict units to thoes in the list >--

end --/3
End

Else

Begin
----------------------------------------------------
--- Report on the historic date range provided
----------------------------------------------------
if (@unitIDs is null)
begin --2
----------------------------------------------------
--- Report on the historic date range provided for all units
----------------------------------------------------
Insert into
@tblReturn
SELECT
tU1.userID
, tU1.UnitID
, tU1.FirstName
, tU1.LastName
, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
, tU1.Username as ''Username''
, tU1.Email as ''Email''
, tU1.ExternalID as ''ExternalID''
, tC.Name as ''CourseName''
FROM
tblUser tU1
inner join tblUnit on
tU1.UnitID = tblUnit.UnitID
and tblUnit.organisationID = @organisationID
and tU1.Active = 1 --< only want active users >--
and tu1.userTypeID <> 1 --< not interested in saltadmins >--
inner join  dbo.udfReport_HistoricUserCourseStatusWithinRange(@effectiveFromDate, @effectiveToDate) vUCS
on vUCS.UserID = tU1.userID
and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
--and vUCS.CourseID = @courseID--
inner join dbo.udfCsvToInt(@courseIDs) tR
on tR.IntValue = vUCS.CourseID
inner join dbo.tblCourse as tC
on tR.IntValue = tC.CourseID

end --/2
else
begin --3
----------------------------------------------------------------
--- Report on the historic date range provided for the specified units
----------------------------------------------------------------
Insert into
@tblReturn
SELECT
tU1.userID
, tU1.UnitID
, tU1.FirstName
, tU1.LastName
, dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
, tU1.Username as ''Username''
, tU1.Email as ''Email''
, tU1.ExternalID as ''ExternalID''
, tC.Name as ''CourseName''
FROM
tblUser tU1
inner join tblUnit on
tU1.UnitID = tblUnit.UnitID
and tblUnit.organisationID = @organisationID
and tU1.Active = 1 --< only want active users >--
and tu1.userTypeID <> 1 --< not interested in saltadmins >--
inner join  dbo.udfReport_HistoricUserCourseStatusWithRange(@effectiveFromDate, @effectiveToDate) vUCS
on vUCS.UserID = tU1.userID
and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
--and vUCS.CourseID = @courseID--
inner join dbo.udfCsvToInt(@courseIDs) tR
on tR.IntValue = vUCS.CourseID
inner join dbo.tblCourse as tC
on tR.IntValue = tC.CourseID
inner join dbo.udfCsvToInt(@unitIDs) tU
on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--

end --/3
End
return
end -- /1














' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_CourseStatusGrandTotal]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		Name: prcReport_CourseStatusGrandTotal
**		Desc: a copy of prcreport_CourseStatusSearch, but with select statements
**				altered to return a total, instead of a list of data.
**
**		Return values: Grand Total distinct users in Course Status report
** 
**		Called by:   
**              
**		Parameters:
**		Input							Output
**     ----------							-----------
**
**		Auth: Mark Donald
**		Date: 27 Aug 2009
**
*******************************************************************************/

ALTER       Procedure [prcReport_CourseStatusGrandTotal]
(
	@organisationID		int,
	@unitIDs 		varchar(8000),
	@courseIDs 		varchar(8000),
	@courseModuleStatus	int,
	@dateFromOrg 		datetime,
	@dateToOrg 		datetime,
	@IncludeInactive int,
	@classificationID int
)
AS
	------------------------------------------
	Set Nocount On
	DECLARE @dateFrom 		datetime
	DECLARE @dateTo 		datetime
	SET @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFromOrg,@OrganisationID)
	SET @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateToOrg,@OrganisationID)
	Declare
		@CONST_INCOMPLETE     	int,
		@CONST_COMPLETE     	int,
		@CONST_FAILD            int,
		@CONST_NOTSTARTED 	    int,
		@CONST_EXPIRED_TIMELAPSED		int,
		@CONST_EXPIRED_NEWCONTENT		int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	= 1
	set @CONST_FAILD	= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED   = 4
	set @CONST_EXPIRED_NEWCONTENT	= 5

	DECLARE @Units TABLE
	(
		UnitID INT PRIMARY KEY(UnitID)
	)

	DECLARE @Courses TABLE
	(
		CourseID INT PRIMARY KEY(CourseID)
	)

	DECLARE @CoursesWithAccess 	TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @UserModuleWithAccess TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE(ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus
	TABLE
	(
		UserID	INT,
		ModuleID INT, 
		LatestQuizID INT, 
		QuizStatusID INT, 
		QuizScore INT
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	DECLARE @UsersQuizStatusNOTSTARTED
	TABLE
	(
		UserID	INT,
		ModuleID INT, 
		LatestQuizID INT, 
		QuizStatusID INT, 
		QuizScore INT
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO @Courses SELECT * FROM dbo.udfCsvToInt(@courseIDs)
	
	INSERT INTO @Units SELECT * FROM  dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO @CoursesWithAccess
	SELECT A.CourseID FROM @Courses A, tblOrganisationCourseAccess B, tblCourse C
	WHERE A.CourseID = B.GrantedCourseID AND B.OrganisationID = @organisationID AND
	A.CourseID = C.CourseID AND C.Active = 1

	--Get All the users for all specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
	SELECT 
		DISTINCT A.UserID, A.UnitiD 
	FROM 
		tblUser A 
		join @Units B on A.UnitID = B.UnitID
		join tblUnit C on B.UnitID = C.UnitID AND C.Active = 1
		LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
	WHERE
		A.Active = CASE @IncludeInactive WHEN 0 THEN 1 ELSE A.Active END
		AND ((@classificationID =0) OR (classificationID = @classificationID))
			--If classification is Any (0), This will find users of any Custom Classification



	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Courses
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question

		--Find the latest status of courses
		SELECT
			count(distinct A.UserID) AS TotalDistinctUsers
		FROM
		(
		SELECT
			A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
		FROM
			tblUserCourseStatus A, @CoursesWithAccess B
		WHERE
			A.DateCreated < DATEADD(DD, 1, @dateTo)
			and
			A.CourseID = B.CourseID
		GROUP BY
			A.UserID, A.CourseID
		) A, @Users B, tblUserCourseStatus C, tblUser D, tblCourse E, tblUnitHierarchy F
		WHERE
			A.UserID = B.UserID AND B.UserID = C.UserID AND 
			A.LatestCourseStatus = C.UserCourseStatusID AND
			(C.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo)) AND
			C.CourseStatusID = case @courseModuleStatus
						when @CONST_COMPLETE then 2   -- Complete
						when @CONST_INCOMPLETE then 1 -- InComplete
						end AND
			A.UserID = D.UserID AND A.CourseID = E.CourseID AND
			D.UnitID = F.UnitID

	end -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Courses
		--  - AND took a quiz, for a Module within the selected Course, within the date range of DateCreated in UserQuizStatus and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------

		--Find All Modules for all units with access

		INSERT INTO @UserModuleWithAccess
		SELECT DISTINCT A.UserID, A.ModuleID, A.UnitID FROM
		(
			SELECT A.UserID, A.ModuleID, A.UnitID
				FROM vwUserModuleAccess A where courseid in (SELECT courseid from @Courses) )A, @Users B
				Where A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO @UsersNQuizStatus
		SELECT DISTINCT
			A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
		FROM
			(
		SELECT 
			A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
		FROM 
			@UserModuleWithAccess A, tblUserQuizStatus B 
		WHERE
			A.UserID = B.UserID AND A.ModuleID = B.ModuleID
		GROUP BY
			A.UserID, A.ModuleID) A, tblUserQuizStatus B
		WHERE
			A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
			A.LatestQuizID = B.UserQuizStatusID AND
			(B.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo))

		INSERT INTO @UsersQuizStatusNOTSTARTED
		SELECT * FROM @UsersNQuizStatus WHERE QuizStatusID = case @courseModuleStatus
									when @CONST_FAILD then 3   -- Failed
									when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
									when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
									end

		--Get Data in report format
		SELECT
			count(distinct A.UserID) AS TotalDistinctUsers
		FROM 
			(select distinct userid, moduleid from @UsersQuizStatusNOTSTARTED) A, 
			tblUser B, tblCourse C, tblModule D, tblUnitHierarchy E
		WHERE 
			A.UserID = B.UserID AND B.Active = 1 AND
			A.ModuleID = D.ModuleID AND 
			B.UnitID = E.UnitID AND
			D.CourseID = C.CourseID AND C.Active = 1 AND D.Active = 1

	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Courses
		--  - AND who have not started ANY of the quizes they have access to in this course within the selected date range(DateCreated in vwUserQuizStatus)
		--------------------


		--Find All Modules for all units with access

		INSERT INTO @UserModuleWithAccess
		SELECT DISTINCT A.UserID, A.ModuleID, A.UnitID FROM
		(
			SELECT A.UserID, A.ModuleID, A.UnitID
				FROM vwUserModuleAccess A where courseid in (SELECT courseid from @Courses) )A, @Users B
				Where A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO @UsersNQuizStatus
		SELECT  DISTINCT
			A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
		FROM
			(
		SELECT 
			A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
		FROM 
			@UserModuleWithAccess A, tblUserQuizStatus B 
		WHERE
			A.UserID = B.UserID AND A.ModuleID = B.ModuleID
		GROUP BY
			A.UserID, A.ModuleID) A, tblUserQuizStatus B
		WHERE
			A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
			A.LatestQuizID = B.UserQuizStatusID AND
			(B.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo))


		--Get User with Quiz NOT STARTED
		INSERT INTO @UsersQuizStatusNOTSTARTED
		SELECT * FROM @UsersNQuizStatus WHERE QuizStatusID NOT IN (2,3,4,5) AND
		UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3,4,5))

		
		--Get Data in report format
		SELECT
			count(distinct A.UserID) AS TotalDistinctUsers
		FROM 
			(select distinct userid, moduleid from @UsersQuizStatusNOTSTARTED) A, 
			tblUser B, tblCourse C, tblModule D, tblUnitHierarchy E
		WHERE 
			A.UserID = B.UserID AND B.Active = 1 AND
			A.ModuleID = D.ModuleID AND B.UnitID = E.UnitID AND
			D.CourseID = C.CourseID AND C.Active = 1 AND D.Active = 1

	end --/ Not started - Any


' 
END








IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_CompleteCourseLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'


/****** Object:  User Defined Function dbo.udfReport_CompleteCourseLogic    Script Date: 16/03/2006******/

/*Summary:
Selects User details for users that have Completed their training

Parameters:
@organisationID Integer,
@unitIDs	string		(Mandatory)
@courseIDs	string		(Mandatory)
@effectiveFromDate	datetime	(optional)
@effectiveToDate	datetime	(optional)
Returns:


Called By:
prcReport_CourseStatusReport

Calls:
fn dbo.udfGetUnitPathway( UnitID )
fn udfReport_completeUsers()
fn udfCsvToInt( csv )


Remarks:


Author: 

Execution:


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
**/
ALTER function [udfReport_CompleteCourseLogic]
(
    @organisationID Integer,	-- Organisation of the user running the report
    @unitIDs Varchar(8000),		-- string of unit id''s
    @courseIDs varchar(8000), 			-- course IDs to restrict search to
    @effectiveFromDateOrg datetime = null,	-- effective date of report From
    @effectiveToDateOrg datetime = null	-- effective date of report To
)

-------------------------------------------------------------------
Returns @tblReturn Table
(
    UserID		Int,
    UnitID		Int,
    FirstName		nVarchar(255),
    LastName 	nVarchar(255),
    UnitPathway 	nVarchar(3000),
    [Date]		Datetime,
    Username		nvarchar(100),
    Email		nvarchar(100),
    ExternalID		nvarchar(50),
    CourseName	nvarchar(200)
)

as
Begin --1
	DECLARE @effectiveFromDate 		datetime
	DECLARE @effectiveToDate 		datetime
	SET @effectiveFromDate = dbo.udfDaylightSavingTimeToUTC(@effectiveFromDateOrg,@OrganisationID)
	SET @effectiveToDate = dbo.udfDaylightSavingTimeToUTC(@effectiveToDateOrg,@OrganisationID)

    if (@unitIDs is null)
    begin --2
----------------------------------------------------
--- Report on all units
----------------------------------------------------
        if (@effectiveFromDate is null)
        begin --4
----------------------------------------------------
--- Report on the current date
----------------------------------------------------
            Insert into
                @tblReturn
            SELECT
                tU1.userID
                , tU1.UnitID
                , tU1.FirstName
                , tU1.LastName
                , dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
                , dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
                , tU1.Username as ''Username''
				, tU1.Email as ''Email''
				, tU1.ExternalID as ''ExternalID''
				, tC.Name as ''CourseName''
            FROM
                tblUser tU1
                inner join tblUnit
                    on tU1.UnitID = tblUnit.UnitID
                        and tblUnit.organisationID = @organisationID
                        and tU1.Active = 1 --< only want active users >--
                        and tu1.userTypeID <> 1 --< not interested in saltadmins >--
                inner join vwUserCourseStatus vUCS
                    on vUCS.UserID = tU1.userID
                    and vUCS.CourseStatusID = 2 --< only want completed users >--
                    --and vUCS.CourseID in (SELECT * FROM dbo.udfCsvToInt(@courseIDs))--
                inner join dbo.udfCsvToInt(@courseIDs)tR
					on tR.IntValue = vUCS.CourseID
				inner join dbo.tblCourse tC
					on tR.IntValue = tC.CourseID
        end --/4
        else
        begin --5

----------------------------------------------------
--- Report on the historic date
----------------------------------------------------
            Insert into
                @tblReturn
            SELECT
                tU1.userID
                , tU1.UnitID
                , tU1.FirstName
                , tU1.LastName
                , dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
                , dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
                , tU1.Username as ''Username''
				, tU1.Email as ''Email''
				, tU1.ExternalID as ''ExternalID''
				, tC.Name as ''CourseName''
            FROM
                tblUser tU1
                inner join tblUnit
                    on tU1.UnitID = tblUnit.UnitID
                        and tblUnit.organisationID = @organisationID
                        and tU1.Active = 1 --< only want active users >--
                        and tu1.userTypeID <> 1 --< not interested in saltadmins >--
                inner join  dbo.udfReport_HistoricUserCourseStatusWithinRange(@effectiveFromDate, @effectiveToDate) vUCS
                    on vUCS.UserID = tU1.userID
                        and vUCS.CourseStatusID = 2 --< only want completed users >--
                        --and vUCS.CourseID in (SELECT * FROM dbo.udfCsvToInt(@courseIDs))--
                inner join dbo.udfCsvToInt(@courseIDs)tR
					on tR.IntValue = vUCS.CourseID
				inner join dbo.tblCourse tC
					on tR.IntValue = tC.CourseID
        end  --/5
    end --/2
    else
    begin --3
----------------------------------------------------
--- Report on specified units
----------------------------------------------------
        if (@effectiveFromDate is null)
        Begin --6
    ----------------------------------------------------
    --- Report on the current date
    ----------------------------------------------------
            Insert into
                @tblReturn
            SELECT
                tU1.userID
                , tU1.UnitID
                , tU1.FirstName
                , tU1.LastName
                , dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
                , dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
                , tU1.Username as ''Username''
				, tU1.Email as ''Email''
				, tU1.ExternalID as ''ExternalID''
				, tC.Name as ''CourseName''
            FROM
                tblUser tU1
                inner join tblUnit on
                    tU1.UnitID = tblUnit.UnitID
                    and tblUnit.organisationID = @organisationID
                    and tU1.Active = 1 --< only want active users >--
                    and tu1.userTypeID <> 1 --< not interested in saltadmins >--
                inner join vwUserCourseStatus vUCS
                    on vUCS.UserID = tU1.userID
                    and vUCS.CourseStatusID = 2 --< only want completed users >--
                    --and vUCS.CourseID in (SELECT * FROM dbo.udfCsvToInt(@courseIDs))--
                inner join dbo.udfCsvToInt(@courseIDs)tR
					on tR.IntValue = vUCS.CourseID
				inner join dbo.tblCourse as tC
					on tR.IntValue = tC.CourseID
                inner join dbo.udfCsvToInt(@unitIDs) tU
                    on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
        end  --/6
        else
		Begin  --7
    ----------------------------------------------------
    --- Report on the historic date
    ----------------------------------------------------
                Insert into
                    @tblReturn
                SELECT
                    tU1.userID
                    , tU1.UnitID
                    , tU1.FirstName
                    , tU1.LastName
                    , dbo.udfGetUnitPathway(tU1.UnitID) as ''UnitPathway''
                , dbo.udfUTCtoDaylightSavingTime(vUCS.DateCreated,@OrganisationID) as ''Date''
                    , tU1.Username as ''Username''
					, tU1.Email as ''Email''
					, tU1.ExternalID as ''ExternalID''
					, tC.Name as ''CourseName''
                FROM
                    tblUser tU1
                    inner join tblUnit 
                        on tU1.UnitID = tblUnit.UnitID
                            and tblUnit.organisationID = @organisationID
                            and tU1.Active = 1 --< only want active users >--
                            and tu1.userTypeID <> 1 --< not interested in saltadmins >--
                    inner join  dbo.udfReport_HistoricUserCourseStatusWithinRange(@effectiveFromDate, @effectiveToDate) vUCS
                        on vUCS.UserID = tU1.userID
                            and vUCS.CourseStatusID = 2 --< only want completed users >--
                            --and vUCS.CourseID = @courseID--
                    inner join dbo.udfCsvToInt(@courseIDs) tR
						on tR.IntValue = vUCS.CourseID
					inner join dbo.tblCourse as tC
						on tR.IntValue = tC.CourseID
                    inner join dbo.udfCsvToInt(@unitIDs) tU
                        on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
           End  --/7
        end --/3
    return
end -- /1


' 
END











SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Policies]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/******************************************************************************
**		File: dbo.prcReport_Policies.PRC
**		Name: prcReport_Policies
**		Desc: For reporting of Policy acceptance by users
**              
**		Return values:
**			Policy
**			UnitPathway
**			Lastname
**			Firstname
**			Email
**			Accepted
**			DateAccepted
** 
**		Called by:   
**              
**		Parameters:
**			@organisationID Integer = ''0''
**			@policyIDs varchar(8000) = ''0''
**			@unitIDs varchar(8000) = ''0''
**			@dateFrom datetime = Null
**			@dateTo datetime = Null
**			@acceptanceStatus varchar(20) = ''BOTH'' 
**			@includeInactiveUsers varchar(5) = ''false''
**
**		Input							Output
**     ----------							-----------
**
**		Auth: Chris Plewright
**		Date: 31 Jul 2008
**
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		--------		--------				-------------------------------------------
**		14/08/2009		Mark Donald				More detail in Order By clause
**												+ extra column (userid) in result set
**		09/06/2011		J hedlefs				tIMEZONE
*******************************************************************************/
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
ALTER Procedure [dbo].[prcReport_Policies]
	@organisationID Integer = ''0'',
	@policyIDs varchar(8000) = ''0'',
    @unitIDs varchar(8000) = ''0'',
	@dateFromOrg datetime = Null,
	@dateToOrg datetime = Null,
	@acceptanceStatus varchar(20) = ''BOTH'', 
	@includeInactiveUsers varchar(5) = ''false''
AS
	
BEGIN

	SET NOCOUNT ON;
	DECLARE @dateFrom 		datetime
	DECLARE @dateTo 		datetime
	SET @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFromOrg,@OrganisationID)
	SET @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateToOrg,@OrganisationID)

	select 
	Policy = pol.PolicyName + '' ('' + pol.PolicyFileName + '')'', 
	UnitPathway = tblUnitHierarchy.HierarchyName, 
	--tblUser.Lastname,
	CASE
		WHEN tblUser.Active = 0 then LastName + '' (I)''
		ELSE LastName
	END AS LastName,
	tblUser.Firstname,
	tblUser.Email,
	tblUser.userid,
	Accepted = case when ua1.Accepted = 1  and (ua1.DateAccepted >= @dateFrom and ua1.DateAccepted <= @dateTo) then ''Yes'' else ''No'' end,
	case when ua1.DateAccepted >= @dateFrom and ua1.DateAccepted <= @dateTo then  dbo.udfUTCtoDaylightSavingTime(ua1.DateAccepted,@OrganisationID)  else null end as DateAccepted
	from tblPolicy pol
	join tblOrganisation org on org.OrganisationID = pol.Organisationid and org.OrganisationID = @OrganisationID
	join tblUser on tblUser.OrganisationID = org.OrganisationID and (@includeInactiveUsers=''true'' or tblUser.Active=1) and tblUser.UnitID in (select IntValue from dbo.udfCsvToInt(@unitIDs))
	join tblUserPolicyAccepted ua1 on pol.PolicyID = ua1.PolicyID and tblUser.UserID = ua1.UserID
	join tblUnitHierarchy on tblUser.UnitID = tblUnitHierarchy.UnitID
	left join tblUserPolicyAccess upa on upa.PolicyID = pol.PolicyID and upa.UserID = tblUser.Userid 
	where upa.granted = 1 and pol.Active = 1 and pol.Deleted = 0 and pol.uploaddate between @dateFrom and @dateTo
	and pol.PolicyID in ( select IntValue from dbo.udfCsvToInt(@policyIDs ) )
	and (
		--Condition A - ACCEPTED
		( @acceptanceStatus=''ACCEPTED'' and exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1 ) )
		or
		--Condition B - NOT_ACCEPTED
		( @acceptanceStatus=''NOT_ACCEPTED'' and not exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1) )
		or
		--Condition C - BOTH
		@acceptanceStatus=''BOTH''
		)
	--and (@includeInactiveUsers=''true'' and exists )
	ORDER BY policy, unitpathway, lastname, firstname
	
END 


' 
END




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_PoliciesGrandTotal]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/******************************************************************************
**		File: dbo.prcReport_PoliciesGrandTotal.PRC
**		Name: prcReport_PoliciesGrandTotal
**		Desc: counts total distinct users in policies report - basically, it''s a copy
**				of that report with the selects changed to return a total instead of data
**              
**		Parameters:
**			@organisationID Integer = ''0''
**			@policyIDs varchar(8000) = ''0''
**			@unitIDs varchar(8000) = ''0''
**			@dateFrom datetime = Null
**			@dateTo datetime = Null
**			@acceptanceStatus varchar(20) = ''BOTH'' 
**			@includeInactiveUsers varchar(5) = ''false''
**
**		Input							Output
**     ----------							-----------
**
**		Auth: Mark Donald
**		Date: 27 Aug 2009
**
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		--------		--------				-------------------------------------------
**		09/06/2011	j hedlefs			timezone
*******************************************************************************/
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
ALTER Procedure [prcReport_PoliciesGrandTotal]
	@organisationID Integer = ''0'',
	@policyIDs varchar(8000) = ''0'',
    @unitIDs varchar(8000) = ''0'',
	@dateFromOrg datetime = Null,
	@dateToOrg datetime = Null,
	@acceptanceStatus varchar(20) = ''BOTH'', 
	@includeInactiveUsers varchar(5) = ''false''
AS
BEGIN	
	SET NOCOUNT ON;
	DECLARE @dateFrom 		datetime
	DECLARE @dateTo 		datetime
	SET @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFromOrg,@OrganisationID)
	SET @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateToOrg,@OrganisationID)

select
	count(distinct tblUser.userid) as TotalDistinctUsers
from tblPolicy pol
join tblOrganisation org on org.OrganisationID = pol.Organisationid and org.OrganisationID = @OrganisationID
join tblUser on tblUser.OrganisationID = org.OrganisationID and (@includeInactiveUsers=''true'' or tblUser.Active=1) and tblUser.UnitID in (select IntValue from dbo.udfCsvToInt(@unitIDs))
join tblUserPolicyAccepted ua1 on pol.PolicyID = ua1.PolicyID and tblUser.UserID = ua1.UserID
join tblUnitHierarchy on tblUser.UnitID = tblUnitHierarchy.UnitID
left join tblUserPolicyAccess upa on upa.PolicyID = pol.PolicyID and upa.UserID = tblUser.Userid 
where upa.granted = 1 and pol.Active = 1 and pol.Deleted = 0 and pol.uploaddate between @dateFrom and @dateTo
and pol.PolicyID in ( select IntValue from dbo.udfCsvToInt(@policyIDs ) )
and (
	--Condition A - ACCEPTED
	( @acceptanceStatus=''ACCEPTED'' and exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1 ) )
	or
	--Condition B - NOT_ACCEPTED
	( @acceptanceStatus=''NOT_ACCEPTED'' and not exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1) )
	or
	--Condition C - BOTH
	@acceptanceStatus=''BOTH''
    )
--and (@includeInactiveUsers=''true'' and exists )

END
' 
END





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_PoliciesTotals]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/******************************************************************************
**		File: dbo.prcReport_PoliciesTotals.PRC
**		Name: prcReport_PoliciesTotals
**		Desc: For counting user policy acceptance by policy
**              
**		Return values:
**			Policy
**			UnitPathway
**			Lastname
**			Firstname
**			Email
**			UserID
**			Accepted
**			DateAccepted
** 
**		Called by:   
**              
**		Parameters:
**			@organisationID Integer = ''0''
**			@policyIDs varchar(8000) = ''0''
**			@unitIDs varchar(8000) = ''0''
**			@dateFrom datetime = Null
**			@dateTo datetime = Null
**			@acceptanceStatus varchar(20) = ''BOTH'' 
**			@includeInactiveUsers varchar(5) = ''false''
**
**		Input							Output
**     ----------							-----------
**
**		Auth: Mark Donald
**		Date: 14 Aug 2009
**
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		--------		--------				-------------------------------------------
**    
*******************************************************************************/

ALTER PROCEDURE [prcReport_PoliciesTotals]
	@organisationID Integer = 0,
	@policyIDs varchar(8000) = ''0'',
	@unitIDs varchar(8000) = ''0'',
	@dateFromOrg datetime = Null,
	@dateToOrg datetime = Null,
	@acceptanceStatus varchar(20) = ''BOTH'', 
	@includeInactiveUsers varchar(5) = ''false''
AS
BEGIN	
	DECLARE @dateFrom 		datetime
	DECLARE @dateTo 		datetime
	SET @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFromOrg,@OrganisationID)
	SET @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateToOrg,@OrganisationID)


	SET NOCOUNT ON;
	select 
		pol.PolicyName AS policy,
		count (*) as totalusers,
		sum(CASE WHEN ua1.Accepted = 1  and (ua1.DateAccepted >= @dateFrom and ua1.DateAccepted <= @dateTo) THEN 1 ELSE 0 END) AS totalaccepted,
		sum(CASE WHEN ua1.Accepted = 1  and (ua1.DateAccepted >= @dateFrom and ua1.DateAccepted <= @dateTo) THEN 0 ELSE 1 END) AS totalnotaccepted
from tblPolicy pol
join tblOrganisation org on org.OrganisationID = pol.Organisationid and org.OrganisationID = @OrganisationID
join tblUser on tblUser.OrganisationID = org.OrganisationID and (@includeInactiveUsers=''true'' or tblUser.Active=1) and tblUser.UnitID in (select IntValue from dbo.udfCsvToInt(@unitIDs))
join tblUserPolicyAccepted ua1 on pol.PolicyID = ua1.PolicyID and tblUser.UserID = ua1.UserID
join tblUnitHierarchy on tblUser.UnitID = tblUnitHierarchy.UnitID
left join tblUserPolicyAccess upa on upa.PolicyID = pol.PolicyID and upa.UserID = tblUser.Userid 
where upa.granted = 1 and pol.Active = 1 and pol.Deleted = 0 and pol.uploaddate between @dateFrom and @dateTo
and pol.PolicyID in ( select IntValue from dbo.udfCsvToInt(@policyIDs ) )
and (
	--Condition A - ACCEPTED
	( @acceptanceStatus=''ACCEPTED'' and exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1 ) )
	or
	--Condition B - NOT_ACCEPTED
	( @acceptanceStatus=''NOT_ACCEPTED'' and not exists(select * from tblUserPolicyAccepted where pol.PolicyID = tblUserPolicyAccepted.PolicyID and tblUser.UserID = tblUserPolicyAccepted.UserID and tblUserPolicyAccepted.DateAccepted >= @dateFrom and tblUserPolicyAccepted.DateAccepted <= @dateTo and tblUserPolicyAccepted.Accepted = 1) )
	or
	--Condition C - BOTH
	@acceptanceStatus=''BOTH''
    )
--and (@includeInactiveUsers=''true'' and exists )
group by pol.PolicyName
--ORDER BY policy, unitpathway, lastname, firstname  

END
' 
END




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Progress]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		Name: prcReport_Progress
**
**		Called by:   
**      
**		Auth: Mark Donald
**		Date: 11 Jan 2010
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**    
*******************************************************************************/


ALTER PROCEDURE [prcReport_Progress]
(
	@organisationID int,
	@unitIDs varchar(8000),
	@courseIDs varchar(8000),
	@includeInactive int,
	@classificationID int
)
AS
	SET NOCOUNT ON;
	BEGIN
		DECLARE @currentstatus TABLE (usercoursestatusid int)
		INSERT INTO @currentstatus
			SELECT
				max(usercoursestatusid) usercoursestatusid
				FROM
					tblusercoursestatus
				GROUP BY
					userid, courseid

		SELECT
			hierarchyname ''unitpathway'', lastname, firstname, CASE u.active WHEN 1 THEN NULL ELSE ''(i)'' END flag,
			c.name coursename, externalid, email, username, [status] currentstatus, previousstatus, (
				SELECT
					convert(varchar(10), dbo.udfUTCtoDaylightSavingTime(max(datecreated),@OrganisationID), 103)
					FROM
						tblusercoursestatus
					WHERE
						userid = s.userid
						AND courseid = s.courseid
						AND coursestatusid = 2
			) AS lastcompletiondate
			FROM
				tblusercoursestatus s
				INNER JOIN tblcourse c ON
					c.courseid = s.courseid
					AND c.courseid IN (SELECT IntValue FROM dbo.udfCsvToInt(@courseIDs))
				INNER JOIN tbluser u ON
					u.userid = s.userid
					AND u.unitid IN (SELECT IntValue FROM dbo.udfCsvToInt(@unitIDs))
				LEFT JOIN (
					SELECT
						userid, courseid, max(usercoursestatusid) usercoursestatusid -- 2nd most recent record
						FROM
							tblusercoursestatus
						WHERE
							usercoursestatusid NOT IN (SELECT usercoursestatusid FROM @currentstatus)
						GROUP BY
							userid, courseid
				) AS p ON
					s.userid = p.userid
					AND s.courseid = p.courseid
				LEFT JOIN (
					SELECT
						usercoursestatusid, v.coursestatusid, [status] previousstatus
						FROM
							tblusercoursestatus v
							INNER JOIN tblcoursestatus z ON
								v.coursestatusid = z.coursestatusid
						WHERE
							z.coursestatusid > 0
				) AS def2 ON
					def2.usercoursestatusid = p.usercoursestatusid
				LEFT JOIN tbluserclassification g ON
					g.userid = u.userid,
				tblunithierarchy h,
				tblcoursestatus def,
				@currentstatus r
			WHERE
				h.unitid = u.unitid
				AND def.coursestatusid = s.coursestatusid
				AND s.usercoursestatusid = r.usercoursestatusid
				AND u.organisationid = @organisationID
				AND (@includeInactive = 1 OR u.active = 1)
				AND (@classificationID = 0 OR classificationID = @classificationID)
			ORDER BY
				unitpathway, lastname, firstname, coursename
	END
' 
END





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Summary]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
This Report provides a high level summary information. 
It shows how many users in each unit are complete or incomplete in each course. 
The results can be views as a bar graph

Called By:
	SummaryReport in Reporting Services 

Calls:
udfReport_CompletUsers_logic
udfReport_IncompletUsers_logic
Remarks:


Author:
Jack Liu
Date Created: 31 March 2005

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1
	Mark Donald	23/07/2009		Add @classificationID parameter and use it
								to filter insert into #result table

prcReport_Summary 8, ''19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84'' ,7, null

prcReport_Summary 8, ''19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84'' ,7, ''20041130''

--------------------

**/

ALTER  Proc [prcReport_Summary]
(
	@organisationID Integer,	-- Organisation of the current user
	@unitIDs varchar(8000) = '''',	-- string of unit id''s
	@courseID int,			-- course ID to restrict search to
	@effectiveDateOrg datetime = Null,	-- Effective date as at when to run the report
	@classificationID int
)

AS
------------------------------------------
Set Nocount On
DECLARE @effectiveDate 		datetime
SET @effectiveDate = dbo.udfDaylightSavingTimeToUTC(@effectiveDateOrg,@OrganisationID)
CREATE TABLE #result
(
	UnitID		Int,
	UnitPathway 	nVarchar(4000),
	Complete	int,
	Incomplete	int
)
declare @rowCount as integer

insert into #result
select 
	UnitID,
	min(UnitPathway) as UnitPathway,
	sum(Complete) as Complete,
	sum(Incomplete) as Incomplete 
from (Select
		UnitID, 
		UnitPathWay,
		1 as Complete, 
		0 as Incomplete,
		UserID
	From	dbo.udfReport_CompleteUsersLogic(@organisationID, @unitIDs, @courseID,@effectiveDate)
	Union all
	Select
		UnitID, 
		UnitPathWay,
		0 as Complete, 
		1 as Incomplete,
		UserID
	from  dbo.udfReport_IncompleteUsersLogic(@organisationID, @unitIDs, @courseID,@effectiveDate)
	) as Users
	LEFT JOIN tblUserClassification c ON c.UserID  = Users.UserID
WHERE
	((@classificationID =0) OR (classificationID = @classificationID))
	--If classification is Any (0), This will find users of any Custom Classification
group by UnitID
Order By UnitPathway

set @rowCount=@@rowcount

if (@rowCount>1)
begin
	insert into #result
	select 0,
		''Total'',
		Sum(Complete),
		Sum(Incomplete)
	from #result
		
	set @rowCount = @rowCount+1
end

select *,
	@rowCount  as Count	
from #result

drop table #result










' 
END





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Trend]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary:
refer to section 16.5.5.2 of Func. Spec. returns avg. score
and num of user per module for a selected course and unit

Called By: Report.cs, TrendReport.aspx.cs
Calls: udfCsvToInt

Remarks: Raises an error if a parameter is null

Author: Claude Nehme
Date Created: 16th of February 2004

prcReport_Trend "1,2,3", 1,1

Modification History
-----------------------------------------------------------
v#	Author			Date			Description
#1	Peter Kneale 	03/03/04		Added ''Passed or Failed Users only''
#2	Jack Liu		05/03/04		Remove the hierarchy unit, change to flat file
#3	Jack Liu		14/09/05		Order the result by Module
									and order by most recent(the last recorded status with specified passmark)
#4	Usman Tjiudri	11 Nov 2005		Include BoldMark indicator for the latest PassMark record.
#5	j hedlefs		09/06/2011		timezone
									
*/

ALTER     Procedure [prcReport_Trend]
(
@organisationID integer = null,
@unitIDs varchar(8000) = null,
@courseID integer = null,
@fromDateOrg datetime,
@toDateOrg datetime
)

as
	DECLARE @fromDate 		datetime
	DECLARE @toDate 		datetime
	SET @fromDate = dbo.udfDaylightSavingTimeToUTC(@fromDateOrg,@OrganisationID)
	SET @toDate = dbo.udfDaylightSavingTimeToUTC(@toDateOrg,@OrganisationID)

Set NoCount On

If @courseID Is Null
Begin
	Raiserror(''The Parameter @courseID was null.  @courseID does not accept Null values.'', 16, 1)
	Return	
End

-- Temporary table to store the query for further data manipulation.
Declare @tblResult Table
(	
	Unit		nVarchar(200),
	UnitID		Int,
	Course		nVarchar(100),
	CourseID	Int,
	Module		nVarchar(100),
	ModuleID	Int,
	NumOfUsers	Int,
	QuizCount int,
	QuizPassMark	Int,
	AvgScore	Int,
	LastUserQuizStatusID Int,
	BoldMark	Bit -- Indicator whether current record should be bold or not
)

If @unitIDs Is Null
Begin
	Insert Into @tblResult
	(
		Unit,
		UnitID,
		Course,
		CourseID,
		Module,
		ModuleID,
		NumOfUsers,
		QuizCount,
		QuizPassMark,
		AvgScore,
		LastUserQuizStatusID
	)
	Select 	dbo.udfGetUnitPathway(un.UnitID) as Unit,
		un.UnitID,
		min(co.Name) as  Course,
		co.CourseID,
		min(mo.Name) as Module,
		mo.ModuleID,
		count(DISTINCT usr.UserID) as NumOfUsers,
		count(usr.UserID) as QuizCount,
		uqs.QuizPassMark,
		avg(uqs.QuizScore) as AvgScore,
		max(uqs.UserQuizStatusID) as LastUserQuizStatusID
	From
		tblUser usr
		inner join tblUnit un on un.UnitID = usr.UnitID
		inner join tblUserQuizStatus uqs on usr.UserID = uqs.UserID 
					and (uqs.QuizStatusID = 2 or uqs.QuizStatusID = 3) 	-- Passed or Failed Users only
					and uqs.DateCreated between @fromDate and dateadd(dd,1,@toDate)
		inner join tblModule mo on mo.ModuleID = uqs.ModuleID
		inner join tblCourse co on mo.CourseID = co.CourseID and co.CourseID = @courseID
	Where
		usr.UnitID is not null
	and 	usr.Active = 1
	and 	un.OrganisationID = @organisationID
	Group By
		un.UnitID,
		co.CourseID,
		mo.ModuleID,
		uqs.QuizPassMark
	Order By
		Unit,
		Course,
		Module,
		LastUserQuizStatusID desc

End
Else
Begin
	Insert Into @tblResult
	(
		Unit,
		UnitID,
		Course,
		CourseID,
		Module,
		ModuleID,
		NumOfUsers,
		QuizCount,
		QuizPassMark,
		AvgScore,
		LastUserQuizStatusID
	)
	Select	dbo.udfGetUnitPathway(un.UnitID) as Unit,
		un.UnitID,
		min(co.Name) as  Course,
		co.CourseID,
		min(mo.Name) as Module,
		mo.ModuleID,
		count(DISTINCT usr.UserID) as NumOfUsers,
		count(usr.UserID) as QuizCount,
		uqs.QuizPassMark,
		avg(uqs.QuizScore) as AvgScore,
		max(uqs.UserQuizStatusID) as LastUserQuizStatusID
	From
		tblUser usr
		inner join tblUnit un on un.UnitID = usr.UnitID
		inner join dbo.udfCsvToInt(@unitIDs) as selectedUnit on selectedUnit.IntValue= un.UnitID
		inner join tblUserQuizStatus uqs on usr.UserID = uqs.UserID
					and (uqs.QuizStatusID = 2 or uqs.QuizStatusID = 3) 	-- Passed or Failed Users only
					and uqs.DateCreated between @fromDate and dateadd(dd,1,@toDate)
		inner join tblModule mo on mo.ModuleID = uqs.ModuleID
		inner join tblCourse co on mo.CourseID = co.CourseID and co.CourseID = @courseID
	Where 
		usr.UnitID is not null
	and 	usr.Active = 1
	Group By
		un.UnitID,
		co.CourseID,
		mo.ModuleID,
		uqs.QuizPassMark
	Order By
		Unit,
		Course,
		Module,
		LastUserQuizStatusID desc
End

-- Update BoldMark field for group of records (by Unit, Course and Module) with more than one version of pass mark.
Update @tblResult
Set BoldMark = 1
Where LastUserQuizStatusID In (
Select tb.QuizStatusID From 
(Select UnitID, CourseID, ModuleID, Max(LastUserQuizStatusID) As QuizStatusID from @tblResult Group by UnitID, CourseID, ModuleID having count(*) > 1) As tb
)

-- Returning records to callers
Select * From @tblResult


' 
END


/* Modifying Stored Procedures for UTC */

/****** Object:  StoredProcedure [dbo].[prc_ADMIN_LessonPageAuditPagesVisited]    Script Date: 06/08/2011 09:27:26 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prc_ADMIN_LessonPageAuditPagesVisited]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prc_ADMIN_LessonPageAuditPagesVisited]
GO

/****** Object:  StoredProcedure [dbo].[prc_ADMIN_LessonPageAuditPagesVisited]    Script Date: 06/08/2011 09:27:26 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prc_ADMIN_LessonPageAuditPagesVisited]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'create proc [dbo].[prc_ADMIN_LessonPageAuditPagesVisited]

@OrgID int

as

select
	left(tblOrganisation.OrganisationName, 25) as [Org Name]
	, left(tblUser.Firstname + '' '' + tblUser.LastName, 25) as [username]
	, left(tblCourse.Name + ''/'' + tblModule.Name, 65) as [Course / Module]
	, left(tblLessonPage.ToolbookPageID + ''/'' + tblLessonPage.Title, 50) [Page id / name]
	, dbo.udfUTCtoDaylightSavingTime(tblLessonPageAudit.DateAccessed, @OrgID)
From
	tblLessonPageAudit
	inner join .tblLessonSession on tblLessonPageAudit.LessonSessionID = tblLessonSession.LessonSessionID
	inner join tblUser on tblLessonSession.UserID = tblUser.userID
	inner join tblOrganisation on tblOrganisation.OrganisationID = tblUser.OrganisationID
	inner join tblLessonPage on tblLessonPage.LessonPageID = tblLessonPageAudit.LessonPageID
	inner join tblLesson on tblLesson.LessonID = .tblLessonPage.LessonID
	inner join tblModule on tblModule.moduleid = tblLesson.moduleID
	inner join tblCourse on tblModule.courseid = tblCourse.courseid
where
	tblLessonSession.dATEtIMECompleted > ''2004-11-23''
	and tblOrganisation.OrganisationID <> 8
order by tblOrganisation.OrganisationName, tblUser.LastName, tblLessonSession.LessonSessionID desc

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCourse_AdminMashup]    Script Date: 06/08/2011 10:27:06 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_AdminMashup]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCourse_AdminMashup]
GO

/****** Object:  StoredProcedure [dbo].[prcCourse_AdminMashup]    Script Date: 06/08/2011 10:27:06 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_AdminMashup]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary:		Compiles a bunch of info based on the selected units/courses then filters it based on administrator selection
Parameters:		Comma separated list of userID:courseID, comma separated list of adminID (unit administrators)
Returns:		table (lastname firstname userid email course_names)
		
Called By:		BusinessServices.Course.GetAdminMashup in Course.cs
Calls:			None

Remarks:		None

Author:			Mark Donald
Date Created:	20 Jan 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcCourse_AdminMashup]
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@input_csv varchar(8000),
	@adminids varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
AS
BEGIN
	SET NOCOUNT ON;

--*********

set @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFrom, @organisationID)
set @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateTo, @organisationID)

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @mashup TABLE (userid int, courseid int)
	DECLARE @selectedadmin TABLE (adminid int)
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

INSERT INTO
		@selectedadmin
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@adminids)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, A.UnitID
			FROM
				(SELECT
					A.UserID, D.UnitID
					FROM
						(SELECT
							A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
							FROM
								tblUserCourseStatus A, @CoursesWithAccess B
							WHERE
								A.DateCreated < DATEADD(DD, 1, @quizDateTo)
								and A.CourseID = B.CourseID
							GROUP BY
								A.UserID, A.CourseID
						) A, @Users B, tblUserCourseStatus C, tblUser D
					WHERE
						A.UserID = B.UserID
						AND B.UserID = C.UserID
						AND A.LatestCourseStatus = C.UserCourseStatusID
						AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
						AND C.CourseStatusID = case @courseModuleStatus
													when @CONST_COMPLETE then 2   -- Complete
													when @CONST_INCOMPLETE then 1 -- InComplete
													end
						AND A.UserID = D.UserID
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
				AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
			ORDER BY
				A.UserID, A.UnitID
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, UnitID
				FROM 
					(select
						distinct userid, moduleid
						from
							@UsersQuizStatusNOTSTARTED
					) A, tblUser B, tblModule D
				WHERE 
					A.UserID = B.UserID
					AND A.ModuleID = D.ModuleID
					AND D.Active = 1
				ORDER BY
					A.UserID, UnitID
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT 
				A.UserID, UnitID
				FROM
					(SELECT
						DISTINCT A.UserID, B.UnitID
						FROM 
							(SELECT
								DISTINCT userid, moduleid
								FROM
									@UsersQuizStatusNOTSTARTED
							) A, tblUser B, tblModule D
						WHERE 
							A.UserID = B.UserID
							AND A.ModuleID = D.ModuleID
							AND D.Active = 1
					) A
					LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
						AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				WHERE
					--If classification is Any (0), This will find users of any Custom Classification
					@classificationID =0 OR tblUserClassification.classificationID = @classificationID
				ORDER BY
					A.UserID, UnitID

	end --/ Not started - Any


insert into @tblUnit(UnitID)
select distinct UnitID
from @tblUserUnit

---If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the users Units.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, ua.UserID
from @tblUnit u
	inner join tblUnitAdministrator ua
		on ua.UnitID = u.UnitID
	inner join tblUser us
		on us.UserID = ua.UserID and us.UserTypeID = 3 --Unit Administrator

--If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, us.UserID
from tblUser us
	cross join @tblUnit u
where us.OrganisationID = @organisationID
	and us.UserTypeID = 2 -- Organisation Administrator
	and u.UnitID not in (select UnitID from @tblUnitAdministrator)
	and us.Active = 1

--*********

	-- clean up the input so it resembles ''userid:courseid,userid:courseid,''
	SELECT @input_csv = replace(rtrim(ltrim(replace(replace(replace(@input_csv,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip input_csv
	WHILE patindex(''%,%'', @input_csv) <> 0
		BEGIN
			SELECT @pos = patindex(''%,%'', @input_csv)
			SELECT @temp = left(@input_csv, @pos - 1)
			SELECT @colon_pos = patindex(''%:%'', @input_csv)
			INSERT @mashup VALUES (
				cast(substring(@temp, 1, @colon_pos - 1) AS int),
				cast(substring(@temp, @colon_pos + 1, len(@temp)) AS int)
			)
			SELECT @input_csv = substring(@input_csv, @pos + 1, len(@input_csv))
		END

	-- join @mashup, @tblunitadministrator & @selectedadmin tables & sort results by adminid and courseid
	SELECT
		adminid, a.email, a.firstname, a.lastname, m.courseid, [name] coursename, u.firstname, u.lastname
		FROM
			@mashup m,
			@tblunitadministrator n,
			@selectedadmin s,
			tbluser a,
			tblcourse c,
			tbluser u
		WHERE
			u.userid = m.userid
			AND n.unitid = u.unitid
			AND a.userid = adminid
			AND adminid = adminuserid
			AND c.courseid = m.courseid
		ORDER BY
			adminid, m.courseid
			
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCourse_GetList]    Script Date: 06/08/2011 10:38:55 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCourse_GetList]
GO

/****** Object:  StoredProcedure [dbo].[prcCourse_GetList]    Script Date: 06/08/2011 10:38:55 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary: Gets a list of all Courses
Parameters: None
Returns: table
		
Called By: BusinessServices.Course.GetCourseList in Course.cs
Calls: None

Remarks: None

Author: Stephen Kenendy-Clark
Date Created: 06th of Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE  Procedure [dbo].[prcCourse_GetList]

@OrgID int

As

Select 
	  [CourseID]
	, [Name] 
	, [Notes] 
	, [Active] 
	, [CreatedBy]
	, dbo.udfUTCtoDaylightSavingTime([DateCreated], @OrgID) 
	, [UpdatedBy] 
	, dbo.udfUTCtoDaylightSavingTime([DateUpdated], @OrgID)
From 
	[tblCourse]
Order by Name

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCourse_GetListByOrganisation]    Script Date: 06/08/2011 10:41:21 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetListByOrganisation]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCourse_GetListByOrganisation]
GO

/****** Object:  StoredProcedure [dbo].[prcCourse_GetListByOrganisation]    Script Date: 06/08/2011 10:41:21 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetListByOrganisation]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




/*
Summary: Gets a list of all Courses
Parameters: None
Returns: 
		
Called By: BusinessServices.Course.GetCourseListAccessableToOrg
Calls: None

Remarks: None

Author: Stephen Kenendy-Clark
Date Created: 06th of Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE     Procedure [dbo].[prcCourse_GetListByOrganisation]
(
	@organisationID  int -- The organisation ID
)

As

-------------------------------------------------------------
-- Return Select
-------------------------------------------------------------
Select
	c.[CourseID]
	, c.[Name]
	, c.[Notes]
	, c.[Active]
	, c.[CreatedBy] 
	, dbo.udfUTCtoDaylightSavingTime(c.[DateCreated], @organisationID)
	, c.[UpdatedBy]
	, dbo.udfUTCtoDaylightSavingTime(c.[DateUpdated], @organisationID)
From 
	[tblCourse] c
	inner Join tblOrganisationCourseAccess oca
		on oca.GrantedCourseID = c.CourseID
			and oca.organisationID = @organisationID
order by c.Name



' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_GetListByUser]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCourse_GetListByUser]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_GetListByUser]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets a list of all Courses a user can access 
Parameters: None
Returns:

Called By: BusinessServices.Course.GetCourseListAccessableToUser
Calls: None

Remarks: None

Author: Stephen Kenendy-Clark
Date Created: 04th of May 2004

prcCourse_GetListByUser 11
Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1
*/

CREATE  Procedure [prcCourse_GetListByUser]
(
    @userid  int -- The UserID
)

As

-------------------------------------------------------------
-- Return Select
-------------------------------------------------------------
Select distinct
    c.[CourseID]
    , c.[Name]
    , c.[Notes]
    , c.[Active]
    , c.[CreatedBy]
    , dbo.udfUTCtoDaylightSavingTime(c.[DateCreated], vUMA.OrganisationID)
    , c.[UpdatedBy]
    , dbo.udfUTCtoDaylightSavingTime(c.[DateUpdated], vUMA.OrganisationID)
From
    [tblCourse] c
    inner Join vwUserModuleAccess vUMA
        on vUMA.CourseID = c.CourseID
            and vUMA.userid = @userid
order by c.Name
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCourse_GetOne]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets a list of all Courses
Parameters: CourseID int
Returns: table
		
Called By: BusinessServices.Course.GetCourse
Calls: None

Remarks: None

Author: Stephen Kenendy-Clark
Date Created: 06th of Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE   Procedure [prcCourse_GetOne]
(
	@CourseID  int=null -- the course id
	, @OrgID int
)

As

Select
	[CourseID]
	, [Name]
	, [Notes]
	, [Active]
	, [CreatedBy]
	, dbo.udfUTCtoDaylightSavingTime([DateCreated], @OrgID) as DateCreated
	, [UpdatedBy] 
	, dbo.udfUTCtoDaylightSavingTime([DateUpdated], @OrgID) as DateUpdated
From 
	[tblCourse]
Where
	CourseID = @CourseID
' 
END
GO




/****** Object:  StoredProcedure [dbo].[prcCourse_GetSelected]    Script Date: 06/08/2011 10:47:44 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetSelected]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCourse_GetSelected]
GO

/****** Object:  StoredProcedure [dbo].[prcCourse_GetSelected]    Script Date: 06/08/2011 10:47:44 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCourse_GetSelected]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary:		Gets a list of Courses
Parameters:		Comma separated list of courseIDs
Returns:		table
		
Called By:		BusinessServices.Course.GetCourseList in Course.cs
Calls:			None

Remarks:		None

Author:			Mark Donald
Date Created:	10 Nov 2009

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcCourse_GetSelected]
	@courseIDs varchar(8000)
	, @OrgID int
AS
BEGIN
	SET NOCOUNT ON;
	
	SELECT 
		courseid, [name], notes, active, createdby, dbo.udfUTCtoDaylightSavingTime(datecreated, @OrgID), updatedby, dbo.udfUTCtoDaylightSavingTime(dateupdated, @OrgID)
		FROM 
			tblcourse
		WHERE
			courseid IN (SELECT * FROM dbo.udfCsvToInt(@courseIDs))
		ORDER BY [name]
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCPD_Report]    Script Date: 06/08/2011 10:58:52 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPD_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCPD_Report]
GO

/****** Object:  StoredProcedure [dbo].[prcCPD_Report]    Script Date: 06/08/2011 10:58:52 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPD_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[prcCPD_Report]
(
	@profileid int = -1,
	@profileperiodid int = -1,
	@firstname varchar(200)='''',
	@lastname varchar(200) ='''',
	@username varchar(200)='''',
	@shortfallusers smallint=0,
	@UnitIDs varchar(8000)='''',
	@OrgID int
)
as begin


	(select
		hierarchyname as pathway			
		, u.lastname as lastname
		, u.firstname as firstname
		,u.username as username
		,u.email as useremail	
		,c.name as coursee
		,m.name collate database_default as module
		,coalesce(upt.points,0) as points
		,pf.profileid
		,dbo.udfUTCtoDaylightSavingTime(upt.DateAssigned, @OrgID) as dateassigned
		,m.sequence as modID
	from tblProfile pf
		join tblprofileperiod pp on pp.profileid = pf.profileid
		join tbluserprofileperiodaccess upa on upa.profileperiodid = pp.profileperiodid 
			and granted = 1
		join tbluser  u on u.userid = upa.userid
		join tblunithierarchy uh on uh.unitid = u.unitid and u.unitid in (select IntValue from dbo.udfCsvToInt(@unitIDs)) 
		left join tblProfilePoints ppt on ppt.profileperiodid =pp.profileperiodid 
		left join tblusercpdpoints upt on upt.userid = u.userid	 and upt.profilepointsid = ppt.profilepointsid
		left join tblmodule m on m.moduleid = ppt.typeid and profilepointstype =''M''
		left join tblcourse c on c.CourseID =  m.courseid
		join vwusermoduleaccess uma on u.userid = uma.userid and m.moduleid = uma.moduleid
	where 		
		(@profileid= -1 or pf.profileid = @profileid) and 
		(@profileperiodid=-1 or pp.profileperiodid  = @profileperiodid)and 
		(@firstname ='''' or u.firstname=@firstname ) and
		(@lastname ='''' or u.lastname =@lastname) and
		(@username ='''' or u.username =@username) and 
		(@shortfallusers =0 
			or (select sum(u2.points) from tblusercpdpoints u2 where u2.userid = u.userid)<pp.points) or (select sum(u2.points) from tblusercpdpoints u2 where u2.userid = u.userid) is null)

union

	(select
		hierarchyname as pathway			
		, u.lastname as lastname
		, u.firstname as firstname
		,u.username as username
		,u.email as useremail	
		,case when policyname is null then '''' else ''Policy'' end as coursee
		,coalesce(policyname,'''') collate database_default as module
		,coalesce(upt.points,0) as points
		,pf.profileid
		,dbo.udfUTCtoDaylightSavingTime(upt.DateAssigned, @OrgID) as dateassigned
		,null as modID
	from tblProfile pf
		join tblprofileperiod pp on pp.profileid = pf.profileid
		join tbluserprofileperiodaccess upa on upa.profileperiodid = pp.profileperiodid 
			and granted = 1
		join tbluser  u on u.userid = upa.userid
		join tblunithierarchy uh on uh.unitid = u.unitid and u.unitid in (select IntValue from dbo.udfCsvToInt(@unitIDs)) 
		left join tblProfilePoints ppt on ppt.profileperiodid =pp.profileperiodid 
		left join tblusercpdpoints upt on upt.userid = u.userid	 and upt.profilepointsid = ppt.profilepointsid
		left join tblpolicy on tblPolicy.policyid = ppt.typeid and profilepointstype =''P''
		join tblUserPolicyAccess upola on upola.userid = u.userid and upola.policyid = ppt.typeid and upola.granted = 1
	where 	   
		(@profileid= -1 or pf.profileid = @profileid) and 
		(@profileperiodid=-1 or pp.profileperiodid  = @profileperiodid)and 
		(@firstname ='''' or u.firstname=@firstname ) and
		(@lastname ='''' or u.lastname =@lastname) and
		(@username ='''' or u.username =@username) and 
		(@shortfallusers =0 
			or (select sum(u2.points) from tblusercpdpoints u2 where u2.userid = u.userid)<pp.points)  or (select sum(u2.points) from tblusercpdpoints u2 where u2.userid = u.userid) is null)
	Order by 
		coursee, 
		modID 


end

SET QUOTED_IDENTIFIER OFF 
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCPDModuleHistory_Report]    Script Date: 06/08/2011 11:15:53 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDModuleHistory_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCPDModuleHistory_Report]
GO

/****** Object:  StoredProcedure [dbo].[prcCPDModuleHistory_Report]    Script Date: 06/08/2011 11:15:53 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDModuleHistory_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[prcCPDModuleHistory_Report]
(
	@ProfileID  varchar(20),
	@ModuleID	varchar(20),
	@UserID		varchar(20),
	@OrgID		int
)
as 

select
	convert(varchar (11),dbo.udfUTCtoDaylightSavingTime(pp.DateStart, @OrgID),113) + '' - '' + convert( varchar(11),dbo.udfUTCtoDaylightSavingTime(pp.DateEnd, @OrgID),113) as PeriodDesc, 
	sum(upt.Points) as Points
from 
	tblProfilePeriod pp
	join tblProfilePoints pt 
		on pt.profileperiodid =pp.profileperiodid
	join tbluserCPDPoints upt 
		on upt.profilepointsID = pt.profilepointsid
where 
	pt.profilepointstype =''M'' 
	and pt.typeid = @ModuleID
	and pp.profileid =@ProfileID 
	and upt.userid =@UserID
	--and GETUTCDATE() between pp.DateStart and pp.dateend
group by 
	convert(varchar (11),dbo.udfUTCtoDaylightSavingTime(pp.DateStart, @OrgID),113) + '' - '' + convert( varchar(11),dbo.udfUTCtoDaylightSavingTime(pp.DateEnd, @OrgID),113)


SET QUOTED_IDENTIFIER ON 
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCPDPoints_Update]    Script Date: 06/08/2011 11:18:52 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDPoints_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCPDPoints_Update]
GO

/****** Object:  StoredProcedure [dbo].[prcCPDPoints_Update]    Script Date: 06/08/2011 11:18:52 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDPoints_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[prcCPDPoints_Update]
(
	@profileid int = -1,
	@OrgID int
)
as begin
	set nocount on
	declare @userquizstatusid int
	declare @userlessonstatusid int
	declare @userid int
	declare @quizstatusid int
	declare @lessonstatusid int
	declare @datecreated datetime
	declare @pointsgiven bit
	declare @applytoquiz bit
	declare @applytolesson bit
	declare @profilepointsid int
	declare @points numeric(10,1)
	declare @quizpassed bit
	declare @lessonpassed bit
	declare @userstatusid int
	declare @statusid int
	declare @type char
	declare @moduleid int
	declare @newmoduleid int

	set @applytoquiz = (select applytoquiz from tblProfilePeriod pp join tblProfile p 
		on pp.profileid = p.profileid where p.profileid = @profileid and ProfilePeriodActive = 1)

	set @applytolesson = (select applytolesson from tblProfilePeriod pp join tblProfile p 
		on pp.profileid = p.profileid where p.profileid = @profileid and ProfilePeriodActive = 1)

	-- delete points (if requirements re: lesson and quiz have changed) 
	-- find User CPD points within the period
	declare @lessonquizstatus int
	declare @profileperiodid int

	-- lessonquizstatus 
	-- 0 Lesson Only
	-- 1 Quiz Only
	-- 2 Lesson and Quiz
	
	select @lessonquizstatus = 
		(case when (applytoquiz = 1 and applytolesson = 1) then	2				
		when (applytoquiz = 0 and applytolesson = 1) then	0
		when (applytoquiz = 1 and applytolesson = 0) then	1
		end), @profileperiodid = pp.profileperiodid
	from tblProfile p
	join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
	where p.profileid = @profileid and ProfilePeriodActive =1
	
	delete from tblusercpdpoints
	where profilepointsid in
	(select profilepointsid from tblprofilepoints where profileperiodid = @profileperiodid and active=1 and profilepointstype=''M'')
	--and lessonquizstatus not in (@lessonquizstatus)
	and userid in (select distinct uppa.UserID from tblProfile p
	join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
	join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
	where p.ProfileID = @profileid
	and uppa.Granted = 1)

	-- need to interate through for each user that has access to the profile
	declare usercursor cursor for 
	select distinct uppa.UserID from tblProfile p
	join tblProfilePeriod pp on p.ProfileID = pp.ProfileID and pp.ProfilePeriodActive = 1
	join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
	where p.ProfileID = @profileid
	and uppa.Granted = 1

	open usercursor

	fetch next from usercursor into @userid

	while @@FETCH_STATUS = 0

	begin
		
		-- Apply to Quiz only
		if (@applytoquiz = 1 and @applytolesson = 0)
			begin
				-- Get and iterate through the user quiz status records for the user
				declare userquizcursor cursor for
				select m.moduleid, ppts.profilepointsid, ppts.points, UserQuizStatusID, QuizStatusID, dbo.udfUTCtoDaylightSavingTime(uqs.datecreated, @OrgID) from tblProfile p
				join tblProfilePeriod pp on p.ProfileID = pp.ProfileID and pp.ProfilePeriodActive = 1
				join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
				join tblUserQuizStatus uqs on uppa.UserID = uqs.UserID
				join tblQuizSession qs on uqs.quizsessionid = qs.quizsessionid
				join tblQuiz q on q.quizid = qs.quizid 
				join tblModule m on m.moduleid = q.moduleid
				join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
				where p.ProfileID = @profileid
				and uppa.Granted = 1
				and uppa.UserID = @userID
				and uqs.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
				order by m.moduleid, uqs.datecreated

				-- initialise
				set @pointsgiven = 0
				set @moduleid = 0
				set @newmoduleid = 0

				open userquizcursor

				fetch next from userquizcursor 
				into @newmoduleid, @profilepointsid, @points, @userquizstatusid, @quizstatusid, @datecreated

				while @@FETCH_STATUS = 0
				begin
					if @newmoduleid <> @moduleid
					begin
						set @pointsgiven = 0
					end
					if @pointsgiven = 0 
					begin
						if @quizstatusid = 2
						begin
							insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
							values (@profilepointsid, @userID, @points, @datecreated, 1)
						set @pointsgiven = 1
						end		
					end
					if @pointsgiven = 1
					begin
						if @quizstatusid = 5
						begin
						set @pointsgiven = 0
						end
					end

					set @moduleid = @newmoduleid
					fetch next from userquizcursor 
					into @newmoduleid, @profilepointsid, @points, @userquizstatusid, @quizstatusid, @datecreated
				end

				close userquizcursor
				deallocate userquizcursor
			end

		-- Apply to Lesson Only
		if (@applytoquiz = 0 and @applytolesson = 1)
			begin
				-- Get and iterate through the user lesson status records for the user
				declare userlessoncursor cursor for
				select m.moduleid, ppts.profilepointsid, ppts.points, UserLessonStatusID, LessonStatusID, dbo.udfUTCtoDaylightSavingTime(uls.datecreated, @OrgID) from tblProfile p
				join tblProfilePeriod pp on p.ProfileID = pp.ProfileID and pp.ProfilePeriodActive = 1
				join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
				join tblUserLessonStatus uls on uppa.UserID = uls.UserID
				join tblModule m on m.moduleid = uls.moduleid
				join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
				where p.ProfileID = @profileid
				and uppa.Granted = 1
				and uppa.UserID = @userID
				and uls.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
				order by m.moduleid, uls.datecreated

				-- initialise
				set @pointsgiven = 0
				set @moduleid = 0
				set @newmoduleid = 0

				open userlessoncursor

				fetch next from userlessoncursor 
				into @newmoduleid, @profilepointsid, @points,@userlessonstatusid, @lessonstatusid, @datecreated

				while @@FETCH_STATUS = 0
				begin
					if @newmoduleid <> @moduleid
					begin
						set @pointsgiven = 0
					end
					if @pointsgiven = 0
					begin
						if @lessonstatusid = 3
						begin
							insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
							values (@profilepointsid, @userID, @points, @datecreated, 0)
						set @pointsgiven = 1
						end		
					end
					if @pointsgiven = 1
					begin
						if @lessonstatusid = 5
						begin
						set @pointsgiven = 0
						end
					end
					set @moduleid = @newmoduleid
					fetch next from userlessoncursor 
					into @newmoduleid, @profilepointsid, @points,@userlessonstatusid, @lessonstatusid, @datecreated
				end

				close userlessoncursor
				deallocate userlessoncursor
			end

		-- Apply to Quiz and Lesson
		if (@applytoquiz = 1 and @applytolesson = 1)
			begin
				create table #tempUserStatus
				(
				moduleid int,
				profilepointsid int,
				points numeric(10,1),
				userstatusid int,
				statusid int,
				datecreated datetime,
				type char
				)
				-- insert quiz status values into temp status table
				insert into #tempUserStatus (moduleid, profilepointsid, points, userstatusid, statusid, datecreated, type)
				select m.moduleid, ppts.profilepointsid, ppts.points, UserQuizStatusID, QuizStatusID, uqs.datecreated, ''Q'' from tblProfile p
				join tblProfilePeriod pp on p.ProfileID = pp.ProfileID and pp.ProfilePeriodActive = 1
				join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
				join tblUserQuizStatus uqs on uppa.UserID = uqs.UserID
				join tblQuizSession qs on uqs.quizsessionid = qs.quizsessionid
				join tblQuiz q on q.quizid = qs.quizid 
				join tblModule m on m.moduleid = q.moduleid
				join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
				where p.ProfileID = @profileid
				and uppa.Granted = 1
				and uppa.UserID = @userID
				and uqs.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
				
				-- insert lesson status values into temp status table
				insert into #tempUserStatus (moduleid, profilepointsid, points, userstatusid, statusid, datecreated, type)
				select m.moduleid, ppts.profilepointsid, ppts.points, UserLessonStatusID, LessonStatusID, uls.datecreated, ''L'' from tblProfile p
				join tblProfilePeriod pp on p.ProfileID = pp.ProfileID and pp.ProfilePeriodActive = 1
				join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
				join tblUserLessonStatus uls on uppa.UserID = uls.UserID
				join tblModule m on m.moduleid = uls.moduleid
				join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
				where p.ProfileID = @profileid
				and uppa.Granted = 1
				and uppa.UserID = @userID
				and uls.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
				
				set @pointsgiven = 0
				set @quizpassed = 0
				set @lessonpassed = 0
				set @moduleid = 0
				set @newmoduleid = 0

				declare userquizlessoncursor cursor for
				select * from #tempUserStatus order by moduleid, datecreated

				open userquizlessoncursor

				fetch next from userquizlessoncursor 
				into @newmoduleid, @profilepointsid, @points,@userstatusid, @statusid, @datecreated, @type
				while @@FETCH_STATUS = 0
				begin
					if @newmoduleid <> @moduleid
					begin
						set @pointsgiven = 0
						set @lessonpassed = 0
						set @quizpassed = 0
					end
					if @pointsgiven = 0
					begin
						if (@statusid = 2 and @type = ''Q'' and @quizpassed = 0)
						begin
							-- passed quiz
							set @quizpassed = 1
						end
						if (@statusid = 3 and @type = ''L'' and @lessonpassed = 0)
						begin
							-- lesson passed
							set @lessonpassed = 1
						end
						if (@quizpassed = 1 and @lessonpassed = 1)
						begin
							-- give points
							insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
							values (@profilepointsid, @userID, @points, @datecreated, 2)
							set @pointsgiven = 1
						end
					end
					if (@pointsgiven = 1)
					begin
						if (@statusid = 5 and @type = ''Q'')
						begin
							set @quizpassed = 0
							set @pointsgiven = 0
						end
						if (@statusid = 5 and @type = ''L'')
						begin
							set @lessonpassed = 0
							set @pointsgiven = 0
						end
					end
					set @moduleid = @newmoduleid	
					fetch next from userquizlessoncursor 
					into @newmoduleid, @profilepointsid, @points,@userstatusid, @statusid, @datecreated, @type
				end

				drop table #tempUserStatus
				close userquizlessoncursor
				deallocate userquizlessoncursor
			end

		fetch next from usercursor into @userid

	end

	close usercursor
	deallocate usercursor
	set nocount off
end

 SET QUOTED_IDENTIFIER ON 
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcCPDPoints_UpdateUser]    Script Date: 06/08/2011 11:44:43 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDPoints_UpdateUser]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcCPDPoints_UpdateUser]
GO

/****** Object:  StoredProcedure [dbo].[prcCPDPoints_UpdateUser]    Script Date: 06/08/2011 11:44:43 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcCPDPoints_UpdateUser]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE procedure [dbo].[prcCPDPoints_UpdateUser]
(
	@profileid int,
	@userid int,
	@OrgID int
)
as begin
	set nocount on
	declare @userquizstatusid int
	declare @userlessonstatusid int
	declare @quizstatusid int
	declare @lessonstatusid int
	declare @datecreated datetime
	declare @pointsgiven bit
	declare @applytoquiz bit
	declare @applytolesson bit
	declare @profilepointsid int
	declare @points numeric(10,1)
	declare @quizpassed bit
	declare @lessonpassed bit
	declare @userstatusid int
	declare @statusid int
	declare @type char
	declare @moduleid int
	declare @newmoduleid int

	set @applytoquiz = (select applytoquiz from tblProfilePeriod pp join tblProfile p 
		on pp.profileid = p.profileid where p.profileid = @profileid and pp.profileperiodactive = 1)

	set @applytolesson = (select applytolesson from tblProfilePeriod pp join tblProfile p 
		on pp.profileid = p.profileid where p.profileid = @profileid and pp.profileperiodactive = 1)

	-- delete points (if requirements re: lesson and quiz have changed) 
	-- find User CPD points within the period
	declare @lessonquizstatus int
	declare @profileperiodid int

	-- lessonquizstatus 
	-- 0 Lesson Only
	-- 1 Quiz Only
	-- 2 Lesson and Quiz
	
	select @lessonquizstatus = 
		(case when (applytoquiz = 1 and applytolesson = 1) then	2				
		when (applytoquiz = 0 and applytolesson = 1) then	0
		when (applytoquiz = 1 and applytolesson = 0) then	1
		end), @profileperiodid = pp.profileperiodid
	from tblProfile p
	join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
	where p.profileid = @profileid and pp.profileperiodactive=1 and GETUTCDATE() between pp.datestart and dateadd(d,1,pp.dateend)
	
	
	delete from tblusercpdpoints
	where profilepointsid in
	(select profilepointsid from tblprofilepoints where profileperiodid = @profileperiodid and active=1 and profilepointstype=''M'')
	and userid = @userid
	
	-- add points for user
		
	-- Apply to Quiz only
	if (@applytoquiz = 1 and @applytolesson = 0)
		begin
			-- Get and iterate through the user quiz status records for the user
			declare userquizcursor cursor for
			select m.moduleid, ppts.profilepointsid, ppts.points, UserQuizStatusID, QuizStatusID, dbo.udfUTCtoDaylightSavingTime(uqs.datecreated, @OrgID) from tblProfile p
			join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
			join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
			join tblUserQuizStatus uqs on uppa.UserID = uqs.UserID
			join tblQuizSession qs on uqs.quizsessionid = qs.quizsessionid
			join tblQuiz q on q.quizid = qs.quizid 
			join tblModule m on m.moduleid = q.moduleid
			join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
			where p.ProfileID = @profileid
			and uppa.Granted = 1
			and uppa.UserID = @userID
			and uqs.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
			order by m.moduleid, uqs.datecreated

			-- initialise
			set @pointsgiven = 0
			set @moduleid = 0
			set @newmoduleid = 0

			open userquizcursor

			fetch next from userquizcursor 
			into @newmoduleid, @profilepointsid, @points, @userquizstatusid, @quizstatusid, @datecreated

			while @@FETCH_STATUS = 0
			begin
				if @newmoduleid <> @moduleid
				begin
					set @pointsgiven = 0
				end
				if @pointsgiven = 0 
				begin
					if @quizstatusid = 2
					begin
						insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
						values (@profilepointsid, @userID, @points, @datecreated, 1)
					set @pointsgiven = 1
					end		
				end
				if @pointsgiven = 1
				begin
					if @quizstatusid = 5
					begin
					set @pointsgiven = 0
					end
				end

				set @moduleid = @newmoduleid
				fetch next from userquizcursor 
				into @newmoduleid, @profilepointsid, @points, @userquizstatusid, @quizstatusid, @datecreated
			end

			close userquizcursor
			deallocate userquizcursor
		end

	-- Apply to Lesson Only
	if (@applytoquiz = 0 and @applytolesson = 1)
		begin
			-- Get and iterate through the user lesson status records for the user
			declare userlessoncursor cursor for
			select m.moduleid, ppts.profilepointsid, ppts.points, UserLessonStatusID, LessonStatusID, dbo.udfUTCtoDaylightSavingTime(uls.datecreated, @OrgID) from tblProfile p
			join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
			join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
			join tblUserLessonStatus uls on uppa.UserID = uls.UserID
			join tblModule m on m.moduleid = uls.moduleid
			join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
			where p.ProfileID = @profileid
			and uppa.Granted = 1
			and uppa.UserID = @userID
			and uls.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
			order by m.moduleid, uls.datecreated

			-- initialise
			set @pointsgiven = 0
			set @moduleid = 0
			set @newmoduleid = 0

			open userlessoncursor

			fetch next from userlessoncursor 
			into @newmoduleid, @profilepointsid, @points,@userlessonstatusid, @lessonstatusid, @datecreated

			while @@FETCH_STATUS = 0
			begin
				if @newmoduleid <> @moduleid
				begin
					set @pointsgiven = 0
				end
				if @pointsgiven = 0
				begin
					if @lessonstatusid = 3
					begin
						insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
						values (@profilepointsid, @userID, @points, @datecreated, 0)
					set @pointsgiven = 1
					end		
				end
				if @pointsgiven = 1
				begin
					if @lessonstatusid = 5
					begin
					set @pointsgiven = 0
					end
				end
				set @moduleid = @newmoduleid
				fetch next from userlessoncursor 
				into @newmoduleid, @profilepointsid, @points,@userlessonstatusid, @lessonstatusid, @datecreated
			end

			close userlessoncursor
			deallocate userlessoncursor
		end

	-- Apply to Quiz and Lesson
	if (@applytoquiz = 1 and @applytolesson = 1)
		begin
			create table #tempUserStatus
			(
			moduleid int,
			profilepointsid int,
			points numeric(10,1),
			userstatusid int,
			statusid int,
			datecreated datetime,
			type char
			)
			-- insert quiz status values into temp status table
			insert into #tempUserStatus (moduleid, profilepointsid, points, userstatusid, statusid, datecreated, type)
			select m.moduleid, ppts.profilepointsid, ppts.points, UserQuizStatusID, QuizStatusID, uqs.datecreated, ''Q'' from tblProfile p
			join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
			join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
			join tblUserQuizStatus uqs on uppa.UserID = uqs.UserID
			join tblQuizSession qs on uqs.quizsessionid = qs.quizsessionid
			join tblQuiz q on q.quizid = qs.quizid 
			join tblModule m on m.moduleid = q.moduleid
			join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
			where p.ProfileID = @profileid
			and uppa.Granted = 1
			and uppa.UserID = @userID
			and uqs.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
			
			-- insert lesson status values into temp status table
			insert into #tempUserStatus (moduleid, profilepointsid, points, userstatusid, statusid, datecreated, type)
			select m.moduleid, ppts.profilepointsid, ppts.points, UserLessonStatusID, LessonStatusID, dbo.udfUTCtoDaylightSavingTime(uls.datecreated, @OrgID), ''L'' from tblProfile p
			join tblProfilePeriod pp on p.ProfileID = pp.ProfileID
			join tblUserProfilePeriodAccess uppa on pp.ProfilePeriodID = uppa.ProfilePeriodID
			join tblUserLessonStatus uls on uppa.UserID = uls.UserID
			join tblModule m on m.moduleid = uls.moduleid
			join tblProfilePoints ppts on ppts.typeid = m.moduleid and ppts.profilepointstype = ''M'' and ppts.profileperiodid = pp.profileperiodid
			where p.ProfileID = @profileid
			and uppa.Granted = 1
			and uppa.UserID = @userID
			and uls.datecreated between pp.datestart and dateadd(d,1,pp.dateend)
			
			set @pointsgiven = 0
			set @quizpassed = 0
			set @lessonpassed = 0
			set @moduleid = 0
			set @newmoduleid = 0

			declare userquizlessoncursor cursor for
			select * from #tempUserStatus order by moduleid, datecreated

			open userquizlessoncursor

			fetch next from userquizlessoncursor 
			into @newmoduleid, @profilepointsid, @points,@userstatusid, @statusid, @datecreated, @type
			while @@FETCH_STATUS = 0
			begin
				if @newmoduleid <> @moduleid
				begin
					set @pointsgiven = 0
					set @lessonpassed = 0
					set @quizpassed = 0
				end
				if @pointsgiven = 0
				begin
					if (@statusid = 2 and @type = ''Q'' and @quizpassed = 0)
					begin
						-- passed quiz
						set @quizpassed = 1
					end
					if (@statusid = 3 and @type = ''L'' and @lessonpassed = 0)
					begin
						-- lesson passed
						set @lessonpassed = 1
					end
					if (@quizpassed = 1 and @lessonpassed = 1)
					begin
						-- give points
						insert into tblUserCPDPoints (ProfilePointsID, UserID, Points, DateAssigned, LessonQuizStatus)
						values (@profilepointsid, @userID, @points, @datecreated, 2)
						set @pointsgiven = 1
					end
				end
				if (@pointsgiven = 1)
				begin
					if (@statusid = 5 and @type = ''Q'')
					begin
						set @quizpassed = 0
						set @pointsgiven = 0
					end
					if (@statusid = 5 and @type = ''L'')
					begin
						set @lessonpassed = 0
						set @pointsgiven = 0
					end
				end
				set @moduleid = @newmoduleid	
				fetch next from userquizlessoncursor 
				into @newmoduleid, @profilepointsid, @points,@userstatusid, @statusid, @datecreated, @type
			end

			drop table #tempUserStatus
			close userquizlessoncursor
			deallocate userquizlessoncursor
		end
	set nocount off
end

SET QUOTED_IDENTIFIER ON 
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueueMessage]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_QueueMessage]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_QueueMessage]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcEmail_QueueMessage] 
	-- Add the parameters for the stored procedure here
           @organisationID int,
           @AddressTo nvarchar(255),
           @Subject nvarchar(255),
           @Body nvarchar(max),
           @AddressSender nvarchar(255),
           @AddressFrom nvarchar(255),
           @IsHTML bit,
           @AddressBccs nvarchar(max)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    DECLARE @TEMP datetime
    DECLARE @QueuedTime datetime
    SET @TEMP = DATEADD(YEAR,1,GETUTCDATE())
    SET @QueuedTime = GETUTCDATE()
INSERT INTO tblEmailQueue
           ([organisationID]
           ,[AddressTo]
           ,[Subject]
           ,[Body]
           ,[QueuedTime]
           ,[SendStarted]
           ,[AddressSender]
           ,[AddressFrom]
           ,[IsHTML]
           ,[AddressBccs])
     VALUES
           (@organisationID,
           @AddressTo,
           @Subject, 
           @Body,
           @QueuedTime, 
           @TEMP,
           @AddressSender, 
           @AddressFrom,
           @IsHTML,
           @AddressBccs)
           
           
           SELECT EmailQueueID from tblEmailQueue
           WHERE
				[organisationID] = @organisationID
				AND	[AddressTo] = @AddressTo
				AND [Subject]  = @Subject
				AND [Body] = @Body
				AND [QueuedTime] = @QueuedTime
				AND [SendStarted] = @TEMP
				AND [AddressSender] = @AddressSender
				AND [AddressFrom] = @AddressFrom
				AND [IsHTML] = @IsHTML
				AND [AddressBccs] = @AddressBccs
END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_Search]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_Search]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_Search]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	The procedure will search email sent within the selected date range to a email and contain text in subject or body

Returns:
	
		
Called By: 
Calls:

Remarks:
		

Author: Jack Liu
Date Created: 25 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
select * from tblEmail


prcEmail_Search''20040102'',''20040228'','''','''',''''

**/

CREATE  PROCEDURE [prcEmail_Search]
(
	
	@dateFrom  datetime,
	@dateTo  datetime,
	@toEmail nvarchar(50),
	@subject nvarchar(50),
	@body nvarchar(50),
	@organisationID int
)
as
set nocount on

set @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFrom, @organisationID)
set @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateTo, @organisationID)

if @toEmail=''''
	set @toEmail=null

if @subject=''''
	set @subject=null

if @body=''''
	set @body=null


select  ToEmail,
	subject,
	body,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @organisationID) as DateCreated
from tblEmail
where Datediff(day, @dateFrom, DateCreated)>=0
	and  Datediff(day,  @dateTo, DateCreated)<=0
	and (@toEmail is null  or toEmail =@toEmail)
	and (@subject is null  or subject like ''%''+ @subject +''%'')
	and (@body is null  or body   like ''%''+ @body +''%'')
	and OrganisationID = IsNull(@organisationID,OrganisationID)
order by datecreated
' 
END
GO






/****** Object:  StoredProcedure [dbo].[prcErrorLog_GetOne]    Script Date: 06/08/2011 12:24:20 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcErrorLog_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcErrorLog_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcErrorLog_GetOne]    Script Date: 06/08/2011 12:24:20 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcErrorLog_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	Returns a single error
Returns:
	A single error of the tblErrorLog table
		
Called By: 
	ErrorLog Class.

Calls:
	Nothing
Remarks:
	None.

Author:
Peter Kneale
Date Created: 9 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


prcErrorLog_GetReport
**/
CREATE Procedure [dbo].[prcErrorLog_GetOne]
	@ErrorLogID int,
	@OrgID int

As

Set NoCount On
	
	SELECT 
	    [ErrorLogID], 
	    [Source], 
	    [Module], 
	    [Function], 
	    [Code], 
	    [Message], 
	    [StackTrace], 
	    [ErrorLevel], 
	    [ErrorLevelDescription],
	    [ErrorStatusDescription],
	    [ErrorStatus], 
	    [Resolution], 
	    dbo.udfUTCtoDaylightSavingTime([DateCreated], @OrgID) as DateCreated, 
	    dbo.udfUTCtoDaylightSavingTime([DateUpdated], @OrgID) as DateUpdated
    FROM 
	    tblErrorLog
	Inner Join  
	    tblErrorLevel
	    on
	    tblErrorLog.[ErrorLevel] = tblErrorLevel.[ErrorLevelID]
	Inner Join
	    tblErrorStatus
	    on
	    tblErrorLog.[ErrorStatus] = tblErrorStatus.[ErrorStatusID]
Where
	ErrorLogID = @ErrorLogID

	

' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcErrorLog_GetReport]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcErrorLog_GetReport]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcErrorLog_GetReport]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Returns an report of the most recent errors and when they occured.
	Errors containing the exact same Module, Function, Code and Stack Trace
	are assumed to be the same error.
Returns:
	A Summary of the tblErrorLog table
		
Called By: 
	ErrorLog Class.

Calls:
	Nothing
Remarks:
	None.

Author:
Peter Kneale
Date Created: 9 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


prcErrorLog_GetReport
**/
CREATE Procedure [prcErrorLog_GetReport]

@OrgID int

As

Set NoCount On
	
	SELECT 
	    [ErrorLogID], 
	    [Source], 
	    [Module], 
	    [Function], 
	    [Code], 
	    [Message], 
	    [StackTrace], 
	    [ErrorLevel], 
	    [ErrorLevelDescription],
	    [ErrorStatusDescription],
	    [ErrorStatus], 
	    [Resolution], 
	    dbo.udfUTCtoDaylightSavingTime([DateCreated], @OrgID) as DateCreated, 
	    dbo.udfUTCtoDaylightSavingTime([DateUpdated], @OrgID) as DateUpdated 
    FROM 
	    tblErrorLog
	Inner Join  
	    tblErrorLevel
	    on
	    tblErrorLog.[ErrorLevel] = tblErrorLevel.[ErrorLevelID]
	Inner Join
	    tblErrorStatus
	    on
	    tblErrorLog.[ErrorStatus] = tblErrorStatus.[ErrorStatusID]
    Order by 
	    DateCreated desc
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcLesson_GetListByModule]    Script Date: 06/08/2011 12:35:11 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLesson_GetListByModule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcLesson_GetListByModule]
GO

/****** Object:  StoredProcedure [dbo].[prcLesson_GetListByModule]    Script Date: 06/08/2011 12:35:11 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLesson_GetListByModule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	Selects a list of lessons for a module. Caller can specify whether to only return only valid modules.

Parameters:
	@moduleID
	@activeOnly

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Module.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	5. ParameterException


Author: Gavin Buddis
Date Created: 16 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		4/5/2007		Added WorkSiteIDs to select

**/
CREATE  Procedure [dbo].[prcLesson_GetListByModule]
(
	@moduleID Integer = Null,
	@activeOnly Bit = 0,
	@OrgID int
)

As

Set Nocount On

-- Declarations
Declare @strErrorMessage Varchar(200) -- Holds the error message
Declare @intErrorNumber Integer -- Holds the error number

-- Initialise variables
Set @strErrorMessage = ''''
Set @intErrorNumber = 0

--Validate Parameter @moduleID
If (@moduleID Is Null)
Begin
	Set @intErrorNumber = 5
	Set @strErrorMessage = ''Missing or Null parameter @moduleID in stored procedure prcLesson_GetListByModule''
	Goto Finalise
End

If (@activeOnly = 1)
Begin
	Select 
		LessonID,
		ModuleID,
		ToolbookID,
		ToolbookLocation,
		dbo.udfUTCtoDaylightSavingTime(DatePublished, @OrgID),
		LoadedBy,
		dbo.udfUTCtoDaylightSavingTime(DateLoaded, @OrgID),
		Active,
		LWorkSiteID,
		QFWorkSiteID
	From
		tblLesson
	Where 
		ModuleID = @moduleID
		And Active = 1
End
Else
Begin
	Select 
		LessonID,
		ModuleID,
		ToolbookID,
		ToolbookLocation,
		dbo.udfUTCtoDaylightSavingTime(DatePublished, @OrgID),
		LoadedBy,
		dbo.udfUTCtoDaylightSavingTime(DateLoaded, @OrgID),
		Active,
		LWorkSiteID,
		QFWorkSiteID		
	From
		tblLesson
	Where 
		ModuleID = @moduleID

End

Finalise:
If(@intErrorNumber > 0)
Begin
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End



' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcLink_GetListByOrganisation]    Script Date: 06/08/2011 12:50:31 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLink_GetListByOrganisation]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcLink_GetListByOrganisation]
GO

/****** Object:  StoredProcedure [dbo].[prcLink_GetListByOrganisation]    Script Date: 06/08/2011 12:50:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLink_GetListByOrganisation]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets a List of Links per Organisation
Parameters: 
		@organisationID Integer ID of the Organisatyion to return the Links for.
Returns: 
		
Called By: 
		Links.cs
Calls: 

Remarks:

Author: Peter Vranich
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcLink_GetListByOrganisation]
(
	@organisationID Integer = Null -- ID of the Organisation to return the Links for.
)

As

Set Nocount On

If(@organisationID Is Null)
Begin
	Raiserror(''The @organisationID parameter was Null.  You must supply a value.'', 16, 1)
	Return
End

Select
	LinkID,
	OrganisationID,
	Caption,
	Url,
	ShowDisclaimer,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @organisationID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID),
	LinkOrder 
From
	tblLink
Where
	(OrganisationID = @organisationID)
Order by
	LinkOrder, Caption
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcModule_GetListByCourse]    Script Date: 06/08/2011 14:42:13 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcModule_GetListByCourse]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcModule_GetListByCourse]
GO

/****** Object:  StoredProcedure [dbo].[prcModule_GetListByCourse]    Script Date: 06/08/2011 14:42:13 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcModule_GetListByCourse]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets a list of Modules per Course
Parameters: 
		@courseID Integer ID of the Course to return the Modules for.
Returns: 
		
Called By: 
		Module.cs
Calls: 

Remarks:

Author: Gavin Buddis
Date Created: 16th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcModule_GetListByCourse]
(
	@courseID Integer = Null, -- ID of the Course to return the Modules for.
	@OrgID int
)

As

Set Nocount On

If(@courseID Is Null)
Begin
	Raiserror(''The @courseID parameter was Null.  You must supply a value.'', 16, 1)
	Return
End

Select
	ModuleID,
	CourseID,
	[Name],
	[Sequence],
	[Description],
	Active,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrgID) 
From
	tblModule
Where
	(CourseID = @courseID)
Order By
	[Sequence] ASC
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcModule_GetOne]    Script Date: 06/08/2011 14:46:12 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcModule_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcModule_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcModule_GetOne]    Script Date: 06/08/2011 14:46:12 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcModule_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary: Gets the details of one Module
Parameters: @moduleID integer
Returns: ModuleID, CourseID, Name, Sequence, Description, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated
		
Called By: Module.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 16th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcModule_GetOne]
(
	@moduleID Integer = null, -- ModuleID
	@OrgID int
)

As

If @moduleID Is Null
Begin
	Raiserror(''The Parameter @moduleID was null.  @moduleID does not accept Null values.'', 16, 1)
	Return
End

Select
	ModuleID, 
	CourseID, 
	[Name], 
	[Sequence], 
	[Description], 
	Active, 
	CreatedBy, 
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID), 
	UpdatedBy, 
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrgID)
From
	tblModule
Where
	ModuleID = @moduleID


' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModuleStatusUpdateHistory_GetLastRun]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcModuleStatusUpdateHistory_GetLastRun]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModuleStatusUpdateHistory_GetLastRun]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Get the Module Status Updatelast run date time

Returns:

Called By:

Calls:
Nothing

Remarks:

Author: Jack Liu
Date Created: 26 March 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1

prcModuleStatusUpdateHistory_GetLastRun

**/
CREATE Procedure [prcModuleStatusUpdateHistory_GetLastRun]

@OrgID int

AS
Set Nocount On
select dbo.udfUTCtoDaylightSavingTime((select  max(FinishTime) as LastRunDate
from tblModuleStatusUpdateHistory), @OrgID) as LastRunDate 




' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_Add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOrganisation_Add]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_Add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
Add a new Organisation.

Parameters:
@intOrganisationID Integer OutPut
@organisationID Integer
@organisationName VarChar(50)
@notes VarChar(1000)
@logo VarChar(100)
@lessonFrequency Integer
@quizFrequency Integer
@quizPassMark Integer
@CPDReportName nvarchar(255)
@AllocatedDiskSpace Integer = Null
@InclLogo bit = 0,
@PasswordLockout bit = 0
@TimeZoneID int = Null


Returns:
Nothing

Called By:
Organisation.cs.

Calls:
Nothing

Remarks:
Exception:
0. Succeed
4. UniqueViolationException
5. MissingParameterException
6. PermissionDeniedException
10. BusinessServiceException (General)

Author: Peter Vranich
Date Created: 18th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		30/4/2007		Added @lessonCompletionDate and @quizCompletionDate
#2  aaronc		May 2008		Added @CPDReportName
#3	aaronc		June 2008		Added @AllocatedDiskSpace
#4  aaronc		June2008		Addition of organisation record to tblOrganisationCPDPolicyAccess
#5  vdl			08 June 2011	Time zone

**/
CREATE    Procedure [prcOrganisation_Add]
(
	@intOrganisationID Integer OutPut, -- The ID of the newly created organisation.
	@organisationName nVarChar(50) = Null, -- The name of the organisation.
	@notes nVarChar(4000) = Null, -- The notes for the organisation.
	@logo VarChar(100) = Null, -- The name of the organisation logo image.
	@lessonFrequency Integer = Null, -- Default Lesson frequency for the organisation.
	@quizFrequency Integer = Null, -- Default Quiz frequency for the organisation.
	@quizPassMark Integer = Null, -- Default Quiz pass mark for the organisation.
	@lessonCompletionDate DateTime = Null, -- Default Lesson completion date
	@quizCompletionDate DateTime = Null, -- Default Quiz completion date
	@advancedReporting bit = 0,
	@actionUserID Integer = Null, -- ID of the User that is making the changes.
	@CPDReportName nvarchar(255) = Null, -- CPD Report Name
	@AllocatedDiskSpace Integer = Null, -- Allocated Disk Space
	@InclLogo bit = 0, -- include Certificate Logo
	@PasswordLockout bit = 0,
	@TimeZoneID int = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

-- Declarations
Declare @strErrorMessage Varchar(200) -- Holds the error message
Declare @intErrorNumber Integer -- Holds the error number
Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.

-- Initialise variables
Set @strErrorMessage = ''''
Set @intErrorNumber = 0
Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''

-- Validation Routines
If(@actionUserID Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_Add''
Goto Finalise
End

If Not Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID <= @intUserTypeOrgAdmin)
Begin
Set @intErrorNumber = 6
Set @strErrorMessage = ''You do not have access to modify this Organisation.''
Goto Finalise
End

If(@organisationName Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @organisationName in stored procedure prcOrganisation_Add''
Goto Finalise
End

If Exists(Select * From tblOrganisation Where OrganisationName = @organisationName)
Begin
Set @intErrorNumber = 4
Set @strErrorMessage = ''The Organisation Name '' + @organisationName + '' already exists please choose another name for your Organisation.''
Goto Finalise
End

If(@notes Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @notes in stored procedure prcOrganisation_Add''
Goto Finalise
End

If(@logo Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @logo in stored procedure prcOrganisation_Add''
Goto Finalise
End

If(@lessonFrequency Is Null and @lessonCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @lessonFrequency, @lessonCompletionDate in stored procedure prcOrganisation_Add''
Goto Finalise
End

If(@quizFrequency Is Null and @quizCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizFrequency, @quizCompletionDate in stored procedure prcOrganisation_Add''
Goto Finalise
End

If(@quizPassMark Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizPassMark in stored procedure prcOrganisation_Add''
Goto Finalise
End

Insert Into tblOrganisation
(
	OrganisationName,
	Logo,
	DefaultLessonFrequency,
	DefaultQuizFrequency,
	DefaultQuizPassMark,
--	DefaultLessonCompletionDate, 
--	DefaultQuizCompletionDate, 
	advancedReporting,
	CreatedBy, 
	CPDReportName,
	AllocatedDiskSpace,
	IncludeCertificateLogo,
	PasswordLockout,
	TimeZoneID
)
Values
(
	@organisationName,
	@logo,
	@lessonFrequency,
	@quizFrequency,
	@quizPassMark,
--	@lessonCompletionDate, 
--	@quizCompletionDate, 
	@advancedReporting,
	@actionUserID,
	@CPDReportName,
	@AllocatedDiskSpace,
	@InclLogo,
	@PasswordLockout,
	@TimeZoneID
)


Select @intOrganisationID = @@Identity

-- lesson completion datetime to utc
set @lessonCompletionDate = dbo.udfDaylightSavingTimeToUtc (@lessonCompletionDate, @intOrganisationID)

-- quiz completion time to utc
set @quizCompletionDate = dbo.udfDaylightSavingTimeToUtc (@quizCompletionDate, @intOrganisationID)


--update the org with these utc dates
update 
	tblOrganisation 
set 
	DefaultLessonCompletionDate = @lessonCompletionDate,
	DefaultQuizCompletionDate = @quizCompletionDate
where
	OrganisationID =  @intOrganisationID



insert into tblOrganisationCPDAccess
(
OrganisationID,
GrantCPDAccess
)
values
(
@intOrganisationID,
0 -- no access initially
)

insert into tblOrganisationPolicyAccess
(
OrganisationID,
GrantPolicyAccess
)
values
(
@intOrganisationID,
0 -- no access initially
)

-- Add values to tblOrganisationNotes
Declare LangIDLOOP CURSOR
	for
	select LangID from tblLang
	
	open LangIDLOOP

	declare @LangID int

	FETCH NEXT from LangIDLOOP into @LangID
	while @@FETCH_STATUS = 0
	BEGIN

		insert into tblOrganisationNotes
		(
		OrganisationID,
		LanguageID,
		Notes
		)
		values
		(
		@intOrganisationID,
		@LangID,
		@notes
		)
		FETCH NEXT from LangIDLOOP into @LangID
	END
close LangIDLOOP
deallocate LangIDLOOP

Finalise:
If(@intErrorNumber > 0)
Begin
Rollback Transaction
Select
@intErrorNumber As ''ErrorNumber'',
@strErrorMessage As ''ErrorMessage''
End
Else
Begin
Commit Transaction
Select
@intErrorNumber As ''ErrorNumber'',
''Successfully Added'' As ''ErrorMessage''
End
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetAdminList]    Script Date: 06/08/2011 15:12:50 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetAdminList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetAdminList]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetAdminList]    Script Date: 06/08/2011 15:12:50 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetAdminList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*Summary:
	Gets a List of all the Administrators for a particular organisation.

Parameters:
	@organisationID

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	None

Author: Peter Vranich
Date Created: 12th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [dbo].[prcOrganisation_GetAdminList]
(
	@organisationID Integer = Null -- ID of the Organisation that you wish to get the Admins for.
)

As

Select
	UserID,
	FirstName,
	LastName,
	Email,
	OrganisationID,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @organisationID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID)
From
	tblUser
Where
	((OrganisationID = @organisationID)
		And (UserTypeID = 2)
		And (Active = 1))
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetCourseAccessList]    Script Date: 06/08/2011 15:14:11 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetCourseAccessList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetCourseAccessList]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetCourseAccessList]    Script Date: 06/08/2011 15:14:11 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetCourseAccessList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary:
	Gets a list of all Courses and flags which one the organisation has access to.

Parameters:
	@organisationID Integer

Returns: 
	CourseID
	Name
	Notes
	Active
	Granted
	CreatedBy
	DateCreated
	UpdatedBy
	DateUpdated

Called By:
	Course.cs
Calls: None

Remarks: None

Author: Peter Vranich
Date Created: 19th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcOrganisation_GetCourseAccessList]
(
	@organisationID Integer -- The ID of the organisation that you wish to get the course access list for.
)

As

Set NoCount On

Select
	CourseID, 
	Name, 
	Notes, 
	Active,
	Case
		When toca.GrantedCourseID Is Not Null Then 1
		Else 0
	End As Granted,
	CreatedBy, 
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @organisationID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID)
From 
	tblCourse As tc
	Left Outer Join tblOrganisationCourseAccess As toca
		On tc.CourseID = toca.GrantedCourseID
			And toca.OrganisationID = @organisationID
Order By
	Name


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetList]    Script Date: 06/08/2011 15:16:35 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetList]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetList]    Script Date: 06/08/2011 15:16:35 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets a list of all Organisation
Parameters: None
Returns: OrganisationID, OrganisationName,  Logo, Notes, DefaultLessonFrequency, DefaultQuizFrequency, DefaultQuizPassMark, CreatedBy, DateCreated,  UpdatedBy, DateUpdated
		
Called By: Header.ascx
Calls: None

Remarks: None

Author: Peter Vranich
Date Created: 28th of January 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcOrganisation_GetList]

As

Select
	OrganisationID,
	OrganisationName,
	Logo,
	Notes,
	DefaultLessonFrequency,
	DefaultQuizFrequency,
	DefaultQuizPassMark,
	dbo.udfUTCtoDaylightSavingTime(DefaultLessonCompletionDate, OrganisationID), 
	dbo.udfUTCtoDaylightSavingTime(DefaultQuizCompletionDate, OrganisationID), 
	DomainName,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID)
From
	tblOrganisation
order by OrganisationName


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/08/2011 15:20:17 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/08/2011 15:20:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets othe details of one Organisation
Parameters: @orgID integer
Returns: OrganisationID, OrganisationName,  Logo, Notes, DefaultLessonFrequency, DefaultQuizFrequency, DefaultQuizPassMark, CreatedBy, DateCreated,  UpdatedBy, DateUpdated

Called By: Organisation.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Peter Vranich
Date Created: 4th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	aaronc		May 2008		Added retrieval of CPDReportName
#2	aaronc		June2008		Added retrieval of AllocatedDiskSpace
*/

CREATE procedure [dbo].[prcOrganisation_GetOne]
(
@LangCode nvarchar(10),
@orgID Integer = null -- OrganisationID
)

As

If @orgID Is Null
Begin
Raiserror(''The Parameter @orgID was null.  @orgID does not accept Null values.'', 16, 1)
Return
End

Select
o.OrganisationID,
o.OrganisationName,
o.Logo,
orgN.Notes,
o.DefaultLessonFrequency,
o.DefaultQuizFrequency,
o.DefaultQuizPassMark,
dbo.udfUTCtoDaylightSavingTime(o.DefaultLessonCompletionDate, o.OrganisationID),
dbo.udfUTCtoDaylightSavingTime(o.DefaultQuizCompletionDate, o.OrganisationID),
o.AdvancedReporting,
o.CreatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateCreated, o.OrganisationID),
o.UpdatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateUpdated, o.OrganisationID),
o.CPDReportName,
o.AllocatedDiskSpace,
o.IncludeCertificateLogo,
o.PasswordLockout,
o.TimeZoneID
From
tblOrganisation o
left join tblOrganisationNotes orgN
on o.OrganisationID = orgN.OrganisationID
left join tblLang l
on orgN.LanguageID = l.LangID
Where
o.OrganisationID = @orgID
and l.LangCode = @LangCode
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetProfiles]    Script Date: 06/08/2011 15:57:20 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetProfiles]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetProfiles]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetProfiles]    Script Date: 06/08/2011 15:57:20 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetProfiles]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Get''s a list of profiles for an organisation

Parameters:
	@OrganisationID int,

Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: June 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcOrganisation_GetProfiles]
(
	@OrganisationID int
)
as

select
	pro.profileid,
	propd.profileperiodid, 
	pro.profilename,
	dbo.udfUTCtoDaylightSavingTime(propd.datestart, @OrganisationID),
	dbo.udfUTCtoDaylightSavingTime(propd.dateend, @OrganisationID),
	dbo.udfUTCtoDaylightSavingTime(propd.futuredatestart, @OrganisationID),
	dbo.udfUTCtoDaylightSavingTime(propd.futuredateend, @OrganisationID),
	case when ((propd.datestart < GETUTCDATE()) and (GETUTCDATE() < dateadd(hh,24,propd.dateend))) then ''Enabled'' else ''Disabled'' end [ProfileStatus]
from 
	tblProfile pro
	left join tblProfilePeriod propd on pro.profileid = propd.profileid
where
	pro.organisationid = @OrganisationID
	and (profileperiodactive = 1)
order by 
	pro.profilename

' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOrganisation_GetUsers]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_GetUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Gets a list of all users that are not organisation administrators for the specified organisation.

Parameters:
	@organisationID Integer	
	@firstName Varchar(50) = ''''
	@lastname Varchar(50) = ''''

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:

Author: Peter Vranich
Date Created: 17th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE    Procedure [prcOrganisation_GetUsers]
(
	@organisationID Integer = Null, -- ID of the Organisation to get the users from.
	@firstName nVarchar(50) = '''', -- First name of the user(s) to search for.
	@lastname nVarchar(50) = '''' -- Last name of the user(s) to search for.
)

As

Set NoCount On

-- Declarations
Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.

-- Initialisation
Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''

If(@firstName Is Null)
Begin
	Set @firstName = ''''
End

If(@lastName Is Null)
Begin
	Set @lastName = ''''
End


Select
	UserID,
	FirstName,
	LastName,
	Email,
	OrganisationID,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated
From
	tblUser
Where
	((OrganisationID = @organisationID)
		And (FirstName Like ''%'' + @firstName + ''%'')
		And (LastName Like ''%'' + @lastName + ''%'')
		And (UserTypeID > @intUserTypeOrgAdmin)
		And (UnitID Is Not Null)
		And (Active = 1))
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_RemoveAdmin]    Script Date: 06/08/2011 16:05:48 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_RemoveAdmin]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_RemoveAdmin]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_RemoveAdmin]    Script Date: 06/08/2011 16:05:48 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_RemoveAdmin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*Summary:
	Updates the specified Organisation Administrator to be a SALT User.

Parameters:
	@updateUserID Integer
	@actionUserID Integer
	@organisationID Integer
	@originalDateUpdated DateTime

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	6. PermissionDeniedException
	10. BusinessServiceException (General)

Author: Peter Vranich
Date Created: 13th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [dbo].[prcOrganisation_RemoveAdmin]
(
	@updateUserID Integer = Null, -- ID of the User that you wish to set Admin rights for.
	@actionUserID Integer = Null, -- ID of the User that is making the changes.
	@organisationID Integer = Null, -- ID of the Organisation that this user must belong to.
	@originalDateUpdated DateTime -- original Date of the record.
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

 set @originalDateUpdated = dbo.udfDaylightSavingTimeToUTC(@originalDateUpdated, @organisationID)

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @intUserTypeUser Integer -- Holds the value for the User UserTypeID from the tblUserType table.
	Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.
	Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0
	Select @intUserTypeUser = UserTypeID From tblUserType Where Type = ''User''
	Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''
	Select @dtCurrentDateUpdated = DateUpdated From tblUser Where UserID = @updateUserID
	
	-- Validation Routines
	If(@updateUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If Not Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID <= @intUserTypeOrgAdmin)
	Begin
		Set @intErrorNumber = 6
		Set @strErrorMessage = ''You do not have access to modify this User.  Click here to return to the login page.''
		Goto Finalise
	End
	
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@originalDateUpdated != @dtCurrentDateUpdated)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''The user''''s details have been updated by another user, you will need to refresh the users details and re-enter your changes.  Click here to refresh.''
		Goto Finalise
	End

	If Exists(Select * From tblUser Where UserID = @updateUserID)
	Begin
		Update tblUser
		Set
			UserTypeID = @intUserTypeUser
		Where
			UserID = @updateUserID
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''Record not found @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End



' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_RemoveAdministrator]    Script Date: 06/08/2011 16:26:29 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_RemoveAdministrator]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_RemoveAdministrator]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_RemoveAdministrator]    Script Date: 06/08/2011 16:26:29 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_RemoveAdministrator]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




/*Summary:
	Updates the specified Organisation Administrator to be a SALT User.

Parameters:
	@updateUserID Integer
	@actionUserID Integer
	@organisationID Integer
	@originalDateUpdated DateTime

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	6. PermissionDeniedException
	7. IntegrityViolationException
	10. BusinessServiceException (General)

Author: Peter Vranich
Date Created: 13th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE  Procedure [dbo].[prcOrganisation_RemoveAdministrator]
(
	@updateUserID Integer = Null, -- ID of the User that you wish to set Admin rights for.
	@actionUserID Integer = Null, -- ID of the User that is making the changes.
	@organisationID Integer = Null, -- ID of the Organisation that this user must belong to.
	@originalDateUpdated DateTime -- original Date of the record.
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

set @originalDateUpdated = dbo.udfDaylightSavingTimeToUTC(@originalDateUpdated, @organisationID)

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @intUserTypeUser Integer -- Holds the value for the User UserTypeID from the tblUserType table.
	Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.
	Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0
	Select @intUserTypeUser = UserTypeID From tblUserType Where Type = ''User''
	Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''
	Select @dtCurrentDateUpdated = DateUpdated From tblUser Where UserID = @updateUserID
	
	-- Validation Routines
	If(@updateUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If Not Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID <= @intUserTypeOrgAdmin)
	Begin
		Set @intErrorNumber = 6
		Set @strErrorMessage = ''You do not have access to modify this User.  Click here to return to the login page.''
		Goto Finalise
	End
	
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@originalDateUpdated != @dtCurrentDateUpdated)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''The user''''s details have been updated by another user, you will need to refresh the users details and re-enter your changes.  Click here to refresh.''
		Goto Finalise
	End

	If Exists(Select * From tblUser Where UserID = @updateUserID)
	Begin
		Update tblUser
		Set
			UserTypeID = @intUserTypeUser
		Where
			UserID = @updateUserID
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''Record not found @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End





' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_SetAdmin]    Script Date: 06/08/2011 16:28:32 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_SetAdmin]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_SetAdmin]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_SetAdmin]    Script Date: 06/08/2011 16:28:32 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_SetAdmin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	Sets a new Organisation Administrator.

Parameters:
	@updateUserID Integer
	@actionUserID Integer
	@organisationID Integer
	@originalDateUpdated Integer

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	6. PermissionDeniedException
	10. BusinessServiceException (General)

Author: Peter Vranich
Date Created: 13th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE  Procedure [dbo].[prcOrganisation_SetAdmin]
(
	@updateUserID Integer = Null, -- ID of the User that you wish to set Admin rights for.
	@actionUserID Integer = Null, -- ID of the User that is making the changes.
	@organisationID Integer = Null, -- ID of the Organisation that this user must belong to.
	@originalDateUpdated Integer -- original Date of the record.
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

set @originalDateUpdated = cast(dbo.udfDaylightSavingTimeToUTC(@originalDateUpdated, @organisationID) as integer)

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.
	Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0
	Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''
	Select @dtCurrentDateUpdated = dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID) From tblUser Where UserID = @updateUserID
	
	-- Validation Routines
	If(@updateUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID = @intUserTypeOrgAdmin)
	Begin
		Set @intErrorNumber = 6
		Set @strErrorMessage = ''You do not have access to modify this User.  Click here to return to the login page.''
		Goto Finalise
	End
	
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
	If(@originalDateUpdated != @dtCurrentDateUpdated)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''The user''''s details have been updated by another user, you will need to refresh the users details and re-enter your changes.  Click here to refresh.''
		Goto Finalise
	End
	
	If Exists(Select * From tblUser Where UserID = @updateUserID)
	Begin
		Update tblUser
		Set
			UserTypeID = @intUserTypeOrgAdmin
		Where
			UserID = @updateUserID
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''Record not found @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End


' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_SetAdministrator]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcOrganisation_SetAdministrator]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcOrganisation_SetAdministrator]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Sets a new Organisation Administrator.

Parameters:
	@updateUserID Integer
	@actionUserID Integer
	@organisationID Integer
	@originalDateUpdated Integer

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	6. PermissionDeniedException
	7. IntegrityViolationException
	10. BusinessServiceException (General)

Author: Peter Vranich
Date Created: 13th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE Procedure [prcOrganisation_SetAdministrator]
(
	@updateUserID Integer, -- ID of the User that you wish to set Admin rights for.
	@actionUserID Integer, -- ID of the User that is making the changes.
	@organisationID Integer, -- ID of the Organisation that this user must belong to.
	@originalDateUpdated DateTime -- original Date of the record.
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

set @originalDateUpdated = dbo.udfDaylightSavingTimeToUTC(@originalDateUpdated, @organisationID) 

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number

	declare @intActionUserTypeID integer
	Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	--Select @dtCurrentDateUpdated = dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID) From tblUser Where UserID = @updateUserID
	Select @dtCurrentDateUpdated = DateUpdated From tblUser Where UserID = @updateUserID
	
	-- Validation Routines
	If(@updateUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdministrator''
		Goto Finalise
	End
	
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdministrator''
		Goto Finalise
	End
	
	select @intActionUserTypeID =UserTypeID
	from tblUser
	where UserID = @actionUserID

	--if action user is not  Salt Administrator(1) or Org Administrator
	If (@intActionUserTypeID>2)
	Begin
		Set @intErrorNumber = 6
		Set @strErrorMessage = ''You do not have access to modify this User.  Click here to return to the login page.''
		Goto Finalise
	End
	
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcOrganisation_SetAdministrator''
		Goto Finalise
	End
	
	If(@originalDateUpdated != @dtCurrentDateUpdated)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''The user''''s details have been updated by another user, you will need to refresh the users details and re-enter your changes.  Click here to refresh.''
		Goto Finalise
	End
	
	If Exists(Select * From tblUser Where UserID = @updateUserID)
	Begin
		Update tblUser
		Set
			UserTypeID = 2, -- Org admin
			DateUpdated = GETUTCDATE()
		Where
			UserID = @updateUserID
		
		delete 
		from tblUnitAdministrator
		where userID = @updateUserID
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''Record not found @userID in stored procedure prcOrganisation_SetAdmin''
		Goto Finalise
	End
	
Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO






/****** Object:  StoredProcedure [dbo].[prcOrganisation_Update]    Script Date: 06/08/2011 16:37:25 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_Update]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_Update]    Script Date: 06/08/2011 16:37:25 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[prcOrganisation_Update] (
@LangCode nvarchar(10),
@organisationID Integer = Null, -- ID of the organisation to update.
@organisationName nVarChar(50) = Null, -- The name of the organisation.
@notes nVarChar(4000) = Null, -- The notes for the organisation.
@logo VarChar(100) = Null, -- The name of the organisation logo image.
@lessonFrequency Integer = Null, -- Default Lesson frequency for the organisation.
@quizFrequency Integer = Null, -- Default Quiz frequency for the organisation.
@quizPassMark Integer = Null, -- Default Quiz pass mark for the organisation.
@lessonCompletionDate DateTime = Null, -- Default Lesson completion date
@quizCompletionDate DateTime = Null, -- Default Quiz completion date
@advancedReporting bit = 0,
@actionUserID Integer = Null, -- ID of the User that is making the changes.
@originalDateUpdated DateTime, -- original Date of the record.
@CPDReportName nvarchar(255) = Null, -- CPD Report Name
@AllocatedDiskSpace int = Null,
@inclLogo bit = 0,	-- include certificate logo
@PasswordLockout bit,
@TimeZoneID int = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

set @lessonCompletionDate = dbo.udfDaylightSavingTimeToUTC(@lessonCompletionDate, @organisationID)
set @quizCompletionDate = dbo.udfDaylightSavingTimeToUTC(@quizCompletionDate, @organisationID)
set @originalDateUpdated = dbo.udfDaylightSavingTimeToUTC(@originalDateUpdated, @organisationID)

-- Declarations
Declare @strErrorMessage Varchar(200) -- Holds the error message
Declare @intErrorNumber Integer -- Holds the error number
Declare @intUserTypeOrgAdmin Integer -- Holds the value for the OrgAdmin UserTypeID from the tblUserType table.
Declare @dtCurrentDateUpdated DateTime -- Holds the current date updated date.

-- Initialise variables
Set @strErrorMessage = ''''
Set @intErrorNumber = 0
Select @intUserTypeOrgAdmin = UserTypeID From tblUserType Where Type = ''Organisation Administrator''
Select @dtCurrentDateUpdated = DateUpdated From tblOrganisation Where OrganisationID = @organisationID

-- Validation Routines
If(@actionUserID Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If Not Exists(Select * From tblUser Where UserID = @actionUserID And UserTypeID <= @intUserTypeOrgAdmin)
Begin
Set @intErrorNumber = 6
Set @strErrorMessage = ''You do not have access to modify this Organisation.''
Goto Finalise
End

If(@organisationID Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@organisationName Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @organisationName in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If Exists(Select * From tblOrganisation Where OrganisationName = @organisationName And OrganisationID != @organisationID)
Begin
Set @intErrorNumber = 4
Set @strErrorMessage = ''The Organisation Name '' + @organisationName + '' already exists please choose another name for your Organisation.''
Goto Finalise
End

If(@notes Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @notes in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@logo Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @logo in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@lessonFrequency Is Null and @lessonCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @lessonFrequency, @lessonCompletionDate in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@quizFrequency Is Null and @quizCompletionDate Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizFrequency, @quizCompletionDate in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@quizPassMark Is Null)
Begin
Set @intErrorNumber = 5
Set @strErrorMessage = ''Missing or Null parameter @quizPassMark in stored procedure  prcOrganisation_Update''
Goto Finalise
End

If(@originalDateUpdated != @dtCurrentDateUpdated)
Begin
Set @intErrorNumber = 7
Set @strErrorMessage = ''The organisation''''s details have been updated by another user, you will need to refresh the organisation''''s details and re-enter your changes.  Click here to refresh.''
Goto Finalise
End

If Exists(Select * From tblOrganisation Where OrganisationID = @organisationID)
Begin
Update tblOrganisation
Set
OrganisationName = @organisationName,
Logo = @logo,
DefaultLessonFrequency = @lessonFrequency,
DefaultQuizFrequency = @quizFrequency,
DefaultQuizPassMark = @quizPassMark,
DefaultLessonCompletionDate = @lessonCompletionDate,
DefaultQuizCompletionDate = @quizCompletionDate,
advancedReporting = IsNull(@advancedReporting,advancedReporting),
UpdatedBy = @actionUserID,
DateUpdated = GETUTCDATE(),
CPDReportName = @CPDReportName,
AllocatedDiskSpace = @AllocatedDiskSpace,
IncludeCertificateLogo = @inclLogo,
PasswordLockout = @PasswordLockout,
TimeZoneID = @TimeZoneID
Where
OrganisationID = @organisationID

update tblOrganisationNotes
set
Notes = @notes
where OrganisationID = @OrganisationID
and LanguageID = (select LangID from tblLang where LangCode = @LangCode)
End
Else
Begin
Set @intErrorNumber = 1
Set @strErrorMessage = ''Record not found in stored procedure prcOrganisation_Update''
Goto Finalise
End

Finalise:
If(@intErrorNumber > 0)
Begin
Rollback Transaction
Select
@intErrorNumber As ''ErrorNumber'',
@strErrorMessage As ''ErrorMessage''
End
Else
Begin
Commit Transaction
Select
@intErrorNumber As ''ErrorNumber'',
''Successfully Updated'' As ''ErrorMessage''
End


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_AdminMashup]    Script Date: 06/08/2011 18:18:43 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_AdminMashup]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_AdminMashup]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_AdminMashup]    Script Date: 06/08/2011 18:18:43 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_AdminMashup]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary:		Compiles a bunch of info based on the selected units/policies then filters it based on administrator selection
Parameters:		Comma separated list of userID:policyID, comma separated list of adminID (unit administrators)
Returns:		table (lastname firstname userid email policy_names)
		
Called By:		BusinessServices.policy.GetAdminMashup in policy.cs
Calls:			None

Remarks:		None

Author:			Mark Donald
Date Created:	20 Jan 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcPolicy_AdminMashup]
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@policyIDs 			varchar(8000),
	@input_csv varchar(8000),
	@adminids varchar(8000),
	@classificationID 	int,
	@policyStatus	int,
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@includeInactive	int
AS
BEGIN
	SET NOCOUNT ON;

--*********

set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @organisationID)
set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @organisationID)

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_NOT_ACCEPTED     int,
	@CONST_ACCEPTED     	int,
	@CONST_UNKNOWN          int


	set @CONST_NOT_ACCEPTED	= 0
	set @CONST_ACCEPTED	    = 1
	set @CONST_UNKNOWN		= 2


	DECLARE @Units TABLE (UnitID INT)
	DECLARE @policies TABLE (policyID INT)
	DECLARE @policiesWithAccess TABLE (policyID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @mashup TABLE (userid int, policyid int)
	DECLARE @selectedadmin TABLE (adminid int)
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50)

	INSERT INTO
		@policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policyIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

INSERT INTO
		@selectedadmin
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@adminids)

	if @policyStatus = @CONST_ACCEPTED
	BEGIN
		SELECT

		untadm.UserID, usr.Email, adm.FirstName, adm.LastName, pol.policyID, pol.PolicyName, usr.FirstName, usr.LastName 
			FROM
				@policies ps 
				INNER JOIN tblPolicy pol ON ps.policyID = pol.policyID 
				INNER JOIN tblUserPolicyAccepted polacp ON polacp.policyID = pol.policyID AND polacp.Accepted = ''True'' AND COALESCE(polacp.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom AND COALESCE(polacp.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo
				INNER JOIN tblUserPolicyAccess polacs ON polacs.policyID = pol.policyID AND polacs.Granted = ''True'' AND polacp.userID = polacs.userID
				INNER JOIN tblUser usr ON usr.userID = polacp.userID
				INNER JOIN tblUnitAdministrator untadm ON untadm.UnitID = usr.UserID
				INNER JOIN tblUser adm ON adm.UserID = untadm.UserID
				WHERE pol.organisationID = @organisationID;
	END
	else
	BEGIN
		SELECT

		untadm.UserID, usr.Email, adm.FirstName, adm.LastName, pol.policyID, pol.PolicyName, usr.FirstName, usr.LastName 
			FROM
				@policies ps 
				INNER JOIN tblPolicy pol ON ps.policyID = pol.policyID 
				INNER JOIN tblUserPolicyAccepted polacp ON polacp.policyID = pol.policyID AND polacp.Accepted = ''False'' 
				INNER JOIN tblUserPolicyAccess polacs ON polacs.policyID = pol.policyID AND polacs.Granted = ''True'' AND polacp.userID = polacs.userID
				INNER JOIN tblUser usr ON usr.userID = polacp.userID
				INNER JOIN tblUnitAdministrator untadm ON untadm.UnitID = usr.UserID
				INNER JOIN tblUser adm ON adm.UserID = untadm.UserID
				WHERE pol.organisationID = @organisationID;
				
	END
			
END




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_Get]    Script Date: 06/08/2011 18:31:16 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_Get]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_Get]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_Get]    Script Date: 06/08/2011 18:31:16 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_Get]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Gets a policy

Parameters:
	@PolicyID int,

Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: June 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcPolicy_Get]
(
	@PolicyID int,
	@OrgID int
)
as

select 
PolicyID,
OrganisationID, 
PolicyName, 
Active,
Deleted,
PolicyFileName,
PolicyFileSize,
dbo.udfUTCtoDaylightSavingTime(UploadDate, @OrgID),
ConfirmationMessage
from tblPolicy
where 
PolicyID = @PolicyID
and deleted = 0


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]    Script Date: 06/08/2011 18:34:02 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]    Script Date: 06/08/2011 18:34:02 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*
Summary:		Mainly just returns a list of unit admins that meet the flagged conditions

Parameters:		Comma separated list of userID:courseID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.GetAdminsInOrgPendingPolicy in Policy.cs
Calls:			None

Remarks:		None

Author:			John H
Date Created:	21 MAy 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]
	@policy_ids varchar(8000),
	@unit_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@OrgIDUTC int
AS
BEGIN
	SET NOCOUNT ON;

set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @OrgIDUTC)
set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @OrgIDUTC)

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_units TABLE (unitid int)
	DECLARE @result TABLE (firstname nvarchar(50), lastname nvarchar(50), userid int, email nvarchar(100), new_policy_names varchar(8000), modified_policy_names varchar(8000), HierarchyName nvarchar(500))
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@userid int, @admid int,
		@new_policy_names varchar(8000),
		@users_with_policies varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5),
		@aunit int,@orgID int

	IF @accepted = ''0''
	BEGIN
		SELECT @strAccepted = ''True''
	END
	ELSE
	BEGIN
		SELECT @strAccepted = ''False''
	END

	
	
	-- rip the unit selection
	INSERT INTO @selected_units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unit_ids)

	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''
	SELECT @aunit = (SELECT TOP (1) unitid FROM @selected_units)
	SELECT @orgID = OrganisationID FROM tblUnit WHERE tblUnit.UnitID = @aunit

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)



--	SELECT DISTINCT adm.UserID, hier.HierarchyName, adm.LastName, adm.FirstName,  adm.email, '''',''''
	SELECT DISTINCT adm.UserID, unt.Name as HierarchyName, adm.LastName, adm.FirstName,  adm.email, '''',''''
		FROM
			@policies pols 
			INNER JOIN tblUserPolicyAccess polacs ON polacs.policyid = pols.policyid AND polacs.granted = ''True''
			INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted 
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))
			INNER JOIN tblUser usr ON usr.userid = polacs.userid AND usr.userid = polacd.userid AND usr.active = ''True'' 
			INNER JOIN @selected_units su ON usr.unitid = su.unitid
			INNER JOIN udf_GetAdminEmailsForORG(@orgID) uadm ON uadm.UnitID = su.unitid  
			INNER JOIN tblUnitHierarchy hier ON hier.UnitID = usr.UnitID 
			INNER JOIN tblUnit unt ON unt.UnitID = usr.UnitID 
			INNER JOIN tblUser adm ON adm.userid = uadm.userid 
		WHERE NOT EXISTS
	(SELECT *
		FROM
			@policies Spols 
			INNER JOIN tblUserPolicyAccess Spolacs ON Spolacs.policyid = Spols.policyid AND Spolacs.granted = ''True''
			INNER JOIN tblUserPolicyAccepted Spolacd ON Spolacd.policyid = Spols.policyid AND Spolacd.Accepted = @strAccepted 
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))
			INNER JOIN tblUser Susr ON Susr.userid = Spolacs.userid AND Susr.userid = Spolacd.userid AND Susr.active = ''True'' 
			INNER JOIN @selected_units Ssu ON Susr.unitid = Ssu.unitid
			INNER JOIN udf_GetAdminEmailsForORG(@orgID) Suadm ON Suadm.UnitID = Ssu.unitid  
     		INNER JOIN tblUnitHierarchy Shier ON Shier.UnitID = Susr.UnitID 
			INNER JOIN tblUnit Sunt ON Sunt.UnitID = Susr.UnitID 
			INNER JOIN tblUser Sadm ON Sadm.userid = Suadm.userid and Sadm.UserID = adm.UserID
			WHERE (hier.hierarchy LIKE Shier.hierarchy+'',%'') )

 



END




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_GetListByOrganisation]    Script Date: 06/08/2011 18:36:06 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetListByOrganisation]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_GetListByOrganisation]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetListByOrganisation]    Script Date: 06/08/2011 18:36:06 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetListByOrganisation]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets a list of all Policies assigned within the Organisation
Parameters: @organisationID  int -- The organisation ID
Returns: 
		
Called By: BusinessServices.Policy.GetPolicyListAccessableToOrg
Calls: None

Remarks: Cut and Paste of course SP

Author: John R
Date Created: 17th of May 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE     Procedure [dbo].[prcPolicy_GetListByOrganisation]
(
	@organisationID  int -- The organisation ID

)

As

-------------------------------------------------------------
-- Return Select
-------------------------------------------------------------
Select
	p.[PolicyID]
	, p.[PolicyName]
	, dbo.udfUTCtoDaylightSavingTime(p.[UploadDate], @organisationID)
 
From 
	[tblPolicy] p
WHERE     (p.Active = ''True'') AND (p.Deleted = ''False'')
			and p.organisationID = @organisationID
order by p.PolicyName







' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_GetPoliciesAssignedToUsers]    Script Date: 06/08/2011 18:37:56 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetPoliciesAssignedToUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_GetPoliciesAssignedToUsers]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetPoliciesAssignedToUsers]    Script Date: 06/08/2011 18:37:56 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetPoliciesAssignedToUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*
Summary:		Compiles a %POLICY_NAMES% block and returns it with a bunch of user info for sending email to that user
				(Mainly just returns a list of users and the policies that they are assigned to (that meet the flagged conditions))

Parameters:		Comma separated list of userID:courseID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.prcPolicy_GetUsersByPolicyAndUnit in Policy.cs
Calls:			None

Remarks:		None

Author:			Mark Donald (John R copied prcCourse_UserMashup - no optimising attempted as execution time expected to be small)
Date Created:	13 Nov 2009 (copied 18/05/2010)

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcPolicy_GetPoliciesAssignedToUsers]
	@policy_ids varchar(8000),
	@user_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@OrgID int
AS

BEGIN
	SET NOCOUNT ON;

set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @OrgID)
set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @OrgID)

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_users TABLE (userid int)
	DECLARE @result TABLE (firstname nvarchar(50), lastname nvarchar(50), userid int, email nvarchar(100), new_policy_names varchar(8000), modified_policy_names varchar(8000), HierarchyName nvarchar(500))
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@userid int,
		@new_policy_names varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5)



	IF @accepted = ''0''
	BEGIN
		SELECT @strAccepted = ''True''
	END
	ELSE
	BEGIN
		SELECT @strAccepted = ''False''
	END

	
	
	-- rip the user selection
	INSERT INTO @selected_users
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@user_ids)

	-- clean up the input so it resembles ''userid:policyid,userid:policyid,''
	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)
	-- Note to self: String operations take hundreds of times longer than cursor operations so first think of a way to limit the number of string operations, then get rid of the cursors.
	SELECT @new_policy_names = ''''
	SELECT @modified_policy_names = ''''
	DECLARE concatenator CURSOR READ_ONLY FOR
		SELECT DISTINCT
			userid
			FROM
				@selected_users 
	OPEN concatenator
	FETCH NEXT FROM concatenator INTO @userid
	WHILE @@FETCH_STATUS = 0
		BEGIN
			SELECT
				@new_policy_names = @new_policy_names + [PolicyName] + char(13) + char(10) + char(9)
				FROM
					tblpolicy pol 
					INNER JOIN @policies pols ON	pol.policyid = pols.policyid
					INNER JOIN tblUserPolicyAccess polacc ON polacc.policyid = pol.policyid AND polacc.granted = ''True'' AND polacc.userid = @userid
					INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted AND polacd.userid = @userid  
AND (
		((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))
					INNER JOIN tblUser usr ON usr.userid = polacc.userid AND usr.active = ''True'' AND usr.userid = @userid

			SELECT @new_policy_names = substring(@new_policy_names, 1, len(@new_policy_names) - 3)

			INSERT INTO
				@result
				SELECT
					usr.firstname, usr.lastname, usr.userid, usr.email, @new_policy_names, @modified_policy_names, hier.HierarchyName
					FROM
						tbluser usr
						INNER JOIN tblUnitHierarchy hier ON hier.UnitID = usr.UnitID 
					WHERE
						userid = @userid
			SELECT @new_policy_names = ''''
			SELECT @modified_policy_names = ''''
			FETCH NEXT FROM concatenator INTO @userid
		END
	CLOSE concatenator
	DEALLOCATE concatenator


	--Get Data in report format
	SELECT 
		DISTINCT UserID, HierarchyName, LastName, FirstName,  email, new_policy_names, modified_policy_names 

 FROM @result
END




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_GetPoliciesInUnit]    Script Date: 06/08/2011 18:40:17 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetPoliciesInUnit]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_GetPoliciesInUnit]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetPoliciesInUnit]    Script Date: 06/08/2011 18:40:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetPoliciesInUnit]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*
Summary:		Compiles a %POLICY_NAMES% block and returns it with a bunch of user info for sending email to that user
				(Mainly just returns a list of policies that are assigned to users that meet the flagged conditions)
Parameters:		Comma separated list of userID:courseID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.prcPolicy_GetUsersByPolicyAndUnit in Policy.cs
Calls:			None

Remarks:		None

Author:			Mark Donald (John R copied prcCourse_UserMashup - no optimising attempted as execution time expected to be small)
Date Created:	13 Nov 2009 (copied 18/05/2010)

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcPolicy_GetPoliciesInUnit]
	@policy_ids varchar(8000),
	@unit_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@OrgID int
AS
BEGIN
	SET NOCOUNT ON;

set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @OrgID)
set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @OrgID)

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_units TABLE (unitid int)
	DECLARE @result TABLE (policy_names varchar(8000))
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@userid int,
		@policy_names varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5)



	IF @accepted = ''0''
	BEGIN
		SELECT @strAccepted = ''True''
	END
	ELSE
	BEGIN
		SELECT @strAccepted = ''False''
	END

	
	
	-- rip the user selection
	INSERT INTO @selected_units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unit_ids)

	-- clean up the input so it resembles ''userid:policyid,userid:policyid,''
	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)
	-- Note to self: String operations take hundreds of times longer than cursor operations so first think of a way to limit the number of string operations, then get rid of the cursors.


	SELECT DISTINCT pol.PolicyName
		FROM
			@policies pols 
			INNER JOIN tblPolicy pol ON pol.PolicyID = pols.PolicyID
			INNER JOIN tblUserPolicyAccess polacs ON polacs.policyid = pols.policyid AND polacs.granted = ''True''
			INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))

			INNER JOIN tblUser usr ON usr.userid = polacs.userid AND usr.userid = polacd.userid AND usr.active = ''True'' 
			INNER JOIN @selected_units su ON usr.unitid = su.unitid 
END




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcPolicy_GetUserAndPoliciesForAdmins]    Script Date: 06/08/2011 18:42:11 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetUserAndPoliciesForAdmins]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcPolicy_GetUserAndPoliciesForAdmins]
GO

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetUserAndPoliciesForAdmins]    Script Date: 06/08/2011 18:42:11 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcPolicy_GetUserAndPoliciesForAdmins]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary:		Compiles a %USER-POLICY_NAMES% block and returns it with a bunch of user info for sending email to that user
			

Parameters:		Comma separated list of adminuserID,policyID,unitID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.GetUserAndPoliciesForAdmins in Policy.cs
Calls:			None

Remarks:		None

Author:			John H
Date Created:	21 May 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [dbo].[prcPolicy_GetUserAndPoliciesForAdmins]
	@admin_ids varchar(8000),
	@policy_ids varchar(8000),
	@unit_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime,
	@OrgIDUTC int
AS
BEGIN
	SET NOCOUNT ON;

set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @OrgIDUTC)
set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @OrgIDUTC)

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_units TABLE (unitid int)
	DECLARE @selected_admins TABLE (userid int)
	DECLARE @result TABLE (firstname nvarchar(50), policyname nvarchar(50), userid int, email nvarchar(100), user_list varchar(8000), PolicyID int, HierarchyName nvarchar(500))
					
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@admid int , @PolicyID int,
		@PolicyName varchar(8000),
		@user_list varchar(8000),
		@users_with_policies varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5),
		@aunit int,@orgID int


	IF @accepted = ''0''
	BEGIN
		SELECT @strAccepted = ''True''
	END
	ELSE
	BEGIN
		SELECT @strAccepted = ''False''
	END

	
	
	-- rip the unit selection
	INSERT INTO @selected_units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unit_ids)

	SELECT @aunit = (SELECT TOP (1) unitid FROM @selected_units)
	SELECT @orgID = OrganisationID FROM tblUnit WHERE tblUnit.UnitID = @aunit

	-- rip the admin selection
	INSERT INTO @selected_admins
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@admin_ids)




	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)
	-- Note to self: String operations take hundreds of times longer than cursor operations so first think of a way to limit the number of string operations, then get rid of the cursors.

	SELECT @user_list = ''''
	DECLARE concatenator CURSOR READ_ONLY FOR
		SELECT DISTINCT
			uadm.userid , pol.PolicyName, pol.policyid
			FROM
				tblpolicy pol 
				INNER JOIN @policies pols ON pol.policyid = pols.policyid
				INNER JOIN tblUserPolicyAccess polacc ON polacc.policyid = pol.policyid AND polacc.granted = ''True''
				INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))

				INNER JOIN tblUser u ON u.userid = polacc.userid AND u.userid = polacd.userid AND u.active = ''True'' 
				INNER JOIN udf_GetAdminEmailsForORG(@orgID) uadm ON u.UnitID = uadm.unitid 
				INNER JOIN tblUnitHierarchy hier ON hier.UnitID = u.UnitID 
				INNER JOIN @selected_units su ON su.unitID = u.unitid 
				INNER JOIN @selected_admins sa on sa.userid = uadm.userid
			ORDER BY uadm.userid 
	OPEN concatenator
	FETCH NEXT FROM concatenator INTO @admID , @policyName, @PolicyID
	WHILE @@FETCH_STATUS = 0
		BEGIN
			SELECT @user_list = COALESCE(@user_list,'''') +  char(13) + char(10) + char(9)  + u.FirstName + '' '' + u.LastName 
				FROM
				tblpolicy pol 
				INNER JOIN @policies pols ON pol.policyid = pols.policyid AND pol.policyid = @PolicyID
				INNER JOIN tblUserPolicyAccess polacc ON polacc.policyid = pol.policyid AND polacc.granted = ''True''
				INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))

				INNER JOIN tblUser u ON u.userid = polacc.userid AND u.userid = polacd.userid AND u.active = ''True''  
				INNER JOIN udf_GetAdminEmailsForORG(@orgID) uadm ON u.UnitID = uadm.unitid AND uadm.userid = @admid 
				INNER JOIN tblUnitHierarchy hier ON hier.UnitID = u.UnitID 
				INNER JOIN @selected_units su ON su.unitID = u.unitid 
				ORDER BY u.LastName , u.FirstName

			INSERT INTO
				@result
				SELECT
					adm.firstName+'' ''+adm.lastname, @policyName, adm.userid, adm.email, @user_list, @PolicyID, unt.HierarchyName
					FROM
						tblUser adm 
						INNER JOIN tblUnitHierarchy unt ON unt.unitid = adm.unitid AND adm.userid = @admID AND adm.active = ''True''
						
			SELECT @user_list = ''''

			FETCH NEXT FROM concatenator INTO @admID , @policyName, @PolicyID
		END
	CLOSE concatenator
	DEALLOCATE concatenator


	--Get Data in report format
	SELECT 
		DISTINCT UserID, HierarchyName, PolicyName, FirstName,  email, user_list, PolicyID 
 FROM @result
END




' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_GetUsersByPolicyAndUnit]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcPolicy_GetUsersByPolicyAndUnit]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_GetUsersByPolicyAndUnit]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary:		Compiles a %POLICY_NAMES% block and returns it with a bunch of user info for sending email to that user
				(Mainly just returns a list of users and the policies that they are assigned to (that meet the flagged conditions))

Parameters:		Comma separated list of userID:courseID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.GetUsersByPolicyAndUnit in Policy.cs
Calls:			None

Remarks:		None

Author:			Mark Donald (John R copied prcCourse_UserMashup - no optimising attempted as execution time expected to be small)
Date Created:	13 Nov 2009 (copied 18/05/2010)

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE PROCEDURE [prcPolicy_GetUsersByPolicyAndUnit]
	@policy_ids varchar(8000),
	@unit_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_units TABLE (unitid int)
	DECLARE @result TABLE (firstname nvarchar(50), lastname nvarchar(50), userid int, email nvarchar(100), new_policy_names varchar(8000), modified_policy_names varchar(8000), HierarchyName nvarchar(500))
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@userid int,
		@new_policy_names varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5)



	IF @accepted = ''0''
	BEGIN
		SELECT @strAccepted = ''True''
	END
	ELSE
	BEGIN
		SELECT @strAccepted = ''False''
	END

	
	
	-- rip the user selection
	INSERT INTO @selected_units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unit_ids)

	-- clean up the input so it resembles ''userid:policyid,userid:policyid,''
	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,'' '',''''),'',,'','',''),'','','' ''))),'' '','','') + '',''

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)
	-- Note to self: String operations take hundreds of times longer than cursor operations so first think of a way to limit the number of string operations, then get rid of the cursors.
	SELECT @new_policy_names = ''''
	SELECT @modified_policy_names = ''''
	DECLARE concatenator CURSOR READ_ONLY FOR
		SELECT DISTINCT
			usr.userid
			FROM
				@policies pols 
				INNER JOIN tblUserPolicyAccess polacs ON polacs.policyid = pols.policyid AND polacs.granted = ''True''
				INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))

				INNER JOIN tblUser usr ON usr.userid = polacs.userid AND usr.userid = polacd.userid AND usr.active = ''True'' 
				INNER JOIN @selected_units su ON usr.unitid = su.unitid 
	OPEN concatenator
	FETCH NEXT FROM concatenator INTO @userid
	WHILE @@FETCH_STATUS = 0
		BEGIN
			SELECT
				@new_policy_names = @new_policy_names + [PolicyName] + char(13) + char(10) + char(9)
				FROM
					tblpolicy pol 
					INNER JOIN @policies pols ON	pol.policyid = pols.policyid
					INNER JOIN tblUserPolicyAccess polacc ON polacc.policyid = pol.policyid AND polacc.granted = ''True''
					INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted
				AND (
				((COALESCE(polacd.DateAccepted,CAST(''1/1/1980'' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST(''1/1/2999'' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = ''False''))

					INNER JOIN tblUser usr ON usr.userid = polacc.userid AND usr.active = ''True'' AND usr.userid = @userid

			SELECT @new_policy_names = substring(@new_policy_names, 1, len(@new_policy_names) - 3)

			INSERT INTO
				@result
				SELECT
					usr.firstname, usr.lastname, usr.userid, usr.email, @new_policy_names, @modified_policy_names, hier.HierarchyName
					FROM
						tbluser usr
						INNER JOIN tblUnitHierarchy hier ON hier.UnitID = usr.UnitID 
					WHERE
						userid = @userid
			SELECT @new_policy_names = ''''
			SELECT @modified_policy_names = ''''
			FETCH NEXT FROM concatenator INTO @userid
		END
	CLOSE concatenator
	DEALLOCATE concatenator


	--Get Data in report format
	SELECT 
		DISTINCT UserID, HierarchyName, LastName, FirstName,  email, new_policy_names, modified_policy_names 

 FROM @result
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfile_Add]    Script Date: 06/09/2011 09:30:03 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfile_Add]
GO

/****** Object:  StoredProcedure [dbo].[prcProfile_Add]    Script Date: 06/09/2011 09:30:03 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Adds Profile

Parameters:
	@ProfileName

Returns:
Nothing

Called By:
Profile.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcProfile_Add]
(
	@ProfileID int output,
	@profilePeriodID int Output,
	@OrganisationID int,
	@ProfileName nvarchar(255),
	@DateStart datetime,
	@DateEnd datetime,
	@Points numeric(10,1),
	@EndOfPeriodAction char(1),
	@MonthIncrement int,
	@FutureDateStart datetime,
	@FutureDateEnd datetime,
	@FuturePoints numeric(10,1)
)
as
Begin 

set @DateStart = dbo.udfDaylightSavingTimeToUTC(@DateStart, @OrganisationID)
set @DateEnd =dbo.udfDaylightSavingTimeToUTC(@DateEnd, @OrganisationID)
set @FutureDateStart = dbo.udfDaylightSavingTimeToUTC(@FutureDateStart, @OrganisationID)
set @FutureDateEnd = dbo.udfDaylightSavingTimeToUTC(@FutureDateEnd, @OrganisationID)

	-- insert values into tblProfile
	insert into tblProfile
	(OrganisationID,
	ProfileName)
	values
	(@OrganisationID,
	@ProfileName)

	-- get ProfileID
	set @ProfileID = @@Identity

	-- insert values into tblProfilePeriod
	insert into tblProfilePeriod
		(ProfileID,
		DateStart,
		DateEnd,
		Points,
		EndOfPeriodAction,
		MonthIncrement,
		FutureDateStart,
		FutureDateEnd,
		FuturePoints,
		ApplyToQuiz,
		ApplyToLesson,
		ProfilePeriodActive)
	values
		(@ProfileID,
		@DateStart,
		@DateEnd,
		@Points,
		@EndOfPeriodAction,
		@MonthIncrement,
		@FutureDateStart,
		@FutureDateEnd,
		@FuturePoints,
		1,
		1,
		1)
	
	-- get the profileperiodid
	set @ProfilePeriodID = @@Identity
End
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfile_Get]    Script Date: 06/09/2011 09:35:58 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Get]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfile_Get]
GO

/****** Object:  StoredProcedure [dbo].[prcProfile_Get]    Script Date: 06/09/2011 09:35:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Get]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Gets a profile

Parameters:
	@ProfileID int,

Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcProfile_Get]
(
	@ProfileID int,
	@profileperiodID int,
	@OrgID int
)
as

select
	pro.profilename,
	dbo.udfUTCtoDaylightSavingTime(propd.datestart, @OrgID),
	dbo.udfUTCtoDaylightSavingTime(propd.dateend, @OrgID),
	propd.points,
	propd.endofperiodaction,
	propd.monthincrement,
	dbo.udfUTCtoDaylightSavingTime(propd.futuredatestart, @OrgID),
	dbo.udfUTCtoDaylightSavingTime(propd.futuredateend, @OrgID),
	propd.futurepoints,
	propd.ApplyToQuiz,
	propd.ApplyToLesson
from 
	tblProfile pro
	left join tblProfilePeriod propd on pro.profileid = propd.profileid
where 
	pro.profileid = @ProfileID
	and (@profileperiodID = -1 or propd.profileperiodid = @profileperiodid)
	and (profileperiodactive =  1   or ((dbo.udfUTCtoDaylightSavingTime(propd.datestart, @OrgID)) > (dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(), @OrgID))))

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfile_Update]    Script Date: 06/09/2011 09:57:01 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfile_Update]
GO

/****** Object:  StoredProcedure [dbo].[prcProfile_Update]    Script Date: 06/09/2011 09:57:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Updates a Profile.

Parameters:



Returns:
Nothing

Called By:
Profile.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcProfile_Update]
(
	@ProfileID int,
	@ProfileName nvarchar(255),
	@OrganisationID int,
	@DateStart datetime,
	@DateEnd datetime,
	@Points numeric(10,1),
	@EndOfPeriodAction char(1),
	@MonthIncrement int,
	@FutureDateStart datetime,
	@FutureDateEnd datetime,
	@FuturePoints numeric(10,1)
)
as

set @DateStart = dbo.udfDaylightSavingTimeToUTC(@DateStart, @OrganisationID)
set @DateEnd = dbo.udfDaylightSavingTimeToUTC(@DateEnd, @OrganisationID)
set @FutureDateStart = dbo.udfDaylightSavingTimeToUTC(@FutureDateStart, @OrganisationID)
set @FutureDateEnd = dbo.udfDaylightSavingTimeToUTC(@FutureDateEnd, @OrganisationID)

-- Update tblProfile
update tblProfile
set ProfileName =  @ProfileName 
where ProfileID = @ProfileID
and OrganisationID = @OrganisationID 

-- Get profileperiodid for profileid
declare @ProfilePeriodID int
-- Get ProfilePeriodID
set @ProfilePeriodID = 
	(select ProfilePeriodID 
	from tblProfilePeriod
	where ProfileID = @ProfileID 
	and profileperiodactive = 1)

if @ProfilePeriodID > 0 
begin
	-- Update tblProfilePeriod
	update tblProfilePeriod
	set DateStart = @DateStart,
	DateEnd = @DateEnd,
	Points = @Points,
	EndOfPeriodAction = @EndOfPeriodAction ,
	MonthIncrement = @MonthIncrement ,
	FutureDateStart = @FutureDateStart,
	FutureDateEnd = @FutureDateEnd,
	FuturePoints = @FuturePoints 
	where ProfilePeriodID = @ProfilePeriodID 
	and ProfileID = @ProfileID
end
else
begin
	-- just in case - set any other profileperiods with same profileid
	-- as inactive
	update tblProfilePeriod
		set profileperiodactive = 0
		where profileid = @profileid

	-- No profileperiod exists (profile with future period deleted)
	-- so need to add the profile period
	-- insert values into tblProfilePeriod

	
	insert into tblProfilePeriod
	(ProfileID,
	DateStart,
	DateEnd,
	Points,
	EndOfPeriodAction,
	MonthIncrement,
	FutureDateStart,
	FutureDateEnd,
	FuturePoints,
	ApplyToQuiz,
	ApplyToLesson,
	profileperiodactive)
	values
	(
	@ProfileID,
	@DateStart,
	@DateEnd,
	@Points,
	@EndOfPeriodAction,
	@MonthIncrement,
	@FutureDateStart,
	@FutureDateEnd,
	@FuturePoints,
	1,
	1,
	1 
	)
end

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfile_UserSearch]    Script Date: 06/09/2011 10:01:10 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_UserSearch]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfile_UserSearch]
GO

/****** Object:  StoredProcedure [dbo].[prcProfile_UserSearch]    Script Date: 06/09/2011 10:01:10 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfile_UserSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	Returns results of search for users on Assign Users tab of CPDdetail.aspx	

Returns:

Called By:
 
Calls:

Remarks:
	The searching units will include all children and grandchildren
	Only return users that logged on user has permission to see
	

Author: Aaron Cripps
Date Created: July 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

CREATE  Procedure  [dbo].[prcProfile_UserSearch]
(
	@organisationID  Int,
	@ProfileID int,
	@ProfilePeriodID int,
	@parentUnitIDs  Varchar(8000),
	@firstName	nVarchar(50),
	@lastName	nVarchar(50),
	@userName	nVarChar(100),
	@Email		nVarChar(100),
	@ExternalID nVarChar(50),
	@adminUserID		Int,
	@Type nvarchar(50)
)
As
Set Nocount On

Declare @intUserTypeID Int

Select @intUserTypeID = UserTypeID  
From tblUser
Where userID = @adminUserID


if  @ProfilePeriodID is null
	Set @ProfilePeriodID =0


--Check Data
If @parentUnitIDs is null
	set @parentUnitIDs =''''

If @firstName is null
	Set @firstName = ''''

Set @firstName =rtrim(@firstName)

If @lastName is null
	Set @lastName = ''''

Set @lastName =rtrim(@lastName)

If @userName is null
	Set @userName = ''''

set @userName = rtrim(@userName)

if @Email is null 
	set @Email = ''''

set @Email = rtrim(@Email)

if @ExternalID is null
	set @ExternalID = ''''

set @ExternalID = rtrim(@ExternalID)

if @Type = ''search''
Begin
	Select 	
	    us.UserID,
		us.UserName,
		us.FirstName,
		case
			When us.Active = 0 then us.LastName + ''(I)''
			Else us.LastName
		end as LastName,
		case
			When us.LastLogin Is Null then ''Never''
			Else cast(dbo.udfUTCtoDaylightSavingTime(us.LastLogin, @organisationID) as varchar)
		end as LastLogin,
		dbo.udfGetUnitPathway(us.UnitID) as Pathway,
		us.Active,
		uppa.Granted

	From tblUnit un, tblUser us, tblUserProfilePeriodAccess uppa
	
	Where (un.OrganisationID = @organisationID)
		and
		(
			us.Active=1
		)
		--0. Join Unit and User tables
		and (
			un.UnitID = us.UnitID
		    )
		-- Join User and UserProfilePeriodAccess tables
		and (
			us.UserID = uppa.UserID
			)
		and (
			uppa.ProfilePeriodID = @ProfilePeriodID
			)
		--1. Within the selected Parent Units (can select multiple units)
		--The unit hierarchy contains the parent Unit ID
		and (
		un.UnitID in 
			(
				Select IntValue from dbo.udfCsvToInt(@parentUnitIDs)
			)
			or (@parentUnitIDs='''')
			)
		--2. User firstname contains the entered text
		and (
			(firstname like ''%''+ @firstName + ''%'') 
			or (firstname ='''')
		    )
		--3. User lastname contains the entered text
		and (
			(lastname like ''%''+ @lastName + ''%'') 
			or (lastname ='''')
		    )
		-- User username contains the entered text
		and (
			(username like ''%'' + @userName + ''%'')
			or (userName='''')
			)
		-- User email contains the entered text
		and (
			(email like ''%'' + @Email + ''%'')
			or (email='''') or (email is null)
			)
		-- User externalid contains the entered text
		and (
			(externalID like ''%'' + @ExternalID + ''%'')
			or (externalID = '''') or (externalid is null)
			)
		--4. Permission
		--Salt Administrator(1), Organisation Administrator(2) has permission to access all units
		--Unit Administrator(3) only has permission to those that he is administrator
		and (
			(@intUserTypeID<3)
			or (un.UnitID in (select UnitID from tblUnitAdministrator where UserID=@adminUserID))
		     )	
	Order By Name
End
else if @Type = ''view''
Begin
	Select 	
	    us.UserID,
		us.UserName,
		us.FirstName,
		case
			When us.Active = 0 then us.LastName + ''(I)''
			Else us.LastName
		end as LastName,
		case
			When us.LastLogin Is Null then ''Never''
			Else cast(dbo.udfUTCtoDaylightSavingTime(us.LastLogin, @organisationID) as varchar)
		end as LastLogin,
		dbo.udfGetUnitPathway(us.UnitID) as Pathway,
		us.Active,
		uppa.Granted

	From tblUnit un, tblUser us, tblUserProfilePeriodAccess uppa
	
	Where (un.OrganisationID = @organisationID)
		and
		(
			us.Active=1
		)
		--0. Join Unit and User tables
		and (
			un.UnitID = us.UnitID
		    )
		-- Join User and UserProfilePeriodAccess tables
		and (
			us.UserID = uppa.UserID
			)
		and (
			uppa.ProfilePeriodID = @ProfilePeriodID
			)
		--1. Within the selected Parent Units (can select multiple units)
		--The unit hierarchy contains the parent Unit ID
		--and (
		--un.UnitID in 
		--	(
		--		Select IntValue from dbo.udfCsvToInt(@parentUnitIDs)
		--	)
		--	or (@parentUnitIDs='''')
		--	)
		--2. User firstname contains the entered text
		--and (
		--	(firstname like ''%''+ @firstName + ''%'') 
		--	or (firstname ='''')
		--    )
		--3. User lastname contains the entered text
		--and (
		--	(lastname like ''%''+ @lastName + ''%'') 
		--	or (lastname ='''')
		--    )
		-- User username contains the entered text
		--and (
		--	(username like ''%'' + @userName + ''%'')
		--	or (userName='''')
		--	)
		-- User email contains the entered text
		--and (
		--	(email like ''%'' + @Email + ''%'')
		--	or (email='''') or (email is  null)
		--	)
		-- User externalid contains the entered text
		--and (
		--	(externalID like ''%'' + @ExternalID + ''%'' )
		--	or (externalID = '''') or (externalid is null)
		--	)
		--4. Permission
		--Salt Administrator(1), Organisation Administrator(2) has permission to access all units
		--Unit Administrator(3) only has permission to those that he is administrator
		and (
			(@intUserTypeID<3)
			or (un.UnitID in (select UnitID from tblUnitAdministrator where UserID=@adminUserID))
		     )	
		and uppa.Granted=1
	Order By Name
End

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfilePoints_Add]    Script Date: 06/09/2011 10:06:00 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfilePoints_Add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfilePoints_Add]
GO

/****** Object:  StoredProcedure [dbo].[prcProfilePoints_Add]    Script Date: 06/09/2011 10:06:00 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfilePoints_Add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Adds Profile

Parameters:
	@ProfilePointsType nvarchar(1),
	@TypeID int, 
	@ProfilePeriodID int,
	@Points numeric(10,1),
	@Active bit,
	@DateAssigned datetime

Returns:
Nothing

Called By:
Profile.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcProfilePoints_Add]
(
@ProfilePointsType nvarchar(1),
@TypeID int, 
@ProfilePeriodID int,
@Points numeric(10,1),
@Active bit,
@DateAssigned datetime,
@OrgID int
--@ApplyToQuiz bit,
--@ApplyToLesson bit
)

as

set @DateAssigned = dbo.udfDaylightSavingTimeToUTC(@DateAssigned, @OrgID)

-- insert values into tblProfilePoints
insert into tblProfilePoints
(
ProfilePointsType,
TypeID,
ProfilePeriodID,
Points,
Active,
DateAssigned --,
--ApplyToQuiz,
--ApplyToLesson
)
values
(
@ProfilePointsType,
@TypeID,
@ProfilePeriodID,
@Points,
@Active,
@DateAssigned --,
--@ApplyToQuiz,
--@ApplyToLesson
)




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfilePoints_Update]    Script Date: 06/09/2011 10:08:09 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfilePoints_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcProfilePoints_Update]
GO

/****** Object:  StoredProcedure [dbo].[prcProfilePoints_Update]    Script Date: 06/09/2011 10:08:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcProfilePoints_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Updates ProfilePoints

Parameters:
	@ProfilePointsID int,
	@ProfilePointsType nvarchar(1),
	@TypeID int, 
	@ProfilePeriodID int,
	@Points numeric(10,1),
	@Active bit,
	@DateAssigned datetime

Returns:
Nothing

Called By:
Profile.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

create procedure [dbo].[prcProfilePoints_Update]
(
@ProfilePointsID int,
@ProfilePointsType nvarchar(1),
@TypeID int, 
@ProfilePeriodID int,
@Points numeric(10,1),
@Active bit,
@DateAssigned datetime,
@OrgID int
--@ApplyToQuiz bit,
--@ApplyToLesson bit
)

as

set @DateAssigned = dbo.udfDaylightSavingTimeToUTC(@DateAssigned, @OrgID)

-- update tblProfilePoints values
update tblProfilePoints
set 
ProfilePointsType = @ProfilePointsType,
TypeID = @TypeID,
ProfilePeriodID = @ProfilePeriodID,
Points = @Points,
Active = @Active --,
--DateAssigned = @DateAssigned --,
--ApplyToQuiz = @ApplyToQuiz,
--ApplyToLesson = @ApplyToLesson
where ProfilePointsID = @ProfilePointsID

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcQuiz_GetListByModule]    Script Date: 06/09/2011 10:09:57 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuiz_GetListByModule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcQuiz_GetListByModule]
GO

/****** Object:  StoredProcedure [dbo].[prcQuiz_GetListByModule]    Script Date: 06/09/2011 10:09:57 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuiz_GetListByModule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/*Summary:
	Selects a list of quizzes for a module. Caller can specify whether to only return active quizzes.

Parameters:
	@moduleID
	@activeOnly

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Module.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeeded
	5. ParameterException
	10. BusinessServiceException (General)		


Author: Gavin Buddis
Date Created: 16 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		4/5/2007		Added WorkSiteID to select

**/
CREATE  Procedure [dbo].[prcQuiz_GetListByModule]
(
	@moduleID Integer = Null,
	@activeOnly Bit = 0,
	@OrgID int
)

As

Set Nocount On

-- Declarations
Declare @strErrorMessage Varchar(200) -- Holds the error message
Declare @intErrorNumber Integer -- Holds the error number

-- Initialise variables
Set @strErrorMessage = ''''
Set @intErrorNumber = 0

--Validate Parameter @moduleID
If (@moduleID Is Null)
Begin
	Set @intErrorNumber = 5
	Set @strErrorMessage = ''Missing or Null parameter @moduleID in stored procedure prcQuiz_GetListByModule''
	Goto Finalise
End

If (@activeOnly = 1)
Begin
	Select 
		QuizID,
		ModuleID,
		ToolbookID,
		ToolbookLocation,
		dbo.udfUTCtoDaylightSavingTime(DatePublished, @OrgID),
		LoadedBy,
		dbo.udfUTCtoDaylightSavingTime(DateLoaded, @OrgID),
		Active,
		WorkSiteID
	From
		tblQuiz
	Where 
		ModuleID = @moduleID And
		Active = 1
End
Else
Begin
	Select 
		QuizID,
		ModuleID,
		ToolbookID,
		ToolbookLocation,
		dbo.udfUTCtoDaylightSavingTime(DatePublished, @OrgID),
		LoadedBy,
		dbo.udfUTCtoDaylightSavingTime(DateLoaded, @OrgID),
		Active,
		WorkSiteID
	From
		tblQuiz
	Where 
		ModuleID = @moduleID

End

Finalise:
If(@intErrorNumber > 0)
Begin
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End



' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcQuizSession_UpdateEndQuizInfo]    Script Date: 06/09/2011 10:27:58 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_UpdateEndQuizInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcQuizSession_UpdateEndQuizInfo]
GO

/****** Object:  StoredProcedure [dbo].[prcQuizSession_UpdateEndQuizInfo]    Script Date: 06/09/2011 10:27:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_UpdateEndQuizInfo]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Update record in tblQuizSession
Insert record into tblUserQuizStatus
Insert record into tblUserCourseStatus
 
Returns:
data table

Called By:
ToolBook.cs: UpdateEndQuizInfo

Author: Li Zhang
Date Created: 13-10-2006
Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added QuizCompletionDate
**/

CREATE PROCEDURE [dbo].[prcQuizSession_UpdateEndQuizInfo]
(
	@QuizSessionID	varchar(50) -- unique GUID that identifies this toolbook quiz session
	, @Duration	int -- the duration in seconds of the quiz as mesured by toolbook
	, @Score 	int -- the score as mesured by toolbook
	, @UserID	int	-- user id
	, @QuizID	int -- quiz id
	, @PassMark	int	-- quiz pass mark
	, @UnitID	int	-- user''s unit id
	, @ModuleID	int -- quiz module id
	, @CourseID	int -- module course id
	, @OldCourseStatus	int -- course status before update
	, @NewQuizStatus int -- the quiz status
	, @NewCourseStatus	int	-- course status after update
	, @QuizFrequency	int -- quiz frequency
	, @QuizCompletionDate	datetime -- quiz completiondate
	, @OrgID int
)
AS
	SET nocount on
	SET xact_abort on 
BEGIN TRANSACTION

set @QuizCompletionDate = dbo.udfDaylightSavingTimeToUTC(@QuizCompletionDate, @OrgID)

	DECLARE @dateCreated datetime
	SET @dateCreated = GETUTCDATE()
	
	IF EXISTS
		(
			SELECT QuizSessionID
			FROM tblQuizSession
			WHERE QuizSessionID = @QuizSessionID
			AND	DateTimeStarted IS NOT NULL
			AND DateTimeCompleted IS NULL
		)
	BEGIN
		-- < update tblQuizSession >--
		UPDATE tblQuizSession
		SET DateTimeCompleted = @dateCreated
			, Duration = @Duration
			, QuizScore = @Score
			, QuizPassMark = @PassMark
		WHERE
			QuizSessionID = @QuizSessionID
		
		--< insert into tblUserQuizStatus >--
		INSERT INTO 
				tblUserQuizStatus
				(
					UserID,
					ModuleID,
					QuizStatusID,
					QuizFrequency,
					QuizPassMark,
					QuizCompletionDate,
					QuizScore,
					QuizSessionID,
					DateCreated
				)
		VALUES 
				(
					@UserID,
					@ModuleID,
					@NewQuizStatus,
					@QuizFrequency,
					@PassMark,
					@QuizCompletionDate,
					@Score,
					@QuizSessionID,
					@dateCreated
				)
				
		--< insert into tblUserCourseStatus >--
		IF (@OldCourseStatus = -1) or (@OldCourseStatus <> @NewCourseStatus)
		BEGIN
			EXEC prcUserCourseStatus_Insert @UserID, @ModuleID, @NewCourseStatus
		END
		ELSE
		BEGIN
			IF NOT EXISTS (SELECT UserID FROM vwUserModuleAccess where UserID = @UserID AND CourseID = @CourseID) AND
			EXISTS (SELECT UserCourseStatusID FROM tblUserCourseStatus WHERE UserID = @UserID AND CourseID = @CourseID AND CourseStatusID <> 0)
			BEGIN
				EXEC prcUserCourseStatus_Insert @UserID, @ModuleID, @NewCourseStatus = 0
			END
		END
		
	END
	
	COMMIT TRANSACTION


' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetModuleRule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_GetModuleRule]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetModuleRule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: 
	Gets unit module compliance rules
		
Called By: Unit.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Jack Liu
Date Created: 18th of February 2004


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

prcUnit_GetModuleRule 1, 1

*/

CREATE  Procedure [prcUnit_GetModuleRule]
(
	@unitID Int,
	@courseID int
)

As

set nocount on

Select 	m.ModuleID,
	m.Name,
	umr.UsingDefault,
	isnull(umr.LessonFrequency, 0) as LessonFrequency,
	isnull(umr.QuizFrequency, 0) as QuizFrequency,
	umr.QuizPassMark,
	dbo.udfUTCtoDaylightSavingTime(umr.LessonCompletionDate, u.OrganisationID) as LessonCompletionDate,
	dbo.udfUTCtoDaylightSavingTime(umr.QuizCompletionDate, u.OrganisationID) as QuizCompletionDate
From vwUnitModuleRule umr
	inner join tblModule m 	on m.ModuleID=  umr.ModuleID
	join tblUnit u on u.UnitID = umr.UnitID
where umr.UnitID = @unitID
	and umr.CourseId= @courseID
order by m.Sequence
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_GetOne]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets details of one Unit
		
Called By: Unit.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Jack Liu
Date Created: 10th of February 2004

prcUnit_GetOne 5

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE  Procedure [prcUnit_GetOne]
(
	@unitID Integer = null	
)

As

If @unitID Is Null
Begin
	Raiserror(''The Parameter @unitID was null.  @unitID does not accept Null values.'', 16, 1)
	Return
End

Select
	u.UnitID,
	u.Name,
	u.ParentUnitID,
	u.Hierarchy,
	dbo.udfGetUnitPathway(u.UnitID) as Pathway,
	u.Active,
	u.OrganisationID,
	o.OrganisationName as Organisation,
	u.CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(u.DateCreated, u.OrganisationID) as DateCreated,
	u.UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(u.DateUpdated, u.OrganisationID) as DateUpdated
From
	tblUnit u
		left join tblOrganisation o 
			on u.OrganisationID = o.OrganisationID
Where	u.UnitID = @unitID
' 
END
GO




/****** Object:  StoredProcedure [dbo].[prcUnit_SaveModuleRule]    Script Date: 06/09/2011 16:06:01 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_SaveModuleRule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUnit_SaveModuleRule]
GO

/****** Object:  StoredProcedure [dbo].[prcUnit_SaveModuleRule]    Script Date: 06/09/2011 16:06:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_SaveModuleRule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: 
	Populate the compliance rules to an individual module
		
Called By: Unit.cs
Calls: None

Remarks:

Author: Jack Liu
Date Created: 18th of February 2004


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

prcUnit_SaveModuleRule 1, 1

*/

CREATE  Procedure [dbo].[prcUnit_SaveModuleRule]
(
	@unitID Int,
	@moduleID int,
	@usingDefault bit,
	@lessonFrequency int,
	@quizFrequency int,
	@quizPassMark int,
	@lessonCompletionDate datetime, 
	@quizCompletionDate datetime, 
	@adminUserID int,
	@OrgID int
)

As

set nocount on

set @lessonCompletionDate = dbo.udfDaylightSavingTimeToUTC(@lessonCompletionDate, @OrgID)
set @quizCompletionDate = dbo.udfDaylightSavingTimeToUTC(@quizCompletionDate, @OrgID)

--1. If the module uses default rules, delete the existing individual rule
if (@usingDefault=1)
begin
	Delete 
	from tblUnitRule
	where UnitID=@unitID
		and moduleID= @moduleID
end
--2. If the module contains individual rule, update the existing individual rule
else if exists(select ModuleID 
		from tblUnitRule
		where UnitID=@unitID
			and moduleID= @moduleID)
begin
	Update tblUnitRule
	set 	LessonFrequency = @LessonFrequency,
		QuizFrequency = @QuizFrequency,
		QuizPassMark = @QuizPassMark,
		LessonCompletionDate = @lessonCompletionDate, 
		QuizCompletionDate = @quizCompletionDate, 
		UpdatedBy = @adminUserID,
		DateUpdated =  GETUTCDATE()
	where UnitID=@unitID
		and moduleID= @moduleID
	
end
--3. If the module doesn''t contain any individual rule, add the new rule
else
begin
	insert into tblUnitRule
		(
		UnitID, 
		ModuleID,
		LessonFrequency,
		QuizFrequency,
		QuizPassMark,
		LessonCompletionDate, 
		QuizCompletionDate, 
		CreatedBy,
		DateCreated
		)
	values (
		@unitID,
		@moduleID,
		@lessonFrequency,
		@quizFrequency,
		@quizPassMark,
		@lessonCompletionDate, 
		@quizCompletionDate, 
		@adminUserID,
		GETUTCDATE()
		)
	
end





' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUnit_SaveModuleRuleToAll]    Script Date: 06/09/2011 16:12:00 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_SaveModuleRuleToAll]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUnit_SaveModuleRuleToAll]
GO

/****** Object:  StoredProcedure [dbo].[prcUnit_SaveModuleRuleToAll]    Script Date: 06/09/2011 16:12:00 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_SaveModuleRuleToAll]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: 
	Populate the compliance rules to all modules in the course
		
Called By: Unit.cs
Calls: None

Remarks:

Author: Jack Liu
Date Created: 18th of February 2004


Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

prcUnit_SaveModuleRuleToAll 1, 1

*/

CREATE  Procedure [dbo].[prcUnit_SaveModuleRuleToAll]
(
	@unitID Int,
	@courseID int,
	@lessonFrequency int,
	@quizFrequency int,
	@quizPassMark int,
	@lessonCompletionDate DateTime = Null, -- Lesson completion date
	@quizCompletionDate DateTime = Null, -- Quiz completion date
	@adminUserID int,
	@OrgID int
)

As

set nocount on

set xact_abort on
Begin Tran

set @lessonCompletionDate = dbo.udfDaylightSavingTimeToUTC(@lessonCompletionDate, @OrgID)
set @quizCompletionDate = dbo.udfDaylightSavingTimeToUTC(@quizCompletionDate, @OrgID)

	Delete tblUnitRule
	from tblUnitRule ur
		inner join tblModule m
			 on  ur.ModuleID  = m.ModuleID
	where ur.UnitID=@unitID
		and m.CourseId= @courseID

	insert into tblUnitRule
		(
		UnitID, 
		ModuleID,
		LessonFrequency,
		QuizFrequency,
		QuizPassMark,
		LessonCompletionDate,
		QuizCompletionDate,
		CreatedBy,
		DateCreated
		)
	Select 	@unitID,
		m.ModuleID,
		@lessonFrequency,
		@quizFrequency,
		@quizPassMark,
		@lessonCompletionDate,
		@quizCompletionDate,
		@adminUserID,
		GETUTCDATE()
	From tblModule m
	where m.CourseId= @courseID
	
commit tran





' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUnit_Update]    Script Date: 06/09/2011 16:16:01 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUnit_Update]
GO

/****** Object:  StoredProcedure [dbo].[prcUnit_Update]    Script Date: 06/09/2011 16:16:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUnit_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
	Updates a unit details.
Returns:
	Nothing.
		
Called By: 
	Unit Class.

Calls:
	Nothing
Remarks:
	Validation:
	1. Integrity Violation
	The Unit''s details have been updated by another user (since the data are retrieved)
	
	2. Deactivate a Unit
	.There are no users in this unit
	.There are no active sub-units in this units

	3. Activate a Unit
	.Parent unit must be active
	
	Exception:
	0. Succeed
	1. RecordNotFound
	4. UniqueViolationException
	5. MissingParameterException
	6. PermissionDeniedException
	7. IntegrityViolationException
	10. BusinessServiceException (General)	


Author: Jack Liu
Date Created: 10 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE PROCEDURE [dbo].[prcUnit_Update]
(
	@unitID	int,
	@name 	nvarchar(100),
	@active	bit,
	@updatedByUserID int,
	@originalDateUpdated DateTime,
	@OrgID int
)
AS

set nocount on

set xact_abort on
Begin Tran

	--Validation
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @strErrorMessage Varchar(200) -- Holds the error message

	declare @blnExistingStatus bit
	declare @strHierarchy nvarchar(500)
	declare @intParentUnitID int
	declare @dteDateUpdated datetime


	select @blnExistingStatus = active,
		@strHierarchy=  Hierarchy +'',%'',
		@intParentUnitID = ParentUnitID,
		@dteDateUpdated = dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrgID)
	from tblUnit
	where UnitID = @unitID

	set @intErrorNumber=0
	set @strErrorMessage=''''

	--1. Integrity Violation
	--The Unit''s details have been updated by another user (since the data are retrieved)
	
	if (@dteDateUpdated>@originalDateUpdated)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''The unit''''s details have been updated by another user, you will need to refresh the unit''''s details and re-enter your changes.  <a href="[Url]">Click here</a> to refresh.''
		Goto Finalise
	End

	--2. Deactivate unit
	--.There are no users in this unit
	--.There are no active sub-units in this units
	if (@blnExistingStatus=1 and @active=0)
	Begin
		if exists(select UserID from tblUser where UnitID=@unitID)
		BEGIN	
			Set @intErrorNumber = 10
			set @strErrorMessage = ''You can not deactivate a unit which contains users.  Please move the users to another unit.''
			Goto Finalise
		end	
		
		if exists(select UnitID from tblUnit where hierarchy like @strHierarchy  and active=1)
		BEGIN	
			Set @intErrorNumber = 101
			set @strErrorMessage = ''You can not deactivate a unit which contains active sub-units.''
			Goto Finalise
		end	
	end

	--3. Activate a Unit
	--.Parent unit must be active
	else if (@blnExistingStatus=0 and @active=1)
	Begin
		if exists(select UnitID from tblUnit where unitID=@intParentUnitID  and active=0)
		BEGIN	
			Set @intErrorNumber = 102
			set @strErrorMessage = ''You cannot activate a unit whose parent unit is inactive.''
			Goto Finalise
		end	
	end
	

	if (@intErrorNumber=0)
	begin
		UPDATE 	tblUnit
		SET 	Name		= 	@name,
			Active		= 	@active,
			UpdatedBy	= 	@updatedByUserID,
			DateUpdated	= 	GETUTCDATE()
		WHERE 	UnitID = @unitID
	end


Finalise:
If(@intErrorNumber > 0)
Begin
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
	Rollback Transaction
End
Else
Begin
	Select
		0 As ''ErrorNumber'',
		''Successfully Updated'' As ''ErrorMessage''
	Commit Transaction
End


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetArchiveUsers]    Script Date: 06/09/2011 16:26:17 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetArchiveUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetArchiveUsers]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetArchiveUsers]    Script Date: 06/09/2011 16:26:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetArchiveUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
-- =============================================
-- Author:		Li Zhang
-- Create date: June 2008
-- Description:	
-- =============================================
CREATE PROCEDURE [dbo].[prcUser_GetArchiveUsers]
	@fromDate datetime,
	@inclNewUsers int,
	@orgID int,
	@userID int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

set @fromDate = dbo.udfDaylightSavingTimeToUTC(@fromDate, @orgID)

	declare @SelectedUnitIDs table 
	(unid int)

	declare @usertype int
	DECLARE @tblTemp table(
		LastLogin nvarchar(200),
		FirstName nvarchar(200),
		LastName nvarchar(200),
		Username nvarchar(200),
		ExternalID nvarchar(50),
		Email nvarchar(100),
		UserID int)


	-- Get user type
	Select @UserType = UserTypeID from tblUser Where UserID = @UserID

	-- salt and org admins
	IF (@UserType in(1,2))	
	Begin
		insert into @SelectedUnitIDs
		select unitID 
		from 
		tblUnit Where OrganisationID = @orgID
		
	end 
	
	-- unit admin
	IF (@UserType = 3)
	Begin
		insert into @SelectedUnitIDs
		select 	u.unitID 
		from 	tblUnit as u
				inner join tblUnitAdministrator as ua
					on (u.unitID=ua.unitID)
						and (ua.userID = @userID)
		where 	(u.organisationID=@orgID)
	end


	-- get users haven''t login after @fromDate
	insert into @tblTemp
		select 
			dbo.udfUTCtoDaylightSavingTime(LastLogin, @orgID), FirstName, LastName, Username, ExternalID,Email, UserID 
		from 
			tblUser
			join @SelectedUnitIDs on unid = unitid
		where
			LastLogin < @fromDate 
			and OrganisationID =  @orgID 
			and Active = ''true''
			



	if @inclNewUsers = 1
	begin
		insert into @tblTemp		
		select 
			''Never'', FirstName, LastName, Username, ExternalID, Email, UserID 
		from 
			tblUser
			join @SelectedUnitIDs on unid = unitid
		where
			LastLogin is null and DateUpdated < @fromDate 
			and OrganisationID =  @orgID and Active = ''true''			
	end


	select * from @tblTemp
		 
END



SET QUOTED_IDENTIFIER ON 
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetDetailsByEmail]    Script Date: 06/09/2011 16:31:58 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetDetailsByEmail]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetDetailsByEmail]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetDetailsByEmail]    Script Date: 06/09/2011 16:31:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetDetailsByEmail]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets the details of one User by their email address
Parameters: @emailAddress varchar(100)
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcUser_GetDetailsByEmail]
(
	@emailAddress varchar(100) = null, -- Email Address
	@OrgID int
)

As
Set NoCount On

If @emailAddress Is Null
Begin
	Raiserror(''The Parameter @emailAddress was null.  @emailAddress does not accept Null values.'', 16, 1)
	Return
End

Select
	UserID,
	FirstName,
	LastName,
	UserName,
	Password,
	Email,
	ExternalID,
	OrganisationID,
	UnitID,
	UserTypeID,
	Active,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrgID)
From
	tblUser
Where
	Email = @emailAddress
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/09/2011 16:43:07 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/09/2011 16:43:07 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcUser_GetOne]
(
	@userID Integer = null, -- User ID
	@OrgID int
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

Select
	UserID,
	FirstName,
	LastName,
	UserName,
	Password,
	Email,
	ExternalID,
	OrganisationID,
	UnitID,
	UserTypeID,
	Active,
	CreatedBy,
	dbo.udfDaylightSavingTimeToUTC(DateCreated, @OrgID),
	UpdatedBy,
	dbo.udfDaylightSavingTimeToUTC(DateUpdated, @OrgID)
	LastLogin,
	TimeZoneID
From
	tblUser
Where
	UserID = @userID
' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetQuizHistory]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_GetQuizHistory]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetQuizHistory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Returns the quiz history for a given user for a given module
Parameters: @UserID integer, @ModuleID integer
Returns:

	Recordset 1
		Status,
		QuizPassMark,
		QuizScore,
		DateCreated,
		QuizStatusID,
		QuizSessionID

Called By: 
	User.cs
Calls: 
	

Remarks: Raises an error if the parameter is null

Author: Peter Kneale
Date Created: 9th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

-- prcUser_GetQuizHistory 1,1
*/
CREATE Procedure [prcUser_GetQuizHistory]
	@UserID 	Integer,		-- UserID of the user that we want the quiz history on
	@ModuleID 	Integer,		-- Module ID from which we need the quiz history information
	@OrgID int
As
	Set NoCount On

	--------------------------------------------------------------------
	---- Declarations
	--------------------------------------------------------------------
	
	--------------------------------------------------------------------
	---- Logic
	----- Get the Users Quiz Details
	--------------------------------------------------------------------

	Select 
		Status,
		QuizPassMark,
		QuizScore,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID) as DateCreated,
		tblUserQuizStatus.QuizStatusID,
		QuizSessionID
	From 
		tblUserQuizStatus, tblQuizStatus
	Where
		tblUserQuizStatus.QuizStatusID = tblQuizStatus.QuizStatusID
	And
		tblUserQuizStatus.UserID = @userID
	And
		tblUserQuizStatus.ModuleID = @moduleID

	Order By
		DateCreated desc
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetSALTAdministrators]    Script Date: 06/09/2011 16:48:32 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetSALTAdministrators]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetSALTAdministrators]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetSALTAdministrators]    Script Date: 06/09/2011 16:48:32 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetSALTAdministrators]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'






/*Summary:
	Gets a list of all SALT Administrators.  Restrict to those with 
	the specified Active status if specified.

Parameters:
	@active Bit

Returns:
	Nothing
		
Called By: 
	User.cs.

Calls:
	Nothing

Remarks:

Author: Gavin Buddis
Date Created: 23rd March 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [dbo].[prcUser_GetSALTAdministrators]
(
	@requestedByUserID Integer = Null, -- User ID of the currently logged in user
	@OrgID int
)

As

Set NoCount On

Select
	UserID,
	Username,
	FirstName,
	case
	When Active = 0 Then LastName + '' (I)''
	Else LastName
	End As LastName,
	Email,
	Active,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID),
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrgID)
From
	tblUser
Where
	(UserID <> @requestedByUserID)
	And (UserTypeID = 1)



' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetUnassigned]    Script Date: 06/09/2011 16:50:45 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetUnassigned]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetUnassigned]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetUnassigned]    Script Date: 06/09/2011 16:50:45 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetUnassigned]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Returns the users that are not currently assigned to a unit.
	This function never returns users who are salt administrators

Parameters: @OrganisationID 	Integer
Returns:
		UserID,
		First Name,
		Last Name,
		DateUpdated
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: User.cs
Calls: Nothing

Remarks: Raises an error if the parameter is null

	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	7. IntegrityConstraintException
	10. BusinessServiceException (General)		

Author: Peter Kneale
Date Created: 9th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

-- prcUser_GetUnassigned 1
*/
CREATE Procedure [dbo].[prcUser_GetUnassigned]
	@OrganisationID 	Integer
AS

Set NoCount On

	-- Declarations
	Declare @strErrorMessage Varchar(200) 		-- Holds the error message
	Declare @intErrorNumber Integer			-- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	-- Validation
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure prcUser_GetUnassigned''
		Goto Finalise
	End	
	
	-- Logic
	Select     
		UserID,
		LastName,
		FirstName,
		UserName,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrganisationID)
	From         
		tblUser
	Where
		OrganisationID=@OrganisationID
	And	
		UnitID is null
	And
		UserTypeID <> 1
    order by
        LastName,
        FirstName
	-- Set the error message to successfull
	Set @strErrorMessage = ''User successfully selected.''

	-- Finalise the procedure
	Goto Finalise

Finalise:
If(@intErrorNumber > 0)
Begin
	Select
		@intErrorNumber 	As ''ErrorNumber'',
		@strErrorMessage 	As ''ErrorMessage''
End
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUserCourse_GetCompletionDate]    Script Date: 06/09/2011 17:19:23 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourse_GetCompletionDate]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserCourse_GetCompletionDate]
GO

/****** Object:  StoredProcedure [dbo].[prcUserCourse_GetCompletionDate]    Script Date: 06/09/2011 17:19:23 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourse_GetCompletionDate]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
summary: get completion date for the last required component in a course is completed
parameters: userID int, courseID int
returns: datetimecompleted datetime

called by: 
Author: Li Zhang
Date Created:

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	  
*/
CREATE Procedure [dbo].[prcUserCourse_GetCompletionDate]
(@userID int,
@courseID int,
@OrgID int,
@courseCompletionDate datetime=null output
)
AS

Set Nocount On

	/*
	select
	um.UserID,
	um.ModuleID
	into #tblCurrentAssignedModules
	from vwUserModuleAccess um
	inner join
	vwUnitModuleRule umr
	on umr.moduleID = um.moduleID
	and umr.unitID = um.unitId
	inner join 
	tblmodule m
	on um.moduleId= m.moduleID
	where
	um.userID = @userID
	and m.courseID = @courseID

	--select * from #tblCurrentAssignedModules

	select 
	um.userID,
	um.moduleID,
	qs.DateTimeCompleted
	into
	#tblStartedModules
	from
	#tblCurrentAssignedModules um
	inner join
	(
	select
	um.userID,
	um.moduleID,
	max(DateTimeCompleted) as DateTimeCompleted
	from 
	#tblCurrentAssignedModules um
	inner join tblQuiz q
	on q.moduleID = um.ModuleID
	inner join tblQuizSession qs
	on qs.QuizID = q.quizID
	and qs.userID = um.userId
	and qs.datetimecompleted is not null
	group by um.userID, um.moduleID
	)as lastQuizDate
	on lastquizdate.userID = um.userID
	and lastquizdate.moduleID = um.moduleID
	inner join tblQuiz q
	on 
	q.moduleID = um.moduleID
	inner join tblQuizSession qs
	on qs.quizid = q.quizid
	and qs.userid = um.userid
	and qs.datetimecompleted = lastquizdate.datetimecompleted

	select @courseCompletionDate = max(DateTimeCompleted) from #tblstartedmodules

*/


select top 1 @courseCompletionDate = dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrgID) from tblUserCourseStatus where CourseID = @courseID and UserID = @userID and CourseStatusID = 2 order by DateCreated desc
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_GetOne]    Script Date: 06/09/2011 17:23:27 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserCourseStatus_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_GetOne]    Script Date: 06/09/2011 17:23:27 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




/*
Summary: Gets othe details of one Organisation
Parameters: 	@courseID integer
		@userID integer
Returns: 

Called By: User.cs
Calls: None

Remarks: Raises an error if either of the input parameters are null

Author: Gavin Buddis
Date Created: 2/4/04

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1
*/

Create  Procedure [dbo].[prcUserCourseStatus_GetOne]
(
@userID int, 	-- The User ID
@courseID int, 	-- the Course ID
@OrgID int
)

As

If @courseID Is Null
Begin
	Raiserror(''The Parameter @courseID was null.  @courseID does not accept Null values.'', 16, 1)
	Return
End

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

DECLARE
	@modulesassigned varchar(1000), -- sql2000 doesn''t allow the naked column value (modulesassigned) to be used as a param for a table udf that''s used in a join
	@coursestatusid int

SELECT
	TOP 1 @modulesassigned = modulesassigned, @coursestatusid = coursestatusid
	FROM
		tblusercoursestatus
	WHERE
		userid = @userid
		AND courseid = @courseid
	ORDER BY
		datecreated DESC

SELECT
	TOP 1 @userid userid, @courseid courseid, @coursestatusid coursestatusid, @modulesassigned modulesassigned, dbo.udfUTCtoDaylightSavingTime(datecreated, @OrgID)
	FROM
		tbluserquizstatus,
		dbo.udfCsvToInt(@modulesassigned)
	WHERE
		moduleid = intvalue
		AND userid = @userid
		AND quizstatusid = 2 -- passed
	ORDER BY
		datecreated DESC

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUserLessonStatus_Update_old_Quick]    Script Date: 06/09/2011 17:32:05 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserLessonStatus_Update_old_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserLessonStatus_Update_old_Quick]
GO

/****** Object:  StoredProcedure [dbo].[prcUserLessonStatus_Update_old_Quick]    Script Date: 06/09/2011 17:32:05 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserLessonStatus_Update_old_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/* Summary:
Update lesson status for each user
This schedule task only updates three status:
Unassigned Modules (0)
New Assigned Modules (Not Started(1))
Expired Modules (Time Elapsed)(4)

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user lesson status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''Not started''.
If a module is unassigned from a user, the status will be ''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''unassinged''

------------ Decision Processes -------------

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules

1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)

2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)

2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson date/frequency, the new status is Expired (Time Expired)(4)



------------ Data need to be recorded -------------

LessonFrequency
0  Unassigned:  		-
1  Not Started: 		Y
4  Expired (Time Elapsed): 	Y


Author: Jack Liu
Date Created: 21 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate

prcUserLessonStatus_Update

**/
CREATE Procedure [dbo].[prcUserLessonStatus_Update_old_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On

/*

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules
*/

-- mikev(1): added lessonCompletionDate
select 	um.UserID,
um.ModuleID,
umr.LessonFrequency, 
umr.LessonCompletionDate
into #tblCurrentAssignedModules
from vwUserModuleAccess um
inner join vwUnitModuleRule umr
on umr.ModuleID  = um.ModuleID
and umr.UnitID = um.UnitID
where um.UnitID in (select UnitID from tblUnit where OrganisationID = @OrgID)
and um.UserID IN (select UserID from tblUser where OrganisationID = @OrgID)


-- select * from #tblCurrentAssignedModules
/*
1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

*/

select 	uls.UserID,
uls.ModuleID
into #PreviousAssignedModules
from vwUserLessonStatus uls
where 	uls.LessonStatusID<>0 --not Unassigned (0)
and uls.UserID IN (select UserID from tblUser where OrganisationID = @OrgID)

/*
2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
*/

insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID
)
select pam.UserID,
pam.ModuleID,
0  as QuizStatusID --Unassigned (0)
from #PreviousAssignedModules pam
left join #tblCurrentAssignedModules cam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)


/*
2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)
*/

-- mikev(1): Added LessonCompletionDate
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
1  as LessonStatusID,--Not Started(1)
cam.LessonFrequency, cam.LessonCompletionDate
from #tblCurrentAssignedModules cam
left join #PreviousAssignedModules pam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where pam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)

/*
2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson frequency, the new status is Expired (Time Expired)(4)
*/

select 	max(LastStarted.UserLessonStatusID) LastStartedStatusID
into #tblLastStartedStatus
from tblUserLessonStatus LastStarted
inner join vwUserLessonStatus CurrentStatus
on  LastStarted.UserID = CurrentStatus.UserID
and  LastStarted.ModuleID = CurrentStatus.ModuleID
and CurrentStatus.LessonStatusID in (2,3)
where LastStarted.LessonStatusID = 2
and LastStarted.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
group by LastStarted.UserID, LastStarted.moduleID

-- mikev(1): added LessonCompletionDate
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as LessonStatusID, --(Time Elapsed)(4)
cam.LessonFrequency, cam.LessonCompletionDate
from #tblLastStartedStatus lss
inner join tblUserLessonStatus uls
on uls.UserLessonStatusID = lss.LastStartedStatusID
inner join #tblCurrentAssignedModules cam
on cam.UserID = uls.UserID
and cam.ModuleID = uls.ModuleID
where
	(
		cam.LessonCompletionDate is null 
		and DateDiff(day,GETUTCDATE(), dateadd(month, cam.LessonFrequency, uls.DateCreated)) <= 0
	)
	or 
	(
		isnull(DateDiff(day, GETUTCDATE(), cam.LessonCompletionDate), 1) <= 0
	)
	and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
--Expired

drop table #tblCurrentAssignedModules

drop table #PreviousAssignedModules

drop table #tblLastStartedStatus

-- Extend completion dates
	update tblOrganisation 
		set DefaultLessonCompletionDate = dateadd(year, 1, [DefaultLessonCompletionDate])
		where DefaultLessonCompletionDate < GETUTCDATE() and OrganisationID = @OrgID

	update tblUnitRule
		set LessonCompletionDate = dateadd(year, 1, [LessonCompletionDate])
		where LessonCompletionDate < GETUTCDATE() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
-- /Extend completion dates
		

SET QUOTED_IDENTIFIER ON 
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUserQuizStatus_FIX]    Script Date: 06/09/2011 17:40:05 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserQuizStatus_FIX]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserQuizStatus_FIX]
GO

/****** Object:  StoredProcedure [dbo].[prcUserQuizStatus_FIX]    Script Date: 06/09/2011 17:40:05 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserQuizStatus_FIX]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE   Procedure [dbo].[prcUserQuizStatus_FIX]
(
	@orgID int
)
AS
Set Nocount On

/*
1.1  Get all modules that are currently assigned to each users (CurrentAssignedModules)
and current compliance rules
*/

select
um.UserID,
um.ModuleID,
umr.QuizFrequency,
umr.QuizPassMark
into
#tblCurrentAssignedModules
from
vwUserModuleAccess um
inner join
vwUnitModuleRule umr
on
umr.ModuleID  = um.ModuleID
and umr.UnitID = um.UnitID
where
um.OrganisationID = @orgID

/*
1.2. Get the last quiz activity for each user and module pair (StartedModules)
*/

select
um.userID,
um.moduleID,
q.active,
qs.QuizScore,
qs.QuizSessionID,
dbo.udfUTCtoDaylightSavingTime(qs.DateTimeCompleted, @orgID)
into
#tblStartedModules
from
#tblCurrentAssignedModules um
inner join
(
select
um.userID, um.moduleID, max(dbo.udfUTCtoDaylightSavingTime(DateTimeCompleted, @orgID))  as DateTimeCompleted
from
#tblCurrentAssignedModules um
inner join tblQuiz q
on q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted is not null
group by um.userID, um.moduleID
)
as LastQuizDate

on
LastQuizDate.userID = um.userID
and LastQuizDate.ModuleID = um.ModuleID

inner join tblQuiz q
on
q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted  = LastQuizDate.DateTimeCompleted

/*
1.3. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
a) Get a list of modules that is in the quiz status table that the last statuses are not Unassigned (0)(PreviousAssignedModules)
b) Get rid off all modules that are currently assigned to the users (from step 1)
c)All modules left are Unassigned(0)
*/
--1. Get Current User Quiz status
CREATE TABLE #tblCurrentUserQuizStatus
(
UserID int NOT NULL ,
ModuleID int NOT NULL ,
QuizStatusID int not NULL ,
QuizFrequency int NULL ,
QuizPassMark int NULL ,
QuizScore int NULL,
QuizSessionID uniqueidentifier NULL
)

/*
1.5. Started Modules
a)If the last quiz is inactive, the status is Expired (New Content)(5)
b)If the last quiz is past the current quiz frequency, the status is Expired (Time Expired)(4)
c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
If user Failed the quiz, the status is Failed (3)
If user Passed the quiz, the status is Passed (2)
*/

-- a)If the last quiz is inactive, the status is Expired (New Content)(5)


insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark
)
select
cam.UserID,
cam.ModuleID,
5  as QuizStatusID, --  Expired (New Content)(5)
cam.QuizFrequency,
cam.QuizPassMark
from
#tblCurrentAssignedModules cam
inner join
#tblStartedModules sm
on
sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
sm.active=0 --Inactive

-- select * from #tblCurrentUserQuizStatus order by userID

/*
2. Update User Quiz status
----------------------------
If the last quiz status for each user is not the same as the current status, add the new status
*/




declare @cursor_UserID 	        int
declare @cursor_ModuleID 	    int
declare @cursor_QuizStatusID 	int
declare @cursor_QuizFrequency 	int
declare @cursor_QuizPassMark	int
declare @cursor_QuizScore	    int
declare @cursor_QuizSessionID   varchar(50)
declare @cursor_UserQuizStatusID int
declare @int_rc int

DECLARE CurrentUserQuizStatus CURSOR
FOR


select
cs.UserID,
cs.ModuleID,
cs.QuizStatusID,
cs.QuizFrequency,
cs.QuizPassMark,
cs.QuizScore,
cs.QuizSessionID,
s.UserQuizStatusID
from
#tblCurrentUserQuizStatus cs
left join vwUserQuizStatus s
on cs.userID = s.UserID
and cs.ModuleID = s.ModuleID
and cs.QuizStatusID = s.QuizStatusID

Open CurrentUserQuizStatus

-- First Read testreportCursor
FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizScore,@cursor_QuizSessionID, @cursor_UserQuizStatusID

WHILE @@FETCH_STATUS = 0
BEGIN

--new user quiz status records

-- Eisting user quiz status records
EXEC prcUserQuizStatus_UpdateCourseStatus @cursor_UserID, @cursor_ModuleID

FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizScore,@cursor_QuizSessionID,@cursor_UserQuizStatusID
END
-- Finished CurrentUserQuizStatus
CLOSE CurrentUserQuizStatus
DEALLOCATE CurrentUserQuizStatus

drop table  #tblCurrentUserQuizStatus

drop table #tblCurrentAssignedModules

drop table #tblStartedModules

' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcQuizSession_UpdateEndQuizInfo]    Script Date: 06/14/2011 10:41:36 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_UpdateEndQuizInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcQuizSession_UpdateEndQuizInfo]
GO

/****** Object:  StoredProcedure [dbo].[prcQuizSession_UpdateEndQuizInfo]    Script Date: 06/14/2011 10:41:36 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_UpdateEndQuizInfo]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
Update record in tblQuizSession
Insert record into tblUserQuizStatus
Insert record into tblUserCourseStatus
 
Returns:
data table

Called By:
ToolBook.cs: UpdateEndQuizInfo

Author: Li Zhang
Date Created: 13-10-2006
Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added QuizCompletionDate
**/

CREATE PROCEDURE [dbo].[prcQuizSession_UpdateEndQuizInfo]
(
	@QuizSessionID	varchar(50) -- unique GUID that identifies this toolbook quiz session
	, @Duration	int -- the duration in seconds of the quiz as mesured by toolbook
	, @Score 	int -- the score as mesured by toolbook
	, @UserID	int	-- user id
	, @QuizID	int -- quiz id
	, @PassMark	int	-- quiz pass mark
	, @UnitID	int	-- user''s unit id
	, @ModuleID	int -- quiz module id
	, @CourseID	int -- module course id
	, @OldCourseStatus	int -- course status before update
	, @NewQuizStatus int -- the quiz status
	, @NewCourseStatus	int	-- course status after update
	, @QuizFrequency	int -- quiz frequency
	, @QuizCompletionDate	datetime -- quiz completiondate
)
AS
	SET nocount on
	SET xact_abort on 
BEGIN TRANSACTION

declare @OrgID int
select @OrgID = organisationID from tblUnit where tblUnit.UnitID=@UnitID

set @QuizCompletionDate = dbo.udfDaylightSavingTimeToUTC(@QuizCompletionDate, @OrgID)

	DECLARE @dateCreated datetime
	SET @dateCreated = GETUTCDATE()
	
	IF EXISTS
		(
			SELECT QuizSessionID
			FROM tblQuizSession
			WHERE QuizSessionID = @QuizSessionID
			AND	DateTimeStarted IS NOT NULL
			AND DateTimeCompleted IS NULL
		)
	BEGIN
		-- < update tblQuizSession >--
		UPDATE tblQuizSession
		SET DateTimeCompleted = @dateCreated
			, Duration = @Duration
			, QuizScore = @Score
			, QuizPassMark = @PassMark
		WHERE
			QuizSessionID = @QuizSessionID
		
		--< insert into tblUserQuizStatus >--
		INSERT INTO 
				tblUserQuizStatus
				(
					UserID,
					ModuleID,
					QuizStatusID,
					QuizFrequency,
					QuizPassMark,
					QuizCompletionDate,
					QuizScore,
					QuizSessionID,
					DateCreated
				)
		VALUES 
				(
					@UserID,
					@ModuleID,
					@NewQuizStatus,
					@QuizFrequency,
					@PassMark,
					@QuizCompletionDate,
					@Score,
					@QuizSessionID,
					@dateCreated
				)
				
		--< insert into tblUserCourseStatus >--
		IF (@OldCourseStatus = -1) or (@OldCourseStatus <> @NewCourseStatus)
		BEGIN
			EXEC prcUserCourseStatus_Insert @UserID, @ModuleID, @NewCourseStatus
		END
		ELSE
		BEGIN
			IF NOT EXISTS (SELECT UserID FROM vwUserModuleAccess where UserID = @UserID AND CourseID = @CourseID) AND
			EXISTS (SELECT UserCourseStatusID FROM tblUserCourseStatus WHERE UserID = @UserID AND CourseID = @CourseID AND CourseStatusID <> 0)
			BEGIN
				EXEC prcUserCourseStatus_Insert @UserID, @ModuleID, @NewCourseStatus = 0
			END
		END
		
	END
	
	COMMIT TRANSACTION


' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportDistinctUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Used to build the CC list on step 2 of the report

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
ALTER        Proc [prcReport_EmailReportDistinctUsers]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFromOrg 		datetime,
	@quizDateToOrg 		datetime,
	@includeInactive	int
)
AS
------------------------------------------
	Set Nocount On

	DECLARE @quizDateFrom 		datetime
	DECLARE @quizDateTo 		datetime
	SET @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFromOrg,@OrganisationID)
	SET @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateToOrg,@OrganisationID)




	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		SELECT 
			DISTINCT A.UserID, F.HierarchyName, A.FirstName, A.LastName, A.DateCreated, A.DAteArchived
		FROM
			(SELECT
				A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
				D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
				FROM
					(SELECT
						A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
						FROM
							tblUserCourseStatus A, @CoursesWithAccess B
						WHERE
							A.DateCreated < DATEADD(DD, 1, @quizDateTo)
							and A.CourseID = B.CourseID
						GROUP BY
							A.UserID, A.CourseID
					) A, @Users B, tblUserCourseStatus C, tblUser D
				WHERE
					A.UserID = B.UserID
					AND B.UserID = C.UserID
					AND A.LatestCourseStatus = C.UserCourseStatusID
					AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
					AND C.CourseStatusID = case @courseModuleStatus
												when @CONST_COMPLETE then 2   -- Complete
												when @CONST_INCOMPLETE then 1 -- InComplete
											end
					AND A.UserID = D.UserID
			) A
			LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
				AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
		WHERE
			--If classification is Any (0), This will find users of any Custom Classification
			(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
			AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
		ORDER BY
			F.HierarchyName, A.LastName, A.FirstName
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		SELECT
			DISTINCT A.UserID, C.HierarchyName, B.FirstName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
			dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived
			FROM 
				(select
					distinct userid, moduleid
					from
						@UsersQuizStatusNOTSTARTED
				) A, tblUser B, tblModule D, tblUnitHierarchy C
			WHERE 
				A.UserID = B.UserID
				AND B.UnitID = C.UnitID
				AND A.ModuleID = D.ModuleID
				AND D.Active = 1
			ORDER BY
				C.HierarchyName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end, B.FirstName
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		SELECT 
			DISTINCT A.UserID, B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end as ''LastName'', 
			A.FirstName, 
			dbo.udfUTCtoDaylightSavingTime(A.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(A.DateArchived, @OrganisationID) as DateArchived
			FROM
				(SELECT
					DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, B.DateCreated, B.DateArchived, courseid
					FROM 
						(SELECT
							DISTINCT userid, moduleid
							FROM
								@UsersQuizStatusNOTSTARTED
						) A, tblUser B, tblModule D
					WHERE 
						A.UserID = B.UserID
						AND A.ModuleID = D.ModuleID
						AND D.Active = 1
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				@classificationID =0 OR tblUserClassification.classificationID = @classificationID
			ORDER BY
				B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end, A.FirstName

	end --/ Not started - Any


' 
END
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportToAdministrators]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_EmailReportToAdministrators]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportToAdministrators]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Get a list of users that will appear in the administrtors email list

Returns:
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name
  AdminUserID,UserUnitID,Administrator Email,Administrator Name, Administrator''s Unit, User Unit, User name

  order by AdminUserID,UserUnitID	

Called By: Email report
Calls:

Remarks:

Sending to Administrators	
If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the user''s Units.

If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.

Only one email will be sent to each administrator.

Within the body of the email for each administrator will be the list of users who are in the Units which they administer. (See Appendix A).  
The list will group the users into Units and have the Unit name as the heading for each group.


	
Author:Jack Liu
Date Created: 27 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

prcReport_EmailReportToAdministrators 3, ''42,48,11''

select * from tbluser where userID = 42

--------------------

**/

CREATE Proc [prcReport_EmailReportToAdministrators]
(
	@organisationID int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFrom 		datetime,
	@quizDateTo 		datetime,
	@includeInactive	int
)

AS

Set Nocount On
	DECLARE @quizDateFromOrg 		datetime
	DECLARE @quizDateToOrg 		datetime
	SET @quizDateFromOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateFrom,@OrganisationID)
	SET @quizDateToOrg = dbo.udfDaylightSavingTimeToUTC(@quizDateTo,@OrganisationID)

declare @tblUserUnit table
(
	UserID int,
	UnitID int
)


declare @tblUnit table
(
	unitID int
)

declare @tblUnitAdministrator table
(
	unitID int,
	AdminUserID int
)
	Set Nocount On
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, A.UnitID
			FROM
				(SELECT
					A.UserID, D.UnitID
					FROM
						(SELECT
							A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
							FROM
								tblUserCourseStatus A, @CoursesWithAccess B
							WHERE
								A.DateCreated < DATEADD(DD, 1, @quizDateToOrg)
								and A.CourseID = B.CourseID
							GROUP BY
								A.UserID, A.CourseID
						) A, @Users B, tblUserCourseStatus C, tblUser D
					WHERE
						A.UserID = B.UserID
						AND B.UserID = C.UserID
						AND A.LatestCourseStatus = C.UserCourseStatusID
						AND (C.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)
						AND C.CourseStatusID = case @courseModuleStatus
													when @CONST_COMPLETE then 2   -- Complete
													when @CONST_INCOMPLETE then 1 -- InComplete
													end
						AND A.UserID = D.UserID
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
				AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
			ORDER BY
				A.UserID, A.UnitID
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT
				DISTINCT A.UserID, UnitID
				FROM 
					(select
						distinct userid, moduleid
						from
							@UsersQuizStatusNOTSTARTED
					) A, tblUser B, tblModule D
				WHERE 
					A.UserID = B.UserID
					AND A.ModuleID = D.ModuleID
					AND D.Active = 1
				ORDER BY
					A.UserID, UnitID
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFromOrg AND @quizDateToOrg)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		INSERT INTO @tblUserUnit(UserID, UnitID)
			SELECT 
				A.UserID, UnitID
				FROM
					(SELECT
						DISTINCT A.UserID, B.UnitID
						FROM 
							(SELECT
								DISTINCT userid, moduleid
								FROM
									@UsersQuizStatusNOTSTARTED
							) A, tblUser B, tblModule D
						WHERE 
							A.UserID = B.UserID
							AND A.ModuleID = D.ModuleID
							AND D.Active = 1
					) A
					LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
						AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				WHERE
					--If classification is Any (0), This will find users of any Custom Classification
					@classificationID =0 OR tblUserClassification.classificationID = @classificationID
				ORDER BY
					A.UserID, UnitID

	end --/ Not started - Any


insert into @tblUnit(UnitID)
select distinct UnitID
from @tblUserUnit

---If "Administrators" was selected as the Recipient Type, then the email will be sent to the administrators of the users Units.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, ua.UserID
from @tblUnit u
	inner join tblUnitAdministrator ua
		on ua.UnitID = u.UnitID
	inner join tblUser us
		on us.UserID = ua.UserID and us.UserTypeID = 3 --Unit Administrator

--If a user belongs to a Unit that does not have its own administrator, the email will go to the Organisation Administrators.
insert into @tblUnitAdministrator (UnitID, AdminUserID)
select u.UnitID, us.UserID
from tblUser us
	cross join @tblUnit u
where us.OrganisationID = @organisationID
	and us.UserTypeID = 2 -- Organisation Administrator
	and u.UnitID not in (select UnitID from @tblUnitAdministrator)
	and us.Active = 1


-- Tidy up the results
SELECT
	DISTINCT adminuserid userid, hierarchyname, lastname, firstname, 
			dbo.udfUTCtoDaylightSavingTime(DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(DateArchived, @OrganisationID) as DateArchived,
	NULL courseid
	FROM
		@tblunitadministrator a
		INNER JOIN tbluser u ON userid = a.adminuserid 
		INNER JOIN tblunithierarchy h ON h.unitid = u.unitid
	WHERE
		u.active = 1
	ORDER BY
		hierarchyname, adminuserid
' 
END
GO







IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
The e-mail report allows an administrator to e-mail users
who have failed or not completed their quizzes.
It can also email administrators notifying them of
users that they are responsible for who have failed or not
completed their quizzes.

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
ALTER        Proc [prcReport_EmailReportUserSearch]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFromOrg 		datetime,
	@quizDateToOrg 		datetime,
	@includeInactive	int
)
AS
------------------------------------------
	Set Nocount On
	DECLARE @quizDateFrom 		datetime
	DECLARE @quizDateTo 		datetime
	SET @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFromOrg,@OrganisationID)
	SET @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateToOrg,@OrganisationID)
	
	
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(A.courseid AS varchar(10)) userid
		FROM
			(SELECT
				A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
				D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
				FROM
					(SELECT
						A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
						FROM
							tblUserCourseStatus A, @CoursesWithAccess B
						WHERE
							A.DateCreated < DATEADD(DD, 1, @quizDateTo)
							and A.CourseID = B.CourseID
						GROUP BY
							A.UserID, A.CourseID
					) A, @Users B, tblUserCourseStatus C, tblUser D
				WHERE
					A.UserID = B.UserID
					AND B.UserID = C.UserID
					AND A.LatestCourseStatus = C.UserCourseStatusID
					AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
					AND C.CourseStatusID = case @courseModuleStatus
												when @CONST_COMPLETE then 2   -- Complete
												when @CONST_INCOMPLETE then 1 -- InComplete
											end
					AND A.UserID = D.UserID
			) A
			LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
				AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
		WHERE
			--If classification is Any (0), This will find users of any Custom Classification
			(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
			AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		SELECT
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM 
				(select
					distinct userid, moduleid
					from
						@UsersQuizStatusNOTSTARTED
				) A, tblUser B, tblModule D, tblUnitHierarchy C
			WHERE 
				A.UserID = B.UserID
				AND B.UnitID = C.UnitID
				AND A.ModuleID = D.ModuleID
				AND D.Active = 1
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM
				(SELECT
					DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, 
			dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived,
					courseid
					FROM 
						(SELECT
							DISTINCT userid, moduleid
							FROM
								@UsersQuizStatusNOTSTARTED
						) A, tblUser B, tblModule D
					WHERE 
						A.UserID = B.UserID
						AND A.ModuleID = D.ModuleID
						AND D.Active = 1
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				@classificationID =0 OR tblUserClassification.classificationID = @classificationID

	end --/ Not started - Any


' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
The e-mail report allows an administrator to e-mail users
who have failed or not completed their quizzes.
It can also email administrators notifying them of
users that they are responsible for who have failed or not
completed their quizzes.

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
ALTER        Proc [prcReport_EmailReportUserSearch]
(
	@organisationID		int,
	@unitIDs 			varchar(MAX),
	@courseIDs 			varchar(8000),
	@classificationID 	int,
	@courseModuleStatus	int,
	@quizDateFromOrg 		datetime,
	@quizDateToOrg 		datetime,
	@includeInactive	int
)
AS
------------------------------------------
	Set Nocount On
	DECLARE @quizDateFrom 		datetime
	DECLARE @quizDateTo 		datetime
	SET @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFromOrg,@OrganisationID)
	SET @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateToOrg,@OrganisationID)
	
	
	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_UNKNOWN 	        int,
	@CONST_EXPIRED_TIMELAPSED int,
	@CONST_EXPIRED_NEWCONTENT int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	    = 1
	set @CONST_FAILD		= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED	= 4
	set @CONST_EXPIRED_NEWCONTENT  = 5

	DECLARE @Units TABLE (UnitID INT)
	DECLARE @Courses TABLE (CourseID INT)
	DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
	DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)
	DECLARE @UsersQuizStatusNOTSTARTED TABLE (
		UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO
		@Courses
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@courseIDs)

	INSERT INTO
		@Units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO
		@CoursesWithAccess
		SELECT
			A.CourseID, [name]
			FROM
				@Courses A, tblOrganisationCourseAccess B, tblCourse C
			WHERE
				A.CourseID = B.GrantedCourseID
				AND B.OrganisationID = @organisationID
				AND A.CourseID = C.CourseID
				AND C.Active = 1

	--Get All the users for all specfied units
	INSERT INTO
		@Users
		SELECT 
			DISTINCT A.UserID, A.UnitiD
			FROM
				tblUser A
				join  @Units B on A.UnitID = B.UnitID 
				join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
			WHERE 
				@includeinactive =1 or A.Active = 1 -- show all or only active users
		


	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have the Custom Classification option (if provided)
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(A.courseid AS varchar(10)) userid
		FROM
			(SELECT
				A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
				D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
				FROM
					(SELECT
						A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
						FROM
							tblUserCourseStatus A, @CoursesWithAccess B
						WHERE
							A.DateCreated < DATEADD(DD, 1, @quizDateTo)
							and A.CourseID = B.CourseID
						GROUP BY
							A.UserID, A.CourseID
					) A, @Users B, tblUserCourseStatus C, tblUser D
				WHERE
					A.UserID = B.UserID
					AND B.UserID = C.UserID
					AND A.LatestCourseStatus = C.UserCourseStatusID
					AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
					AND C.CourseStatusID = case @courseModuleStatus
												when @CONST_COMPLETE then 2   -- Complete
												when @CONST_INCOMPLETE then 1 -- InComplete
											end
					AND A.UserID = D.UserID
			) A
			LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
				AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
			LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
		WHERE
			--If classification is Any (0), This will find users of any Custom Classification
			(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
			AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
	END -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					)A, @Users B
				Where
					A.UserID = B.UserID
		
		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT 
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID

		INSERT INTO
			@UsersQuizStatusNOTSTARTED
				SELECT
					*
					FROM
						@UsersNQuizStatus
					WHERE
						QuizStatusID = case @courseModuleStatus
											when @CONST_FAILD then 3   -- Failed
											when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
											when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
										end

		--Get Data in report format
		SELECT
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM 
				(select
					distinct userid, moduleid
					from
						@UsersQuizStatusNOTSTARTED
				) A, tblUser B, tblModule D, tblUnitHierarchy C
			WHERE 
				A.UserID = B.UserID
				AND B.UnitID = C.UnitID
				AND A.ModuleID = D.ModuleID
				AND D.Active = 1
	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
		--------------------
		-- Not started  --
		--------------------
		-- When "Course/Module Status" is set to "Not Started"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Course
		--  - AND have the Custom Classification option
		--  - AND who have not started ANY of the quizes they have access to in this course
		--------------------
		
		INSERT INTO
			@UserModuleWithAccess
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.UnitID
				FROM
					(SELECT
						A.UserID, A.ModuleID, A.UnitID
						FROM
							vwUserModuleAccess A
						where
							courseid in (SELECT courseid from @Courses)
					) A, @Users B
				Where
					A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO
			@UsersNQuizStatus
			SELECT
				DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
				FROM
					(SELECT
						A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
						FROM 
							@UserModuleWithAccess A, tblUserQuizStatus B 
						WHERE
							A.UserID = B.UserID
							AND A.ModuleID = B.ModuleID
						GROUP BY
							A.UserID, A.ModuleID
					) A, tblUserQuizStatus B
				WHERE
					A.UserID = B.UserID
					AND A.ModuleID = B.ModuleID
					AND A.LatestQuizID = B.UserQuizStatusID
					AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

		--select * from @UsersNQuizStatus

		--Get User with Quiz NOT STARTED
		INSERT INTO
			@UsersQuizStatusNOTSTARTED
			SELECT
				*
				FROM
					@UsersNQuizStatus
				WHERE
					QuizStatusID NOT IN (2,3)
					AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

		--select * from @UsersQuizStatusNOTSTARTED
		--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

		--Get Data in report format
		SELECT 
			DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
			FROM
				(SELECT
					DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, 
			dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated, 
			dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived,
					courseid
					FROM 
						(SELECT
							DISTINCT userid, moduleid
							FROM
								@UsersQuizStatusNOTSTARTED
						) A, tblUser B, tblModule D
					WHERE 
						A.UserID = B.UserID
						AND A.ModuleID = D.ModuleID
						AND D.Active = 1
				) A
				LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
					AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
				LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
			WHERE
				--If classification is Any (0), This will find users of any Custom Classification
				@classificationID =0 OR tblUserClassification.classificationID = @classificationID

	end --/ Not started - Any


' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Licensing]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_Licensing]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Licensing]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Procedure [prcReport_Licensing]
(
	@CourseLicensingID int,
	@OrganisationID int
)
AS

BEGIN

	IF (@CourseLicensingID = 0)
		BEGIN
			SELECT     
				Header.Name as CourseName, 
				Header.LicenseNumber, 
				Header.Period, 
				Header.LicensesRemaining, 
				tblUnitHierarchy.HierarchyName as UnitPathway, 
				tblUser.FirstName + '' '' + tblUser.LastName AS FullName, 
				tblUser.ExternalID, 
				tblUser.Email, 
				dbo.udfUTCtoDaylightSavingTime(tblUser.DateCreated, @OrganisationID) as DateCreated, 
				tblUser.Active, 
				CASE 
					WHEN (tblUser.Active = 0 AND DateArchived IS NULL) THEN ''YES'' 
					ELSE CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(DateArchived, @OrganisationID), 103) 
					END AS DateArchive, 
				Header.LicensesUsed
			FROM tblCourseLicensingUser 
			INNER JOIN tblUser ON tblCourseLicensingUser.UserID = tblUser.UserID 
			INNER JOIN tblUnitHierarchy ON tblUser.UnitID = tblUnitHierarchy.UnitID 
			RIGHT JOIN tblCourseLicensing ON tblCourseLicensingUser.CourseLicensingID = tblCourseLicensing.CourseLicensingID 
				and tblCourseLicensing.OrganisationID = @OrganisationID
			RIGHT JOIN (
				SELECT	tblCourseLicensing.CourseLicensingID, 
						tblCourse.Name, 
						tblCourseLicensing.LicenseNumber, 
						CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateStart, @OrganisationID), 103) + '' - '' + CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateEnd, @OrganisationID), 103) AS Period, 
						tblCourseLicensing.LicenseNumber - coalesce(COUNT(tblCourseLicensingUser.CourseLicensingUserID),0) AS LicensesRemaining, 
						coalesce(COUNT(tblCourseLicensingUser.CourseLicensingUserID),0) AS LicensesUsed
				FROM tblCourseLicensingUser AS tblCourseLicensingUser 
				RIGHT JOIN tblCourseLicensing ON  tblCourseLicensingUser.CourseLicensingID = tblCourseLicensing.CourseLicensingID
					and tblCourseLicensing.OrganisationID = @OrganisationID
				INNER JOIN tblCourse ON tblCourseLicensing.CourseID = tblCourse.CourseID 
				WHERE tblCourseLicensing.OrganisationID = @OrganisationID
				GROUP BY tblCourse.Name, tblCourseLicensing.LicenseNumber, tblCourseLicensing.DateStart, 
						tblCourseLicensing.DateEnd, tblCourseLicensing.CourseLicensingID
				HAVING      (tblCourseLicensing.DateStart < GETUTCDATE()) AND (dateadd(d,1,tblCourseLicensing.DateEnd) > GETUTCDATE())
			) AS Header ON tblCourseLicensing.CourseLicensingID = Header.CourseLicensingID
			order by tblUnitHierarchy.HierarchyName,Header.Name,tblUser.FirstName + '' '' + tblUser.LastName

		END
	ELSE
		BEGIN
			SELECT     
				Header.Name as CourseName, 
				Header.LicenseNumber, 
				Header.Period, 
				Header.LicensesRemaining, 
				tblUnitHierarchy.HierarchyName as UnitPathway, 
				tblUser.FirstName + '' '' + tblUser.LastName AS FullName, 
				tblUser.ExternalID, 
				tblUser.Email, 
				dbo.udfUTCtoDaylightSavingTime(tblUser.DateCreated, @OrganisationID) as DateCreated, 
				tblUser.Active, 
				CASE 
					WHEN (tblUser.Active = 0 AND DateArchived IS NULL) THEN ''YES'' 
					ELSE CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(DateArchived, @OrganisationID), 103) 
					END AS DateArchive, 
				Header.LicensesUsed
			FROM tblCourseLicensingUser 
			INNER JOIN tblUser ON tblCourseLicensingUser.UserID = tblUser.UserID 
			INNER JOIN tblUnitHierarchy ON tblUser.UnitID = tblUnitHierarchy.UnitID 
			RIGHT JOIN tblCourseLicensing ON tblCourseLicensingUser.CourseLicensingID = tblCourseLicensing.CourseLicensingID 
				and tblCourseLicensing.OrganisationID = @OrganisationID
			RIGHT JOIN (
				SELECT	tblCourseLicensing.CourseLicensingID, 
						tblCourse.Name, 
						tblCourseLicensing.LicenseNumber, 
						CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateStart, @OrganisationID), 103) + '' - '' + CONVERT(varchar, dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateEnd, @OrganisationID), 103) AS Period,
						tblCourseLicensing.LicenseNumber - coalesce(COUNT(tblCourseLicensingUser.CourseLicensingUserID),0) AS LicensesRemaining, 
						coalesce(COUNT(tblCourseLicensingUser.CourseLicensingUserID),0) AS LicensesUsed
				FROM tblCourseLicensingUser AS tblCourseLicensingUser 
				RIGHT JOIN tblCourseLicensing ON tblCourseLicensingUser.CourseLicensingID = tblCourseLicensing.CourseLicensingID
					and tblCourseLicensing.OrganisationID = @OrganisationID
				INNER JOIN tblCourse ON tblCourseLicensing.CourseID = tblCourse.CourseID 
				WHERE tblCourseLicensing.OrganisationID = @OrganisationID				
				GROUP BY tblCourse.Name, tblCourseLicensing.LicenseNumber, dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateStart, @OrganisationID), 
					dbo.udfUTCtoDaylightSavingTime(tblCourseLicensing.DateEnd, @OrganisationID), tblCourseLicensing.CourseLicensingID
				HAVING tblCourseLicensing.CourseLicensingID = @CourseLicensingID
			) AS Header ON tblCourseLicensing.CourseLicensingID = Header.CourseLicensingID
			order by tblUnitHierarchy.HierarchyName,Header.Name,tblUser.FirstName + '' '' + tblUser.LastName
	END
END
' 
END
GO




/****** Object:  UserDefinedFunction [dbo].[udfGetEmailsinDay]    Script Date: 06/15/2011 14:51:23 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfGetEmailsinDay]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE FUNCTION [dbo].[udfGetEmailsinDay] 
(
	@OrgName nvarchar(50)
)
RETURNS int
AS
BEGIN
	-- Declare the return variable here
	DECLARE @EmailsinDay int

	-- Add the T-SQL statements to compute the return value here
	SET @EmailsinDay = (SELECT COUNT(OrganisationID) FROM dbo.tblEmail 
							WHERE OrganisationID = (SELECT OrganisationID FROM tblOrganisation WHERE OrganisationName = @OrgName) AND
							DateCreated BETWEEN DATEADD(DAY, -1, GETUTCDATE()) AND GETUTCDATE()) 

	-- Return the result of the function
	RETURN @EmailsinDay

END
' 
END

GO


/****** Object:  UserDefinedFunction [dbo].[udfGetEmailsinHour]    Script Date: 06/15/2011 14:51:51 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfGetEmailsinHour]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 14/06/2011
-- Description:	Gets emails delivered in last 1 hour
-- =============================================
CREATE FUNCTION [dbo].[udfGetEmailsinHour] 
(
	@OrgName nvarchar(50)
)
RETURNS int
AS
BEGIN
	-- Declare the return variable here
	DECLARE @EmailsinHour int

	-- Add the T-SQL statements to compute the return value here
	SET @EmailsinHour = (SELECT COUNT(OrganisationID) FROM dbo.tblEmail 
							WHERE OrganisationID = (SELECT OrganisationID FROM tblOrganisation WHERE OrganisationName = @OrgName) AND
							DateCreated BETWEEN DATEADD(hour, -1, GETUTCDATE()) AND GETUTCDATE()) 

	-- Return the result of the function
	RETURN @EmailsinHour

END
' 
END

GO


/****** Object:  UserDefinedFunction [dbo].[udfGetPercentExpectedEmails]    Script Date: 06/15/2011 14:52:10 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfGetPercentExpectedEmails]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 15/06/2011
-- Description:	Calculates the percentage of expected emails sent in the last day
--				The percentage is calculated on the average workload
--				(averaged over last 7 days)
-- =============================================
CREATE FUNCTION [dbo].[udfGetPercentExpectedEmails] 
(
	@OrgName nvarchar(50)
)
RETURNS int
AS
BEGIN
	-- Declare the return variable here
	DECLARE @ExpectedEmails int
	DECLARE @EmailsinLastDay int
	DECLARE @EmailsinLast7days int

	SET @EmailsinLastDay = (SELECT COUNT(OrganisationID) FROM dbo.tblEmail 
							WHERE OrganisationID = (SELECT OrganisationID FROM tblOrganisation WHERE OrganisationName = @OrgName) AND
							DateCreated BETWEEN DATEADD(DAY, -1, GETUTCDATE()) AND GETUTCDATE()) 

	SET @EmailsinLast7days = (SELECT COUNT(OrganisationID) FROM dbo.tblEmail 
							WHERE OrganisationID = (SELECT OrganisationID FROM tblOrganisation WHERE OrganisationName = @OrgName) AND
							DateCreated BETWEEN DATEADD(DAY, -7, GETUTCDATE()) AND GETUTCDATE()) 

	IF (@EmailsinLast7days <> 0)
	BEGIN					
		SET @ExpectedEmails = ((@EmailsinLastDay * 7 * 100)/@EmailsinLast7days)
	END
	ELSE
		SET @ExpectedEmails = 0	

	-- Return the result of the function
	RETURN @ExpectedEmails

END

' 
END

GO


/****** Object:  StoredProcedure [dbo].[prcGetEmailThroughput]    Script Date: 06/15/2011 14:52:38 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetEmailThroughput]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [dbo].[prcGetEmailThroughput]
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT o.OrganisationName AS OrganisationName, dbo.udfGetEmailsinHour(o.OrganisationName) AS "Emails delivered in last hour", dbo.udfGetEmailsinDay(o.OrganisationName) AS "Emails delivered in last day", dbo.udfGetPercentExpectedEmails(o.OrganisationName) AS "Percent of Expected Emails"
		FROM tblEmail e JOIN tblOrganisation o ON e.OrganisationID = o.OrganisationID
			GROUP BY OrganisationName
			ORDER BY "Percent of Expected Emails" DESC
END' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgDateStr]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfGetSaltOrgDateStr]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgDateStr]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE FUNCTION [udfGetSaltOrgDateStr]
(
		@OrgID int

)
RETURNS Table
AS

return


	SELECT  convert( varchar(17), dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(),@OrgID),113) as PrintDate









' 
END

GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcGetSaltOrgDate]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcGetSaltOrgDate]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcGetSaltOrgDate]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE procedure [prcGetSaltOrgDate]
(
		@OrgID int

)

AS

begin


	 SELECT  convert( varchar(17), dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(),@OrgID),113) as PrintDate

end








' 
END
GO



/* Script for Organisation Mail Setup screen */
/* Author: Hitendra Jagtap Date:18/06/2011 */

IF EXISTS (SELECT 1 
    FROM INFORMATION_SCHEMA.TABLES 
    WHERE TABLE_TYPE='BASE TABLE' 
    AND TABLE_NAME='tblOrganisation')
BEGIN
	IF NOT EXISTS( SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tblOrganisation' 
		AND  COLUMN_NAME = 'WarnMgrsofDeliquentUsers')
	BEGIN
		ALTER TABLE tblOrganisation  ADD WarnMgrsofDeliquentUsers 
			bit NOT NULL DEFAULT 0
	END
	IF NOT EXISTS( SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'tblOrganisation' 
		AND  COLUMN_NAME = 'WarnUsersofDelinquency')
	BEGIN
		ALTER TABLE tblOrganisation  ADD WarnUsersofDelinquency 
			bit NOT NULL DEFAULT 0
	END
END

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/18/2011 09:14:49 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/18/2011 09:14:49 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Gets othe details of one Organisation
Parameters: @orgID integer
Returns: OrganisationID, OrganisationName,  Logo, Notes, DefaultLessonFrequency, DefaultQuizFrequency, DefaultQuizPassMark, CreatedBy, DateCreated,  UpdatedBy, DateUpdated

Called By: Organisation.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Peter Vranich
Date Created: 4th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	aaronc		May 2008		Added retrieval of CPDReportName
#2	aaronc		June2008		Added retrieval of AllocatedDiskSpace
*/

CREATE procedure [dbo].[prcOrganisation_GetOne]
(
@LangCode nvarchar(10),
@orgID Integer = null -- OrganisationID
)

As

If @orgID Is Null
Begin
Raiserror(''''''The Parameter @orgID was null.  @orgID does not accept Null values.'''''', 16, 1)
Return
End

Select
o.OrganisationID,
o.OrganisationName,
o.Logo,
orgN.Notes,
o.DefaultLessonFrequency,
o.DefaultQuizFrequency,
o.DefaultQuizPassMark,
dbo.udfUTCtoDaylightSavingTime(o.DefaultLessonCompletionDate, o.OrganisationID) as DefaultLessonCompletionDate,
dbo.udfUTCtoDaylightSavingTime(o.DefaultQuizCompletionDate, o.OrganisationID) as DefaultQuizCompletionDate,
o.AdvancedReporting,
o.CreatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateCreated, o.OrganisationID) as DateCreated,
o.UpdatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateUpdated, o.OrganisationID)as DateUpdated,
o.CPDReportName,
o.AllocatedDiskSpace,
o.IncludeCertificateLogo,
o.PasswordLockout,
o.TimeZoneID,
o.WarnMgrsofDeliquentUsers,
o.WarnUsersofDelinquency,
o.NumberOfReminders,
o.DelinquencyPeriod,
o.DelinquencyReminderPeriod,
o.DaysWarningBeforeExpiry
From
tblOrganisation o
left join tblOrganisationNotes orgN
on o.OrganisationID = orgN.OrganisationID
left join tblLang l
on orgN.LanguageID = l.LangID
Where
o.OrganisationID = @orgID
and l.LangCode = @LangCode
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/18/2011 09:15:55 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUpdateOrgDeliquency]
GO

/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/18/2011 09:15:55 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra
-- Create date: 17/06/2011
-- Description:	Update Delinquency settings for Organisation
-- =============================================
CREATE PROCEDURE [dbo].[prcUpdateOrgDeliquency] 

	@WarnMgrsofDeliquentUsers bit,
	@WarnUsersofDelinquency bit,
	@NumberOfReminders int,
	@DelinquencyPeriod int,
	@DelinquencyReminderPeriod int,
	@DaysWarningBeforeExpiry int

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	UPDATE tblOrganisation SET WarnMgrsofDeliquentUsers = @WarnMgrsofDeliquentUsers,
		WarnUsersofDelinquency = @WarnUsersofDelinquency,
		NumberOfReminders = @NumberOfReminders,
		DelinquencyPeriod = @DelinquencyPeriod,
		DelinquencyReminderPeriod = @DelinquencyReminderPeriod,
		DaysWarningBeforeExpiry = @DaysWarningBeforeExpiry

END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgMidnight]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfGetSaltOrgMidnight]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfGetSaltOrgMidnight]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'CREATE FUNCTION [udfGetSaltOrgMidnight]
(
		@OrgID int

)
RETURNS DateTime
AS
BEGIN

	DECLARE @ORGDate DateTime ,@OrgMidnight datetime

	SELECT @OrgMidnight = CAST(convert( varchar(11), dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(),@OrgID),113) AS DateTime)

	SELECT @ORGDate = dbo.udfDaylightSavingTimeToUTC(@OrgMidnight,@OrgID)

	RETURN @ORGDate

END

' 
END

GO


/****** Object:  StoredProcedure [dbo].[prcDeleteTimezoneDaylightSavingRule]    Script Date: 06/20/2011 10:15:23 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcDeleteTimezoneDaylightSavingRule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcDeleteTimezoneDaylightSavingRule]
GO

/****** Object:  StoredProcedure [dbo].[prcDeleteTimezoneDaylightSavingRule]    Script Date: 06/20/2011 10:15:23 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcDeleteTimezoneDaylightSavingRule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Deletes Daylight saving rule for timezone
-- =============================================
CREATE PROCEDURE [dbo].[prcDeleteTimezoneDaylightSavingRule]
	@TimezoneId int,
	@StartYear smallint
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DELETE FROM tblTimeZoneDaylightSavingRules
		WHERE TimezoneID=@TimezoneId AND start_year=@StartYear
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/20/2011 10:15:48 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZoneRule_update]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/20/2011 10:15:48 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Updates the daylight saving rule for timeaone
-- =============================================
CREATE PROCEDURE [dbo].[prcTimeZoneRule_update] 
(
	@WrittenName NVarChar(60), 
	@OffsetDaylight Int, 
	@year_start Int, 
	@year_end  Int, 
	@StartTimeOfDay Int, 
	@day_start Int, 
	@week_start Int, 
	@StartMonth Int, 
	@EndTimeOfDay Int, 
	@EndDayOfWeek Int, 
	@EndWeek Int, 
	@EndMonth Int,
	@Error bit out
)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?

	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)

			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)


	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE ((first_start_date < @Period_end) AND (last_end_date > @Period_start))
	AND TimezoneID = @TimezoneID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		UPDATE tblTimeZoneDaylightSavingRules SET
			   TimezoneID=@TimezoneID
			   , offset_mins=@OffsetDaylight
			   , start_year=@year_start
			   , end_year=@year_end
			   , hours_start=@StartTimeOfDay
			   , day_start=@day_start
			   , week_start=@week_start
			   , month_start=@StartMonth
			   , hours_end=@EndTimeOfDay
			   , day_end=@EndDayOfWeek
			   , week_end=@EndWeek
			   , month_end=@EndMonth
			   , first_start_date=@Period_start
			   , last_end_date=@Period_end

		SET @Error = 0
	END
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/20/2011 10:17:34 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcGetTimezoneDaylightRules]
GO

/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/20/2011 10:17:34 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Gets daylight saving rules for timezone and start year
-- =============================================
CREATE PROCEDURE [dbo].[prcGetTimezoneDaylightRules] 
	@TimezoneId int,
	@StartYear smallint
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT tz.WrittenName AS WrittenName, tzd.first_start_date AS FirstStartDate, tzd.last_end_date AS LastEndDate, tzd.offset_mins AS Offset,
		tzd.hours_start AS TimeStart, tzd.day_start AS WeekdayStart, tzd.week_start AS WeekStart, tzd.month_start AS MonthStart,
		tzd.hours_end AS TimeEnd, tzd.day_end AS WeekdayEnd, tzd.week_end AS WeekEnd, tzd.month_end AS MonthEnd  
		FROM tblTimeZoneDaylightSavingRules tzd JOIN tblTimeZone tz ON tzd.TimezoneID = tz.TimeZoneID
		WHERE tzd.TimezoneID=@TimezoneId AND tzd.start_year=@StartYear

END
' 
END
GO













IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetAdministratorsEmailAddress]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_GetAdministratorsEmailAddress]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetAdministratorsEmailAddress]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




CREATE PROCEDURE [prcUnit_GetAdministratorsEmailAddress]
(
	@unitID	int
)

AS

select coalesce(
-- try to get the closest unit admin then search further afield
(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
and u.unitID=@unitID
and u.Email is not null),


(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
	and u.Email is not null),

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 2
and Email is not null),
	

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 1
and Email is not null),

--all else failed so get the salt admin
(Select top 1	u.Email
from tblUser u 
where UserTypeID = 1
and Email is not null))
	



' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUser_GetAdministratorsEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfUser_GetAdministratorsEmailAddress]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUser_GetAdministratorsEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'




create function [udfUser_GetAdministratorsEmailAddress]
(
	@UserID	int
)
Returns varchar(100)
AS
BEGIN
DECLARE @UnitID int
SELECT @UnitID = UnitID FROM tblUser WHERE UserID = @UserID

DECLARE @Email VARCHAR(100)
SELECT @Email = coalesce(
-- try to get the closest unit admin then search further afield
(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
and u.unitID=@unitID
and u.Email is not null),


(Select top 1	u.Email
from tblUnitAdministrator ua
	inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
	and u.usertypeID=3 --Unit administrator(3)
	and u.Email is not null),

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 2
and Email is not null),
	

(Select top 1	u.Email
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 1
and Email is not null),

--all else failed so get the salt admin
(Select top 1	u.Email
from tblUser u 
where UserTypeID = 1
and Email is not null))
	


return @Email
END' 
END

GO


/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/22/2011 10:52:01 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUpdateOrgDeliquency]
GO

/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/22/2011 10:52:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra
-- Create date: 17/06/2011
-- Description:	Update Delinquency settings for Organisation
-- =============================================
CREATE PROCEDURE [dbo].[prcUpdateOrgDeliquency] 

	@WarnMgrsofDeliquentUsers bit,
	@WarnUsersofDelinquency bit,
	@NumberOfReminders int,
	@DelinquencyPeriod int,
	@DelinquencyReminderPeriod int,
	@DaysWarningBeforeExpiry int,
	@IncludeLogo bit,
	@QuizDueDate datetime

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	UPDATE tblOrganisation SET WarnMgrsofDeliquentUsers = @WarnMgrsofDeliquentUsers,
		WarnUsersofDelinquency = @WarnUsersofDelinquency,
		NumberOfReminders = @NumberOfReminders,
		DelinquencyPeriod = @DelinquencyPeriod,
		DelinquencyReminderPeriod = @DelinquencyReminderPeriod,
		DaysWarningBeforeExpiry = @DaysWarningBeforeExpiry,
		IncludeLogoOnCorrespondence = @IncludeLogo,
		QuizDueDate = @QuizDueDate
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/22/2011 10:52:45 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetOne]    Script Date: 06/22/2011 10:52:45 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets othe details of one Organisation
Parameters: @orgID integer
Returns: OrganisationID, OrganisationName,  Logo, Notes, DefaultLessonFrequency, DefaultQuizFrequency, DefaultQuizPassMark, CreatedBy, DateCreated,  UpdatedBy, DateUpdated

Called By: Organisation.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Peter Vranich
Date Created: 4th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	aaronc		May 2008		Added retrieval of CPDReportName
#2	aaronc		June2008		Added retrieval of AllocatedDiskSpace
*/

CREATE procedure [dbo].[prcOrganisation_GetOne]
(
@LangCode nvarchar(10),
@orgID Integer = null -- OrganisationID
)

As

If @orgID Is Null
Begin
Raiserror(''''''''''The Parameter @orgID was null.  @orgID does not accept Null values.'''''''''', 16, 1)
Return
End

Select
o.OrganisationID,
o.OrganisationName,
o.Logo,
orgN.Notes,
o.DefaultLessonFrequency,
o.DefaultQuizFrequency,
o.DefaultQuizPassMark,
dbo.udfUTCtoDaylightSavingTime(o.DefaultLessonCompletionDate, o.OrganisationID) as DefaultLessonCompletionDate,
dbo.udfUTCtoDaylightSavingTime(o.DefaultQuizCompletionDate, o.OrganisationID) as DefaultQuizCompletionDate,
o.AdvancedReporting,
o.CreatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateCreated, o.OrganisationID) as DateCreated,
o.UpdatedBy,
dbo.udfUTCtoDaylightSavingTime(o.DateUpdated, o.OrganisationID)as DateUpdated,
o.CPDReportName,
o.AllocatedDiskSpace,
o.IncludeCertificateLogo,
o.PasswordLockout,
o.TimeZoneID,
o.WarnMgrsofDeliquentUsers,
o.WarnUsersofDelinquency,
o.NumberOfReminders,
o.DelinquencyPeriod,
o.DelinquencyReminderPeriod,
o.DaysWarningBeforeExpiry,
o.IncludeLogoOnCorrespondence,
o.QuizDueDate
From
tblOrganisation o
left join tblOrganisationNotes orgN
on o.OrganisationID = orgN.OrganisationID
left join tblLang l
on orgN.LanguageID = l.LangID
Where
o.OrganisationID = @orgID
and l.LangCode = @LangCode
' 
END
GO

-- for alter column

if  exists (select * from sysobjects o, syscolumns c 
    	    	where o.id = c.id and o.type = 'U' and o.name = 'tbltimezone'
				and c.name = 'FLB_Name')
begin
    --increase the size for FLB_Name in tbltimezone table
	exec ('alter table tbltimezone alter column FLB_Name nchar(240) null')
end
GO
 


/* Fixed bug in unit pathway report for sub units */

/****** Object:  UserDefinedFunction [dbo].[udfGetUnitIDPathway]    Script Date: 06/22/2011 16:00:09 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfGetUnitIDPathway]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfGetUnitIDPathway]
GO

/****** Object:  UserDefinedFunction [dbo].[udfGetUnitIDPathway]    Script Date: 06/22/2011 16:00:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfGetUnitIDPathway]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'

/****** Object:  User Defined Function dbo.udfGetUnitPathway    Script Date: 20/04/2004 8:25:57 AM ******/

/*
Summary:
user Defined Function that returns pathway of a specified unit
Returns:
">" delimited pathway of a unit
e.g. "Unit 1 > Unit 2 > Unit 5 > Unit 7"

Called By:

Calls:

Remarks:


Author: Jack Liu
Date Created: 6 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1


select  dbo.udfGetUnitIDPathway(9)

select dbo.udfGetUnitPathway(UnitID)
from tblUnit

**/
CREATE  FUNCTION [dbo].[udfGetUnitIDPathway]
(
@UnitID int
)
RETURNS varchar(4000)
Begin

declare @strPathway varchar(4000)
declare @strHierarchy varchar(500)

select @strHierarchy='',''+hierarchy+'',''
from tblUnit
where UnitID = @UnitID

--Convert unit ID hierarchy ''1,2,5,7'' to pathway ''Unit 1 > Unit 2 > Unit 5 > Unit 7''

select @strPathway=IsNull(@strPathway+'' > '','''')+UnitID
from tblUnit
where charindex(@strHierarchy, '',''+cast(UnitID as varchar)+'','')>0
order by [Level]

--select @strPathway

RETURN @strPathway
End







' 
END

GO

/* Fixed Organisation Mail Setup bugs */

/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/22/2011 16:10:02 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUpdateOrgDeliquency]
GO

/****** Object:  StoredProcedure [dbo].[prcUpdateOrgDeliquency]    Script Date: 06/22/2011 16:10:02 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUpdateOrgDeliquency]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra
-- Create date: 17/06/2011
-- Description:	Update Delinquency settings for Organisation
-- =============================================
CREATE PROCEDURE [dbo].[prcUpdateOrgDeliquency] 

	@OrgID int,
	@WarnMgrsofDeliquentUsers bit,
	@WarnUsersofDelinquency bit,
	@NumberOfReminders int,
	@DelinquencyPeriod int,
	@DelinquencyReminderPeriod int,
	@DaysWarningBeforeExpiry int,
	@IncludeLogo bit,
	@QuizDueDate datetime

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	UPDATE tblOrganisation SET WarnMgrsofDeliquentUsers = @WarnMgrsofDeliquentUsers,
		WarnUsersofDelinquency = @WarnUsersofDelinquency,
		NumberOfReminders = @NumberOfReminders,
		DelinquencyPeriod = @DelinquencyPeriod,
		DelinquencyReminderPeriod = @DelinquencyReminderPeriod,
		DaysWarningBeforeExpiry = @DaysWarningBeforeExpiry,
		IncludeLogoOnCorrespondence = @IncludeLogo,
		QuizDueDate = @QuizDueDate
		WHERE OrganisationID = @OrgID
END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_ManagersToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_ManagersToNotify]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_ManagersToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcAutomatedEmails_ManagersToNotify]
(
@OrganisationID int
)


AS

BEGIN







--                    S E L E C T    T H E    R E S U L T S

--declare @OrganisationID int
--set @OrganisationID = 109

;with UsersToNotify (userid,DelinquentCourse) as (
SELECT distinct UsersToNotify.userid , UsersToNotify.DelinquentCourse FROM
(


-- delinquent users
SELECT DISTINCT CD.UserCourseStatusID as UserCourseStatusID, CS.userID , u.username, C.Name     as DelinquentCourse
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID
INNER JOIN tblUserCourseDetails UCD ON (UCD.UserID = u.UserID AND UCD.CourseID = C.CourseID)
where coursestatusid = 1 AND o.OrganisationID = @OrganisationID AND (GETUTCDATE() > DATEADD(d,o.DelinquencyPeriod+1, CS.DateCreated))
AND UCD.LastDelNoteToMgr = 0 and WarnMgrsofDeliquentUsers = 1 and U.active = 1



)  UsersToNotify
)

, UsersToNotifyList(numb, userid,DelinquentCourse) as
(
select 1,null,CAST('''' AS VARCHAR(max))
UNION ALL

SELECT cte.numb + 1,pl.userid,CAST(cte.DelinquentCourse + (case when cte.DelinquentCourse = '''' or pl.DelinquentCourse = '''' then '''' else CHAR(13)+ CHAR(10) end ) + pl.DelinquentCourse AS VARCHAR(max))
from (  SELECT

RowNum = Row_Number() OVER (partition BY userid order by userid)
,userid,DelinquentCourse

FROM UsersToNotify
) AS pl
join UsersToNotifyList cte on pl.RowNum = cte.numb and (cte.userid is null or pl.userid = cte.userid)
)





, ManagersToNotify(numb, username, ManagerEmail ,DelinquentCourse) as
(
select UL.numb, U.username,
CASE WHEN 
(
	(U.DelinquencyManagerEmail is null) 
	or (CHARINDEX(''@'',U.DelinquencyManagerEmail) = 0)
) THEN  
CAST(dbo.udfUser_GetAdministratorsEmailAddress(U.UserID) AS VARCHAR(max)) 
ELSE  CAST(U.DelinquencyManagerEmail AS VARCHAR(max)) 
END ,
DelinquentCourse
FROM UsersToNotifyList UL
inner join (select max(s.numb) as numb ,userid from UsersToNotifyList s group by userid)m on m.userid = UL.userid and m.numb = UL.numb
INNER JOIN tblUser U ON U.UserID = UL.UserID
)

, ManagersToNotifyList(numb, ManagerEmail, UserCourseList) as
(
select 1,CAST(null AS VARCHAR(max)),CAST('''' AS VARCHAR(max))
UNION ALL

SELECT cte.numb + 1,pl.ManagerEmail,CAST(cte.UserCourseList + (case when cte.UserCourseList = '''' or pl.UserCourseList = '''' then '''' else CHAR(13)+ CHAR(10) end ) + pl.UserCourseList AS VARCHAR(max))
from (  SELECT

RowNum = Row_Number() OVER (partition BY ManagerEmail order by ManagerEmail)
,cast(ManagerEmail AS VARCHAR(max)) as ManagerEmail, CAST(username + '' '' + DelinquentCourse AS VARCHAR(max)) as UserCourseList

FROM ManagersToNotify
) AS pl
join ManagersToNotifyList cte on pl.RowNum = cte.numb and (cte.ManagerEmail is null or pl.ManagerEmail = cte.ManagerEmail)
)

--select * from ManagersToNotify
--select * from ManagersToNotifyList




SELECT l.ManagerEmail,
-- Recipient Email Address
l.ManagerEmail as RecipientEmail,

-- Sender Email Address
l.ManagerEmail as SenderEmail,

-- Subject
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Subject'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Subject''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Subject,



-- Header
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Header'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Header''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName'')))



--delinquent
+ UserCourseList+ CHAR(13)+ CHAR(10)

--Email Sig
+     (select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Sig'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Sig'')))+ CHAR(13)+ CHAR(10)  ,''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Body
,


*

FROM
ManagersToNotifyList l

join (select max(s.numb) numb ,ManagerEmail from ManagersToNotifyList s group by ManagerEmail)m on m.ManagerEmail = l.ManagerEmail and m.numb = l.numb
ORDER BY l.numb DESC



UPDATE tblUserCourseDetails SET LastDelNoteToMgr  = 1
from tblUserCourseDetails
join (
SELECT U.userID , C.CourseID
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID
INNER JOIN tblUserCourseDetails UCD ON (UCD.UserID = u.UserID AND UCD.CourseID = C.CourseID)
where coursestatusid = 1 AND o.OrganisationID = @OrganisationID AND (GETUTCDATE() > DATEADD(d,o.DelinquencyPeriod+1, CS.DateCreated))
AND UCD.LastDelNoteToMgr = 0
) a on a.userid = tblUserCourseDetails.UserID and a.CourseID = tblUserCourseDetails.CourseID
 


END
' 
END
GO






set nocount on

delete from [tblTimeZoneDaylightSavingRules]

INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (1, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 1, 5, 8, CAST(0x00009AAC0041EB00 AS DateTime), CAST(0x00009B080041EB00 AS DateTime), CAST(0x00009F09015B22B9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (1, 2009, 2009, 60, 1439, 1, 5, 5, 1439, 5, 3, 8, CAST(0x00009C190041EB00 AS DateTime), CAST(0x00009C6A0041EB00 AS DateTime), CAST(0x00009F09015B22B9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (2, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 1, 5, 8, CAST(0x00009AAC0041EB00 AS DateTime), CAST(0x00009B080041EB00 AS DateTime), CAST(0x00009F0901505461 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (2, 2009, 2009, 60, 1439, 1, 5, 5, 1439, 5, 3, 8, CAST(0x00009C190041EB00 AS DateTime), CAST(0x00009C6A0041EB00 AS DateTime), CAST(0x00009F0901505466 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (3, 1970, 2999, 60, 60, 1, 5, 3, 120, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2312 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (4, 1970, 2999, 60, 60, 1, 5, 3, 120, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F0901505474 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (5, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2320 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (6, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2329 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (7, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2338 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (8, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2341 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (9, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152F835 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (10, 1970, 2006, 60, 0, 5, 5, 3, 60, 6, 5, 9, CAST(0x000064320041EB00 AS DateTime), CAST(0x0000984A0041EB00 AS DateTime), CAST(0x00009F09015B234A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (10, 2007, 2999, 60, 1439, 5, 5, 3, 60, 6, 5, 10, CAST(0x000098FF0041EB00 AS DateTime), CAST(0x000621220041EB00 AS DateTime), CAST(0x00009F09015B2370 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (11, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B238C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (12, 1970, 2999, 60, 0, 1, 5, 3, 0, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2395 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 1970, 2005, 60, 0, 6, 5, 4, 1439, 5, 5, 9, CAST(0x0000644F0041EB00 AS DateTime), CAST(0x000096DD0041EB00 AS DateTime), CAST(0x00009F09015B239F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 2006, 2006, 60, 0, 6, 5, 4, 1439, 5, 3, 9, CAST(0x000097B00041EB00 AS DateTime), CAST(0x000098420041EB00 AS DateTime), CAST(0x00009F09015B23A3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 2007, 2007, 60, 1439, 5, 5, 4, 1439, 5, 1, 9, CAST(0x0000991B0041EB00 AS DateTime), CAST(0x000099A00041EB00 AS DateTime), CAST(0x00009F09015B23A8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 2008, 2008, 60, 1439, 5, 5, 4, 1439, 5, 5, 8, CAST(0x00009A870041EB00 AS DateTime), CAST(0x00009B050041EB00 AS DateTime), CAST(0x00009F09015B23D2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 2009, 2009, 60, 1439, 5, 4, 4, 1439, 5, 5, 9, CAST(0x00009BF30041EB00 AS DateTime), CAST(0x00009C8D0041EB00 AS DateTime), CAST(0x00009F09015B2401 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (13, 2010, 2999, 60, 1439, 5, 5, 4, 1439, 5, 5, 9, CAST(0x00009D660041EB00 AS DateTime), CAST(0x000621050041EB00 AS DateTime), CAST(0x00009F09015B2450 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 1970, 2009, 60, 0, 1, 5, 3, 0, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x00009CAC0020F580 AS DateTime), CAST(0x00009F090152F85F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2010, 2010, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x00009D450041EB00 AS DateTime), CAST(0x00009E1E0020F580 AS DateTime), CAST(0x00009F090152F864 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2011, 2011, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x00009EB10041EB00 AS DateTime), CAST(0x00009F8A0020F580 AS DateTime), CAST(0x00009F090152F868 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2012, 2012, 60, 1439, 7, 4, 3, 1439, 7, 5, 10, CAST(0x0000A01D0041EB00 AS DateTime), CAST(0x0000A0F60020F580 AS DateTime), CAST(0x00009F090152F872 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2013, 2013, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000A1900041EB00 AS DateTime), CAST(0x0000A2620020F580 AS DateTime), CAST(0x00009F090152F877 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2014, 2014, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000A2FC0041EB00 AS DateTime), CAST(0x0000A3CE0020F580 AS DateTime), CAST(0x00009F090152F87B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2015, 2015, 60, 1439, 7, 5, 3, 1439, 7, 4, 10, CAST(0x0000A4680041EB00 AS DateTime), CAST(0x0000A53A0020F580 AS DateTime), CAST(0x00009F090152F885 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2016, 2016, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000A5D40041EB00 AS DateTime), CAST(0x0000A6AD0020F580 AS DateTime), CAST(0x00009F090152F889 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2017, 2017, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000A7400041EB00 AS DateTime), CAST(0x0000A8190020F580 AS DateTime), CAST(0x00009F090152F88E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2018, 2018, 60, 1439, 7, 4, 3, 1439, 7, 5, 10, CAST(0x0000A8AC0041EB00 AS DateTime), CAST(0x0000A9850020F580 AS DateTime), CAST(0x00009F090152F897 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2019, 2019, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000AA1F0041EB00 AS DateTime), CAST(0x0000AAF10020F580 AS DateTime), CAST(0x00009F090152F89C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2020, 2020, 60, 1439, 7, 5, 3, 1439, 7, 4, 10, CAST(0x0000AB8B0041EB00 AS DateTime), CAST(0x0000AC5D0020F580 AS DateTime), CAST(0x00009F090152F8A1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (14, 2021, 2999, 60, 1439, 7, 5, 3, 1439, 7, 5, 10, CAST(0x0000ACF70041EB00 AS DateTime), CAST(0x000621230041EB00 AS DateTime), CAST(0x00009F090152F8AA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (15, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B245A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2005, 2005, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x000096280041EB00 AS DateTime), CAST(0x000096E70041EB00 AS DateTime), CAST(0x00009F09015B2463 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2006, 2006, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x000097940041EB00 AS DateTime), CAST(0x0000984C0041EB00 AS DateTime), CAST(0x00009F09015B2468 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2007, 2007, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x000099000041EB00 AS DateTime), CAST(0x000099AA0041EB00 AS DateTime), CAST(0x00009F09015B246D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2008, 2008, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x00009A6C0041EB00 AS DateTime), CAST(0x00009B2B0041EB00 AS DateTime), CAST(0x00009F09015B2471 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2009, 2009, 60, 120, 6, 5, 3, 120, 1, 5, 9, CAST(0x00009BD80041EB00 AS DateTime), CAST(0x00009C900041EB00 AS DateTime), CAST(0x00009F09015B2476 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2010, 2010, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x00009D440041EB00 AS DateTime), CAST(0x00009DEE0041EB00 AS DateTime), CAST(0x00009F09015B247B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2011, 2011, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x00009EB70041EB00 AS DateTime), CAST(0x00009F6F0041EB00 AS DateTime), CAST(0x00009F09015B247F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2012, 2012, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A0230041EB00 AS DateTime), CAST(0x0000A0D40041EB00 AS DateTime), CAST(0x00009F09015B2484 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2013, 2013, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000A18F0041EB00 AS DateTime), CAST(0x0000A2320041EB00 AS DateTime), CAST(0x00009F09015B2489 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2014, 2014, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A2FB0041EB00 AS DateTime), CAST(0x0000A3B30041EB00 AS DateTime), CAST(0x00009F09015B248E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2015, 2015, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A4670041EB00 AS DateTime), CAST(0x0000A5180041EB00 AS DateTime), CAST(0x00009F09015B2492 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2016, 2016, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x0000A5DA0041EB00 AS DateTime), CAST(0x0000A6990020F580 AS DateTime), CAST(0x00009F09015B2497 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2017, 2017, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A7460041EB00 AS DateTime), CAST(0x0000A7F70041EB00 AS DateTime), CAST(0x00009F09015B249B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2018, 2018, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A8B20041EB00 AS DateTime), CAST(0x0000A95C0041EB00 AS DateTime), CAST(0x00009F09015B24A0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2019, 2019, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x0000AA1E0041EB00 AS DateTime), CAST(0x0000AADD0041EB00 AS DateTime), CAST(0x00009F09015B24A5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2020, 2020, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000AB8A0041EB00 AS DateTime), CAST(0x0000AC420041EB00 AS DateTime), CAST(0x00009F09015B24A9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2021, 2021, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000ACF60041EB00 AS DateTime), CAST(0x0000ADA00041EB00 AS DateTime), CAST(0x00009F09015B24AE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (16, 2022, 2022, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x0000AE690041EB00 AS DateTime), CAST(0x0000AF210041EB00 AS DateTime), CAST(0x00009F09015B24B3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (17, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B24C1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (18, 1970, 2999, -60, 120, 1, 1, 4, 120, 1, 1, 9, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000620EC0041EB00 AS DateTime), CAST(0x00009F09015B24CA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (19, 1970, 2006, 60, 180, 1, 1, 4, 240, 1, 1, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x0000984C0041EB00 AS DateTime), CAST(0x00009F09015B24D9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (19, 2007, 2007, 60, 180, 1, 1, 4, 240, 2, 1, 10, CAST(0x000099020041EB00 AS DateTime), CAST(0x000099B90041EB00 AS DateTime), CAST(0x00009F09015B24D9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (20, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152F96A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (21, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B24DD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (22, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F0901555D8A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (23, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152F986 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (24, 1970, 2005, 60, 120, 1, 1, 3, 120, 3, 4, 9, CAST(0x000064190041EB00 AS DateTime), CAST(0x000096DB0041EB00 AS DateTime), CAST(0x00009F09015B24EB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (24, 2008, 2008, 60, 1439, 5, 3, 3, 1439, 7, 3, 9, CAST(0x00009A640041EB00 AS DateTime), CAST(0x00009B1C0041EB00 AS DateTime), CAST(0x00009F09015B24F0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (24, 2009, 2999, 60, 1439, 7, 3, 3, 1439, 2, 3, 9, CAST(0x00009BD20041EB00 AS DateTime), CAST(0x000620FB0041EB00 AS DateTime), CAST(0x00009F09015B24F4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (25, 1970, 2005, 60, 120, 1, 1, 3, 120, 3, 4, 9, CAST(0x000064190041EB00 AS DateTime), CAST(0x000096DB0041EB00 AS DateTime), CAST(0x00009F090152F999 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (25, 2007, 2007, 60, 1439, 5, 5, 3, 1439, 5, 1, 11, CAST(0x000098FF0041EB00 AS DateTime), CAST(0x000099D80041EB00 AS DateTime), CAST(0x00009F0901555DB9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (25, 2008, 2008, 60, 1439, 5, 3, 3, 1439, 7, 3, 9, CAST(0x00009A640041EB00 AS DateTime), CAST(0x00009B1C0041EB00 AS DateTime), CAST(0x00009F090152F99D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (25, 2009, 2999, 60, 1439, 7, 3, 3, 1439, 2, 3, 9, CAST(0x00009BD20041EB00 AS DateTime), CAST(0x000620FB0041EB00 AS DateTime), CAST(0x00009F090152F9A2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (26, 1970, 2999, 60, 240, 1, 5, 3, 300, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B24FE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (27, 2008, 2008, 60, 120, 1, 5, 10, 0, 3, 1, 1, CAST(0x00009B400020F580 AS DateTime), CAST(0x00009A150041EB00 AS DateTime), CAST(0x00009F09015B250C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (27, 2009, 2999, 60, 120, 1, 5, 10, 120, 1, 5, 3, CAST(0x00009CAC0020F580 AS DateTime), CAST(0x000620520041EB00 AS DateTime), CAST(0x00009F09015B2511 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (28, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B251A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (29, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F0901555E24 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (30, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2524 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (31, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 6, 5, 10, CAST(0x00009AAC0041EB00 AS DateTime), CAST(0x00009B450020F580 AS DateTime), CAST(0x00009F09015B252D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (31, 2009, 2009, 60, 1439, 3, 2, 4, 1439, 7, 5, 10, CAST(0x00009BEA0041EB00 AS DateTime), CAST(0x00009CB20020F580 AS DateTime), CAST(0x00009F09015B2531 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (32, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152F9D1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (33, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 6, 5, 10, CAST(0x00009AAC0041EB00 AS DateTime), CAST(0x00009B450020F580 AS DateTime), CAST(0x00009F090152F9DF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (33, 2009, 2009, 60, 1439, 3, 2, 4, 1439, 7, 5, 10, CAST(0x00009BEA0041EB00 AS DateTime), CAST(0x00009CB20020F580 AS DateTime), CAST(0x00009F090152F9E4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (34, 1970, 2005, 60, 120, 1, 1, 3, 120, 3, 4, 9, CAST(0x000064190041EB00 AS DateTime), CAST(0x000096DB0041EB00 AS DateTime), CAST(0x00009F0901555E4A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (34, 2008, 2008, 60, 1439, 5, 3, 3, 1439, 7, 3, 9, CAST(0x00009A640041EB00 AS DateTime), CAST(0x00009B1C0041EB00 AS DateTime), CAST(0x00009F0901555E4F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (34, 2009, 2999, 60, 1439, 7, 3, 3, 1439, 2, 3, 9, CAST(0x00009BD20041EB00 AS DateTime), CAST(0x000620FB0041EB00 AS DateTime), CAST(0x00009F0901555E53 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (36, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B253F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (37, 2008, 2008, 60, 120, 1, 5, 10, 0, 3, 1, 1, CAST(0x00009B400020F580 AS DateTime), CAST(0x00009A150041EB00 AS DateTime), CAST(0x00009F0901555E6F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (37, 2009, 2009, 60, 0, 5, 1, 1, 120, 1, 5, 3, CAST(0x00009B8300317040 AS DateTime), CAST(0x00009BDA0041EB00 AS DateTime), CAST(0x00009F0901555E74 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (39, 2009, 2009, 60, 1380, 6, 3, 6, 1439, 5, 5, 12, CAST(0x00009C2C0041EB00 AS DateTime), CAST(0x00009CEF0020F580 AS DateTime), CAST(0x00009F090152FA3D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (40, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B254E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (41, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F0901555E95 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (42, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2557 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (43, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152FA5E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (44, 2006, 2006, 60, 120, 1, 1, 12, 0, 1, 1, 1, CAST(0x0000988B0020F580 AS DateTime), CAST(0x0000973B00317040 AS DateTime), CAST(0x00009F09015B2560 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (44, 2007, 2999, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000099D40041EB00 AS DateTime), CAST(0x000620520041EB00 AS DateTime), CAST(0x00009F09015B2565 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (45, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152FA70 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (47, 2006, 2006, 60, 120, 1, 1, 12, 0, 1, 1, 1, CAST(0x0000988B0020F580 AS DateTime), CAST(0x0000973B00317040 AS DateTime), CAST(0x00009F090152FA83 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (47, 2007, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000099D40041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F090152FA88 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (47, 2008, 2008, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x00009B400020F580 AS DateTime), CAST(0x00009A6E0041EB00 AS DateTime), CAST(0x00009F090152FA8D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (47, 2009, 2009, 60, 0, 5, 1, 1, 180, 1, 5, 3, CAST(0x00009B8300317040 AS DateTime), CAST(0x00009BDA0041EB00 AS DateTime), CAST(0x00009F090152FA91 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (48, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2573 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (49, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065070041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F09015B2599 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (49, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2B0041EB00 AS DateTime), CAST(0x000620590041EB00 AS DateTime), CAST(0x00009F09015B25BE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (52, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065070041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F09015B25F2 AS DateTime))
GO

INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (52, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2B0041EB00 AS DateTime), CAST(0x000620590041EB00 AS DateTime), CAST(0x00009F09015B25FB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (53, 1970, 2007, 60, 120, 1, 1, 10, 180, 1, 5, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F090099BC16 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (53, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F090099BC66 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (54, 1970, 2007, 60, 120, 1, 1, 10, 180, 1, 5, 3, CAST(0x000064F20041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F09015B2605 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (54, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2B0041EB00 AS DateTime), CAST(0x000620590041EB00 AS DateTime), CAST(0x00009F09015B2609 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (55, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2612 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 1970, 2006, 60, 120, 1, 1, 10, 180, 1, 3, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000097870128A180 AS DateTime), CAST(0x00009F090099BC7D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 2006, 2006, 60, 120, 1, 1, 12, 0, 1, 1, 1, CAST(0x0000988B0020F580 AS DateTime), CAST(0x0000973B00317040 AS DateTime), CAST(0x00009F0901555EFC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 2007, 2007, 60, 120, 1, 5, 9, 180, 1, 3, 3, CAST(0x000099B70128A180 AS DateTime), CAST(0x000098F30128A180 AS DateTime), CAST(0x00009F090099BCC4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 2007, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000099D40041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F0901555F01 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 2008, 2999, 60, 120, 1, 5, 9, 180, 1, 1, 4, CAST(0x00009B230128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F090099BCDB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (56, 2008, 2008, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x00009B400020F580 AS DateTime), CAST(0x00009A6E0041EB00 AS DateTime), CAST(0x00009F0901555F0A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (57, 1970, 2006, 60, 120, 1, 1, 10, 180, 1, 3, 3, CAST(0x000064F20041EB00 AS DateTime), CAST(0x000097880041EB00 AS DateTime), CAST(0x00009F09015B261C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (57, 2007, 2007, 60, 120, 1, 5, 9, 180, 1, 3, 3, CAST(0x000099B80041EB00 AS DateTime), CAST(0x000098F40041EB00 AS DateTime), CAST(0x00009F09015B2620 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (57, 2008, 2999, 60, 120, 1, 5, 9, 180, 1, 1, 4, CAST(0x00009B240041EB00 AS DateTime), CAST(0x000620590041EB00 AS DateTime), CAST(0x00009F09015B2625 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (58, 1970, 2007, 60, 120, 1, 1, 10, 180, 1, 5, 3, CAST(0x000064F20041EB00 AS DateTime), CAST(0x000098FB0041EB00 AS DateTime), CAST(0x00009F090152FAE1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (58, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2B0041EB00 AS DateTime), CAST(0x000620590041EB00 AS DateTime), CAST(0x00009F090152FAE6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (59, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2633 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (60, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152FAF8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (61, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B263D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (62, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650D00F73140 AS DateTime), CAST(0x000097640128A180 AS DateTime), CAST(0x00009F090099BD5F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (62, 2007, 2007, 60, 120, 1, 5, 9, 180, 1, 3, 3, CAST(0x000099B80041EB00 AS DateTime), CAST(0x000098F40041EB00 AS DateTime), CAST(0x00009F090152FB0B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (62, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C50128A180 AS DateTime), CAST(0x000098DE0128A180 AS DateTime), CAST(0x00009F090099BD63 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (62, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A430128A180 AS DateTime), CAST(0x00009F090099BD68 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (62, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006201F0128A180 AS DateTime), CAST(0x00009F090099BD6D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (63, 1970, 2999, 60, 120, 1, 5, 3, 120, 1, 5, 9, CAST(0x000064350041EB00 AS DateTime), CAST(0x000621080041EB00 AS DateTime), CAST(0x00009F09015B2646 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (64, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650E0020F580 AS DateTime), CAST(0x000097650041EB00 AS DateTime), CAST(0x00009F09015B2654 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (64, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C60041EB00 AS DateTime), CAST(0x000098DF0041EB00 AS DateTime), CAST(0x00009F09015B2659 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (64, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B380020F580 AS DateTime), CAST(0x00009A440041EB00 AS DateTime), CAST(0x00009F09015B265D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (64, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA40020F580 AS DateTime), CAST(0x000620200041EB00 AS DateTime), CAST(0x00009F09015B2662 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (65, 1970, 0, 0, 0, 7, 3, 10, 0, 1, 3, 3, CAST(0x000064FF00E6B680 AS DateTime), CAST(0x00008EF900E6B680 AS DateTime), CAST(0x00009F0B0009E0A7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (65, 2007, 2007, 60, 0, 1, 5, 12, 0, 2, 1, 1, CAST(0x00009A130041EB00 AS DateTime), CAST(0x000098A800317040 AS DateTime), CAST(0x00009F09015B266B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (65, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009CA40020F580 AS DateTime), CAST(0x0006203C0041EB00 AS DateTime), CAST(0x00009F09015B2675 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (66, 1970, 2006, 60, 120, 1, 2, 9, 120, 1, 2, 3, CAST(0x000064DC0128A180 AS DateTime), CAST(0x000097800128A180 AS DateTime), CAST(0x00009F090099BDCF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (66, 2007, 2999, 60, 120, 1, 1, 10, 120, 1, 2, 3, CAST(0x000099BE0128A180 AS DateTime), CAST(0x0006203C0128A180 AS DateTime), CAST(0x00009F090099BDD4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 1970, 2008, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x00009B400020F580 AS DateTime), CAST(0x00009F09015B2683 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2009, 2009, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x00009BD90041EB00 AS DateTime), CAST(0x00009CAB0020F580 AS DateTime), CAST(0x00009F09015B2688 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2010, 2010, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009D450041EB00 AS DateTime), CAST(0x00009E1E0020F580 AS DateTime), CAST(0x00009F09015B268C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2011, 2011, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009EB10041EB00 AS DateTime), CAST(0x00009F8A0020F580 AS DateTime), CAST(0x00009F09015B268C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2012, 2012, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A01D0041EB00 AS DateTime), CAST(0x0000A0F60020F580 AS DateTime), CAST(0x00009F09015B2691 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2013, 2013, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A1900041EB00 AS DateTime), CAST(0x0000A2620020F580 AS DateTime), CAST(0x00009F09015B2696 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2014, 2014, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A2FC0041EB00 AS DateTime), CAST(0x0000A3CE0020F580 AS DateTime), CAST(0x00009F09015B269F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2015, 2015, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000A4680041EB00 AS DateTime), CAST(0x0000A53A0020F580 AS DateTime), CAST(0x00009F09015B26A4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2016, 2016, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A5D40041EB00 AS DateTime), CAST(0x0000A6AD0020F580 AS DateTime), CAST(0x00009F09015B26A8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2017, 2017, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A7400041EB00 AS DateTime), CAST(0x0000A8190020F580 AS DateTime), CAST(0x00009F09015B26AD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2018, 2018, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A8AC0041EB00 AS DateTime), CAST(0x0000A9850020F580 AS DateTime), CAST(0x00009F09015B26B2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2019, 2019, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000AA1F0041EB00 AS DateTime), CAST(0x0000AAF10020F580 AS DateTime), CAST(0x00009F09015B26B6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2020, 2020, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000AB8B0041EB00 AS DateTime), CAST(0x0000AC5D0020F580 AS DateTime), CAST(0x00009F09015B26BB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (67, 2021, 2999, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000ACF70041EB00 AS DateTime), CAST(0x000621230041EB00 AS DateTime), CAST(0x00009F09015B26C0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (68, 1970, 2006, 60, 120, 1, 2, 9, 120, 1, 2, 3, CAST(0x000064DD0041EB00 AS DateTime), CAST(0x000097810041EB00 AS DateTime), CAST(0x00009F09015B26CE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (68, 2007, 2999, 60, 120, 1, 1, 10, 120, 1, 2, 3, CAST(0x000099BF0041EB00 AS DateTime), CAST(0x0006203D0041EB00 AS DateTime), CAST(0x00009F09015B26D3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (69, 1970, 2006, 60, 1, 1, 1, 4, 1, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B26DC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (69, 2007, 2999, 60, 1, 1, 2, 3, 1, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B26E1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 1970, 2008, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x000064FF0041EB00 AS DateTime), CAST(0x00009A580041EB00 AS DateTime), CAST(0x00009F09015B26EF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2009, 2009, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x00009CA40020F580 AS DateTime), CAST(0x00009BC40041EB00 AS DateTime), CAST(0x00009F09015B26F3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2010, 2010, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009E100020F580 AS DateTime), CAST(0x00009D370041EB00 AS DateTime), CAST(0x00009F09015B26F8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2011, 2011, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009F7C0020F580 AS DateTime), CAST(0x00009EA30041EB00 AS DateTime), CAST(0x00009F09015B26FD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2012, 2012, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A0EF0020F580 AS DateTime), CAST(0x0000A00F0041EB00 AS DateTime), CAST(0x00009F09015B2701 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2013, 2013, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A25B0020F580 AS DateTime), CAST(0x0000A17B0041EB00 AS DateTime), CAST(0x00009F09015B2706 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2014, 2014, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A3C70020F580 AS DateTime), CAST(0x0000A2E70041EB00 AS DateTime), CAST(0x00009F09015B270B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2015, 2015, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000A5330020F580 AS DateTime), CAST(0x0000A4530041EB00 AS DateTime), CAST(0x00009F09015B2710 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2016, 2016, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A69F0020F580 AS DateTime), CAST(0x0000A5C60041EB00 AS DateTime), CAST(0x00009F09015B2714 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2017, 2017, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x0000A80B0020F580 AS DateTime), CAST(0x0000A7320041EB00 AS DateTime), CAST(0x00009F09015B2719 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2018, 2018, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A97E0020F580 AS DateTime), CAST(0x0000A89E0041EB00 AS DateTime), CAST(0x00009F09015B2748 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2019, 2019, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000AAEA0020F580 AS DateTime), CAST(0x0000AA0A0041EB00 AS DateTime), CAST(0x00009F09015B2748 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2020, 2020, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000AC560020F580 AS DateTime), CAST(0x0000AB760041EB00 AS DateTime), CAST(0x00009F09015B274C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (70, 2021, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000ADC20020F580 AS DateTime), CAST(0x0006203C0041EB00 AS DateTime), CAST(0x00009F09015B2751 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (71, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B27CB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (71, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B27D0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (72, 2007, 2007, 60, 0, 1, 5, 12, 0, 2, 1, 1, CAST(0x00009A130041EB00 AS DateTime), CAST(0x000098A800317040 AS DateTime), CAST(0x00009F090152FBA6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (72, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 3, CAST(0x00009B380020F580 AS DateTime), CAST(0x00009A600041EB00 AS DateTime), CAST(0x00009F090152FBAA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (72, 2009, 2009, 60, 0, 5, 1, 1, 1439, 7, 2, 3, CAST(0x00009B8300317040 AS DateTime), CAST(0x00009BCB0041EB00 AS DateTime), CAST(0x00009F090152FBAF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (73, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650E0020F580 AS DateTime), CAST(0x000097650041EB00 AS DateTime), CAST(0x00009F09015B27D0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (73, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C60041EB00 AS DateTime), CAST(0x000098DF0041EB00 AS DateTime), CAST(0x00009F09015B27D5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (73, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B380020F580 AS DateTime), CAST(0x00009A440041EB00 AS DateTime), CAST(0x00009F09015B27D5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (73, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA40020F580 AS DateTime), CAST(0x000620200041EB00 AS DateTime), CAST(0x00009F09015B27D9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (74, 1970, 2007, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x000064F80041EB00 AS DateTime), CAST(0x000098EC0041EB00 AS DateTime), CAST(0x00009F09015B27D9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (74, 2008, 2008, 60, 1439, 7, 2, 10, 1439, 7, 5, 3, CAST(0x00009B310020F580 AS DateTime), CAST(0x00009A6D0041EB00 AS DateTime), CAST(0x00009F09015B27D9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (74, 2009, 2999, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x00009C9D0020F580 AS DateTime), CAST(0x0006203C0041EB00 AS DateTime), CAST(0x00009F09015B27DE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (75, 1970, 2006, 60, 120, 1, 2, 9, 120, 1, 2, 3, CAST(0x000064DD0041EB00 AS DateTime), CAST(0x000097810041EB00 AS DateTime), CAST(0x00009F090152FBD5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (75, 2006, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x000097950128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F090090039A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (75, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009003A3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (76, 1970, 2006, 60, 1, 1, 1, 4, 1, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F090152FBE3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (76, 2007, 2999, 60, 1, 1, 2, 3, 1, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F090152FBE7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (77, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B27DE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (77, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B27E3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (78, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F090099BE6E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (79, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009EBB00848A9B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (80, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B281B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (80, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B281B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (81, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2820 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (82, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F090099BE98 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (83, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009EBB00848AA5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (84, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2829 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (85, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B2853 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (85, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B2853 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (86, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B2861 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (86, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B2879 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (87, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F09015B2895 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (88, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015B289E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (88, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F09015B28A3 AS DateTime))
GO
print 'Processed 200 total records'
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2010, 2010, 60, 1439, 7, 5, 9, 0, 6, 1, 1, CAST(0x00009DFA0128A180 AS DateTime), CAST(0x00009CEF0107AC00 AS DateTime), CAST(0x00009F090090040F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2011, 2011, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x00009F660128A180 AS DateTime), CAST(0x00009EB70128A180 AS DateTime), CAST(0x00009F0900900419 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2012, 2012, 60, 1439, 7, 5, 9, 1439, 7, 5, 3, CAST(0x0000A0D90128A180 AS DateTime), CAST(0x0000A0230128A180 AS DateTime), CAST(0x00009F090090041D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2013, 2013, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A2450128A180 AS DateTime), CAST(0x0000A1960128A180 AS DateTime), CAST(0x00009F0900900427 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2014, 2014, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A3B10128A180 AS DateTime), CAST(0x0000A3020128A180 AS DateTime), CAST(0x00009F090090042C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2015, 2015, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A51D0128A180 AS DateTime), CAST(0x0000A46E0128A180 AS DateTime), CAST(0x00009F0900900435 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2016, 2016, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A6890128A180 AS DateTime), CAST(0x0000A5DA0128A180 AS DateTime), CAST(0x00009F0900900439 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2017, 2017, 60, 1439, 7, 4, 9, 1439, 7, 1, 4, CAST(0x0000A7F50128A180 AS DateTime), CAST(0x0000A7460128A180 AS DateTime), CAST(0x00009F090090043E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2018, 2018, 60, 1439, 7, 5, 9, 1439, 7, 5, 3, CAST(0x0000A9680128A180 AS DateTime), CAST(0x0000A8B20128A180 AS DateTime), CAST(0x00009F0900900447 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2019, 2019, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000AAD40128A180 AS DateTime), CAST(0x0000AA250128A180 AS DateTime), CAST(0x00009F090090044C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (89, 2020, 2999, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000AC400128A180 AS DateTime), CAST(0x000620570128A180 AS DateTime), CAST(0x00009F0900900451 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (90, 1970, 2007, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x000064F80041EB00 AS DateTime), CAST(0x000098EC0041EB00 AS DateTime), CAST(0x00009F09015560B0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (90, 2008, 2008, 60, 1439, 7, 2, 10, 1439, 7, 5, 3, CAST(0x00009B310020F580 AS DateTime), CAST(0x00009A6D0041EB00 AS DateTime), CAST(0x00009F09015560B5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (90, 2009, 2009, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x00009C9D0020F580 AS DateTime), CAST(0x00009BCB0041EB00 AS DateTime), CAST(0x00009F09015560B9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (90, 2010, 2010, 60, 1439, 7, 2, 10, 1439, 7, 1, 4, CAST(0x00009E090020F580 AS DateTime), CAST(0x00009D4C0041EB00 AS DateTime), CAST(0x00009F09015560C3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (90, 2011, 2999, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x00009F750020F580 AS DateTime), CAST(0x0006203C0041EB00 AS DateTime), CAST(0x00009F09015560C7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (91, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090152FCBA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 1970, 2006, 60, 1439, 6, 5, 3, 1439, 4, 3, 9, CAST(0x000064320128A180 AS DateTime), CAST(0x000098400128A180 AS DateTime), CAST(0x00009F09008FFC9B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2007, 2007, 60, 1439, 5, 5, 3, 1439, 5, 1, 11, CAST(0x000098FE0128A180 AS DateTime), CAST(0x000099D70128A180 AS DateTime), CAST(0x00009F09008FFCA5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2008, 2008, 60, 1439, 5, 1, 4, 1439, 6, 5, 10, CAST(0x00009A710128A180 AS DateTime), CAST(0x00009B4400F73140 AS DateTime), CAST(0x00009F09008FFCA9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2009, 2009, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x00009BD60128A180 AS DateTime), CAST(0x00009CAF00F73140 AS DateTime), CAST(0x00009F09008FFCB3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2010, 2010, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x00009D490128A180 AS DateTime), CAST(0x00009E1B00F73140 AS DateTime), CAST(0x00009F09008FFCC6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2011, 2011, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x00009EB50128A180 AS DateTime), CAST(0x00009F8700F73140 AS DateTime), CAST(0x00009F09008FFCCF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2012, 2012, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A0280128A180 AS DateTime), CAST(0x0000A0F300F73140 AS DateTime), CAST(0x00009F09008FFCE2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2013, 2013, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A1940128A180 AS DateTime), CAST(0x0000A26600F73140 AS DateTime), CAST(0x00009F09008FFCEB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2014, 2014, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A3000128A180 AS DateTime), CAST(0x0000A3D200F73140 AS DateTime), CAST(0x00009F09008FFCF0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2015, 2015, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A46C0128A180 AS DateTime), CAST(0x0000A53E00F73140 AS DateTime), CAST(0x00009F09008FFD07 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2016, 2016, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x0000A5D80128A180 AS DateTime), CAST(0x0000A6AA00F73140 AS DateTime), CAST(0x00009F09008FFD0C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (92, 2017, 2999, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A74B0128A180 AS DateTime), CAST(0x000621270128A180 AS DateTime), CAST(0x00009F09008FFD15 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (93, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F09015560DF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (93, 2007, 2007, 60, 1439, 5, 5, 3, 1439, 5, 1, 11, CAST(0x000098FF0041EB00 AS DateTime), CAST(0x000099D80041EB00 AS DateTime), CAST(0x00009F09015B4826 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (93, 2008, 2008, 60, 1439, 5, 1, 4, 1439, 6, 5, 10, CAST(0x00009A720041EB00 AS DateTime), CAST(0x00009B450020F580 AS DateTime), CAST(0x00009F09015B482F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (93, 2008, 2008, 60, 120, 1, 5, 10, 0, 3, 1, 1, CAST(0x00009B3F00F73140 AS DateTime), CAST(0x00009A140128A180 AS DateTime), CAST(0x00009F090099B9BA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (93, 2009, 2999, 60, 120, 1, 5, 10, 120, 1, 5, 3, CAST(0x00009CAB00F73140 AS DateTime), CAST(0x000620510128A180 AS DateTime), CAST(0x00009F090099B9BF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (94, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F090152FCD2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (94, 2009, 2009, 60, 1380, 6, 3, 6, 1439, 5, 5, 12, CAST(0x00009C2B0128A180 AS DateTime), CAST(0x00009CEE00F73140 AS DateTime), CAST(0x00009F09008FFE7A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (95, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F090152FCDB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (95, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F090152FCE0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (96, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09008FFF14 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (97, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F0901556100 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (98, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F090099BD27 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 1970, 2008, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x000064FE0128A180 AS DateTime), CAST(0x00009A570128A180 AS DateTime), CAST(0x00009F090099BDDD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2009, 2009, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x00009CA300F73140 AS DateTime), CAST(0x00009BC30128A180 AS DateTime), CAST(0x00009F090099BDDD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2010, 2010, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009E0F00F73140 AS DateTime), CAST(0x00009D360128A180 AS DateTime), CAST(0x00009F090099BDDD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2011, 2011, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009F7B00F73140 AS DateTime), CAST(0x00009EA20128A180 AS DateTime), CAST(0x00009F090099BDE2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2012, 2012, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A0EE00F73140 AS DateTime), CAST(0x0000A00E0128A180 AS DateTime), CAST(0x00009F090099BDE2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2013, 2013, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A25A00F73140 AS DateTime), CAST(0x0000A17A0128A180 AS DateTime), CAST(0x00009F090099BDE2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2014, 2014, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A3C600F73140 AS DateTime), CAST(0x0000A2E60128A180 AS DateTime), CAST(0x00009F090099BDE2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2015, 2015, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000A53200F73140 AS DateTime), CAST(0x0000A4520128A180 AS DateTime), CAST(0x00009F090099BDE7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2016, 2016, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A69E00F73140 AS DateTime), CAST(0x0000A5C50128A180 AS DateTime), CAST(0x00009F090099BDEB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2017, 2017, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x0000A80A00F73140 AS DateTime), CAST(0x0000A7310128A180 AS DateTime), CAST(0x00009F090099BDF0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2018, 2018, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A97D00F73140 AS DateTime), CAST(0x0000A89D0128A180 AS DateTime), CAST(0x00009F090099BDF5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2019, 2019, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000AAE900F73140 AS DateTime), CAST(0x0000AA090128A180 AS DateTime), CAST(0x00009F090099BDF9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2020, 2020, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000AC5500F73140 AS DateTime), CAST(0x0000AB750128A180 AS DateTime), CAST(0x00009F090099BDFE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (100, 2021, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000ADC100F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F090099BE03 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (101, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F0901556121 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (101, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F0901556125 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (102, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000621240041EB00 AS DateTime), CAST(0x00009F090155612F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (103, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F090155613D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (103, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F090155613D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (104, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643C0041EB00 AS DateTime), CAST(0x000098680041EB00 AS DateTime), CAST(0x00009F090155614B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (104, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098ED0041EB00 AS DateTime), CAST(0x0006212B0041EB00 AS DateTime), CAST(0x00009F090155614F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2010, 2010, 60, 1439, 7, 5, 9, 0, 6, 1, 1, CAST(0x00009DFB0041EB00 AS DateTime), CAST(0x00009CF000317040 AS DateTime), CAST(0x00009F0901556162 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2011, 2011, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x00009F670041EB00 AS DateTime), CAST(0x00009EB80041EB00 AS DateTime), CAST(0x00009F09015561A4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2012, 2012, 60, 1439, 7, 5, 9, 1439, 7, 5, 3, CAST(0x0000A0DA0041EB00 AS DateTime), CAST(0x0000A0240041EB00 AS DateTime), CAST(0x00009F09015561AD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2013, 2013, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A2460041EB00 AS DateTime), CAST(0x0000A1970041EB00 AS DateTime), CAST(0x00009F09015561B2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2014, 2014, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A3B20041EB00 AS DateTime), CAST(0x0000A3030041EB00 AS DateTime), CAST(0x00009F09015561B7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2015, 2015, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A51E0041EB00 AS DateTime), CAST(0x0000A46F0041EB00 AS DateTime), CAST(0x00009F09015561C0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2016, 2016, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000A68A0041EB00 AS DateTime), CAST(0x0000A5DB0041EB00 AS DateTime), CAST(0x00009F09015561C5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2017, 2017, 60, 1439, 7, 4, 9, 1439, 7, 1, 4, CAST(0x0000A7F60041EB00 AS DateTime), CAST(0x0000A7470041EB00 AS DateTime), CAST(0x00009F09015561C9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2018, 2018, 60, 1439, 7, 5, 9, 1439, 7, 5, 3, CAST(0x0000A9690041EB00 AS DateTime), CAST(0x0000A8B30041EB00 AS DateTime), CAST(0x00009F09015561CE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2019, 2019, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000AAD50041EB00 AS DateTime), CAST(0x0000AA260041EB00 AS DateTime), CAST(0x00009F09015561D7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (107, 2020, 2999, 60, 1439, 7, 5, 9, 1439, 7, 1, 4, CAST(0x0000AC410041EB00 AS DateTime), CAST(0x000620580041EB00 AS DateTime), CAST(0x00009F09015561DC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (108, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 1, 5, 8, CAST(0x00009AAB0128A180 AS DateTime), CAST(0x00009B070128A180 AS DateTime), CAST(0x00009F09009A5524 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (108, 2009, 2009, 60, 1439, 1, 5, 5, 1439, 5, 3, 8, CAST(0x00009C180128A180 AS DateTime), CAST(0x00009C690128A180 AS DateTime), CAST(0x00009F09009A5529 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (110, 1970, 2999, 60, 60, 1, 5, 3, 120, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5537 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (112, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5545 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (113, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A554F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (114, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A555D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (115, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5566 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (117, 1970, 2006, 60, 0, 5, 5, 3, 60, 6, 5, 9, CAST(0x000064310128A180 AS DateTime), CAST(0x000098490128A180 AS DateTime), CAST(0x00009F09009A5574 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (117, 2007, 2999, 60, 1439, 5, 5, 3, 60, 6, 5, 10, CAST(0x000098FE0128A180 AS DateTime), CAST(0x000621210128A180 AS DateTime), CAST(0x00009F09009A5579 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (118, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5582 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (119, 1970, 2999, 60, 0, 1, 5, 3, 0, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A558B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 1970, 2005, 60, 0, 6, 5, 4, 1439, 5, 5, 9, CAST(0x0000644E0128A180 AS DateTime), CAST(0x000096DC0128A180 AS DateTime), CAST(0x00009F09009A5595 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 2006, 2006, 60, 0, 6, 5, 4, 1439, 5, 3, 9, CAST(0x000097AF0128A180 AS DateTime), CAST(0x000098410128A180 AS DateTime), CAST(0x00009F09009A559A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 2007, 2007, 60, 1439, 5, 5, 4, 1439, 5, 1, 9, CAST(0x0000991A0128A180 AS DateTime), CAST(0x0000999F0128A180 AS DateTime), CAST(0x00009F09009A559E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 2008, 2008, 60, 1439, 5, 5, 4, 1439, 5, 5, 8, CAST(0x00009A860128A180 AS DateTime), CAST(0x00009B040128A180 AS DateTime), CAST(0x00009F09009A55A3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 2009, 2009, 60, 1439, 5, 4, 4, 1439, 5, 5, 9, CAST(0x00009BF20128A180 AS DateTime), CAST(0x00009C8C0128A180 AS DateTime), CAST(0x00009F09009A55A8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (120, 2010, 2999, 60, 1439, 5, 5, 4, 1439, 5, 5, 9, CAST(0x00009D650128A180 AS DateTime), CAST(0x000621040128A180 AS DateTime), CAST(0x00009F09009A55B1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (122, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A55BF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2005, 2005, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x000096270128A180 AS DateTime), CAST(0x000096E60128A180 AS DateTime), CAST(0x00009F09009A55C8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2006, 2006, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x000097930128A180 AS DateTime), CAST(0x0000984B0128A180 AS DateTime), CAST(0x00009F09009A55CD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2007, 2007, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x000098FF0128A180 AS DateTime), CAST(0x000099A90128A180 AS DateTime), CAST(0x00009F09009A55D2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2008, 2008, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x00009A6B0128A180 AS DateTime), CAST(0x00009B2A0128A180 AS DateTime), CAST(0x00009F09009A55D6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2009, 2009, 60, 120, 6, 5, 3, 120, 1, 5, 9, CAST(0x00009BD70128A180 AS DateTime), CAST(0x00009C8F0128A180 AS DateTime), CAST(0x00009F09009A55DB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2010, 2010, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x00009D430128A180 AS DateTime), CAST(0x00009DED0128A180 AS DateTime), CAST(0x00009F09009A55E0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2011, 2011, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x00009EB60128A180 AS DateTime), CAST(0x00009F6E0128A180 AS DateTime), CAST(0x00009F09009A55E5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2012, 2012, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A0220128A180 AS DateTime), CAST(0x0000A0D30128A180 AS DateTime), CAST(0x00009F09009A55E9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2013, 2013, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000A18E0128A180 AS DateTime), CAST(0x0000A2310128A180 AS DateTime), CAST(0x00009F09009A55F3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2014, 2014, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A2FA0128A180 AS DateTime), CAST(0x0000A3B20128A180 AS DateTime), CAST(0x00009F09009A55F7 AS DateTime))
GO

INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2015, 2015, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A4660128A180 AS DateTime), CAST(0x0000A5170128A180 AS DateTime), CAST(0x00009F09009A55FC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2016, 2016, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x0000A5D90128A180 AS DateTime), CAST(0x0000A69800F73140 AS DateTime), CAST(0x00009F09009A5600 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2017, 2017, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A7450128A180 AS DateTime), CAST(0x0000A7F60128A180 AS DateTime), CAST(0x00009F09009A5605 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2018, 2018, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A8B10128A180 AS DateTime), CAST(0x0000A95B0128A180 AS DateTime), CAST(0x00009F09009A560A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2019, 2019, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x0000AA1D0128A180 AS DateTime), CAST(0x0000AADC0128A180 AS DateTime), CAST(0x00009F09009A560F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2020, 2020, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000AB890128A180 AS DateTime), CAST(0x0000AC410128A180 AS DateTime), CAST(0x00009F09009A5613 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2021, 2021, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000ACF50128A180 AS DateTime), CAST(0x0000AD9F0128A180 AS DateTime), CAST(0x00009F09009A5618 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (123, 2022, 2022, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x0000AE680128A180 AS DateTime), CAST(0x0000AF200128A180 AS DateTime), CAST(0x00009F09009A561D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (124, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5642 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (125, 1970, 2999, -60, 120, 1, 1, 4, 120, 1, 1, 9, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000620EB0128A180 AS DateTime), CAST(0x00009F09009A5647 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (126, 1970, 2006, 60, 180, 1, 1, 4, 240, 1, 1, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x0000984B0128A180 AS DateTime), CAST(0x00009F09009A5650 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (126, 2007, 2007, 60, 180, 1, 1, 4, 240, 2, 1, 10, CAST(0x000099010128A180 AS DateTime), CAST(0x000099B80128A180 AS DateTime), CAST(0x00009F09009A5655 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (128, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5663 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (131, 1970, 2005, 60, 120, 1, 1, 3, 120, 3, 4, 9, CAST(0x000064180128A180 AS DateTime), CAST(0x000096DA0128A180 AS DateTime), CAST(0x00009F09009A5671 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (131, 2008, 2008, 60, 1439, 5, 3, 3, 1439, 7, 3, 9, CAST(0x00009A630128A180 AS DateTime), CAST(0x00009B1B0128A180 AS DateTime), CAST(0x00009F09009A5671 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (131, 2009, 2999, 60, 1439, 7, 3, 3, 1439, 2, 3, 9, CAST(0x00009BD10128A180 AS DateTime), CAST(0x000620FA0128A180 AS DateTime), CAST(0x00009F09009A5671 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (133, 1970, 2999, 60, 240, 1, 5, 3, 300, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5684 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (134, 2008, 2008, 60, 120, 1, 5, 10, 0, 3, 1, 1, CAST(0x00009B3F00F73140 AS DateTime), CAST(0x00009A140128A180 AS DateTime), CAST(0x00009F09009A568D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (134, 2009, 2999, 60, 120, 1, 5, 10, 120, 1, 5, 3, CAST(0x00009CAB00F73140 AS DateTime), CAST(0x000620510128A180 AS DateTime), CAST(0x00009F09009A5692 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (135, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A569B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (137, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A56A9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (138, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 6, 5, 10, CAST(0x00009AAB0128A180 AS DateTime), CAST(0x00009B4400F73140 AS DateTime), CAST(0x00009F09009A56B7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (138, 2009, 2009, 60, 1439, 3, 2, 4, 1439, 7, 5, 10, CAST(0x00009BE90128A180 AS DateTime), CAST(0x00009CB100F73140 AS DateTime), CAST(0x00009F09009A56BC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (143, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A56D8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (147, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A56EB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (149, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A56FE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (151, 2006, 2006, 60, 120, 1, 1, 12, 0, 1, 1, 1, CAST(0x0000988A00F73140 AS DateTime), CAST(0x0000973A0107AC00 AS DateTime), CAST(0x00009F09009A5707 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (151, 2007, 2999, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000099D30128A180 AS DateTime), CAST(0x000620510128A180 AS DateTime), CAST(0x00009F09009A570C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (155, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5728 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (156, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065060128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F09009A5731 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (156, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F09009A5736 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (159, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065060128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F09009A5749 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (159, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F09009A574D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (161, 1970, 2007, 60, 120, 1, 1, 10, 180, 1, 5, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F09009A5773 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (161, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F09009A577C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (162, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5786 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (164, 1970, 2006, 60, 120, 1, 1, 10, 180, 1, 3, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000097870128A180 AS DateTime), CAST(0x00009F09009A5794 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (164, 2007, 2007, 60, 120, 1, 5, 9, 180, 1, 3, 3, CAST(0x000099B70128A180 AS DateTime), CAST(0x000098F30128A180 AS DateTime), CAST(0x00009F09009A5798 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (164, 2008, 2999, 60, 120, 1, 5, 9, 180, 1, 1, 4, CAST(0x00009B230128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F09009A579D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (166, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A57AB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (168, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A57B9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (170, 1970, 2999, 60, 120, 1, 5, 3, 120, 1, 5, 9, CAST(0x000064340128A180 AS DateTime), CAST(0x000621070128A180 AS DateTime), CAST(0x00009F09009A57CC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (171, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650D00F73140 AS DateTime), CAST(0x000097640128A180 AS DateTime), CAST(0x00009F09009A57D5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (171, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C50128A180 AS DateTime), CAST(0x000098DE0128A180 AS DateTime), CAST(0x00009F09009A57DA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (171, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A430128A180 AS DateTime), CAST(0x00009F09009A57DF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (171, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006201F0128A180 AS DateTime), CAST(0x00009F09009A57E3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (172, 2007, 2007, 60, 0, 1, 5, 12, 0, 2, 1, 1, CAST(0x00009A120128A180 AS DateTime), CAST(0x000098A70107AC00 AS DateTime), CAST(0x00009F09009A57ED AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (172, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 3, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A5F0128A180 AS DateTime), CAST(0x00009F09009A57ED AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (172, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F09009A57F6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 1970, 2008, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x00009B3F00F73140 AS DateTime), CAST(0x00009F09009A5804 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2009, 2009, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x00009BD80128A180 AS DateTime), CAST(0x00009CAA00F73140 AS DateTime), CAST(0x00009F09009A5809 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2010, 2010, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009D440128A180 AS DateTime), CAST(0x00009E1D00F73140 AS DateTime), CAST(0x00009F09009A580D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2011, 2011, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009EB00128A180 AS DateTime), CAST(0x00009F8900F73140 AS DateTime), CAST(0x00009F09009A5812 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2012, 2012, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A01C0128A180 AS DateTime), CAST(0x0000A0F500F73140 AS DateTime), CAST(0x00009F09009A5817 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2013, 2013, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A18F0128A180 AS DateTime), CAST(0x0000A26100F73140 AS DateTime), CAST(0x00009F09009A5817 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2014, 2014, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A2FB0128A180 AS DateTime), CAST(0x0000A3CD00F73140 AS DateTime), CAST(0x00009F09009A581C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2015, 2015, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000A4670128A180 AS DateTime), CAST(0x0000A53900F73140 AS DateTime), CAST(0x00009F09009A5820 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2016, 2016, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A5D30128A180 AS DateTime), CAST(0x0000A6AC00F73140 AS DateTime), CAST(0x00009F09009A5825 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2017, 2017, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A73F0128A180 AS DateTime), CAST(0x0000A81800F73140 AS DateTime), CAST(0x00009F09009A582A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2018, 2018, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A8AB0128A180 AS DateTime), CAST(0x0000A98400F73140 AS DateTime), CAST(0x00009F09009A582E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2019, 2019, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000AA1E0128A180 AS DateTime), CAST(0x0000AAF000F73140 AS DateTime), CAST(0x00009F09009A5833 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2020, 2020, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000AB8A0128A180 AS DateTime), CAST(0x0000AC5C00F73140 AS DateTime), CAST(0x00009F09009A5838 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (174, 2021, 2999, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000ACF60128A180 AS DateTime), CAST(0x000621220128A180 AS DateTime), CAST(0x00009F09009A5838 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (175, 1970, 2006, 60, 120, 1, 2, 9, 120, 1, 2, 3, CAST(0x000064DC0128A180 AS DateTime), CAST(0x000097800128A180 AS DateTime), CAST(0x00009F09009A583D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (175, 2007, 2999, 60, 120, 1, 1, 10, 120, 1, 2, 3, CAST(0x000099BE0128A180 AS DateTime), CAST(0x0006203C0128A180 AS DateTime), CAST(0x00009F09009A583D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (176, 1970, 2006, 60, 1, 1, 1, 4, 1, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A584B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (176, 2007, 2999, 60, 1, 1, 2, 3, 1, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A584F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 1970, 2008, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x000064FE0128A180 AS DateTime), CAST(0x00009A570128A180 AS DateTime), CAST(0x00009F09009A5854 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2009, 2009, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x00009CA300F73140 AS DateTime), CAST(0x00009BC30128A180 AS DateTime), CAST(0x00009F09009A5858 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2010, 2010, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009E0F00F73140 AS DateTime), CAST(0x00009D360128A180 AS DateTime), CAST(0x00009F09009A585D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2011, 2011, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009F7B00F73140 AS DateTime), CAST(0x00009EA20128A180 AS DateTime), CAST(0x00009F09009A5862 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2012, 2012, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A0EE00F73140 AS DateTime), CAST(0x0000A00E0128A180 AS DateTime), CAST(0x00009F09009A586B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2013, 2013, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A25A00F73140 AS DateTime), CAST(0x0000A17A0128A180 AS DateTime), CAST(0x00009F09009A5870 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2014, 2014, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A3C600F73140 AS DateTime), CAST(0x0000A2E60128A180 AS DateTime), CAST(0x00009F09009A5875 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2015, 2015, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000A53200F73140 AS DateTime), CAST(0x0000A4520128A180 AS DateTime), CAST(0x00009F09009A5879 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2016, 2016, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A69E00F73140 AS DateTime), CAST(0x0000A5C50128A180 AS DateTime), CAST(0x00009F09009A58B6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2017, 2017, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x0000A80A00F73140 AS DateTime), CAST(0x0000A7310128A180 AS DateTime), CAST(0x00009F09009A58B6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2018, 2018, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A97D00F73140 AS DateTime), CAST(0x0000A89D0128A180 AS DateTime), CAST(0x00009F09009A58BB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2019, 2019, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000AAE900F73140 AS DateTime), CAST(0x0000AA090128A180 AS DateTime), CAST(0x00009F09009A58BB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2020, 2020, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000AC5500F73140 AS DateTime), CAST(0x0000AB750128A180 AS DateTime), CAST(0x00009F09009A58C0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (177, 2021, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000ADC100F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F09009A58C4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (178, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A58CE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (178, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A58D3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (180, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650D00F73140 AS DateTime), CAST(0x000097640128A180 AS DateTime), CAST(0x00009F09009A58E1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (180, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C50128A180 AS DateTime), CAST(0x000098DE0128A180 AS DateTime), CAST(0x00009F09009A58E5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (180, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A430128A180 AS DateTime), CAST(0x00009F09009A58EE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (180, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006201F0128A180 AS DateTime), CAST(0x00009F09009A58F3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (181, 1970, 2007, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x000064F70128A180 AS DateTime), CAST(0x000098EB0128A180 AS DateTime), CAST(0x00009F09009A58FD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (181, 2008, 2008, 60, 1439, 7, 2, 10, 1439, 7, 5, 3, CAST(0x00009B3000F73140 AS DateTime), CAST(0x00009A6C0128A180 AS DateTime), CAST(0x00009F09009A5901 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (181, 2009, 2999, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x00009C9C00F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F09009A5906 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (184, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A5919 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (184, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A591E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (187, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A5935 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (187, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A5939 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (188, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A593E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (191, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5951 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (192, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A595F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (192, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A596D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (193, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A597B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (193, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A5984 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (194, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009A5997 AS DateTime))
GO

INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (195, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F09009A59CB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (195, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F09009A59EC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (199, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 1, 5, 8, CAST(0x00009AAB0128A180 AS DateTime), CAST(0x00009B070128A180 AS DateTime), CAST(0x00009F0900A1DA56 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (199, 2009, 2009, 60, 1439, 1, 5, 5, 1439, 5, 3, 8, CAST(0x00009C180128A180 AS DateTime), CAST(0x00009C690128A180 AS DateTime), CAST(0x00009F0900A1DF22 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (201, 1970, 2999, 60, 60, 1, 5, 3, 120, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E0CD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (203, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E150 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (204, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E15E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (205, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E167 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (206, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E171 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (208, 1970, 2006, 60, 0, 5, 5, 3, 60, 6, 5, 9, CAST(0x000064310128A180 AS DateTime), CAST(0x000098490128A180 AS DateTime), CAST(0x00009F0900A1E17F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (208, 2007, 2999, 60, 1439, 5, 5, 3, 60, 6, 5, 10, CAST(0x000098FE0128A180 AS DateTime), CAST(0x000621210128A180 AS DateTime), CAST(0x00009F0900A1E184 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (209, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E192 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (210, 1970, 2999, 60, 0, 1, 5, 3, 0, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E19B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 1970, 2005, 60, 0, 6, 5, 4, 1439, 5, 5, 9, CAST(0x0000644E0128A180 AS DateTime), CAST(0x000096DC0128A180 AS DateTime), CAST(0x00009F0900A1E1A9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 2006, 2006, 60, 0, 6, 5, 4, 1439, 5, 3, 9, CAST(0x000097AF0128A180 AS DateTime), CAST(0x000098410128A180 AS DateTime), CAST(0x00009F0900A1E1A9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 2007, 2007, 60, 1439, 5, 5, 4, 1439, 5, 1, 9, CAST(0x0000991A0128A180 AS DateTime), CAST(0x0000999F0128A180 AS DateTime), CAST(0x00009F0900A1E1AE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 2008, 2008, 60, 1439, 5, 5, 4, 1439, 5, 5, 8, CAST(0x00009A860128A180 AS DateTime), CAST(0x00009B040128A180 AS DateTime), CAST(0x00009F0900A1E1B2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 2009, 2009, 60, 1439, 5, 4, 4, 1439, 5, 5, 9, CAST(0x00009BF20128A180 AS DateTime), CAST(0x00009C8C0128A180 AS DateTime), CAST(0x00009F0900A1E1BC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (211, 2010, 2999, 60, 1439, 5, 5, 4, 1439, 5, 5, 9, CAST(0x00009D650128A180 AS DateTime), CAST(0x000621040128A180 AS DateTime), CAST(0x00009F0900A1E1C1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (213, 1970, 2999, 60, 180, 1, 5, 3, 240, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E1CF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2005, 2005, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x000096270128A180 AS DateTime), CAST(0x000096E60128A180 AS DateTime), CAST(0x00009F0900A1E1D8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2006, 2006, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x000097930128A180 AS DateTime), CAST(0x0000984B0128A180 AS DateTime), CAST(0x00009F0900A1E1E2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2007, 2007, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x000098FF0128A180 AS DateTime), CAST(0x000099A90128A180 AS DateTime), CAST(0x00009F0900A1E1E6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2008, 2008, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x00009A6B0128A180 AS DateTime), CAST(0x00009B2A0128A180 AS DateTime), CAST(0x00009F0900A1E1EB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2009, 2009, 60, 120, 6, 5, 3, 120, 1, 5, 9, CAST(0x00009BD70128A180 AS DateTime), CAST(0x00009C8F0128A180 AS DateTime), CAST(0x00009F0900A1E1EF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2010, 2010, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x00009D430128A180 AS DateTime), CAST(0x00009DED0128A180 AS DateTime), CAST(0x00009F0900A1E1F4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2011, 2011, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x00009EB60128A180 AS DateTime), CAST(0x00009F6E0128A180 AS DateTime), CAST(0x00009F0900A1E1FD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2012, 2012, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A0220128A180 AS DateTime), CAST(0x0000A0D30128A180 AS DateTime), CAST(0x00009F0900A1E202 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2013, 2013, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000A18E0128A180 AS DateTime), CAST(0x0000A2310128A180 AS DateTime), CAST(0x00009F0900A1E207 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2014, 2014, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A2FA0128A180 AS DateTime), CAST(0x0000A3B20128A180 AS DateTime), CAST(0x00009F0900A1E20C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2015, 2015, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A4660128A180 AS DateTime), CAST(0x0000A5170128A180 AS DateTime), CAST(0x00009F0900A1E210 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2016, 2016, 60, 120, 6, 1, 4, 120, 1, 2, 10, CAST(0x0000A5D90128A180 AS DateTime), CAST(0x0000A69800F73140 AS DateTime), CAST(0x00009F0900A1E215 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2017, 2017, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000A7450128A180 AS DateTime), CAST(0x0000A7F60128A180 AS DateTime), CAST(0x00009F0900A1E21A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2018, 2018, 60, 120, 6, 5, 3, 120, 1, 3, 9, CAST(0x0000A8B10128A180 AS DateTime), CAST(0x0000A95B0128A180 AS DateTime), CAST(0x00009F0900A1E21E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2019, 2019, 60, 120, 6, 5, 3, 120, 1, 1, 10, CAST(0x0000AA1D0128A180 AS DateTime), CAST(0x0000AADC0128A180 AS DateTime), CAST(0x00009F0900A1E228 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2020, 2020, 60, 120, 6, 5, 3, 120, 1, 4, 9, CAST(0x0000AB890128A180 AS DateTime), CAST(0x0000AC410128A180 AS DateTime), CAST(0x00009F0900A1E22D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2021, 2021, 60, 120, 6, 5, 3, 120, 1, 2, 9, CAST(0x0000ACF50128A180 AS DateTime), CAST(0x0000AD9F0128A180 AS DateTime), CAST(0x00009F0900A1E231 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (214, 2022, 2022, 60, 120, 6, 1, 4, 120, 1, 1, 10, CAST(0x0000AE680128A180 AS DateTime), CAST(0x0000AF200128A180 AS DateTime), CAST(0x00009F0900A1E236 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (215, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E23F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (216, 1970, 2999, -60, 120, 1, 1, 4, 120, 1, 1, 9, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000620EB0128A180 AS DateTime), CAST(0x00009F0900A1E24D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (217, 1970, 2006, 60, 180, 1, 1, 4, 240, 1, 1, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x0000984B0128A180 AS DateTime), CAST(0x00009F0900A1E257 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (217, 2007, 2007, 60, 180, 1, 1, 4, 240, 2, 1, 10, CAST(0x000099010128A180 AS DateTime), CAST(0x000099B80128A180 AS DateTime), CAST(0x00009F0900A1E25B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (219, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E269 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (222, 1970, 2005, 60, 120, 1, 1, 3, 120, 3, 4, 9, CAST(0x000064180128A180 AS DateTime), CAST(0x000096DA0128A180 AS DateTime), CAST(0x00009F0900A1E273 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (222, 2008, 2008, 60, 1439, 5, 3, 3, 1439, 7, 3, 9, CAST(0x00009A630128A180 AS DateTime), CAST(0x00009B1B0128A180 AS DateTime), CAST(0x00009F0900A1E27C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (222, 2009, 2999, 60, 1439, 7, 3, 3, 1439, 2, 3, 9, CAST(0x00009BD10128A180 AS DateTime), CAST(0x000620FA0128A180 AS DateTime), CAST(0x00009F0900A1E281 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (224, 1970, 2999, 60, 240, 1, 5, 3, 300, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E28A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (225, 2008, 2008, 60, 120, 1, 5, 10, 0, 3, 1, 1, CAST(0x00009B3F00F73140 AS DateTime), CAST(0x00009A140128A180 AS DateTime), CAST(0x00009F0900A1E298 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (225, 2009, 2999, 60, 120, 1, 5, 10, 120, 1, 5, 3, CAST(0x00009CAB00F73140 AS DateTime), CAST(0x000620510128A180 AS DateTime), CAST(0x00009F0900A1E29D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (226, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E2A6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (228, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E2B0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (229, 2008, 2008, 60, 1439, 7, 5, 5, 1439, 6, 5, 10, CAST(0x00009AAB0128A180 AS DateTime), CAST(0x00009B4400F73140 AS DateTime), CAST(0x00009F0900A1E2B9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (229, 2009, 2009, 60, 1439, 3, 2, 4, 1439, 7, 5, 10, CAST(0x00009BE90128A180 AS DateTime), CAST(0x00009CB100F73140 AS DateTime), CAST(0x00009F0900A1E2C3 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (234, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E2CC AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (238, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E2DA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (240, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E2E8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (242, 2006, 2006, 60, 120, 1, 1, 12, 0, 1, 1, 1, CAST(0x0000988A00F73140 AS DateTime), CAST(0x0000973A0107AC00 AS DateTime), CAST(0x00009F0900A1E2F1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (242, 2007, 2999, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000099D30128A180 AS DateTime), CAST(0x000620510128A180 AS DateTime), CAST(0x00009F0900A1E2F6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (246, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E304 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (247, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065060128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F0900A1E30E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (247, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F0900A1E312 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (250, 1970, 2007, 60, 120, 1, 5, 10, 180, 1, 5, 3, CAST(0x000065060128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F0900A1E31B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (250, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F0900A1E320 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (252, 1970, 2007, 60, 120, 1, 1, 10, 180, 1, 5, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000098FA0128A180 AS DateTime), CAST(0x00009F0900A1E32E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (252, 2008, 2999, 60, 120, 1, 1, 10, 180, 1, 1, 4, CAST(0x00009B2A0128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F0900A1E333 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (253, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E33C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (255, 1970, 2006, 60, 120, 1, 1, 10, 180, 1, 3, 3, CAST(0x000064F10128A180 AS DateTime), CAST(0x000097870128A180 AS DateTime), CAST(0x00009F0900A1E346 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (255, 2007, 2007, 60, 120, 1, 5, 9, 180, 1, 3, 3, CAST(0x000099B70128A180 AS DateTime), CAST(0x000098F30128A180 AS DateTime), CAST(0x00009F0900A1E34A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (255, 2008, 2999, 60, 120, 1, 5, 9, 180, 1, 1, 4, CAST(0x00009B230128A180 AS DateTime), CAST(0x000620580128A180 AS DateTime), CAST(0x00009F0900A1E354 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (257, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E362 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (259, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E36B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (261, 1970, 2999, 60, 120, 1, 5, 3, 120, 1, 5, 9, CAST(0x000064340128A180 AS DateTime), CAST(0x000621070128A180 AS DateTime), CAST(0x00009F0900A1E374 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (262, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650D00F73140 AS DateTime), CAST(0x000097640128A180 AS DateTime), CAST(0x00009F0900A1E383 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (262, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C50128A180 AS DateTime), CAST(0x000098DE0128A180 AS DateTime), CAST(0x00009F0900A1E387 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (262, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A430128A180 AS DateTime), CAST(0x00009F0900A1E38C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (262, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006201F0128A180 AS DateTime), CAST(0x00009F0900A1E391 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (263, 2007, 2007, 60, 0, 1, 5, 12, 0, 2, 1, 1, CAST(0x00009A120128A180 AS DateTime), CAST(0x000098A70107AC00 AS DateTime), CAST(0x00009F0900A1E39A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (263, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 3, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A5F0128A180 AS DateTime), CAST(0x00009F0900A1E39F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (263, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F0900A1E3A8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 1970, 2008, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x00009B3F00F73140 AS DateTime), CAST(0x00009F0900A1E3B1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2009, 2009, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x00009BD80128A180 AS DateTime), CAST(0x00009CAA00F73140 AS DateTime), CAST(0x00009F0900A1E3B6 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2010, 2010, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009D440128A180 AS DateTime), CAST(0x00009E1D00F73140 AS DateTime), CAST(0x00009F0900A1E3BB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2011, 2011, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x00009EB00128A180 AS DateTime), CAST(0x00009F8900F73140 AS DateTime), CAST(0x00009F0900A1E3BF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2012, 2012, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A01C0128A180 AS DateTime), CAST(0x0000A0F500F73140 AS DateTime), CAST(0x00009F0900A1E406 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2013, 2013, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A18F0128A180 AS DateTime), CAST(0x0000A26100F73140 AS DateTime), CAST(0x00009F0900A1E40A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2014, 2014, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A2FB0128A180 AS DateTime), CAST(0x0000A3CD00F73140 AS DateTime), CAST(0x00009F0900A1E40F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2015, 2015, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000A4670128A180 AS DateTime), CAST(0x0000A53900F73140 AS DateTime), CAST(0x00009F0900A1E414 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2016, 2016, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A5D30128A180 AS DateTime), CAST(0x0000A6AC00F73140 AS DateTime), CAST(0x00009F0900A1E419 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2017, 2017, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000A73F0128A180 AS DateTime), CAST(0x0000A81800F73140 AS DateTime), CAST(0x00009F0900A1E41D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2018, 2018, 60, 1320, 7, 4, 3, 1380, 7, 5, 10, CAST(0x0000A8AB0128A180 AS DateTime), CAST(0x0000A98400F73140 AS DateTime), CAST(0x00009F0900A1E422 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2019, 2019, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000AA1E0128A180 AS DateTime), CAST(0x0000AAF000F73140 AS DateTime), CAST(0x00009F0900A1E42B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2020, 2020, 60, 1320, 7, 5, 3, 1380, 7, 4, 10, CAST(0x0000AB8A0128A180 AS DateTime), CAST(0x0000AC5C00F73140 AS DateTime), CAST(0x00009F0900A1E430 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (265, 2021, 2999, 60, 1320, 7, 5, 3, 1380, 7, 5, 10, CAST(0x0000ACF60128A180 AS DateTime), CAST(0x000621220128A180 AS DateTime), CAST(0x00009F0900A1E435 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (266, 1970, 2006, 60, 120, 1, 2, 9, 120, 1, 2, 3, CAST(0x000064DC0128A180 AS DateTime), CAST(0x000097800128A180 AS DateTime), CAST(0x00009F0900A1E43E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (266, 2007, 2999, 60, 120, 1, 1, 10, 120, 1, 2, 3, CAST(0x000099BE0128A180 AS DateTime), CAST(0x0006203C0128A180 AS DateTime), CAST(0x00009F0900A1E447 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (267, 1970, 2006, 60, 1, 1, 1, 4, 1, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E451 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (267, 2007, 2999, 60, 1, 1, 2, 3, 1, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E455 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 1970, 2008, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x000064FE0128A180 AS DateTime), CAST(0x00009A570128A180 AS DateTime), CAST(0x00009F0900A1E45F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2009, 2009, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x00009CA300F73140 AS DateTime), CAST(0x00009BC30128A180 AS DateTime), CAST(0x00009F0900A1E464 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2010, 2010, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009E0F00F73140 AS DateTime), CAST(0x00009D360128A180 AS DateTime), CAST(0x00009F0900A1E464 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2011, 2011, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x00009F7B00F73140 AS DateTime), CAST(0x00009EA20128A180 AS DateTime), CAST(0x00009F0900A1E468 AS DateTime))
GO

INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2012, 2012, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A0EE00F73140 AS DateTime), CAST(0x0000A00E0128A180 AS DateTime), CAST(0x00009F0900A1E468 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2013, 2013, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A25A00F73140 AS DateTime), CAST(0x0000A17A0128A180 AS DateTime), CAST(0x00009F0900A1E46D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2014, 2014, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A3C600F73140 AS DateTime), CAST(0x0000A2E60128A180 AS DateTime), CAST(0x00009F0900A1E476 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2015, 2015, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000A53200F73140 AS DateTime), CAST(0x0000A4520128A180 AS DateTime), CAST(0x00009F0900A1E485 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2016, 2016, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A69E00F73140 AS DateTime), CAST(0x0000A5C50128A180 AS DateTime), CAST(0x00009F0900A1E489 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2017, 2017, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x0000A80A00F73140 AS DateTime), CAST(0x0000A7310128A180 AS DateTime), CAST(0x00009F0900A1E48E AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2018, 2018, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000A97D00F73140 AS DateTime), CAST(0x0000A89D0128A180 AS DateTime), CAST(0x00009F0900A1E492 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2019, 2019, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000AAE900F73140 AS DateTime), CAST(0x0000AA090128A180 AS DateTime), CAST(0x00009F0900A1E497 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2020, 2020, 60, 1439, 7, 3, 10, 1439, 7, 1, 3, CAST(0x0000AC5500F73140 AS DateTime), CAST(0x0000AB750128A180 AS DateTime), CAST(0x00009F0900A1E49C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (268, 2021, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 3, CAST(0x0000ADC100F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F0900A1E4A0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (269, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E4AA AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (269, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E4AF AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (271, 1970, 2006, 60, 0, 1, 1, 11, 120, 1, 2, 2, CAST(0x0000650D00F73140 AS DateTime), CAST(0x000097640128A180 AS DateTime), CAST(0x00009F0900A1E4B8 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (271, 2007, 2007, 60, 0, 1, 2, 10, 0, 1, 5, 2, CAST(0x000099C50128A180 AS DateTime), CAST(0x000098DE0128A180 AS DateTime), CAST(0x00009F0900A1E4BD AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (271, 2008, 2008, 60, 1439, 7, 3, 10, 0, 1, 3, 2, CAST(0x00009B3700F73140 AS DateTime), CAST(0x00009A430128A180 AS DateTime), CAST(0x00009F0900A1E4C1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (271, 2009, 2999, 60, 1439, 7, 3, 10, 1439, 7, 2, 2, CAST(0x00009CA300F73140 AS DateTime), CAST(0x0006201F0128A180 AS DateTime), CAST(0x00009F0900A1E4C1 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (272, 1970, 2007, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x000064F70128A180 AS DateTime), CAST(0x000098EB0128A180 AS DateTime), CAST(0x00009F0900A1E4CB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (272, 2008, 2008, 60, 1439, 7, 2, 10, 1439, 7, 5, 3, CAST(0x00009B3000F73140 AS DateTime), CAST(0x00009A6C0128A180 AS DateTime), CAST(0x00009F0900A1E4D0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (272, 2009, 2999, 60, 1439, 7, 2, 10, 1439, 7, 2, 3, CAST(0x00009C9C00F73140 AS DateTime), CAST(0x0006203B0128A180 AS DateTime), CAST(0x00009F0900A1E4D4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (275, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E4E2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (275, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E4E7 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (278, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E4F0 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (278, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E4F5 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (279, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E4FE AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (282, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E50C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (283, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E516 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (283, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E51B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (284, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E553 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (284, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E58B AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (285, 1970, 2999, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F0900A1E594 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (286, 1970, 2006, 60, 120, 1, 1, 4, 120, 1, 5, 10, CAST(0x0000643B0128A180 AS DateTime), CAST(0x000098670128A180 AS DateTime), CAST(0x00009F0900A1E599 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (286, 2007, 2999, 60, 120, 1, 2, 3, 120, 1, 1, 11, CAST(0x000098EC0128A180 AS DateTime), CAST(0x0006212A0128A180 AS DateTime), CAST(0x00009F0900A1E5A2 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 1970, 2006, 60, 1439, 6, 5, 3, 1439, 4, 3, 9, CAST(0x000064320128A180 AS DateTime), CAST(0x000098400128A180 AS DateTime), CAST(0x00009F09009BEBEB AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2007, 2007, 60, 1439, 5, 5, 3, 1439, 5, 1, 11, CAST(0x000098FE0128A180 AS DateTime), CAST(0x000099D70128A180 AS DateTime), CAST(0x00009F09009BEBF4 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2008, 2008, 60, 1439, 5, 1, 4, 1439, 6, 5, 10, CAST(0x00009A710128A180 AS DateTime), CAST(0x00009B4400F73140 AS DateTime), CAST(0x00009F09009BEBF9 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2009, 2009, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x00009BD60128A180 AS DateTime), CAST(0x00009CAF00F73140 AS DateTime), CAST(0x00009F09009BEC02 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2010, 2010, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x00009D490128A180 AS DateTime), CAST(0x00009E1B00F73140 AS DateTime), CAST(0x00009F09009BEC07 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2011, 2011, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x00009EB50128A180 AS DateTime), CAST(0x00009F8700F73140 AS DateTime), CAST(0x00009F09009BEC0C AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2012, 2012, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A0280128A180 AS DateTime), CAST(0x0000A0F300F73140 AS DateTime), CAST(0x00009F09009BEC15 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2013, 2013, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A1940128A180 AS DateTime), CAST(0x0000A26600F73140 AS DateTime), CAST(0x00009F09009BEC1A AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2014, 2014, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A3000128A180 AS DateTime), CAST(0x0000A3D200F73140 AS DateTime), CAST(0x00009F09009BEC1F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2015, 2015, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A46C0128A180 AS DateTime), CAST(0x0000A53E00F73140 AS DateTime), CAST(0x00009F09009BEC28 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2016, 2016, 60, 1439, 5, 5, 3, 1439, 5, 5, 10, CAST(0x0000A5D80128A180 AS DateTime), CAST(0x0000A6AA00F73140 AS DateTime), CAST(0x00009F09009BEC2D AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (290, 2017, 2999, 60, 1439, 5, 1, 4, 1439, 5, 5, 10, CAST(0x0000A74B0128A180 AS DateTime), CAST(0x000621270128A180 AS DateTime), CAST(0x00009F09009BEC31 AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (291, 2009, 2009, 60, 1380, 6, 3, 6, 1439, 5, 5, 12, CAST(0x00009C2B0128A180 AS DateTime), CAST(0x00009CEE00F73140 AS DateTime), CAST(0x00009F09009BEC3F AS DateTime))
INSERT [tblTimeZoneDaylightSavingRules] ([TimezoneID], [start_year], [end_year], [offset_mins], [hours_start], [day_start], [week_start], [month_start], [hours_end], [day_end], [week_end], [month_end], [first_start_date], [last_end_date], [Last_updated]) VALUES (293, 1970, 2999, 60, 120, 1, 5, 3, 180, 1, 5, 10, CAST(0x000064340128A180 AS DateTime), CAST(0x000621230128A180 AS DateTime), CAST(0x00009F09009BEC4D AS DateTime))
SET IDENTITY_INSERT [tblTimeZone] ON
delete from [tblTimeZone]
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (1, N'Morocco Standard Time', 0, N'(UTC) Casablanca                                                                                                                                                                                                                                ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (2, N'Coordinated Universal Time', 0, N'(UTC) Coordinated Universal Time                                                                                                                                                                                                                ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (3, N'GMT Standard Time', 0, N'(UTC) Dublin, Edinburgh, Lisbon, London                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (4, N'Greenwich Standard Time', 0, N'(UTC) Monrovia, Reykjavik                                                                                                                                                                                                                       ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (5, N'W. Europe Standard Time', 60, N'(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna                                                                                                                                                                                    ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (6, N'Central Europe Standard Time', 60, N'(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague                                                                                                                                                                                   ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (7, N'Romance Standard Time', 60, N'(UTC+01:00) Brussels, Copenhagen, Madrid, Paris                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (8, N'Central European Standard Time', 60, N'(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb                                                                                                                                                                                                    ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (9, N'W. Central Africa Standard Time', 60, N'(UTC+01:00) West Central Africa                                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (10, N'Jordan Standard Time', 120, N'(UTC+02:00) Amman                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (11, N'GTB Standard Time', 120, N'(UTC+02:00) Athens, Bucharest, Istanbul                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (12, N'Middle East Standard Time', 120, N'(UTC+02:00) Beirut                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (13, N'Egypt Standard Time', 120, N'(UTC+02:00) Cairo                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (14, N'South Africa Standard Time', 120, N'(UTC+02:00) Harare, Pretoria                                                                                                                                                                                                                    ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (15, N'FLE Standard Time', 120, N'(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius                                                                                                                                                                                       ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (16, N'Jerusalem Standard Time', 120, N'(UTC+02:00) Jerusalem                                                                                                                                                                                                                           ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (17, N'E. Europe Standard Time', 120, N'(UTC+02:00) Minsk                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (18, N'Namibia Standard Time', 120, N'(UTC+02:00) Windhoek                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (19, N'Arabic Standard Time', 180, N'(UTC+03:00) Baghdad                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (20, N'Arab Standard Time', 180, N'(UTC+03:00) Kuwait, Riyadh                                                                                                                                                                                                                      ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (21, N'Russian Standard Time', 180, N'(UTC+03:00) Moscow, St. Petersburg, Volgograd                                                                                                                                                                                                   ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (22, N'E. Africa Standard Time', 180, N'(UTC+03:00) Nairobi                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (23, N'Georgian Standard Time', 180, N'(UTC+03:00) Tbilisi                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (24, N'Iran Standard Time', 210, N'(UTC+03:30) Tehran                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (25, N'Arabian Standard Time', 240, N'(UTC+04:00) Abu Dhabi, Muscat                                                                                                                                                                                                                   ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (26, N'Azerbaijan Standard Time', 240, N'(UTC+04:00) Baku                                                                                                                                                                                                                                ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (27, N'Mauritius Standard Time', 240, N'(UTC+04:00) Port Louis                                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (28, N'Caucasus Standard Time', 240, N'(UTC+04:00) Yerevan                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (29, N'Afghanistan Standard Time', 270, N'(UTC+04:30) Kabul                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (30, N'Ekaterinburg Standard Time', 300, N'(UTC+05:00) Ekaterinburg                                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (31, N'Pakistan Standard Time', 300, N'(UTC+05:00) Islamabad, Karachi                                                                                                                                                                                                                  ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (32, N'West Asia Standard Time', 300, N'(UTC+05:00) Tashkent                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (33, N'India Standard Time', 330, N'(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (34, N'Sri Lanka Standard Time', 330, N'(UTC+05:30) Sri Jayawardenepura                                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (35, N'Nepal Standard Time', 345, N'(UTC+05:45) Kathmandu                                                                                                                                                                                                                           ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (36, N'N. Central Asia Standard Time', 360, N'(UTC+06:00) Almaty, Novosibirsk                                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (37, N'Central Asia Standard Time', 360, N'(UTC+06:00) Astana, Dhaka                                                                                                                                                                                                                       ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (38, N'Myanmar Standard Time', 390, N'(UTC+06:30) Yangon (Rangoon)                                                                                                                                                                                                                    ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (39, N'SE Asia Standard Time', 420, N'(UTC+07:00) Bangkok, Hanoi, Jakarta                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (40, N'North Asia Standard Time', 420, N'(UTC+07:00) Krasnoyarsk                                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (41, N'China Standard Time', 480, N'(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (42, N'North Asia East Standard Time', 480, N'(UTC+08:00) Irkutsk, Ulaan Bataar                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (43, N'Malay Peninsula Standard Time', 480, N'(UTC+08:00) Kuala Lumpur, Singapore                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (44, N'W. Australia Standard Time', 480, N'(UTC+08:00) Perth                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (45, N'Taipei Standard Time', 480, N'(UTC+08:00) Taipei                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (46, N'Tokyo Standard Time', 540, N'(UTC+09:00) Osaka, Sapporo, Tokyo                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (47, N'Korea Standard Time', 540, N'(UTC+09:00) Seoul                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (48, N'Yakutsk Standard Time', 540, N'(UTC+09:00) Yakutsk                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (49, N'Cen. Australia Standard Time', 570, N'(UTC+09:30) Adelaide                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (50, N'AUS Central Standard Time', 570, N'(UTC+09:30) Darwin                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (51, N'E. Australia Standard Time', 600, N'(UTC+10:00) Brisbane                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (52, N'AUS Eastern Standard Time', 600, N'(UTC+10:00) Canberra, Melbourne, Sydney                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (53, N'West Pacific Standard Time', 600, N'(UTC+10:00) Guam, Port Moresby                                                                                                                                                                                                                  ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (54, N'Tasmania Standard Time', 600, N'(UTC+10:00) Hobart                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (55, N'Vladivostok Standard Time', 600, N'(UTC+10:00) Vladivostok                                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (56, N'Central Pacific Standard Time', 660, N'(UTC+11:00) Magadan, Solomon Is., New Caledonia                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (57, N'New Zealand Standard Time', 720, N'(UTC+12:00) Auckland, Wellington                                                                                                                                                                                                                ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (58, N'Fiji Standard Time', 720, N'(UTC+12:00) Fiji, Marshall Is.                                                                                                                                                                                                                  ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (59, N'Kamchatka Standard Time', 720, N'(UTC+12:00) Petropavlovsk-Kamchatsky                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (60, N'Tonga Standard Time', 780, N'(UTC+13:00) Nuku''alofa                                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (61, N'Azores Standard Time', -60, N'(UTC-01:00) Azores                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (62, N'Cape Verde Standard Time', -60, N'(UTC-01:00) Cape Verde Is.                                                                                                                                                                                                                      ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (63, N'Mid-Atlantic Standard Time', -120, N'(UTC-02:00) Mid-Atlantic                                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (64, N'E. South America Standard Time', -180, N'(UTC-03:00) Brasilia                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (65, N'Argentina Standard Time', -180, N'(UTC-03:00) Buenos Aires                                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (66, N'SA Eastern Standard Time', -180, N'(UTC-03:00) Cayenne                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (67, N'Greenland Standard Time', -180, N'(UTC-03:00) Greenland                                                                                                                                                                                                                           ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (68, N'Montevideo Standard Time', -180, N'(UTC-03:00) Montevideo                                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (69, N'Newfoundland Standard Time', -210, N'(UTC-03:30) Newfoundland                                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (70, N'Paraguay Standard Time', -240, N'(UTC-04:00) Asuncion                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (71, N'Atlantic Standard Time', -240, N'(UTC-04:00) Atlantic Time (Canada)                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (72, N'SA Western Standard Time', -240, N'(UTC-04:00) Georgetown, La Paz, San Juan                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (73, N'Central Brazilian Standard Time', -240, N'(UTC-04:00) Manaus                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (74, N'Pacific SA Standard Time', -240, N'(UTC-04:00) Santiago                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (75, N'Venezuela Standard Time', -270, N'(UTC-04:30) Caracas                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (76, N'SA Pacific Standard Time', -300, N'(UTC-05:00) Bogota, Lima, Quito                                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (77, N'Eastern Standard Time', -300, N'(UTC-05:00) Eastern Time (US & Canada)                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (78, N'US Eastern Standard Time', -300, N'(UTC-05:00) Indiana (East)                                                                                                                                                                                                                      ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (79, N'Central America Standard Time', -360, N'(UTC-06:00) Central America                                                                                                                                                                                                                     ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (80, N'Central Standard Time', -360, N'(UTC-06:00) Central Time (US & Canada)                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (81, N'Central Standard Time (Mexico)', -360, N'(UTC-06:00) Guadalajara, Mexico City, Monterrey                                                                                                                                                                                                 ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (82, N'Canada Central Standard Time', -360, N'(UTC-06:00) Saskatchewan                                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (83, N'US Mountain Standard Time', -420, N'(UTC-07:00) Arizona                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (84, N'Mountain Standard Time (Mexico)', -420, N'(UTC-07:00) Chihuahua, La Paz, Mazatlan                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (85, N'Mountain Standard Time', -420, N'(UTC-07:00) Mountain Time (US & Canada)                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (86, N'Pacific Standard Time', -480, N'(UTC-08:00) Pacific Time (US & Canada)                                                                                                                                                                                                          ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (87, N'Pacific Standard Time (Mexico)', -480, N'(UTC-08:00) Tijuana, Baja California                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (88, N'Alaskan Standard Time', -540, N'(UTC-09:00) Alaska                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (89, N'Hawaiian Standard Time', -600, N'(UTC-10:00) Hawaii                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (90, N'Samoa Standard Time', -660, N'(UTC-11:00) Midway Island, Samoa                                                                                                                                                                                                                ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (91, N'Dateline Standard Time', -720, N'(UTC-12:00) International Date Line West                                                                                                                                                                                                        ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (92, N'Test1', -720, N'(UTC+09:00) Yakuts                                                                                                                                                                                                                              ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (93, N'Syria Standard Time', 120, N'(UTC+02:00) Damascus                                                                                                                                                                                                                            ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (94, N'Bangladesh Standard Time', 360, N'(UTC+06:00) Dhaka                                                                                                                                                                                                                               ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (95, N'Ulaanbaatar Standard Time', 480, N'(UTC+08:00) Ulaanbaatar                                                                                                                                                                                                                         ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (96, N'Magadan Standard Time', 660, N'(UTC+11:00) Magadan                                                                                                                                                                                                                             ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (97, N'UTC+12', 720, N'(UTC+12:00) Coordinated Universal Time+12                                                                                                                                                                                                       ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (98, N'UTC-02', -120, N'(UTC-02:00) Coordinated Universal Time-02                                                                                                                                                                                                       ', 1)
INSERT [tblTimeZone] ([TimeZoneID], [WrittenName], [OffsetUTC], [FLB_Name], [Active]) VALUES (99, N'UTC-11', -660, N'(UTC-11:00) Coordinated Universal Time-11                                                                                                                                                                                                       ', 1)
 SET IDENTITY_INSERT [tblTimeZone] OFF
GO

INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_Header', N'Student Summary Header', N'Hi, Our Records show that the following changes have occurred to your course status for  %APP_NAME%:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_Sig', N'Student Summary Sig', N'<BR>Regards,%APP_NAME% Administrator')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_ExpiredContent', N'Student Summary - Expired Content', N'The content of the following Courses - Modules has been updated and you are required to redo them:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_PassedCourses', N'Student Summary -Passed Courses', N'Congratulations on passing the following courses:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_PassedModules', N'Student Summary - Passed Modules', N'Congratulations on passing the following modules:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_AtRiskOfExpiry', N'Student Summary - At Risk Of Expiry', N'Your quiz results for the following Courses (Modules) will expire unless you complete the entire course before the dates shown:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_AtRiskOfBeingOverdue', N'Student Summary - At Risk Of being Overdue', N'You were nominated to complete the following courses before the dates shown however our records indicate that the courses are not finished at this time.<BR> Please ensure that the courses are finished by the nominated dates:<BR>')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_Subject', N'Student Summary Message Subject', N'%APP_NAME%  Summary.')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Overdue_Summary_Header', N'Overdue Summary Header', N'Hi, The Following students are now Overdue for their %APP_NAME% courses:')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Overdue_Summary_Sig', N'Overdue Summary Sig', N'Regards,%APP_NAME% Administrator')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Overdue_Summary_Subject', N'Overdue Summary Message Subject', N'%APP_NAME%  Overdue Summary.')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Student_Summary_NewStarter', N'Student Summary - New Starter Greeting', N'You have been registered for use of the %APP_NAME% WebSite at %URL%, <BR>Your UserName is %USERNAME% and your initial password is %PASSWORD%. <BR>Please login and change your password as soon as possible.')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Course_Completion_Certificate', N'Course Completion Certificate', N'Congratulations %USERNAME% on passing the %APP_NAME%  %COURSE% , your completion certificate is attached or may be reprinted from the website at %URL%.')
INSERT [tblOrganisationConfig] ([OrganisationID], [Name], [Description], [Value]) VALUES (NULL, N'Email_Failure_delivery_notification', N'Email Failure delivery notification', N'Email Failure delivery notification, the following message failed to be sent for 3 days to the following email address: ')


/* fixed bug in Timezone Daylight savings rule screen */

/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/23/2011 11:05:29 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcGetTimezoneDaylightRules]
GO

/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/23/2011 11:05:29 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Gets daylight saving rules for timezone and start year
-- =============================================
CREATE PROCEDURE [dbo].[prcGetTimezoneDaylightRules] 
	@TimezoneId int,
	@StartYear smallint
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT tz.WrittenName AS WrittenName, tzd.start_year AS StartYear, tzd.end_year AS EndYear, tzd.offset_mins AS Offset,
		tzd.hours_start AS TimeStart, tzd.day_start AS WeekdayStart, tzd.week_start AS WeekStart, tzd.month_start AS MonthStart,
		tzd.hours_end AS TimeEnd, tzd.day_end AS WeekdayEnd, tzd.week_end AS WeekEnd, tzd.month_end AS MonthEnd  
		FROM tblTimeZoneDaylightSavingRules tzd JOIN tblTimeZone tz ON tzd.TimezoneID = tz.TimeZoneID
		WHERE tzd.TimezoneID=@TimezoneId AND tzd.start_year=@StartYear

END
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_Update]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcUser_Update] (
	@userID Integer = Null,
	@unitID Integer = Null,
	@firstName nvarchar(50) = Null,
	@lastName nvarchar(50) = Null,
	@userName nvarchar(100) = Null, 
	@email nvarchar(100) = null,
	@active bit = null,	
	@userTypeID Integer = Null,
	@updatedByUserID Integer = Null,
	@dateUpdated datetime = Null,
	@password nvarchar(50) = Null,
	@oldPassword nvarchar(50) = Null,
	@externalID nvarchar(50) = Null,
	@TimeZoneID Integer = Null,
	@DelinquencyManagerEmail nvarchar(100) = Null,
	@NotifyOfPendingDelinquencies bit = Null

)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @OrgTimeZone Integer -- Holds the ORG timezone
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @UpdatedByUserTypeID Integer -- Holds the UserTypeID for the Updating user.
	Declare @blnChangePassword bit			-- Boolean value to indentify update of the password
	Declare @strCurrentPassword nvarchar(50) -- Holds the current password in the DB for this user
	Declare @strCurrentUserName nvarchar(100) -- Holds the current username in the DB for this user
	Declare @strCurrentEmail nvarchar(100) -- Holds the current email in the DB for this user
	Declare @organisationID Integer -- Used to set the OrgID to null when updating a SALT Administrator
	Declare @dteCurrentDateUpdated datetime -- Holds the current dateupdated in the DB for this user
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0
	Set @blnChangePassword = 0

	-- PARAMETER VALIDATION
	--==============================================================

	-- Verify @UnitID and OrgID
	Select
		@organisationID = OrganisationID
	From 
		tblUser
	Where
		UserID = @userID

	--==================================================
	-- If 0 passed in (for a SALT Admin), insert nulls for 
	-- Unit and Org IDs
	if (@UnitID = 0)
	begin
		Set @UnitID = null
		Set @OrganisationID = null
	end
	
		Select
		@OrgTimeZone = TimeZoneID
	From 
		tblOrganisation
	Where
		OrganisationID = @OrganisationID
	
	if (@OrgTimeZone = @TimeZoneID)
	begin
		Set @TimeZoneID = null
	end
	
--Missing or Null parameter {0} in stored procedure prcUser_Update
	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcUser_Update''
		Goto Finalise
	End
	
	-- If user type is not SALT Administrator, validate parameter @UnitID
	If(@userTypeID <> 1)
	Begin
		If(@unitID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = ''Missing or Null parameter @unitID in stored procedure prcUser_Update''
			Goto Finalise
		End
	End

	--Validate Parameter @firstName
	If(@firstName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @firstName in stored procedure prcUser_Update''
		Goto Finalise
	End

	--Validate Parameter @lastName
	If(@lastName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @lastName in stored procedure prcUser_Update''
		Goto Finalise

	End
	
	--Validate Parameter @userName
	If(@userName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userName in stored procedure prcUser_Update''
		Goto Finalise
	End
	
	--Validate Parameter @email
	If(@email Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @email in stored procedure prcUser_Update''
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcUser_Update''
		Goto Finalise
	End

	--Validate Parameter @userTypeID
	If(@userTypeID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userTypeID in stored procedure prcUser_Update''
		Goto Finalise
	End

	--Validate Parameter @updatedByUserID
	If(@updatedByUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @updatedByUserID in stored procedure prcUser_Update''
		Goto Finalise
	End

	--Validate Parameter @dateUpdated
	If(@dateUpdated Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @dateUpdated in stored procedure prcUser_Update''
		Goto Finalise
	End

	-- Validate User Exists
	--=========================================================
	If Not Exists(Select * From tblUser Where UserID = @userID)
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		Goto Finalise
	End 
	
	-- If a unit was specified make sure it exists
	--=========================================================
	If (@unitID Is Not Null)
	Begin
		If Not Exists(Select * From tblUnit Where UnitID = @unitID)
		Begin
			Set @intErrorNumber = 11
			Set @strErrorMessage = ''The specified unit could be found or may not be active.''
			Goto Finalise
		End
	End

	-- Integrity Constraint
	--=========================================================
	Select 
		@dteCurrentDateUpdated = DateUpdated
	from 
		tblUser
	Where 
		UserID = @userID


	/*If (DateDiff(s, @dteCurrentDateUpdated, @dateUpdated) <> 0)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = ''This record has already been updated by another user, please refresh your screen. If the problem persists please contact your administrator.''
		Goto Finalise
	End */
	

	-- Validate Passwords
	--=======================
	
	-- get Updating User, UserTypeID
	Select 
		@UpdatedByUserTypeID = UserTypeID 
	from 
		tblUser
	Where
		UserID = @updatedByUserID
	
	if(@UpdatedByUserTypeID = 4)
	Begin
		
		-- SALT User
		If (@password Is Not Null or @oldPassword Is Not Null)
		Begin
			If(@password Is Null)
			Begin
				Set @intErrorNumber = 5
				Set @strErrorMessage = ''Missing or Null parameter @password in stored procedure prcUser_Update''
				Goto Finalise
			End
			
			If(@oldPassword Is Null)
			Begin
				Set @intErrorNumber = 5
				Set @strErrorMessage = ''Missing or Null parameter @oldPassword in stored procedure prcUser_Update''
				Goto Finalise
			End
		
			-- Get the current password in the DB
			Select 
				@strCurrentPassword = Password
			From 
				tblUser
			Where 
				UserID = @userID

			-- Ensure old password match current password otherwise error
			if(@oldPassword <> @strCurrentPassword)
			Begin
				Set @intErrorNumber = 4
				Set @strErrorMessage = ''Your old password was entered incorrectly so the user details have not been saved. ''
				Set @strErrorMessage = @strErrorMessage + ''Please try again and if the problem persists please contact your administrator.''
				Goto Finalise
			End 
				
			Set @blnChangePassword = 1
		End 		
	End
	else
	Begin
		-- Administrator
		-- if there is a value in @oldPassword then admin is attempting to update their own password
		if(@oldPassword Is Not Null)
		Begin
			-- Get the current password in the DB
			Select 
				@strCurrentPassword = Password
			From 
				tblUser
			Where 
				UserID = @userID

			-- Ensure old password match current password otherwise error
			if(@oldPassword <> @strCurrentPassword)
			Begin
				Set @intErrorNumber = 4
				Set @strErrorMessage = ''Your old password was entered incorrectly so the user details have not been saved. ''
				Set @strErrorMessage = @strErrorMessage + ''Please try again and if the problem persists please contact your administrator.''
				Goto Finalise
			End 
				
			Set @blnChangePassword = 1		
		End

		If(@password Is Not Null)
		Begin
			Set @blnChangePassword = 1
		End 
	End

	-- Validate Permisions
	--========================================
	if(@UpdatedByUserTypeID = 4)
	Begin
		-- Salt User can only update themselves
		if(@UpdatedByUserID <> @UserID)
		Begin
			Set @intErrorNumber = 41
			Set @strErrorMessage = ''You do not have the permissions required to update this user.''
			Goto Finalise
		End 
	End
	

	-- Validate Unique UserName
	--========================================
	Select
		@strCurrentUserName = UserName
	From 
		tblUser
	Where
		UserID = @userID
	
	-- Check for uniqueness if the username is changing
	if(@strCurrentUserName <> @userName)
	Begin
		If(@userTypeID <> 1)
		begin
			if Exists(Select * from tblUser where UserName = @userName and (organisationID=@organisationID or organisationID is null))
			Begin
				Set @intErrorNumber = 42
				Set @strErrorMessage = @userName
				Goto Finalise
			End 
		end
		else
		begin
			if Exists(Select * from tblUser where UserName = @userName)
			Begin
				Set @intErrorNumber = 42
				Set @strErrorMessage = @userName
				Goto Finalise
			End 
		end
	End 


	-- Validate Unique UserName
	--========================================
	Select
		@strCurrentEmail = Email
	From 
		tblUser
	Where
		UserID = @userID

	-- Check for uniqueness if the email address is changing
	if(@strCurrentEmail <> @email)
	If Exists(Select * From tblUser Where Email = @email)
	Begin
		Set @intErrorNumber = 43
		Set @strErrorMessage = @email
		Goto Finalise
	End


	-- only update if the user is moved to a new unit (so new unit is diff from the current unit)
	if (select unitid from tblUser where userid=@userid) <> @unitid
	begin


	-- update the profile access of the user 
	-- give the user access to profiles for the selected unit
	update tbluserprofileperiodaccess set granted = 1		
		where	userid = @userid 
			and profileperiodid in (
				select profileperiodid from tblunitprofileperiodaccess where 
				unitid = @unitID and granted = 1)
				
    -- give the user access to the policies for the selected unit.
	/*update tbluserpolicyaccess set granted = 1		
		where	userid = @userid
			and policyid in (
				select policyid from tblunitpolicyaccess where 
				unitid = @unitID and granted = 1)*/

	update upa1
	set upa1.granted = upa2.granted
	from tbluserpolicyaccess upa1
	inner join tblunitpolicyaccess upa2
	on upa1.policyid=upa2.policyid
	inner join tblPolicy p
	on upa1.policyid=p.policyid
	where
	upa1.userid=@userid and upa2.unitid=@unitid
	and p.deleted=0

	end	
	


	-- Execute Update
	--===============================================================	
	-- Update the record in tblUser
	if(@blnChangePassword = 1)
	Begin
		-- Update with password change
		Update tblUser
		Set 
			FirstName = @firstName,
			LastName = @lastName,
			UserName = @userName,
			Password = @password,
			Email = @email,
			OrganisationID = @organisationID,
			UnitID = @unitID,
			UserTypeID = @userTypeID,
			Active = @active,
			UpdatedBy = @updatedByUserID,
			DateUpdated = getutcDate(),
			ExternalID = @externalID,
			TimeZoneID = @TimeZoneID,
			DelinquencyManagerEmail = @DelinquencyManagerEmail,
			NotifyOfPendingDelinquencies = @NotifyOfPendingDelinquencies
		Where
			UserID = @userID
	End			
	Else
	Begin
		Update tblUser
		Set 
			FirstName = @firstName,
			LastName = @lastName,
			UserName = @userName,
			Email = @email,
			UnitID = @unitID,
			UserTypeID = @userTypeID,
			Active = @active,
			UpdatedBy = @updatedByUserID,
			DateUpdated = getutcDate(),
			ExternalID = @externalID,
			TimeZoneID = @TimeZoneID,
			DelinquencyManagerEmail = @DelinquencyManagerEmail,
			NotifyOfPendingDelinquencies = @NotifyOfPendingDelinquencies
		Where
			UserID = @userID
	End
	

	update tblUser set DateArchived = getutcdate() where Active = 0 and DateArchived IS NULL AND UserID = @userID
	update tblUser set DateArchived = null where Active = 1 and NOT(DateArchived IS NULL) AND UserID = @userID
	
	
	-- update the user current status
	declare courseIDCursor cursor
	for 
	select
	grantedcourseid
	from
	tblOrganisationCourseAccess oca
	where
	organisationid = (select organisationid from tblUser where userid=@userid)


	/*-- update course status for users
	declare @intOldCourseStatus int
	declare @intNewCourseStatus int
	declare @courseID int
	declare @moduleID int


	open courseIDCursor

	fetch next from courseIDCursor into @courseid
	while (@@FETCH_STATUS <> -1) 
	begin 
		if (@@FETCH_STATUS <> -2) 
		begin 
			exec @intOldCourseStatus = prcUserCourseStatus_GetStatus @courseID, @userID 
			exec @intNewCourseStatus = prcUserCourseStatus_Calculate @courseID, @userID

			--select * from tbluser where userid=@userid

			--select * from tblUsercoursestatus where userid=@userid and courseid=@courseid 

			print ''CourseID: '' + convert(varchar(10), @courseid)
			print ''Old Course Status : '' + convert(varchar(10), @intOldCourseStatus)
			print ''New Course Status : '' + convert(varchar(10), @intNewCourseStatus)

			if (@intOldCourseStatus <> -1) and (@intOldCourseStatus <> @intNewCourseStatus) 
			begin
			print ''Insert''

			set @moduleID = (select top 1 m.moduleId from tblModule m where CourseID = @courseID)
			--print ''ModuleID: '' + convert(varchar(10), @moduleid)  + ''\n''
			exec prcUserCourseStatus_Insert @userID, @ModuleID, @intNewCourseStatus 
			end
		end 

		fetch next from courseIDCursor into @courseid
	end 

	close courseIDCursor deallocate courseIDCursor*/


	
	-- Set the error message to successfull
	Set @strErrorMessage = ''Successfully Updated''

	-- Finalise the procedure
	Goto Finalise


Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
	@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





/* fixed table modifiations for UTC, default datetime when not null */

/*
   Friday, 24 June 201112:07:47 PM
   User: salt_user
   Server: BDW2008\TS
   Database: Algy_Test
   Application: 
*/


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblCourse_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblCourse ADD CONSTRAINT DF_tblCourse_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO


ALTER TABLE dbo.tblCourse SET (LOCK_ESCALATION = TABLE)
GO




IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLesson_DatePublished]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLesson ADD CONSTRAINT DF_tblLesson_DatePublished DEFAULT (getutcdate()) FOR DatePublished
END
GO



IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLesson_DateLoaded]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLesson ADD CONSTRAINT DF_tblLesson_DateLoaded DEFAULT (getutcdate()) FOR DateLoaded
END
GO

ALTER TABLE dbo.tblLesson SET (LOCK_ESCALATION = TABLE)
GO





IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLessonAudit_DateAccessed]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLessonPageAudit	DROP CONSTRAINT DF_tblLessonAudit_DateAccessed
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLessonAudit_DateAccessed]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLessonPageAudit ADD CONSTRAINT DF_tblLessonAudit_DateAccessed DEFAULT (getutcdate()) FOR DateAccessed
END
GO

ALTER TABLE dbo.tblLessonPageAudit SET (LOCK_ESCALATION = TABLE)
GO







IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLink_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLink DROP CONSTRAINT DF_tblLink_DateCreated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLink_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLink ADD CONSTRAINT	DF_tblLink_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblLink SET (LOCK_ESCALATION = TABLE)
GO





IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLogDaily_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLogDaily ADD CONSTRAINT	DF_tblLogDaily_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblLogDaily SET (LOCK_ESCALATION = TABLE)
GO



IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblLogHourly_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblLogHourly ADD CONSTRAINT	DF_tblLogHourly_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblLogHourly SET (LOCK_ESCALATION = TABLE)
GO



IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblModuleStatusUpdateHistory_StartTime]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblModuleStatusUpdateHistory ADD CONSTRAINT	DF_tblModuleStatusUpdateHistory_StartTime DEFAULT (getutcdate()) FOR StartTime
END
GO

ALTER TABLE dbo.tblModuleStatusUpdateHistory SET (LOCK_ESCALATION = TABLE)
GO


IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblOrganisation_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblOrganisation	DROP CONSTRAINT DF_tblOrganisation_DateCreated
END
GO


IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblOrganisation_DateUpdated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblOrganisation	DROP CONSTRAINT DF_tblOrganisation_DateUpdated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblOrganisation_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblOrganisation ADD CONSTRAINT	DF_tblOrganisation_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblOrganisation_DateUpdated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblOrganisation ADD CONSTRAINT	DF_tblOrganisation_DateUpdated DEFAULT (getutcdate()) FOR DateUpdated
END
GO

ALTER TABLE dbo.tblOrganisation SET (LOCK_ESCALATION = TABLE)
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblProfilePoints_DateAssigned]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblProfilePoints ADD CONSTRAINT	DF_tblProfilePoints_DateAssigned DEFAULT (getutcdate()) FOR DateAssigned
END
GO

ALTER TABLE dbo.tblProfilePoints SET (LOCK_ESCALATION = TABLE)
GO



IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblQuiz_DatePublished]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblQuiz ADD CONSTRAINT	DF_tblQuiz_DatePublished DEFAULT (getutcdate()) FOR DatePublished
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblQuiz_DateLoaded]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblQuiz ADD CONSTRAINT	DF_tblQuiz_DateLoaded DEFAULT (getutcdate()) FOR DateLoaded
END
GO

ALTER TABLE dbo.tblQuiz SET (LOCK_ESCALATION = TABLE)
GO



IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblQuizQuestionAudit_DateAccessed]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblQuizQuestionAudit DROP CONSTRAINT DF_tblQuizQuestionAudit_DateAccessed
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblQuizQuestionAudit_DateAccessed]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblQuizQuestionAudit ADD CONSTRAINT	DF_tblQuizQuestionAudit_DateAccessed DEFAULT (getutcdate()) FOR DateAccessed
END
GO

ALTER TABLE dbo.tblQuizQuestionAudit SET (LOCK_ESCALATION = TABLE)
GO





IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZoneDaylightSavingRules_Last_updated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblTimeZoneDaylightSavingRules	DROP CONSTRAINT DF_tblTimeZoneDaylightSavingRules_Last_updated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZoneDaylightSavingRules_first_start_date]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblTimeZoneDaylightSavingRules ADD CONSTRAINT DF_tblTimeZoneDaylightSavingRules_first_start_date DEFAULT (getutcdate()) FOR first_start_date
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZoneDaylightSavingRules_last_end_date]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblTimeZoneDaylightSavingRules ADD CONSTRAINT	DF_tblTimeZoneDaylightSavingRules_last_end_date DEFAULT (getutcdate()) FOR last_end_date
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblTimeZoneDaylightSavingRules_Last_updated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblTimeZoneDaylightSavingRules ADD CONSTRAINT	DF_tblTimeZoneDaylightSavingRules_Last_updated DEFAULT (getutcdate()) FOR Last_updated
END
GO

ALTER TABLE dbo.tblTimeZoneDaylightSavingRules SET (LOCK_ESCALATION = TABLE)
GO


IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnit_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[tblUnit] DROP CONSTRAINT [DF_tblUnit_DateCreated]
END

GO



IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnit_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[tblUnit] ADD  CONSTRAINT [DF_tblUnit_DateCreated]  DEFAULT (getutcdate()) FOR [DateCreated]
END
GO





IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnit_DateUpdated]') AND type = 'D')
BEGIN
	ALTER TABLE [dbo].[tblUnit] DROP CONSTRAINT [DF_tblUnit_DateUpdated]
END
GO




IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnit_DateUpdated]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[tblUnit] ADD  CONSTRAINT [DF_tblUnit_DateUpdated]  DEFAULT (getutcdate()) FOR [DateUpdated]
END
GO


ALTER TABLE dbo.tblUnit SET (LOCK_ESCALATION = TABLE)
GO





IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnitAdministrator_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUnitAdministrator	DROP CONSTRAINT DF_tblUnitAdministrator_DateCreated
END
GO




IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnitAdministrator_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUnitAdministrator ADD CONSTRAINT DF_tblUnitAdministrator_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO


ALTER TABLE dbo.tblUnitAdministrator SET (LOCK_ESCALATION = TABLE)
GO




IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnitRule_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUnitRule	DROP CONSTRAINT DF_tblUnitRule_DateCreated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUnitRule_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUnitRule ADD CONSTRAINT	DF_tblUnitRule_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblUnitRule SET (LOCK_ESCALATION = TABLE)
GO




IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUser_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUser	DROP CONSTRAINT DF_tblUser_DateCreated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUser_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUser ADD CONSTRAINT	DF_tblUser_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblUser SET (LOCK_ESCALATION = TABLE)
GO




IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseStatus_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserCourseStatus	DROP CONSTRAINT DF_tblUserCourseStatus_DateCreated
END
GO


IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCourseStatus_DateCreated]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserCourseStatus ADD CONSTRAINT	DF_tblUserCourseStatus_DateCreated DEFAULT (getutcdate()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblUserCourseStatus SET (LOCK_ESCALATION = TABLE)
GO




IF  NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCPDPoints_DateAssigned]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserCPDPoints ADD CONSTRAINT	DF_tblUserCPDPoints_DateAssigned DEFAULT (getutcdate()) FOR DateAssigned
END
GO

ALTER TABLE dbo.tblUserCPDPoints SET (LOCK_ESCALATION = TABLE)
GO



IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserCurrentLessonStatus_EffectiveDate]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserCurrentLessonStatus	DROP CONSTRAINT DF_tblUserCurrentLessonStatus_EffectiveDate
END
GO

ALTER TABLE dbo.tblUserCurrentLessonStatus ADD CONSTRAINT	DF_tblUserCurrentLessonStatus_EffectiveDate DEFAULT (getutcdate()) FOR DateCreated
GO

ALTER TABLE dbo.tblUserCurrentLessonStatus SET (LOCK_ESCALATION = TABLE)
GO




IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserLessonStatus_EffectiveDate]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserLessonStatus	DROP CONSTRAINT DF_tblUserLessonStatus_EffectiveDate
END
GO

ALTER TABLE dbo.tblUserLessonStatus ADD CONSTRAINT	DF_tblUserLessonStatus_EffectiveDate DEFAULT (getutcdate()) FOR DateCreated
GO

ALTER TABLE dbo.tblUserLessonStatus SET (LOCK_ESCALATION = TABLE)
GO


IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUserQuizStatus_EffectiveDate]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblUserQuizStatus DROP CONSTRAINT DF_tblUserQuizStatus_EffectiveDate
END
GO

ALTER TABLE dbo.tblUserQuizStatus ADD CONSTRAINT DF_tblUserQuizStatus_EffectiveDate DEFAULT (getutcdate()) FOR DateCreated
GO

ALTER TABLE dbo.tblUserQuizStatus SET (LOCK_ESCALATION = TABLE)
GO


/* fixed bug in Organisation Administrators */

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetAdminList]    Script Date: 06/26/2011 16:06:31 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetAdminList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcOrganisation_GetAdminList]
GO

/****** Object:  StoredProcedure [dbo].[prcOrganisation_GetAdminList]    Script Date: 06/26/2011 16:06:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcOrganisation_GetAdminList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'


/*Summary:
	Gets a List of all the Administrators for a particular organisation.

Parameters:
	@organisationID

Returns:
	Nothing
		
Called By: 
	Organisation.cs.

Calls:
	Nothing

Remarks:
	None

Author: Peter Vranich
Date Created: 12th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [dbo].[prcOrganisation_GetAdminList]
(
	@organisationID Integer = Null -- ID of the Organisation that you wish to get the Admins for.
)

As

Select
	UserID,
	FirstName,
	LastName,
	Email,
	OrganisationID,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, @organisationID) as DateCreated,
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, @organisationID) as DateUpdated
From
	tblUser
Where
	((OrganisationID = @organisationID)
		And (UserTypeID = 2)
		And (Active = 1))
' 
END
GO

/* fixed bug in my training view certificate */

/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_GetOne]    Script Date: 06/26/2011 16:20:51 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserCourseStatus_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_GetOne]    Script Date: 06/26/2011 16:20:51 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'




/*
Summary: Gets othe details of one Organisation
Parameters: 	@courseID integer
		@userID integer
Returns: 

Called By: User.cs
Calls: None

Remarks: Raises an error if either of the input parameters are null

Author: Gavin Buddis
Date Created: 2/4/04

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1
*/

CREATE  Procedure [dbo].[prcUserCourseStatus_GetOne]
(
@userID int, 	-- The User ID
@courseID int, 	-- the Course ID
@OrgID int
)

As

If @courseID Is Null
Begin
	Raiserror(''The Parameter @courseID was null.  @courseID does not accept Null values.'', 16, 1)
	Return
End

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

DECLARE
	@modulesassigned varchar(1000), -- sql2000 doesn''t allow the naked column value (modulesassigned) to be used as a param for a table udf that''s used in a join
	@coursestatusid int

SELECT
	TOP 1 @modulesassigned = modulesassigned, @coursestatusid = coursestatusid
	FROM
		tblusercoursestatus
	WHERE
		userid = @userid
		AND courseid = @courseid
	ORDER BY
		datecreated DESC

SELECT
	TOP 1 @userid userid, @courseid courseid, @coursestatusid coursestatusid, @modulesassigned modulesassigned, dbo.udfUTCtoDaylightSavingTime(datecreated, @OrgID) as datecreated
	FROM
		tbluserquizstatus,
		dbo.udfCsvToInt(@modulesassigned)
	WHERE
		moduleid = intvalue
		AND userid = @userid
		AND quizstatusid = 2 -- passed
	ORDER BY
		datecreated DESC

' 
END
GO


/* fixed timezone daylight saving rule issue (added new unique column) */

/*
   Monday, 27 June 201112:10:44 PM
   User: salt_user
   Server: BDW2008\TS
   Database: Algy_Test
   Application: 
*/



if  not exists (select * from sysobjects o, syscolumns c 
    	    	where o.id = c.id and o.type = 'U' and o.name = 'tblTimeZoneDaylightSavingRules'
				and c.name = 'TimezoneRuleID')
begin
    --increase the size for FLB_Name in tbltimezone table
	exec ('ALTER TABLE dbo.tblTimeZoneDaylightSavingRules ADD	TimezoneRuleID int NOT NULL IDENTITY (1, 1)')
end
GO

ALTER TABLE dbo.tblTimeZoneDaylightSavingRules SET (LOCK_ESCALATION = TABLE)
GO





/* fixed bugs in organisation details screen related to timezone */

/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetTZIDfromFLBName]    Script Date: 06/27/2011 15:21:09 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetTZIDfromFLBName]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZone_GetTZIDfromFLBName]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetTZIDfromFLBName]    Script Date: 06/27/2011 15:21:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetTZIDfromFLBName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra
-- Create date: 27/06/2011
-- Description:	Gets the timezone id from its display name
-- =============================================
CREATE PROCEDURE [dbo].[prcTimeZone_GetTZIDfromFLBName]
	@FLBName nvarchar(240)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT TimeZoneID FROM tblTimeZone WHERE FLB_Name LIKE ''%'' + @FLBName + ''%''

END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetList]    Script Date: 06/27/2011 15:21:00 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetList]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZone_GetList]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetList]    Script Date: 06/27/2011 15:21:00 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetList]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE Procedure [dbo].[prcTimeZone_GetList]

As

SELECT TimeZoneID
      ,WrittenName
      ,OffsetUTC
      ,FLB_Name
  FROM tblTimeZone
' 
END
GO


/* fixed edit timezone daylight saving rule issues */

/****** Object:  StoredProcedure [dbo].[prcDeleteTimezoneDaylightSavingRule]    Script Date: 06/27/2011 19:14:34 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcDeleteTimezoneDaylightSavingRule]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcDeleteTimezoneDaylightSavingRule]
GO

/****** Object:  StoredProcedure [dbo].[prcDeleteTimezoneDaylightSavingRule]    Script Date: 06/27/2011 19:14:34 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcDeleteTimezoneDaylightSavingRule]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Deletes Daylight saving rule for timezone
-- =============================================
CREATE PROCEDURE [dbo].[prcDeleteTimezoneDaylightSavingRule]
	@TimezoneId int,
	@RuleID int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DELETE FROM tblTimeZoneDaylightSavingRules
		WHERE TimezoneID=@TimezoneId AND TimezoneRuleID=@RuleID
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/27/2011 19:14:54 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcGetTimezoneDaylightRules]
GO

/****** Object:  StoredProcedure [dbo].[prcGetTimezoneDaylightRules]    Script Date: 06/27/2011 19:14:54 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcGetTimezoneDaylightRules]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Gets daylight saving rules for timezone and start year
-- =============================================
CREATE PROCEDURE [dbo].[prcGetTimezoneDaylightRules] 
	@TimezoneId int,
	@RuleID int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT tz.WrittenName AS WrittenName, tzd.start_year AS StartYear, tzd.end_year AS EndYear, tzd.offset_mins AS Offset,
		tzd.hours_start AS TimeStart, tzd.day_start AS WeekdayStart, tzd.week_start AS WeekStart, tzd.month_start AS MonthStart,
		tzd.hours_end AS TimeEnd, tzd.day_end AS WeekdayEnd, tzd.week_end AS WeekEnd, tzd.month_end AS MonthEnd  
		FROM tblTimeZoneDaylightSavingRules tzd JOIN tblTimeZone tz ON tzd.TimezoneID = tz.TimeZoneID
		WHERE tzd.TimezoneID=@TimezoneId AND tzd.TimezoneRuleID=@RuleID

END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_add]    Script Date: 06/27/2011 19:15:21 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZoneRule_add]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_add]    Script Date: 06/27/2011 19:15:21 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[prcTimeZoneRule_add]
(
@WrittenName NVarChar(60), 
@OffsetDaylight Int, 
@year_start Int, 
@year_end  Int, 
@StartTimeOfDay Int, 
@day_start Int, 
@week_start Int, 
@StartMonth Int, 
@EndTimeOfDay Int, 
@EndDayOfWeek Int, 
@EndWeek Int, 
@EndMonth Int,
@Error bit output
)
AS
BEGIN

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?

	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)

			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)


	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE (first_start_date < @Period_end) AND (last_end_date > @Period_start)
	AND TimezoneID = @TimezoneID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		INSERT INTO tblTimeZoneDaylightSavingRules
			   ([TimezoneID]
			   ,[offset_mins]
			   ,[start_year]
			   ,[end_year]
			   ,[hours_start]
			   ,[day_start]
			   ,[week_start]
			   ,[month_start]
			   ,[hours_end]
			   ,[day_end]
			   ,[week_end]
			   ,[month_end]
			   ,[first_start_date]
			   ,[last_end_date]
		)
		 VALUES
			   (@TimezoneID,
				@OffsetDaylight,
				@year_start,
				@year_end,
				@StartTimeOfDay,
				@day_start,
				@week_start , 
				@StartMonth , 
				@EndTimeOfDay , 
				@EndDayOfWeek , 
				@EndWeek , 
				@EndMonth, 
				@Period_start,
				@Period_end
			   )
		SET @Error = 0
	END


	
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/27/2011 19:15:30 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZoneRule_update]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/27/2011 19:15:30 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Updates the daylight saving rule for timeaone
-- =============================================
CREATE PROCEDURE [dbo].[prcTimeZoneRule_update] 
(
	@RuleID int,
	@WrittenName NVarChar(60),
	@OffsetDaylight Int, 
	@year_start Int, 
	@year_end  Int, 
	@StartTimeOfDay Int, 
	@day_start Int, 
	@week_start Int, 
	@StartMonth Int, 
	@EndTimeOfDay Int, 
	@EndDayOfWeek Int, 
	@EndWeek Int, 
	@EndMonth Int,
	@Error bit output
)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?

	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)

			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)


	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE (first_start_date < @Period_end) AND (last_end_date > @Period_start)
	AND TimezoneID = @TimezoneID AND TimezoneRuleID <> @RuleID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		UPDATE tblTimeZoneDaylightSavingRules SET
			   offset_mins=@OffsetDaylight
			   , start_year=@year_start
			   , end_year=@year_end
			   , hours_start=@StartTimeOfDay
			   , day_start=@day_start
			   , week_start=@week_start
			   , month_start=@StartMonth
			   , hours_end=@EndTimeOfDay
			   , day_end=@EndDayOfWeek
			   , week_end=@EndWeek
			   , month_end=@EndMonth
			   , first_start_date=@Period_start
			   , last_end_date=@Period_end
			   WHERE TimezoneID=@TimezoneID AND TimezoneRuleID=@RuleID

		SET @Error = 0
	END
END
' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_MailServerURL]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_MailServerURL]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_MailServerURL]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcAutomatedEmails_MailServerURL]

AS
BEGIN
SELECT Value FROM tblAppConfig WHERE Name = ''MailServer''
END
' 
END
GO


/* fixed some bugs in edit daylight saving rule */

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_add]    Script Date: 06/28/2011 14:55:37 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZoneRule_add]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_add]    Script Date: 06/28/2011 14:55:37 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[prcTimeZoneRule_add]
(
@WrittenName NVarChar(60), 
@OffsetDaylight Int, 
@year_start Int, 
@year_end  Int, 
@StartTimeOfDay Int, 
@day_start Int, 
@week_start Int, 
@StartMonth Int, 
@EndTimeOfDay Int, 
@EndDayOfWeek Int, 
@EndWeek Int, 
@EndMonth Int,
@Error bit output
)
AS
BEGIN

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?



    	-- the first_start_date and last_end_date may cover a period of decades so we now have to decide if the rule is applied at the datetime given		
		-- so calculate the exact start and end dates and times for the relevant daylight saving period (in the year being considered)
		
		
		-- start with a period (@Period_start datetime, @period_end datetime) that just has the correct year digits

		
		--if  (@startmonth > @endmonth) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
		
		IF(@startmonth > @endmonth)  set @year_end = @year_end + 1  -- rule spans december 31 so adjust






	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)
			SET @Period_start = DATEADD(minute, @StartTimeOfDay, @Period_start)			
			
			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)
			SET @Period_end = DATEADD(minute, @EndTimeOfDay, @Period_end)

	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE (first_start_date < @Period_end) AND (last_end_date > @Period_start)
	AND TimezoneID = @TimezoneID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		INSERT INTO tblTimeZoneDaylightSavingRules
			   ([TimezoneID]
			   ,[offset_mins]
			   ,[start_year]
			   ,[end_year]
			   ,[hours_start]
			   ,[day_start]
			   ,[week_start]
			   ,[month_start]
			   ,[hours_end]
			   ,[day_end]
			   ,[week_end]
			   ,[month_end]
			   ,[first_start_date]
			   ,[last_end_date]
		)
		 VALUES
			   (@TimezoneID,
				@OffsetDaylight,
				@year_start,
				@year_end,
				@StartTimeOfDay,
				@day_start,
				@week_start , 
				@StartMonth , 
				@EndTimeOfDay , 
				@EndDayOfWeek , 
				@EndWeek , 
				@EndMonth, 
				@Period_start,
				@Period_end
			   )
		SET @Error = 0
	END

	SELECT @Error
	
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/28/2011 14:55:54 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZoneRule_update]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZoneRule_update]    Script Date: 06/28/2011 14:55:54 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZoneRule_update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 18/06/2011
-- Description:	Updates the daylight saving rule for timeaone
-- =============================================
CREATE PROCEDURE [dbo].[prcTimeZoneRule_update] 
(
	@RuleID int,
	@WrittenName NVarChar(60),
	@OffsetDaylight Int, 
	@year_start Int, 
	@year_end  Int, 
	@StartTimeOfDay Int, 
	@day_start Int, 
	@week_start Int, 
	@StartMonth Int, 
	@EndTimeOfDay Int, 
	@EndDayOfWeek Int, 
	@EndWeek Int, 
	@EndMonth Int,
	@Error bit output
)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	DECLARE @TimezoneID int
	DECLARE @Period_start datetime, @Period_end datetime
	exec prcTimeZone_GetTimeZoneID @WrittenName, @TimezoneID out
	IF (@year_start < 1970) set @year_start = 1970  -- UNIX EPOCH
	IF (@year_end > 2999) set @year_end = 2999		-- Y3K BUG?

	-- Calculate the earlist start date and the last finish date
			set @Period_start = ''1 jan 2000'' -- start with a known datetime
			Set @Period_start = DATEADD(year,@year_start- 2000,@Period_start) -- then adjust it to match the definition
			Set @Period_start = DATEADD(month,@StartMonth-1,@Period_start)
			Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
			Declare @day_offset int
			if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
			Set @Period_start = DATEADD(day,@day_offset,@Period_start)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_start) > @StartMonth) set @Period_start = DATEADD(week,-1,@Period_start)
			SET @Period_start = DATEADD(minute, @StartTimeOfDay, @Period_start)			
			
			set @Period_end = ''1 jan 2000'' -- start with a known datetime
			Set @Period_end = DATEADD(year,@year_end- 2000,@Period_end) -- then adjust it to match the definition
			Set @Period_end = DATEADD(month,@EndMonth-1,@Period_end)
			Set @Period_end = DATEADD(week,@EndWeek-1,@Period_end)
			if (@EndDayOfWeek >=  DatePart(weekday,@Period_end) ) set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) else  set @day_offset = @EndDayOfWeek -  DatePart(weekday,@Period_end) + 7
			Set @Period_end = DATEADD(day,@day_offset,@Period_end)
			-- We may have jumped to the next month if week = 5 so step back a week if necessary
			if (DatePart(month,@Period_end) > @EndMonth) set @Period_end = DATEADD(week,-1,@Period_end)
			SET @Period_end = DATEADD(minute, @EndTimeOfDay, @Period_end)

	DECLARE @Existing int

	SELECT @Existing = COUNT(*) FROM tblTimeZoneDaylightSavingRules 
	WHERE (first_start_date < @Period_end) AND (last_end_date > @Period_start)
	AND TimezoneID = @TimezoneID AND TimezoneRuleID <> @RuleID
	
	IF (@Existing <> 0)
	BEGIN
		SET @Error = 1
	END
	ELSE
	BEGIN
		UPDATE tblTimeZoneDaylightSavingRules SET
			   offset_mins=@OffsetDaylight
			   , start_year=@year_start
			   , end_year=@year_end
			   , hours_start=@StartTimeOfDay
			   , day_start=@day_start
			   , week_start=@week_start
			   , month_start=@StartMonth
			   , hours_end=@EndTimeOfDay
			   , day_end=@EndDayOfWeek
			   , week_end=@EndWeek
			   , month_end=@EndMonth
			   , first_start_date=@Period_start
			   , last_end_date=@Period_end
			   WHERE TimezoneID=@TimezoneID AND TimezoneRuleID=@RuleID

		SET @Error = 0
	END
	
	SELECT @Error
END
' 
END
GO

/* fixed organisation details screen timezone bug */


/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetFLBNamefromTZID]    Script Date: 06/29/2011 14:51:01 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetFLBNamefromTZID]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcTimeZone_GetFLBNamefromTZID]
GO

/****** Object:  StoredProcedure [dbo].[prcTimeZone_GetFLBNamefromTZID]    Script Date: 06/29/2011 14:51:01 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcTimeZone_GetFLBNamefromTZID]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra
-- Create date: 29/06/2011
-- Description:	Gets the FLB Name of timezone from id
-- =============================================
CREATE PROCEDURE [dbo].[prcTimeZone_GetFLBNamefromTZID] 
	@TimezoneID int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SELECT FLB_Name FROM tblTimeZone WHERE TimeZoneID=@TimezoneID

END
' 
END
GO


/* fixed default value of datetime columns which can be null to UTC */

/*
   Wednesday, 29 June 20113:22:52 PM
   User: salt_user
   Server: bd-sql
   Database: Algy_Test
   Application: 
*/



IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF__tblBookma__DateC__3E3D3572]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblBookmark	DROP CONSTRAINT DF__tblBookma__DateC__3E3D3572
END
GO


IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF__tblBookma__DateC__3E3D3572]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblBookmark ADD CONSTRAINT	DF__tblBookma__DateC__3E3D3572 DEFAULT (GETUTCDATE()) FOR DateCreated
END
GO

ALTER TABLE dbo.tblBookmark SET (LOCK_ESCALATION = TABLE)
GO


/*
   Wednesday, 29 June 20113:23:29 PM
   User: salt_user
   Server: bd-sql
   Database: Algy_Test
   Application: 
*/




IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblCourseLicensingUser_LicenseDate]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblCourseLicensingUser	DROP CONSTRAINT DF_tblCourseLicensingUser_LicenseDate
END
GO


IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblCourseLicensingUser_LicenseDate]') AND type = 'D')
BEGIN
ALTER TABLE dbo.tblCourseLicensingUser ADD CONSTRAINT	DF_tblCourseLicensingUser_LicenseDate DEFAULT (GETUTCDATE()) FOR LicenseDate
END
GO

ALTER TABLE dbo.tblCourseLicensingUser SET (LOCK_ESCALATION = TABLE)
GO



/*
   Wednesday, 29 June 20113:24:04 PM
   User: salt_user
   Server: bd-sql
   Database: Algy_Test
   Application: 
*/


IF EXISTS (SELECT * FROM sys.default_constraints WHERE object_id = OBJECT_ID(N'[dbo].[DF_tblLangValueArchive_DateCreated]') AND parent_object_id = OBJECT_ID(N'[dbo].[tblLangValueArchive]'))
BEGIN
ALTER TABLE dbo.tblLangValueArchive	DROP CONSTRAINT DF_tblLangValueArchive_DateCreated
END
GO

IF Not EXISTS (SELECT * FROM sys.default_constraints WHERE object_id = OBJECT_ID(N'[dbo].[DF_tblLangValueArchive_DateCreated]') AND parent_object_id = OBJECT_ID(N'[dbo].[tblLangValueArchive]'))
BEGIN
ALTER TABLE dbo.tblLangValueArchive ADD CONSTRAINT
	DF_tblLangValueArchive_DateCreated DEFAULT (GETUTCDATE()) FOR DateCreated
END 
GO

ALTER TABLE dbo.tblLangValueArchive SET (LOCK_ESCALATION = TABLE)
GO


IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUser_DateUpdated]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[tblUser] DROP CONSTRAINT [DF_tblUser_DateUpdated]
END

GO

IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_tblUser_DateUpdated]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[tblUser] ADD  CONSTRAINT [DF_tblUser_DateUpdated]  DEFAULT (GETUTCDATE()) FOR [DateUpdated]
END

GO

/* fixed last user logon time bug and pending Delinquency coming as null */

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/30/2011 11:57:45 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/30/2011 11:57:45 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcUser_GetOne]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

Select
	UserID,
	FirstName,
	LastName,
	UserName,
	Password,
	Email,
	ExternalID,
	OrganisationID,
	UnitID,
	UserTypeID,
	Active,
	CreatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
	UpdatedBy,
	dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
	dbo.udfUserUTCtoDaylightSavingTime(LastLogin, @userID) as LastLogin,
	TimeZoneID,
	DelinquencyManagerEmail,
	NotifyOfPendingDelinquencies
From
	tblUser
Where
	UserID = @userID
' 
END
GO


/****** Object:  UserDefinedFunction [dbo].[udfUserUTCtoDaylightSavingTime]    Script Date: 06/30/2011 11:59:05 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfUserUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfUserUTCtoDaylightSavingTime]
GO

/****** Object:  UserDefinedFunction [dbo].[udfUserUTCtoDaylightSavingTime]    Script Date: 06/30/2011 11:59:05 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfUserUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 30/06/2011
-- Description:	changes time from utc to user local time while displaying
-- =============================================
CREATE FUNCTION [dbo].[udfUserUTCtoDaylightSavingTime] 
(
		@UTC DateTime,
		@UserID int
)
RETURNS DateTime
AS
BEGIN
	
	IF (@UTC is null) RETURN null
	DECLARE @UserLocalTime datetime
	DECLARE @UTC_Offset int
	DECLARE @Timezone datetime
	DECLARE @offset_mins int, @hours_start int, @day_start int, @week_start int, @month_start int, @hours_end int, @day_end int, @week_end int, @month_end int, @year_end int , @year_start int
	SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
	FROM tblTimeZone TZ 
	INNER JOIN tblUser Usr ON TZ.TimeZoneID = Usr.TimeZoneID 
	WHERE Usr.UserID = @UserID
	IF (@UTC_Offset IS NULL) 
	BEGIN
		Set @UserLocalTime = ''1 Jan 1900'' -- all results are displayed by Reporting Services so create an "error" that will be apparent in Reporting Services
	END
	ELSE
	BEGIN
		Set @UserLocalTime = DATEADD(minute,@UTC_Offset,@UTC )
		SELECT  @offset_mins = offset_mins, --get definition of the (at most) 1 definition that may cover the datetime
				@hours_start = hours_start, --overlapping definitions removed by GUI so only 1 result returned
				@day_start = day_start,
				@week_start = week_start,
				@month_start = month_start,
				@hours_end = hours_end,
				@day_end = day_end,
				@week_end = week_end,
				@month_end = month_end
		FROM tblTimeZoneDaylightSavingRules 
		WHERE  TimezoneID = @Timezone
		AND @UserLocalTime >= first_start_date
		AND @UserLocalTime <= last_end_date 
		
		-- start with a period (@Period_start datetime, @period_end datetime) that just has the correct year digits
        DECLARE @Period_start datetime, @period_end datetime        
        Set @year_start = year(@UserLocalTime) 
        set @year_end = year(@UserLocalTime)
            
        if (month(@UserLocalTime) <= @month_end) and (@month_start > @month_end) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
            
        IF(@month_start > @month_end) and (month(@UserLocalTime) >= @month_start) set @year_end = @year_start + 1  -- rule spans december 31 so adjust
            
 
		--Set @year_start = year(@UserLocalTime) --now calculate the exact start and end dates and times for the year under consideration
		--IF(@month_start > @month_end) set @year_end = @year_start+1 else set @year_end = @year_start
		--DECLARE @Period_start datetime, @period_end datetime
		
		set @Period_start = ''1 jan 2000'' -- start with a known datetime
		set @year_start = @year_start - 2000
		Set @Period_start = DATEADD(year,@year_start,@Period_start) -- then set the year correctly
		-- Then move to the correct month
		Set @Period_start = DATEADD(month,@month_start-1,@Period_start)
		-- Then move to the correct week (let week 5 slide to the next month for now)
		Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
		-- Now move FORWARD to the correct day (say) the 5th sunday of february
		Declare @day_offset int
		if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
		Set @Period_start = DATEADD(day,@day_offset,@Period_start)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_start) > @month_start) set @Period_start = DATEADD(week,-1,@Period_start)
		Set @Period_start = DATEADD(minute,@hours_start,@Period_start)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end

		set @Period_end = ''1 jan 2000'' -- start with a known datetime
		set @year_end = @year_end - 2000
		Set @Period_end = DATEADD(year,@year_end,@Period_end) -- then adjust it to match the definition
		Set @Period_end = DATEADD(month,@month_end-1,@Period_end)
		Set @Period_end = DATEADD(week,@week_end-1,@Period_end)
		if (@day_end >=  DatePart(weekday,@Period_end) ) set @day_offset = @day_end -  DatePart(weekday,@Period_end) else  set @day_offset = @day_end -  DatePart(weekday,@Period_end) + 7
		Set @Period_end = DATEADD(day,@day_offset,@Period_end)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_end) > @month_end) set @Period_end = DATEADD(week,-1,@Period_end)
		Set @Period_end = DATEADD(minute,@hours_end,@Period_end)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end
		Set @Period_end = DATEADD(minute,-@offset_mins,@Period_end) -- end time is quoted with daylight savings included
		
		
		IF (@UserLocalTime >= @Period_start) 
		AND (@UserLocalTime < @Period_end) set @UserLocalTime = DATEADD(minute,@offset_mins,@UserLocalTime)
	END
	RETURN @UserLocalTime
END
' 
END

GO


/****** Object:  StoredProcedure [dbo].[prcUser_LogLogin]    Script Date: 06/30/2011 11:59:48 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_LogLogin]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_LogLogin]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_LogLogin]    Script Date: 06/30/2011 11:59:48 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_LogLogin]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
	Logs the fact that a user has successfully logged in.
Returns:
	nothing
		
Called By: Login.ascx
Calls:

Remarks:
	
Author:
Peter Kneale
Date Created: 17 Jan 2005

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	14/09/2005		Change the UserName parameter to UserID, the user name is not unique after add domain name 


prcUser_LogLogin ''Jack''
**/

CREATE  PROC [dbo].[prcUser_LogLogin]
(
	@userID  int
)

AS

set nocount on

	Update
		tblUser 
	Set
		LastLogin = GETUTCDATE()
	where 
		userID=@userID
	
' 
END
GO



/* fixed course complete and quiz complete timestamp bugs and admin user log last login date */

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/30/2011 16:46:30 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetOne]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 06/30/2011 16:46:30 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetOne]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

CREATE Procedure [dbo].[prcUser_GetOne]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror(''The Parameter @userID was null.  @userID does not accept Null values.'', 16, 1)
	Return
End

DECLARE @UserTypeID int
SELECT @UserTypeID = UserTypeID FROM tblUser WHERE UserID = @userID

IF (@UserTypeID=2) -- organisation admin
BEGIN
	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUTCtoDaylightSavingTime(LastLogin, OrganisationID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies
	From
		tblUser
	Where
		UserID = @userID
END
ELSE
BEGIN
	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUserUTCtoDaylightSavingTime(LastLogin, @userID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies
	From
		tblUser
	Where
		UserID = @userID
END
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcLessonSession_EndLesson]    Script Date: 06/30/2011 16:49:56 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLessonSession_EndLesson]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcLessonSession_EndLesson]
GO

/****** Object:  StoredProcedure [dbo].[prcLessonSession_EndLesson]    Script Date: 06/30/2011 16:49:56 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcLessonSession_EndLesson]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



/*Summary:
	this proc records that a lesson has ended
	it also:
	-- Checks that the lesson has started -- if it has not - return false
	-- Checks that the lesson has not already ended -- if it has - return false
	
Returns:
	boolean (bit) OK true = 1, false = 0
		
Called By: 
	Businessservices.Toolbook.EndLessonSession
Calls:
	dbo.udfGetUserIDBySessionID
	dbo.udfGetLessonPageIDByToolbookPageID
	dbo.udfGetLessonIDBySessionID
Remarks:
	
Author:
Stephen Kennedy-Clark
Date Created: 5 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
#2 Removed unnecessary transactions

-----------
prcLessonSession_EndLesson @LessonSessionID = ''4986F67F-FF29-4979-9A97-D7846839E0DB''
select * from tblLessonSession

**/

CREATE      Procedure  [dbo].[prcLessonSession_EndLesson]
(
	@lessonSessionID	varchar(50),		-- the lesson session id
	@duration		int,			-- the duration
	@bookmark		varchar(50)  = null 	-- the bookmark
)

As
Set NoCount On
Set Xact_Abort On


------------------------------------------
-- Declerations
------------------------------------------
Declare @bitReturnCalue  bit, -- Return Code
	@intUserID 	 int, -- User ID
	@intLessonPageID int, -- Lesson Page ID 
	@intlessonID 	 int  -- Lesson ID (PK on lesson table)

------------------------------------------
-- initations
------------------------------------------
set @intUserID 	   	= dbo.udfGetUserIDBySessionID(@lessonSessionID)
set @intlessonID	= dbo.udfGetLessonIDBySessionID(@lessonSessionID)

------------------------------------------
-- Checks that the lesson has started - if it has not -> return false
-- and
-- Checks that the lesson has not already ended - if it has -> return false
-- If all is OK then end the lessson by recording lesson end time and duration
-- and delete the old bookmark
-- and then set the bookmark (if one was given)
------------------------------------------
If Exists
	( 
	Select
		LessonSessionID
	From
		tblLessonSession
	Where
		LessonSessionID=@LessonSessionID
			--< Check that the lesson has started >--
			And DateTimeStarted Is Not Null
			--< Check that the lesson has not already ended >--
			And DateTimeCompleted Is Null
	)


Begin --< it is ok to End, record End and return true >--
	Update
		[tblLessonSession]
	Set	
		[DateTimeCompleted]= GETUTCDATE(), 
		[Duration]         = @duration
	Where
		[LessonSessionID]  = @lessonSessionID
	------------------------------------------

	--< delete the existing bookmark for this user for this lesson >--	
	delete tblBookmark
	From
		tblBookmark tBM
		Inner Join tblLessonPage tLP
			On tLP.LessonPageID = tBM.LessonPageID
	Where
		tLP.LessonID = @intlessonID
			And tBM.UserID = @intUserID		
	------------------------------------------

	--< create a new bookmark for this user for this lesson >--
	if len(@bookmark) != 0 or @bookmark is not null
	begin
		set @intLessonPageID = dbo.udfGetLessonPageIDByToolbookPageID(@bookmark, @intlessonID)
		Insert Into
			tblBookmark
			(
				[LessonPageID]
				, [UserID]
				, [DateCreated]
			)
		Values
			(
				@intLessonPageID
				, @intUserID
				, GETUTCDATE()
			)
	end
	------------------------------------------
	set @bitReturnCalue = 1 --< return 1 indicates sucess >--


End
Else
Begin  -- it is NOT ok to End, return false
	set @bitReturnCalue = 0
End


------------------------------------------
-- return
------------------------------------------

Select @bitReturnCalue as ''OKToEnd''




' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_insert]    Script Date: 06/30/2011 16:58:56 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_insert]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUserCourseStatus_insert]
GO

/****** Object:  StoredProcedure [dbo].[prcUserCourseStatus_insert]    Script Date: 06/30/2011 16:58:56 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUserCourseStatus_insert]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'



/*Summary:
	Inserts a new line in the tblUserCourseStatus

Returns:
	null
		
Called By: 
	trgUserQuizStatus
Calls:

Remarks:
	


	
Author: Stepehn Clark
Date Created: 24 March 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


**/
CREATE    procedure [dbo].[prcUserCourseStatus_insert]
(
	  @UserID   int -- The User ID
	, @ModuleID int -- The Module ID
	, @StatusID int -- The Status ID Completed = 1 Incomplete = 0
)
As
------------------------

Declare @intCourse int
	, @strModuleIDs varchar(200)

set @intCourse = (select top 1 CourseID from tblModule where ModuleID = @ModuleID and Active = 1)
if @intCourse is null
begin
	Raiserror (''error in trigger prcUserCourseStatus_insert, course does not exist!'', 16, 1)
	return
end

-------------------------------------------------------
--- Get the ModulesID''s as a comma seperated string
-------------------------------------------------------
set @strModuleIDs = '''' -- string to hold moduelids
select
@strModuleIDs = cast(ModuleID as varchar) + '','' + @strModuleIDs
from
(
	Select
	tU.UserID
	, tU.FirstName
	, tU.LastName
	, tU.UnitID
	, tU.OrganisationID
	, tM.ModuleID
	, tM.CourseID
	, tC.Name ''CourseName''
	, tM.Name
	, tM.Sequence
	, tM.Description
	From
	dbo.tblUser tU
	--< get the courses a user has access to >--
	Inner Join dbo.tblOrganisationCourseAccess tOCA
	On  tOCA.OrganisationID = tU.OrganisationID
	--< get the course details >--
	Inner join dbo.tblCourse tC
	On tC.CourseID = tOCA.GrantedCourseID
	--< get the Active modules in a course >--
	inner join dbo.tblModule tM
	On tM.CourseID = tC.CourseID
	and tM.Active = 1
	--< get the details on which moduels a user is configured to access >--
	Left Outer join dbo.tblUserModuleAccess tUsrMA
	On  tUsrMA.UserID = tU.UserID
	And tUsrMA.ModuleID = tM.ModuleID
	--< get the details on which moduels a user''s Unit is excluded from  >--
	Left Outer Join dbo.tblUnitModuleAccess tUnitMA
	On  tUnitMA.UnitID = tU.UnitID
	And tUnitMA.DeniedModuleID = tM.ModuleID
	Where
	tC.CourseID = @intCourse AND tU.UserID = @UserID AND 
	tU.Active = 1
	--< Active users only >--
	and tu.UnitID is not null
	--< Get the modules that the user''s Unit is not denied >--
	and (tUnitMA.DeniedModuleID  is null
	--<  and the user does not have special access to  it>--
	And tUsrMA.ModuleID is null)
	--< or Get modules that the user has been specially  granted
	or tUsrMA.Granted=1
) as tempTable
where
CourseID = @intCourse
and  UserID = @UserID
-------------------------------------------------------
--- insert the new values
-------------------------------------------------------

INSERT INTO 
	tblUserCourseStatus
	(
	UserID, 
	CourseID, 
	CourseStatusID, 
	ModulesAssigned, 
	DateCreated
	)
VALUES
	(
	@UserID
	, @intCourse
	, @StatusID 
	, @strModuleIDs
	, GETUTCDATE()
	)




' 
END
GO



/****** Object:  StoredProcedure [dbo].[prcQuizSession_GetEndQuizInfo]    Script Date: 06/30/2011 16:59:53 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_GetEndQuizInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcQuizSession_GetEndQuizInfo]
GO

/****** Object:  StoredProcedure [dbo].[prcQuizSession_GetEndQuizInfo]    Script Date: 06/30/2011 16:59:53 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcQuizSession_GetEndQuizInfo]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*Summary:
read all information needed to end a quiz
 
Returns:
data table

Called By:
ToolBook.cs: GetEndQuizInfo

Remarks:

QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Author: Li Zhang
Date Created: 13-10-2006
Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate
**/

CREATE PROCEDURE [dbo].[prcQuizSession_GetEndQuizInfo]
(
	@quizSessionID varchar(50) -- unique that identifies this toolbook quiz session
	, @duration int -- time used to complete the quiz
	, @score int -- user quiz score
)
AS
	SET nocount on
BEGIN
	DECLARE @intUserID	int	-- user id
	,		@intQuizID	int -- quiz id
	,		@intPassMark	int	-- quiz pass mark
	,		@intUnitID	int	-- user''s unit id
	,		@intModuleID	int -- quiz module id
	,		@intCourseID	int -- module course id
	,		@intOldCourseStatus	int -- course status before update
	,		@intNewQuizStatus int -- the quiz status
	, 		@intNewCourseStatus	int	-- course status after update
	,		@intQuizFrequency int
	,		@dtmQuizCompletionDate datetime
	DECLARE	@tblUserEndQuizInfo table	-- return table with all details needed to end a quiz
			( 
				UserID	int
				, QuizID int
				, PassMark int
				, UnitID int
				, ModuleID int 
				, QuizFrequency int
				, QuizCompletionDate datetime
				, NewQuizStatus int
				, OldCourseStatus int
				, NewCourseStatus int
				, CourseID int
				
			)

	--< read required data >--
	
	SET @intUserID = dbo.udfGetUserIDBySessionID(@quizSessionID)
	SET @intQuizID = dbo.udfGetQuizIDBySessionID(@quizSessionID)
	SELECT @intUnitID = (SELECT TOP 1 UnitID FROM tblUser WHERE UserID = @intUserID)
	SELECT @intModuleID = (SELECT TOP 1 ModuleID FROM tblQuiz WHERE QuizID = @intQuizID)
	SET @intPassMark = dbo.udfQuiz_GetPassMark(@intUnitID, @intModuleID)
	IF @score < @intPassMark
	BEGIN
		--< Quiz status: failed >--
		SET @intNewQuizStatus = 3 
	END
	IF @score > @intPassMark OR @score = @intPassMark
	BEGIN
		--< Quiz status: passed >--
		SET @intNewQuizStatus = 2 
	END
	
	SELECT @intCourseID = (SELECT TOP 1 CourseID FROM tblModule WHERE ModuleID = @intModuleID)
	EXEC @intOldCourseStatus = prcUserCourseStatus_GetStatus @intCourseID, @intUserID
	EXEC @intNewCourseStatus = prcUserCourseStatus_Calc @intCourseID, @intUserID,  @intNewQuizStatus,@intModuleID 
	
	--< get pre-defined quiz frequency from tblUnitRule >--
	--< if the value is null then use the default quiz frequency in tblOrganisation >--
	
	-- mikev(1): added QuizCompletionDate
	SET @intQuizFrequency = (
								SELECT  TOP 1   ISNULL(ur.QuizFrequency, o.DefaultQuizFrequency)
								FROM   	tblUnitRule AS ur INNER JOIN tblUser AS u 
								ON ur.UnitID = u.UnitID 
								INNER JOIN tblOrganisation AS o ON u.OrganisationID = o.OrganisationID
								WHERE	u.UserID = @intUserID
							)
							
	SET @dtmQuizCompletionDate = (
								SELECT  TOP 1	ISNULL(ur.QuizCompletionDate, o.DefaultQuizCompletionDate)
								FROM   	tblUnitRule AS ur INNER JOIN tblUser AS u 
								ON ur.UnitID = u.UnitID 
								INNER JOIN tblOrganisation AS o ON u.OrganisationID = o.OrganisationID
								WHERE	u.UserID = @intUserID
							)

	INSERT INTO @tblUserEndQuizInfo ( UserID, QuizID, PassMark, UnitID, ModuleID, QuizFrequency, QuizCompletionDate, NewQuizStatus, OldCourseStatus, NewCourseStatus, CourseID)
	VALUES (@intUserID, @intQuizID, @intPassMark, @intUnitID, @intModuleID, @intQuizFrequency,@dtmQuizCompletionDate,@intNewQuizStatus, @intOldCourseStatus, @intNewCourseStatus, @intCourseID)
	 
	SELECT * FROM @tblUserEndQuizInfo
END

' 
END
GO


/* fixed scenario where user timezone is not defined */

/****** Object:  UserDefinedFunction [dbo].[udfUserUTCtoDaylightSavingTime]    Script Date: 06/30/2011 17:24:43 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfUserUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfUserUTCtoDaylightSavingTime]
GO

/****** Object:  UserDefinedFunction [dbo].[udfUserUTCtoDaylightSavingTime]    Script Date: 06/30/2011 17:24:43 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfUserUTCtoDaylightSavingTime]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 30/06/2011
-- Description:	changes time from utc to user local time while displaying
-- =============================================
CREATE FUNCTION [dbo].[udfUserUTCtoDaylightSavingTime] 
(
		@UTC DateTime,
		@UserID int
)
RETURNS DateTime
AS
BEGIN
	
	IF (@UTC is null) RETURN null
	DECLARE @UserLocalTime datetime
	DECLARE @UTC_Offset int
	DECLARE @Timezone datetime
	DECLARE @offset_mins int, @hours_start int, @day_start int, @week_start int, @month_start int, @hours_end int, @day_end int, @week_end int, @month_end int, @year_end int , @year_start int

	DECLARE @TimezoneID int
	SELECT @TimezoneID = TimeZoneID FROM tblUser WHERE UserID=@UserID
	
	IF (@TimezoneID is NULL)
	BEGIN
		SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
		FROM tblTimeZone TZ 
		INNER JOIN tblOrganisation Org ON TZ.TimeZoneID = Org.TimeZoneID 
		INNER JOIN tblUser Usr ON Usr.OrganisationID = Org.OrganisationID
		WHERE Usr.UserID = @UserID
	END
	ELSE
	BEGIN
		SELECT @UTC_Offset = TZ.OffsetUTC , @Timezone = TZ.TimezoneID
		FROM tblTimeZone TZ 
		INNER JOIN tblUser Usr ON TZ.TimeZoneID = Usr.TimeZoneID 
		WHERE Usr.UserID = @UserID
	END	
	
	IF (@UTC_Offset IS NULL) 
	BEGIN
		Set @UserLocalTime = ''1 Jan 1900'' -- all results are displayed by Reporting Services so create an "error" that will be apparent in Reporting Services
	END
	ELSE
	BEGIN
		Set @UserLocalTime = DATEADD(minute,@UTC_Offset,@UTC )
		SELECT  @offset_mins = offset_mins, --get definition of the (at most) 1 definition that may cover the datetime
				@hours_start = hours_start, --overlapping definitions removed by GUI so only 1 result returned
				@day_start = day_start,
				@week_start = week_start,
				@month_start = month_start,
				@hours_end = hours_end,
				@day_end = day_end,
				@week_end = week_end,
				@month_end = month_end
		FROM tblTimeZoneDaylightSavingRules 
		WHERE  TimezoneID = @Timezone
		AND @UserLocalTime >= first_start_date
		AND @UserLocalTime <= last_end_date 
		
		-- start with a period (@Period_start datetime, @period_end datetime) that just has the correct year digits
        DECLARE @Period_start datetime, @period_end datetime        
        Set @year_start = year(@UserLocalTime) 
        set @year_end = year(@UserLocalTime)
            
        if (month(@UserLocalTime) <= @month_end) and (@month_start > @month_end) set @year_start = @year_start - 1   -- rule spans december 31 so adjust
            
        IF(@month_start > @month_end) and (month(@UserLocalTime) >= @month_start) set @year_end = @year_start + 1  -- rule spans december 31 so adjust
            
 
		--Set @year_start = year(@UserLocalTime) --now calculate the exact start and end dates and times for the year under consideration
		--IF(@month_start > @month_end) set @year_end = @year_start+1 else set @year_end = @year_start
		--DECLARE @Period_start datetime, @period_end datetime
		
		set @Period_start = ''1 jan 2000'' -- start with a known datetime
		set @year_start = @year_start - 2000
		Set @Period_start = DATEADD(year,@year_start,@Period_start) -- then set the year correctly
		-- Then move to the correct month
		Set @Period_start = DATEADD(month,@month_start-1,@Period_start)
		-- Then move to the correct week (let week 5 slide to the next month for now)
		Set @Period_start = DATEADD(week,@week_start-1,@Period_start)
		-- Now move FORWARD to the correct day (say) the 5th sunday of february
		Declare @day_offset int
		if (@day_start >=  DatePart(weekday,@Period_start) ) set @day_offset = @day_start -  DatePart(weekday,@Period_start) else  set @day_offset = @day_start -  DatePart(weekday,@Period_start) + 7
		Set @Period_start = DATEADD(day,@day_offset,@Period_start)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_start) > @month_start) set @Period_start = DATEADD(week,-1,@Period_start)
		Set @Period_start = DATEADD(minute,@hours_start,@Period_start)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end

		set @Period_end = ''1 jan 2000'' -- start with a known datetime
		set @year_end = @year_end - 2000
		Set @Period_end = DATEADD(year,@year_end,@Period_end) -- then adjust it to match the definition
		Set @Period_end = DATEADD(month,@month_end-1,@Period_end)
		Set @Period_end = DATEADD(week,@week_end-1,@Period_end)
		if (@day_end >=  DatePart(weekday,@Period_end) ) set @day_offset = @day_end -  DatePart(weekday,@Period_end) else  set @day_offset = @day_end -  DatePart(weekday,@Period_end) + 7
		Set @Period_end = DATEADD(day,@day_offset,@Period_end)
		-- We may have jumped to the next month if week = 5 so step back a week if necessary
		if (DatePart(month,@Period_end) > @month_end) set @Period_end = DATEADD(week,-1,@Period_end)
		Set @Period_end = DATEADD(minute,@hours_end,@Period_end)  ---TODO check if offset applied OK for 1 hour either side of daylight saving start and end
		Set @Period_end = DATEADD(minute,-@offset_mins,@Period_end) -- end time is quoted with daylight savings included
		
		
		IF (@UserLocalTime >= @Period_start) 
		AND (@UserLocalTime < @Period_end) set @UserLocalTime = DATEADD(minute,@offset_mins,@UserLocalTime)
	END
	RETURN @UserLocalTime
END

' 
END

GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Create]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_Create]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Create]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Inserts a new user.

Parameters:
	@organisationID		(Mandatory)
	@unitID 			(Mandatory)
	@firstName 			(Mandatory)
	@lastName			(Mandatory)
	@userName			(Mandatory)
	@email				(Mandatory)
	@active			(Mandatory)
	@userTypeID			(Mandatory)
	@actionUserID			(Mandatory)
	@password			(Mandatory)

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	User.cs.

Calls:
	Nothing

Assumptions:
	The majority of business logic related to password
	lengths, confirmation passwords, valid emails etc. 
	are implemented through the UI.
	Assumption is that the parameters when passed in 
	contain valid data.

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	7. IntegrityConstraintException
	10. BusinessServiceException (General)		


Author: Peter Vranich
Date Created: 20th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	15/09/2005		User name is only unique per organisation

**/
CREATE  Procedure [prcUser_Create]
(
	@organisationID Integer = Null,
	@unitID Integer = Null,
	@firstName nvarchar(50) = Null,
	@lastName nvarchar(50) = Null,
	@userName nvarchar(100) = Null,
	@email nvarchar(100) = null,
	@active bit = null,	
	@userTypeID Integer = Null,
	@actionUserID Integer = Null,
	@password nvarchar(50) = Null,
	@externalID nvarchar(50) = Null,
	@TimeZoneID Integer = Null,
	@DelinquencyManagerEmail nvarchar(100) = Null,
	@NotifyOfPendingDelinquencies bit = Null


)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @UserID integer -- Holds the UserID once created
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	-- PARAMETER VALIDATION
	--==============================================================

	-- If user type is not SALT Administrator, check that a OrgID and UnitID has been supplied
	If(@userTypeID <>1)
	Begin
		If(@organisationID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure prcUser_Create''
			Goto Finalise
		End
		
		--Validate Parameter @unitID
		If(@unitID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = ''Missing or Null parameter @unitID in stored procedure prcUser_Create''
			Goto Finalise
		End
	End

	--Validate Parameter @firstName
	If(@firstName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @firstName in stored procedure prcUser_Create''
		Goto Finalise
	End

	--Validate Parameter @lastName
	If(@lastName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @lastName in stored procedure prcUser_Create''
		Goto Finalise
	End
	
	--Validate Parameter @userName
	If(@userName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userName in stored procedure prcUser_Create''
		Goto Finalise
	End
	
	--Validate Parameter @email
	If(@email Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @email in stored procedure prcUser_Create''
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcUser_Create''
		Goto Finalise
	End

	--Validate Parameter @userTypeID
	If(@userTypeID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userTypeID in stored procedure prcUser_Create''
		Goto Finalise
	End

	--Validate Parameter @createdByUserID
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @updatedByUserID in stored procedure prcUser_Create''
		Goto Finalise
	End
	
	-- If a unit was specified make sure it exists
	--=========================================================
	If (@unitID Is Not Null)
	Begin
		If Not Exists(Select * From tblUnit Where UnitID = @unitID)
		Begin
			Set @intErrorNumber = 1
			Set @strErrorMessage = ''The specified unit could be found or may not be active.''
			Goto Finalise
		End
	End
	
	If(@userTypeID <>1)
	begin	
		-- User name is unique per organisation
		If Exists(Select * From tblUser Where Username = @userName and (organisationID=@organisationID or organisationID is null))
		Begin
			Set @intErrorNumber = 4
			Set @strErrorMessage = @userName
			Goto Finalise
		End
	end
	else
	begin	
		If Exists(Select * From tblUser Where Username = @userName)
		Begin
			Set @intErrorNumber = 4
			Set @strErrorMessage = @userName
			Goto Finalise
		End
	end
	

	If Exists(Select * From tblUser Where Email = @email)
	Begin
		Set @intErrorNumber = 41
		Set @strErrorMessage = ''The email address '' + @email + '' already exists.  <BR>Please choose another email address.''
		Goto Finalise
	End
	
	Insert Into tblUser
	(
		OrganisationID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		DateCreated,
		ExternalID,
		NewStarter,
		TimeZoneID,DelinquencyManagerEmail,NotifyOfPendingDelinquencies 

	)
	Values
	(
		@organisationID,
		@firstName,
		@lastName,
		@userName,
		@password,
		@email,
		@unitID,
		@userTypeID,
		@active,
		@actionUserID,
		GETUTCDATE(),
		@externalID, -- http://bugs.salt.devbdw.com/edit_bug.aspx?id=274
		1,
		@TimeZoneID, @DelinquencyManagerEmail, @NotifyOfPendingDelinquencies

	)
	
	update tblUser set DateArchived = getutcdate() where Active = 0 and DateArchived IS NULL AND UserID = @@Identity
	update tblUser set DateArchived = null where Active = 1 and NOT(DateArchived IS NULL) AND UserID = @@Identity
	
	-- Set the error message to successfull
	Set @strErrorMessage = @@Identity
	Set @UserID = @@Identity


	-- Get ProfilePeriodID''s for Organisation
	create table #ProfilePeriod
	(
		ProfilePeriodID int
	)
	
	insert into #ProfilePeriod
		select ProfilePeriodID 
		from tblProfilePeriod  pp 
		join tblprofile p 
		on pp.profileid = p.profileid 
		where p.organisationid = @OrganisationID
	
	
	-- insert user into profileperiodaccess against all profileperiodid''s
	-- for the organisation
	insert into tblUserProfilePeriodAccess
	select 
		pp.ProfilePeriodID, 
		@UserID,
		uppa.granted
	from #ProfilePeriod pp
	join tblUnitProfilePeriodAccess uppa 
	on uppa.ProfilePeriodID = pp.ProfilePeriodID
	where uppa.UnitID = @UnitID

	drop table #ProfilePeriod

	-- Get Policies for Organisation
	create table #Policy
	(
		PolicyID int,
		Granted bit
	)
	
	insert into #Policy
		select p.PolicyID, 
		case when (select distinct granted from tblUnitPolicyAccess where unitID = @unitID and policyid = p.policyid) is null then 0 
		else (select distinct granted from tblUnitPolicyAccess where unitID = @unitID and policyid = p.policyid) end
		from tblPolicy p where
		OrganisationID = @OrganisationID
		and deleted = 0


	-- insert user into policy for all policy''s associated with organisation
	insert into tblUserPolicyAccepted (PolicyID, UserID, Accepted)
	select PolicyID, @UserID, 0 from #Policy
	
	-- insert user into policyaccess for all policies
	insert into tblUserPolicyAccess (PolicyID, UserID, Granted)
	select PolicyID, @UserID, Granted  from #Policy

	drop table #Policy

	-- Finalise the procedure
	Goto Finalise


Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





/****** Object:  UserDefinedFunction [dbo].[udfGetUnitPathway]    Script Date: 06/30/2011 22:38:17 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/****** Object:  User Defined Function dbo.udfGetUnitPathway    Script Date: 20/04/2004 8:25:57 AM ******/

/*
Summary:
user Defined Function that returns pathway of a specified unit
Returns:
">" delimited pathway of a unit
e.g. "Unit 1 > Unit 2 > Unit 5 > Unit 7"

Called By:

Calls:

Remarks:


Author: Jack Liu
Date Created: 6 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1


select  dbo.udfGetUnitPathway(9)

select dbo.udfGetUnitPathway(UnitID)
from tblUnit

**/
ALTER  FUNCTION [dbo].[udfGetUnitPathway]
(
@UnitID int
)
RETURNS nvarchar(4000)
Begin

declare @strPathway nvarchar(4000)
declare @strHierarchy nvarchar(500)

select @strHierarchy=','+hierarchy+','
from tblUnit
where UnitID = @UnitID

--Convert unit ID hierarchy ''1,2,5,7'' to pathway ''Unit 1 > Unit 2 > Unit 5 > Unit 7''

select @strPathway=IsNull(@strPathway+' > ','')+Name
from tblUnit
where charindex(','+cast(UnitID as varchar)+',', @strHierarchy)>0
order by [Level]

--select @strPathway

RETURN @strPathway
End

GO


SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/****** Object:  User Defined Function dbo.udfGetUnitPathway    Script Date: 20/04/2004 8:25:57 AM ******/

/*
Summary:
user Defined Function that returns pathway of a specified unit
Returns:
">" delimited pathway of a unit
e.g. "Unit 1 > Unit 2 > Unit 5 > Unit 7"

Called By:

Calls:

Remarks:


Author: Jack Liu
Date Created: 6 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1


select  dbo.udfGetUnitIDPathway(9)

select dbo.udfGetUnitIDPathway(UnitID)
from tblUnit

**/
ALTER  FUNCTION [dbo].[udfGetUnitIDPathway]
(
@UnitID int
)
RETURNS nvarchar(4000)
Begin

declare @strPathway nvarchar(4000)
declare @strHierarchy nvarchar(500)

select @strHierarchy=','+hierarchy+','
from tblUnit
where UnitID = @UnitID

--Convert unit ID hierarchy '1,2,5,7' to pathway 'Unit 1 > Unit 2 > Unit 5 > Unit 7'

select @strPathway=IsNull(@strPathway+' > ','')+cast(UnitID as varchar)
from tblUnit
where charindex(','+cast(UnitID as varchar)+',', @strHierarchy)>0
order by [Level]

--select @strPathway

RETURN @strPathway
End

GO


/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 07/01/2011 00:41:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

ALTER Procedure [dbo].[prcUser_GetOne]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror('The Parameter @userID was null.  @userID does not accept Null values.', 16, 1)
	Return
End

	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUTCtoDaylightSavingTime(LastLogin, OrganisationID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies
	From
		tblUser
	Where
		UserID = @userID
		
GO



/****** Object:  StoredProcedure [dbo].[prcUser_GetOneWithOwnTime]    Script Date: 07/01/2011 00:41:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

Create Procedure [dbo].[prcUser_GetOneWithOwnTime]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror('The Parameter @userID was null.  @userID does not accept Null values.', 16, 1)
	Return
End

	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUserUTCtoDaylightSavingTime(LastLogin, @userID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies
	From
		tblUser
	Where
		UserID = @userID

		
GO







IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_New StartersToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_New StartersToNotify]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_New StartersToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [prcAutomatedEmails_New StartersToNotify] 
(
	@OrganisationID int
)


AS

BEGIN

-- New Starter
SELECT userid,email,(SELECT dbo.udfUser_GetAdministratorsEmailAddress (U.UserID)) as SenderEmail, (SELECT Value + '' login details '' FROM tblAppConfig where Name = ''AppName''), REPLACE
(
 (SELECT REPLACE
   (
	(SELECT REPLACE
	  (
	   (select 
		 REPLACE( 
		  (SELECT coalesce
			( 
			  (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_NewStarter'')
			  ,
			  (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_NewStarter'')
			)
		  )
		  ,''%APP_NAME%'',
		  (SELECT Value FROM tblAppConfig where Name = ''AppName'')
		 )
		)
		 ,''%PASSWORD%'',U.PASSWORD
	  )
	)
    ,''%USERNAME%'',U.USERNAME 
   )
  )
  ,''%URL%'',(select(''<a href="'')+(SELECT CASE WHEN ''true'' = [Value] THEN ''HTTPS://'' ELSE ''http://'' END FROM tblAppConfig where Name = ''SSL'' )+(SELECT DOMAINNAME + ''/Restricted/Login.aspx'' FROM tblOrganisation ORG WHERE ORG.OrganisationID =  @OrganisationID )+(''">'')+(SELECT Value FROM tblAppConfig where Name = ''AppName'')+(''</a>''))
 )

 from tblUser U where  U.OrganisationID = @OrganisationID and U.active = 1 and U.NewStarter = 1 
 
 update tblUser set NewStarter = 0  where  OrganisationID = @OrganisationID and active = 1 and NewStarter = 1 


END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcProfile_Get]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcProfile_Get]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcProfile_Get]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
Gets a profile

Parameters:
	@ProfileID int,

Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

CREATE procedure [prcProfile_Get]
(
	@ProfileID int,
	@profileperiodID int,
	@OrgID int
)
as

select
	pro.profilename,
	dbo.udfUTCtoDaylightSavingTime(propd.datestart, @OrgID) as DateStart,
	dbo.udfUTCtoDaylightSavingTime(propd.dateend, @OrgID) as DateEnd,
	propd.points,
	propd.endofperiodaction,
	propd.monthincrement,
	dbo.udfUTCtoDaylightSavingTime(propd.futuredatestart, @OrgID) as FutureDateStart,
	dbo.udfUTCtoDaylightSavingTime(propd.futuredateend, @OrgID) as FutureDateEnd,
	propd.futurepoints,
	propd.ApplyToQuiz,
	propd.ApplyToLesson
from 
	tblProfile pro
	left join tblProfilePeriod propd on pro.profileid = propd.profileid
where 
	pro.profileid = @ProfileID
	and (@profileperiodID = -1 or propd.profileperiodid = @profileperiodid)
	and (profileperiodactive =  1   or ((dbo.udfUTCtoDaylightSavingTime(propd.datestart, @OrgID)) > (dbo.udfUTCtoDaylightSavingTime(GETUTCDATE(), @OrgID))))
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_Create]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_Create]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_Create]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Add a unit.
Returns:
	Nothing.
		
Called By: 
	Unit Class.

Calls:
	Nothing
Remarks:
		--Create a unit
		--Propagate all unit admininstrators from parent (with propagate flag)

	Validation:
	Exception:
	0: Succeed
	1.RecordNotFound
	2.FK constraint
	3.PKViolationException
	4.UniqueViolationException
	10.BusinessServiceException (General)		


Author: Jack Liu
Date Created: 11 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE PROCEDURE [prcUnit_Create]
(
	@organisationID	int,
	@parentUnitID	int,
	@name 	nvarchar(100),
	@active	bit,
	@createdByUserID int
)

AS

set nocount on

set xact_abort on
Begin Tran
	--Validation
	declare @strErrorMessage varchar(500)

	declare @blnParentStatus bit
	declare @strParentHierarchy varchar(500)
	declare @intParentLevel int
	
	declare @intUnitID int
	
	set @strErrorMessage=''''

	if (@parentUnitID<=0)
		set @parentUnitID=null

	--Create sub-unit
	if (@parentUnitID>0)
	begin
		select @blnParentStatus = active,
			@strParentHierarchy=  Hierarchy,
			@intParentLevel = [level]	
		from tblUnit
		where UnitID = @parentUnitID

		--If parent unit is inactive, the new unit must be inactive
		if (@blnParentStatus=0 and @active=1)
		Begin
			if exists(select UnitID from tblUnit where unitID=@parentUnitID  and active=0)
			BEGIN	
				set @strErrorMessage = ''You cannot create an active unit whose parent unit is inactive.''
			end	
		end
	end
	--Create top level unit
	else
	begin
		set @strParentHierarchy= null
		set @intParentLevel = 0	

	end

	if (@strErrorMessage='''')
	begin
		--1. Create a unit
		Insert into tblUnit(OrganisationID, ParentUnitID, Name, [Level], active,  createdBy, dateCreated, DateUpdated)
			values	(@organisationID, @parentUnitID, @name, @intParentLevel+1,@active, @createdByUserID, getutcdate(), getutcdate())
		
		set @intUnitID=@@identity
		update tblUnit 
		set Hierarchy = IsNull(@strParentHierarchy + '','','''') + cast(@intUnitID as varchar)
		where UnitID=@intUnitID
		--2. Propagate all unit admininstrators from parent (with propagate flag)
		insert into tblUnitAdministrator(UnitID, UserID, Propagate, createdBy, DateCreated)
		select @intUnitID, UserID, 1 , @createdByUserID, getutcdate()
		from tblUnitAdministrator 
		where unitID = @parentUnitID
			and Propagate=1

		select 0 as Error, cast(@intUnitID as varchar) as ErrorMessage
	end
	else
	begin
		select 10 as Error,  @strErrorMessage as ErrorMessage
	end

commit TRAN	

	-- Get ProfilePeriodID''s for Organisation
	create table #ProfilePeriod
	(
		ProfilePeriodID int
	)
	
	insert into #ProfilePeriod
		select ProfilePeriodID 
		from tblProfilePeriod  pp 
		join tblprofile p 
		on pp.profileid = p.profileid 
		where p.organisationid = @OrganisationID

	-- insert unit into profileperiodaccess against all profileperiodid''s
	-- for the organisation
	insert into tblUnitProfilePeriodAccess
	select ProfilePeriodID, @intUnitID, 0 from #ProfilePeriod

	drop table #ProfilePeriod

-- is a child unit	
	if (@parentUnitID <> 0) 
	begin
--	 get list of profile periods the parent unit has access to
	create table #ProfilePeriodTemp
	(
		ProfilePeriodID int
	)

	insert into #ProfilePeriodTemp
	select ProfilePeriodID from tblUnitProfilePeriodAccess 
		where UnitID = @parentUnitID
		and Granted = 1

--	 set profile period access for these units
	update tblUnitProfilePeriodAccess set granted = 1 
		where UnitID = @intUnitID
		and ProfilePeriodID in (select ProfilePeriodID from #ProfilePeriodTemp)

	drop table #ProfilePeriodTemp
	end
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_Create]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcModule_Create]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_Create]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Creates a new Module.

Parameters:
	@courseID
	@name
	@description
	@active
	@userID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Module.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	10. BusinessServiceException (General)


Author: Gavin Buddis
Date Created: 18th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [prcModule_Create]
(
	@courseID Integer = Null,
	@name nVarchar(100) = Null,
	@description nVarchar(1000) = Null,
	@active Bit = 1,
	@userID Integer = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0
	
	--Validate Parameter @courseID
	If(@courseID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @courseID in stored procedure prcModule_Create''
		Goto Finalise
	End

	--Validate Parameter @name
	If(@name Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @name in stored procedure prcModule_Create''
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcModule_Create''
		Goto Finalise
	End

	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcModule_Create''
		Goto Finalise
	End
	
	--Check that there are no other modules of this name within this course
	If Exists(Select CourseID from tblModule Where CourseID=@courseID and [Name]=@name)
	Begin
		Set @intErrorNumber = 4
		Set @strErrorMessage = ''There is already a module of that name within this course''
		Goto Finalise
	End
	
	
	-- Insert the new record
	Insert Into tblModule
	(
		CourseID,
		[Name],
		[Description],
		Active,
		CreatedBy,
		DateCreated,
		UpdatedBy,
		DateUpdated
	)
	Values
	(
		@courseID,
		@name,
		@description,
		@active,
		@userID,
		GetUTCDate(),
		@userID,
		GetUTCDate()
	)
		
	-- Set the error message to successfull
	Set @intErrorNumber = 0
	Set @strErrorMessage = @@identity

	-- Finalise the procedure
	Goto Finalise
	
	

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_Create]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCourse_Create]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_Create]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Created a new Course.

Parameters:
	@intCourseID
	@name
	@notes
	@active
	@userID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Course.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeeded
	4. UniqueViolationException
	5. ParameterException
	10. BusinessServiceException (General)


Author: Gavin Buddis
Date Created: 17th February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE   Procedure [prcCourse_Create]
(
	@intCourseID Integer OutPut, -- The ID of the newly created course.
	@name nVarchar(100) = Null,
	@notes nVarchar(1000) = Null,
	@active Bit = 1,
	@userID Integer = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	--Validate Parameter @name
	If(@name Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @name in stored procedure prcCourse_Create''
		Goto Finalise
	End

	--Validate Parameter @showDisclaimer
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcCourse_Create''
		Goto Finalise
	End

	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcCourse_Create''
		Goto Finalise
	End
	
	If Not Exists(Select * From tblCourse Where Name = @name)
	Begin
		-- Insert the new record
		Insert Into tblCourse
		(
			[Name],
			Notes,
			Active,
			CreatedBy,
			DateCreated,
			UpdatedBy,
			DateUpdated
		)
		Values
		(
			@name,
			@notes,
			@active,
			@userID,
			GetUTCDate(),
			@userID,
			GetUTCDate()
		)
		
		-- Set the error message to successfull
		Set @intErrorNumber = 0
		Select @intCourseID = @@Identity
	
		-- Finalise the procedure
		Goto Finalise
	End
	Else
	Begin
		Set @intErrorNumber = 4
		Set @strErrorMessage = ''The Course Name '' + @name + '' already exists please choose another Course Name.''
		
		Goto Finalise
	End

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_Move]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_Move]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_Move]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Move a  unit to a new parent
Returns:
	Nothing.
		
Called By: 
	Unit Class.

Calls:
	Nothing
Remarks:
	1. Permission Checking:		
		1.1. "From" unit permision: Administrator of this unit and all sub-units
		1.2. "To" unit permision: "Propagate" administrator of this unit

	2. Validation:
		2.1. "From" unit is not the same as "To" unit
		2.2. "From" and "To" unit are in the same organisation
		2.3. "From" unit is not the parent of "To" unit
		2.4  "To" unit is the direct parent of "From" unit


	Moving permissions:
		When a Unit is moved into to another Unit, all of its current administrators will be removed, 
		and it will inherit its new administrators from its new place in the hierarchy, 
		according to the "Administer Sub-units" rights of the existing administrators.

	

	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	10.BusinessServiceException (General)		


Author: Jack Liu
Date Created: 11 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE PROCEDURE [prcUnit_Move]
(
	@fromUnitID	int,
	@toUnitID	int,
	@adminUserID 	int
)

AS

set nocount on

set xact_abort on
Begin Tran
	declare @strErrorMessage varchar(500)
	declare @intErrorNumber int

	declare @intUserTypeID int

	declare @intFromOrganisationID int, @intToOrganisationID int
	declare @strFromHierarchy nvarchar(500),@strToHierarchy nvarchar(500)
	declare @intFromParentUnitID int

	select @intUserTypeID = UserTypeID  
	from tblUser
	where userID = @adminUserID

	select @intFromOrganisationID = OrganisationID,
		@strFromHierarchy = Hierarchy,
		@intFromParentUnitID = parentUnitID
	from tblUnit 
	where unitID=@fromUnitID
	
	select @intToOrganisationID = OrganisationID,
		@strToHierarchy = Hierarchy
	from tblUnit 
	where unitID=@toUnitID


	set @strErrorMessage=''''

	-------------- 1. Permission Checking ----------------
	
	--Salt Administrator (1), Organisation Administrator (2): full permission to access all units
	--Salt User (4): No permission
	if (@intUserTypeID=4)
	begin
		set @strErrorMessage = ''You are not the administrator of the system''
		set @intErrorNumber = 1
	end
	--Unit Administrator (3): limited permission
	else if (@intUserTypeID=3)
	begin
		--	1.1. "From" unit permision: Administrator of this unit and all sub-units
		if 	exists(select su.unitid
				from tblUnit su --sub-units
					left join tblUnitAdministrator ua 
						on su.unitID=ua.unitID
						 	and ua.userID = @adminUserID
				where su.hierarchy+'','' like @strFromHierarchy+'',%'' --"From" Unit and all its sub-units
					and ua.unitID is null)	--Not administrator
		begin
			set @strErrorMessage = ''You are not administrator of the "From" unit and all its sub-units''	
			set @intErrorNumber = 11
		end
		--	1.2. "To" unit permision: "Propagate" administrator of this unit
		else 	if not exists(select unitid from tblUnitAdministrator where unitID=@toUnitID and userID = @adminUserID and propagate=1)
		begin
			set @strErrorMessage = ''You don''''t have permission to administer sub-units of the "To" unit''	
			set @intErrorNumber = 12
		end
	end

	-----------------2. Validation -----------------------------
	if (@strErrorMessage='''')
	begin
		--	2.1. "From" unit is not the same as "To" unit
		if (@fromUnitID=@toUnitID)
		begin
			set @strErrorMessage = ''The "From" unit can''''t be the same as the "To" unit''
			set @intErrorNumber = 13
		end
		--	2.2. "From" and "To" unit are in the same organisation
		else if (@intFromOrganisationID<>@intToOrganisationID)
		begin
			set @strErrorMessage = ''The "From" and the "To" unit should be in the same organisation''
			set @intErrorNumber = 14
		end
		--	2.3. "From" unit is not the parent of "To" unit
		else if (charindex( @strFromHierarchy+'','', @strToHierarchy)=1)
		begin
			set @strErrorMessage = ''The "From" unit can''''t be the parent of the "To" unit''
			set @intErrorNumber = 15
		end
		--	2.4  "To" unit is the direct parent of "From" unit
		else if (@intFromParentUnitID=@toUnitID)
		begin
			set @strErrorMessage = ''The "To" unit can''''t be the direct parent of the "From" unit''
			set @intErrorNumber = 16
		end
	end

	if (@strErrorMessage='''')
	begin
		--1. Update hierarchy and rebuild the unit tree
		Update tblUnit
		set parentUnitID=@toUnitID,
		    UpdatedBy = @adminUserID,	
		     DateUpdated = getutcdate()	
		where unitID=@fromUnitID
		
		exec prcOrganisation_CheckUnitTree @intToOrganisationID

		--2. Moving permissions
		--2.1 Get the new hierarchy
		select 	@strFromHierarchy = Hierarchy
		from tblUnit 
		where unitID=@fromUnitID
		--2.2 Remove all current administrators from the unit and  its sub-units
		Delete 
		from tblUnitAdministrator
		where unitID in (select unitID 
				from tblUnit
				where hierarchy+'','' like @strFromHierarchy+'',%'') --Current Unit and its sub-units	
				

		--2.3 Propagate all unit admininstrators from parent (with propagate flag)
		insert into tblUnitAdministrator(UnitID, UserID, Propagate, createdBy)
		select 	u.UnitID, ua.UserID, 1 , @adminUserID 	
		from 	tblUnitAdministrator ua
			cross join  tblUnit u
		where 	ua.unitID = @toUnitID
			and ua.Propagate=1
			and u.hierarchy+'','' like @strFromHierarchy+'',%''		
		
		--2.4 Check and Update user role
		exec prcOrganisation_CheckUserRole @intToOrganisationID

		select 0 as Error, '''' as ErrorMessage
	end
	else
	begin
		select @intErrorNumber as Error,  @strErrorMessage as ErrorMessage
	end

commit TRAN
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCourse_Update]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCourse_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Updates a Course.

Parameters:
	@courseID
	@name
	@notes
	@active
	@userID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Course.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	4. UniqueViolationException
	5. MissingParameterException
	10. BusinessServiceException (General)		


Author: Gavin Buddis
Date Created: 16 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE  Procedure [prcCourse_Update]
(
	@courseID Integer = Null,
	@name nVarchar(100) = Null,
	@notes nVarchar(1000) = Null,
	@active Bit = 1,
	@userID Integer = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	--Validate Parameter @courseID
	If(@courseID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @courseID in stored procedure prcCourse_Update''
		Goto Finalise
	End
	
	-- Validate that the Caption for this link doesn''t exist.
	If Exists(Select * From tblCourse Where [Name] = @name And courseID != @courseID)
	Begin
		Set @intErrorNumber = 4
		Set @strErrorMessage = ''The Name '' + @name + '' already exists please choose another Name.''
		Goto Finalise
	End
	
	--Validate Parameter @name
	If(@name Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @name in stored procedure prcCourse_Update''
		Goto Finalise
	End

	--Validate Parameter @notes
	If(@notes Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @notes in stored procedure prcCourse_Update''
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcCourse_Update''
		Goto Finalise
	End

	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcCourse_Update''
		Goto Finalise
	End
	
	If Exists(Select * From tblCourse Where CourseID = @courseID)
	Begin
		-- Update the record in tblCourse
		Update tblCourse
		Set 
			[Name] = @name,
			Notes = @notes,
			Active = @active,
			UpdatedBy = @userID,
			DateUpdated = GetUTCDate()
		Where
			CourseID = @courseID
		
		-- Set the error message to successfull
		Set @strErrorMessage = ''Successfully Updated''
	
		-- Finalise the procedure
		Goto Finalise
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		
		Goto Finalise
	End

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPD_CurrentPoints]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCPD_CurrentPoints]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPD_CurrentPoints]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE procedure [prcCPD_CurrentPoints]
(
	@ProfileID  varchar(20),
	@ModuleID	varchar(20),
	@UserID		varchar(20)
)
as 

select
	sum(upt.Points) as Points
from 
	tblProfilePeriod pp
	join tblProfilePoints pt 
		on pt.profileperiodid =pp.profileperiodid
	join tbluserCPDPoints upt 
		on upt.profilepointsID = pt.profilepointsid
where 
	pt.profilepointstype =''M'' 
	and pt.typeid = @ModuleID
	and pp.profileid =@ProfileID 
	and upt.userid =@UserID
	and getutcdate() between pp.DateStart and dateadd(d,1,pp.dateend)
group by 
	convert(varchar (11),pp.DateStart,113) + '' - '' + convert( varchar(11),pp.DateEnd,113)

SET QUOTED_IDENTIFIER ON
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDEmail_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCPDEmail_Report]
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDEmail_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE procedure [prcCPDEmail_Report] 
	(
	@ProfileID  int,
	@UnitIDs varchar(MAX)
	)
as
	select  distinct pf.profileid
		, u.userid
		, u.lastname
		, u.firstname
		,hierarchyname = dbo.udfGetUnitPathway(u.UnitID)
		,u.email as useremail
	from tblProfile pf
		join tblprofileperiod pp on pp.profileid = pf.profileid
		join tbluserprofileperiodaccess upa on upa.profileperiodid = pp.profileperiodid 
			and granted = 1
		join tbluser  u on u.userid = upa.userid
		left join tblusercpdpoints upt on upt.userid = u.userid
	where pf.profileid = @ProfileID and 
		pp.profileperiodactive = 1 and
		getutcdate() between pp.datestart and dateadd(d,1,pp.dateend) and 
		pp.points > coalesce(upt.points,0) and 
		u.unitid in (select IntValue from dbo.udfCsvToInt(@UnitIDs)) and
		u.userid in
		(-- users for a course
			select distinct uma.userid from
			tblProfile p
			join tblProfilePeriod pp 
			on p.profileid = pp.profileid
			join tblProfilePoints ppts
			on pp.profileperiodid = ppts.profileperiodid
			join tblModule m on ppts.typeid = m.moduleid
			join vwUserModuleAccess uma on uma.courseid = m.courseid and u.userid=uma.userid
			where p.profileid = @profileid
			and pp.profileperiodactive = 1
			and ppts.profilepointstype = ''M'')
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDProfileHistory_Report]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcCPDProfileHistory_Report]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcCPDProfileHistory_Report]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE procedure [prcCPDProfileHistory_Report]
(
	@ProfileID  varchar(20),	
	@UserID		varchar(20)
)
as 

select
	convert(varchar (11),pp.DateStart,113) + '' - '' + convert( varchar(11),pp.DateEnd,113) as PeriodDesc, 
	sum(upt.Points) as PointsEarned,
	pp.points as PointsRequired
from 
	tblProfilePeriod pp
	join tblProfilePoints pt 
		on pt.profileperiodid =pp.profileperiodid
	join tbluserCPDPoints upt 
		on upt.profilepointsID = pt.profilepointsid
where 
	pt.profilepointstype =''M'' 
	and pp.profileid =@ProfileID 
	and upt.userid =@UserID
	--and getutcdate() between pp.DateStart and pp.dateend
group by 
	convert(varchar (11),pp.DateStart,113) + '' - '' + convert( varchar(11),pp.DateEnd,113),pp.points


SET QUOTED_IDENTIFIER ON
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_LogSentEmail]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcEmail_LogSentEmail]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcEmail_LogSentEmail]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Procedure [prcEmail_LogSentEmail] 
	@toEmail	nvarchar(1000),
	@toName	nvarchar(128), 
	@fromEmail	nvarchar(128), 
	@fromName	nvarchar(128), 
	@CC		nvarchar(1000) = '''',
	@BCC 		nvarchar(1000) = '''',
	@subject	nvarchar (256),
	@body		ntext,
	@organisationID	int
As

Insert Into
	tblEmail
		(
		ToEmail, 
		ToName, 
		FromEmail, 
		FromName, 
		CC,
		BCC, 
		Subject, 
		Body, 
		DateCreated,
		OrganisationID
		)

	Values	
		(
		@toEmail, 
		@toName, 
		@fromEmail,
		@fromName, 
		@CC, 
		@BCC, 
		@subject, 
		@body, 
		GetUTCDate(),
		@organisationID
		)
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcErrorLog_Create]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcErrorLog_Create]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcErrorLog_Create]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Creates a new entry in the error log.
Returns:
	Nothing.
		
Called By: 
	ErrorLog Class.

Calls:
	Nothing
Remarks:
	This procedure creates an entry in the error log when an error is raised.
	The Date Created field will be stamped with the current date and time.

Author:
Peter Kneale
Date Created: 9 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


prcErrorLog_Create ''Source'', ''Module'', ''Function'', ''Code'', ''Message'', ''StackTrace'', 1
**/

CREATE Procedure [prcErrorLog_Create]

	@strSource varchar(1000) ,		-- Source of Error
	@strModule varchar(100), 		-- Module Error occured in
	@strFunction varchar(100), 		-- Function Error occured in
	@strCode varchar(100), 			-- Code executing when error occurred
	@strMessage varchar(500), 		-- Message from exception
	@strStackTrace varchar(8000), 		-- Complete stack trace from exception
	@intErrorLevel int			-- Error Level from tblErrorLevel

AS
	Set NoCount On
	Set Xact_Abort On
	Begin Tran
	
		Insert Into 
			tblErrorLog
		(
			Source, 
			Module, 
			[Function], 
			Code, 
			Message, 
			StackTrace, 
			ErrorLevel, 
			DateCreated,
			DateUpdated
		)
		Values
		(
			@strSource, 
			@strModule, 
			@strFunction, 
			@strCode, 
			@strMessage, 
			@strStackTrace, 
			@intErrorLevel,   
			GetUTCDate(),   
			GetUTCDate()
		)

	Commit Tran
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLink_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcLink_Update]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLink_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Updates a Link.

Parameters:
	@linkID
	@caption
	@url
	@showDisclaimer
	@userID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Link.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	10. BusinessServiceException (General)		


Author: Peter Vranich
Date Created: 12 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE  Procedure [prcLink_Update]
(
	@linkID Integer = Null,
	@caption nVarchar(100) = Null,
	@url nVarchar(200) = Null,
	@showDisclaimer Bit = 1,
	@userID Integer = Null,
	@LinkOrder Integer = 999
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction
    if @url is null 
    begin
        set @url = ''''
    end

	-- Declarations
	Declare @organisationID Int -- Organisation ID for the link to be updated
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	--Validate Parameter @linkID
	If(@linkID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @linkID in stored procedure prcLink_Update''
		Goto Finalise
	End

	-- Get the Organisation ID for the link to be updated
	Set @organisationID = (Select organisationID From tblLink Where linkID = @linkID)
	
	-- Validate that the Caption for this link doesn''t exist.
	If Exists(Select * From tblLink Where Caption = @caption And LinkID != @linkID And OrganisationID = @organisationID)
	Begin
		Set @intErrorNumber = 4
		Set @strErrorMessage = ''The Caption '' + @caption + '' already exists please choose another Caption.''
		Goto Finalise
	End
	
	--Validate Parameter @caption
	If(@caption Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @strErrorMessage in stored procedure prcLink_Update''
		Goto Finalise
	End

	--Validate Parameter @showDisclaimer
	If(@showDisclaimer Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @showDisclaimer in stored procedure prcLink_Update''
		Goto Finalise
	End

	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @userID in stored procedure prcLink_Update''
		Goto Finalise
	End
	
	If Exists(Select * From tblLink Where LinkID = @linkID)
	Begin
		-- Update the record in tblLink
		Update tblLink
		Set 
			Caption = @caption,
			Url = @url,
			ShowDisclaimer = @showDisclaimer,
			UpdatedBy = @userID,
			DateUpdated = GetUTCDate(),
			LinkOrder = @LinkOrder
		Where
			LinkID = @linkID
		
		-- Set the error message to successfull
		Set @strErrorMessage = ''Successfully Updated''
	
		-- Finalise the procedure
		Goto Finalise
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		
		Goto Finalise
	End

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLogUsage_Hourly]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcLogUsage_Hourly]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLogUsage_Hourly]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcLogUsage_Hourly] AS

Insert Into
	tblLogHourly ([OrganisationID]
      ,[TimePeriod1]
      ,[TimePeriod2]
      ,[TimePeriod3]
      ,[TimePeriod4]
      ,[TimePeriod5]
      ,[TimePeriod6]
      ,[DateCreated] )


SELECT  MAX(tblOrganisation.OrganisationID), 
		COUNT(Minute.UserMinute) AS ''Last Minute'', 
		COUNT(Hour.UserHour) AS ''Last Hour'', 
        COUNT(Days.UserDay) AS ''Last Day'', 
		COUNT(Weeks.userWeek) AS ''Last Week'', 
		COUNT(Months.UserMonth) AS ''Last Month'', 
		COUNT(Years.UserYear) AS ''Last Year'',
		GetUTCDate()
FROM         tblUser INNER JOIN
                      tblOrganisation ON tblUser.OrganisationID = tblOrganisation.OrganisationID LEFT OUTER JOIN
                          (SELECT     UserID AS UserYear
                            FROM          tblUser
                            WHERE      DATEDIFF(Year, LastLogin, getutcdate()) <= 1) AS Years ON UserID = UserYear LEFT OUTER JOIN
                          (SELECT     UserID AS UserMonth
                            FROM          tblUser
                            WHERE      DATEDIFF(Month, LastLogin, getutcdate()) <= 1) AS Months ON UserID = UserMonth LEFT OUTER JOIN
                          (SELECT     UserID AS UserWeek
                            FROM          tblUser
                            WHERE      DATEDIFF(Week, LastLogin, getutcdate()) <= 1) AS Weeks ON UserID = UserWeek LEFT OUTER JOIN
                          (SELECT     UserID AS UserDay
                            FROM          tblUser
                            WHERE      DATEDIFF(Day, LastLogin, getutcdate()) <= 1) AS Days ON UserID = UserDay LEFT OUTER JOIN
                          (SELECT     UserID AS UserHour
                            FROM          tblUser
                            WHERE      DATEDIFF(Hour, LastLogin, getutcdate()) <= 1) AS Hour ON UserID = UserHour LEFT OUTER JOIN
                          (SELECT     UserID AS UserMinute
                            FROM          tblUser
                            WHERE      DATEDIFF(Minute, LastLogin, getutcdate()) <= 1) AS Minute ON UserID = UserMinute
GROUP BY tblUser.OrganisationID
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLogUsage_Daily]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcLogUsage_Daily]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLogUsage_Daily]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcLogUsage_Daily]
as
Insert
into
	tblLogDaily ([OrganisationID]
      ,[TimePeriod1]
      ,[TimePeriod2]
      ,[TimePeriod3]
      ,[TimePeriod4]
      ,[TimePeriod5]
      ,[TimePeriod6]
      ,[TimePeriod7]
      ,[TimePeriod8]
      ,[DateCreated])

SELECT  MAX(tblOrganisation.[OrganisationID]) , 
		COUNT(User_A.User_A) AS ''12am - 7am '', 
		COUNT(User_B.User_B) AS '' 7am - 9am '', 
        COUNT(User_C.User_C) AS '' 9am - 11am'', 
		COUNT(User_D.User_D) AS ''11am - 1pm '', 
		COUNT(User_E.User_E) AS ''1pm  - 3pm'', 
		COUNT(User_F.User_F) AS '' 3pm - 5pm '', 
		COUNT(User_G.User_G) AS '' 5pm - 7pm'', 
		COUNT(User_H.User_H) AS '' 7pm - 12pm '',
		GetUTCDate()
FROM         tblUser INNER JOIN
                      tblOrganisation ON tblUser.OrganisationID = tblOrganisation.OrganisationID LEFT OUTER JOIN
                          (SELECT     UserID AS User_A
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 0 AND DATEPART(hh, LastLogin) < 7) AS User_A ON UserID = User_A LEFT OUTER JOIN
                          (SELECT     UserID AS User_B
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 7 AND DATEPART(hh, LastLogin) < 9) AS User_B ON UserID = User_B LEFT OUTER JOIN
                          (SELECT     UserID AS User_C
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 9 AND DATEPART(hh, LastLogin) < 11) AS User_C ON UserID = User_C LEFT OUTER JOIN
                          (SELECT     UserID AS User_D
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 11 AND DATEPART(hh, LastLogin) < 13) AS User_D ON UserID = User_D LEFT OUTER JOIN
                          (SELECT     UserID AS User_E
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 13 AND DATEPART(hh, LastLogin) < 15) AS User_E ON UserID = User_E LEFT OUTER JOIN
                          (SELECT     UserID AS User_F
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 15 AND DATEPART(hh, LastLogin) < 17) AS User_F ON UserID = User_F LEFT OUTER JOIN
                          (SELECT     UserID AS User_G
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 17 AND DATEPART(hh, LastLogin) < 19) AS User_G ON UserID = User_G LEFT OUTER JOIN
                          (SELECT     UserID AS User_H
                            FROM          tblUser
                            WHERE      DATEPART(hh, LastLogin) >= 19 AND DATEPART(hh, LastLogin) < 24) AS User_H ON UserID = User_H
GROUP BY tblUser.OrganisationID
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcModule_Update]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Updates a Module''s details (except its sequence value).

Parameters:
	@moduleID
	@name
	@description
	@active
	@updatedByUserID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Course.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	10. BusinessServiceException (General)		


Author: Gavin Buddis
Date Created: 16 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE Procedure [prcModule_Update]
(
	@moduleID Integer = Null,
	@name nVarchar(100) = Null,
	@description nVarchar(1000) = Null,
	@active Bit = Null,
	@updatedByUserID Integer = Null
)

As
-- Used to hold the course id when checking for duplicate module names.
Declare @CourseID int
	
Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	-- Validate Parameter @moduleID
	If(@moduleID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @moduleID in stored procedure prcModule_Update''
		Goto Finalise
	End
	
	-- Validate Parameter @name
	If(@name Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @name in stored procedure prcModule_Update''
		Goto Finalise
	End

	-- Validate Parameter @active
	If(@name Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @active in stored procedure prcModule_Update''
		Goto Finalise
	End

	-- Validate Parameter @userID
	If(@updatedByUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @updatedByUserID in stored procedure prcModule_Update''
		Goto Finalise
	End
	
	--Check that there are no other modules of this name within this course
	Select @CourseID = CourseID From tblModule Where ModuleID=@ModuleID
	If Exists(Select CourseID from tblModule Where CourseID=@courseID and [Name]=@name and ModuleID <> @moduleID)
	Begin
		Set @intErrorNumber = 4
		Set @strErrorMessage = ''There is already a module of that name within this course''
		Goto Finalise
	End
	
	If Exists(Select * From tblModule Where ModuleID = @moduleID)
	Begin
		-- Update the record in tblModule
		Update tblModule
		Set 
			[Name] = @name,
			[Description] = @description,
			Active = @active,
			UpdatedBy = @updatedByUserID,
			DateUpdated = GetUTCDate()
		Where
			ModuleID = @moduleID
		
		-- Set the error message to successfull
		Set @strErrorMessage = ''Successfully Updated''
	
		-- Finalise the procedure
		Goto Finalise
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		
		Goto Finalise
	End

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_UpdateSequence]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcModule_UpdateSequence]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcModule_UpdateSequence]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Updates a Module''s sequence value.

Parameters:
	@moduleID
	@sequence
	@userID

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	Course.cs.

Calls:
	Nothing

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	10. BusinessServiceException (General)		


Author: Gavin Buddis
Date Created: 16 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE Procedure [prcModule_UpdateSequence]
(
	@moduleID Integer = Null,
	@sequence Varchar(100) = Null,
	@updatedByUserID Integer = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	--Validate Parameter @moduleID
	If(@moduleID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @moduleID in stored procedure prcModule_UpdateSequence''
		Goto Finalise
	End
	
	--Validate Parameter @name
	If(@sequence Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @sequence in stored procedure prcModule_UpdateSequence''
		Goto Finalise
	End

	--Validate Parameter @userID
	If(@updatedByUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @updatedByUserID in stored procedure prcModule_UpdateSequence''
		Goto Finalise
	End
	
	If Exists(Select * From tblModule Where ModuleID = @moduleID)
	Begin
		-- Update the record in tblModule
		Update tblModule
		Set 
			[Sequence] = @sequence,
			UpdatedBy = @updatedByUserID,
			DateUpdated = GetUTCDate()
		Where
			ModuleID = @moduleID
		
		-- Set the error message to successfull
		Set @strErrorMessage = ''Successfully Updated''
	
		-- Finalise the procedure
		Goto Finalise
	End
	Else
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		
		Goto Finalise
	End

Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_Update]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcPolicy_Update]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_Update]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
Updates a Policy.

Parameters:
	@PolicyID int,
	@OrganisationID int,
	@PolicyName nvarchar(255),
	@Active bit,
	@Deleted bit,
	@PolicyFileName nvarchar(255),
	@PolicyFileSize bigint,
	@UploadDate datetime


Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: June 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

CREATE procedure [prcPolicy_Update]
(
	@PolicyID int,
	@OrganisationID int,
	@PolicyName nvarchar(255),
	@Active bit,
	@Deleted bit,
	@PolicyFileName nvarchar(255),
	@PolicyFileSize bigint,
	@UploadDate datetime,
	@ConfirmationMessage nvarchar(500)
)
as

declare @SQL nvarchar(1000)
declare @SQLL nvarchar(1000)
declare @SQLR nvarchar(1000)
declare @Index int

set @PolicyName = replace(@PolicyName, '''''''', '''''''''''')
set @ConfirmationMessage = replace(@ConfirmationMessage, '''''''', '''''''''''')

set @SQL = ''update tblPolicy''
set @SQL = @SQL + '' set''
if @OrganisationID is not null
begin
	set @SQL = @SQL + '' OrganisationID = '' + cast(@OrganisationID as nvarchar) + '','' 
end
if @PolicyName is not null
begin
	set @SQL = @SQL + '' PolicyName = '''''' + @PolicyName + '''''',''
end
if @Active is not null
begin
	set @SQL = @SQL + '' Active = '' + cast(@Active as char(1)) + '', ''
end
if @Deleted is not null
begin
	set @SQL = @SQL + '' Deleted = '' + cast(@Deleted as char(1)) + '', '' 
end
if @PolicyFileName is not null
begin
	set @SQL = @SQL + '' PolicyFileName = '''''' + @PolicyFileName + '''''',''
end
if @PolicyFileSize is not null
begin
	set @SQL = @SQL + '' PolicyFileSize = '' + cast(@PolicyFileSize as nvarchar) + '',''
end
if @UploadDate is not null
begin
	set @SQL = @SQL + '' UploadDate = getUTCDate() ,''
end
if @ConfirmationMessage is not null
begin
	set @SQL = @SQL + '' ConfirmationMessage = '''''' + @ConfirmationMessage + '''''',''
end
set @SQL = @SQL + '' where PolicyID ='' + cast(@PolicyID as nvarchar)

-- this removes last '','' character from @SQL
set @SQL = reverse(@SQL)
set @index = charindex('','', @SQL)
if @index > 0 
begin
	set @SQLL = left(@SQL, @index-1)
	set @SQLR = right(@SQL, len(@SQL) - (@index))
	set @SQL = @SQLL + @SQLR
end
set @SQL = reverse(@SQL)

exec (@SQL)
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_Add]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcPolicy_Add]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcPolicy_Add]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
Add a new Policy.

Parameters:
	@PolicyID output int,
	@OrganisationID int,
	@PolicyName nvarchar(255),
	@Active bit,
	@Deleted bit,
	@PolicyFileName nvarchar(255),
	@PolicyFileSize bigint,
	@UploadDate datetime


Returns:
Nothing

Called By:
Policy.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: June 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

CREATE procedure [prcPolicy_Add]
(
	@PolicyID int output,
	@OrganisationID int,
	@PolicyName nvarchar(255),
	@Active bit,
	@Deleted bit,
	@PolicyFileName nvarchar(255),
	@PolicyFileSize bigint,
	@ConfirmationMessage nvarchar(500)
)
as

insert into tblPolicy
(
OrganisationID,
PolicyName,
Active,
Deleted,
PolicyFileName,
PolicyFileSize,
UploadDate,
ConfirmationMessage
)
values
(
@OrganisationID,
@PolicyName,
@Active,
@Deleted,
@PolicyFileName,
@PolicyFileSize,
getUTCDate(),
@ConfirmationMessage
)

set @PolicyID = @@Identity

-- get a list of all users for the organisation
create table #UserTemp
(
	UserID int
)

insert into #UserTemp (UserID)
Select
	UserID
From
	tblUser
Where
	OrganisationID = @organisationID

insert into tblUserPolicyAccepted (PolicyID, UserID, Accepted)
select @PolicyID, UserID, 0 from #UserTemp

drop table #UserTemp

/*
	do this bit for policies that are created after the profiles have been created
*/
insert into tblprofilepoints ( profilepointstype, typeid, profileperiodid, points, active, dateassigned)
select ''P'',@PolicyID,profileperiodid,0,1,getutcdate() from tblprofileperiod

select @PolicyID
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_MoveToTopLevel]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_MoveToTopLevel]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_MoveToTopLevel]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Move a unit to top level.
Returns:
	Nothing.
		
Called By: 
	Unit Class.

Calls:
	Nothing
Remarks:


	Exception:
	0: Succeed
	1.RecordNotFound
	2.FK constraint
	3.PKViolationException
	4.UniqueViolationException
	10.BusinessServiceException (General)		


Author: Jack Liu
Date Created: 11 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/
CREATE PROCEDURE [prcUnit_MoveToTopLevel]
(
	@fromUnitID	int,
	@adminUserID 	int
)

AS

set nocount on

set xact_abort on
Begin Tran
	declare @strErrorMessage varchar(500)
	declare @intErrorNumber int

	declare @intUserTypeID int

	declare @intFromOrganisationID int
	declare @strFromHierarchy nvarchar(500)
	declare @intFromParentUnitID int

	select @intUserTypeID = UserTypeID  
	from tblUser
	where userID = @adminUserID

	select @intFromOrganisationID = OrganisationID,
		@strFromHierarchy = Hierarchy,
		@intFromParentUnitID = parentUnitID
	from tblUnit 
	where unitID=@fromUnitID
	

	set @strErrorMessage=''''

	-------------- 1. Permission Checking ----------------
	--Only Salt Administrator (1), Organisation Administrator (2) can move a unit to top level
	If (@intUserTypeID>2)
	begin
		set @strErrorMessage = ''You do not have permission to move a unit to the top level.''	
		set @intErrorNumber = 1
	end

	-----------------2. Validation -----------------------------
	if (@strErrorMessage='''')
	begin
		--	2.1. "From" unit is in top level
		if (@intFromParentUnitID is null)
		begin
			set @strErrorMessage = ''The ''''From'''' unit already exists at the top level.''
			set @intErrorNumber = 11
		end
	end

	if (@strErrorMessage='''')
	begin
		--1. Update hierarchy and rebuild the unit tree
		Update tblUnit
		set parentUnitID=null,
		    UpdatedBy = @adminUserID,	
		     DateUpdated = getutcdate()	
		where unitID=@fromUnitID

		--rebuild the unit tree
		exec prcOrganisation_CheckUnitTree @intFromOrganisationID

		--2. Keep the exsiting administrators
		select 0 as Error, '''' as ErrorMessage
	end
	else
	begin
		select @intErrorNumber as Error,  @strErrorMessage as ErrorMessage
	end

commit TRAN
' 
END
GO







IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_Quick]
GO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/* Summary:
Update lesson status for each user
This schedule task only updates three status:
Unassigned Modules (0)
New Assigned Modules (Not Started(1))
Expired Modules (Time Elapsed)(4)

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user lesson status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''''Not started''''.
If a module is unassigned from a user, the status will be ''''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''''unassinged''''

------------ Decision Processes -------------

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules

1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)

2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)

2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson date/frequency, the new status is Expired (Time Expired)(4)



------------ Data need to be recorded -------------

LessonFrequency
0  Unassigned:  		-
1  Not Started: 		Y
4  Expired (Time Elapsed): 	Y


Author: Jack Liu
Date Created: 21 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate

prcUserLessonStatus_Update

**/
CREATE Procedure [prcUserLessonStatus_Update_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On



--##################################################################################################################
/*
2. Add New lesson status

2.1.     N O T      A S S I G N E D      M O D U L E S
(0) (PreviousAssignedModules - CurrentAssignedModules)
Add record of 0 (unassigned) to tblUserLessonStatus for each User-Module that has been started but now has no Course access or is specifically excluded at unit/user level
*/
--##################################################################################################################
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID
)
select pam.UserID,
pam.ModuleID,
0  as QuizStatusID --Unassigned (0)
from  

(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
 

left join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam -- Current Assigned Modules
               
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)



--##################################################################################################################
/*
2.2.      N E W     A S S I G N E D     M O D U L E S
(Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)
*/
--##################################################################################################################


insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
1  as LessonStatusID,--Not Started(1)
cam.LessonFrequency, 
cam.LessonCompletionDate
from 
(
		SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
		FROM  dbo.tblUser AS tU INNER JOIN
		tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)
 ) cam 
left join 
(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where pam.moduleID is null



--##################################################################################################################
/*
2.3.       E X P I R E D    M O D U L E S
 (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson frequency, the new status is Expired (Time Expired)(4)
*/
--##################################################################################################################




insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as LessonStatusID, --(Time Elapsed)(4)
cam.LessonFrequency, cam.LessonCompletionDate
from (
	select 	max(LastStarted.UserLessonStatusID) LastStartedStatusID
	from tblUserLessonStatus LastStarted
	inner join 
	(
		SELECT LessonStatus.UserLessonStatusID, LessonStatus.UserID, LessonStatus.ModuleID, m.CourseID, LessonStatus.LessonStatusID, LessonStatus.LessonFrequency, 
					   LessonStatus.DateCreated
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		inner join tblModule m on m.ModuleID = LessonStatus.ModuleID
							
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
	) CurrentStatus
	on  LastStarted.UserID = CurrentStatus.UserID
	and  LastStarted.ModuleID = CurrentStatus.ModuleID
	and CurrentStatus.LessonStatusID in (2,3)
	where LastStarted.LessonStatusID = 2
	and LastStarted.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
	group by LastStarted.UserID, LastStarted.moduleID
) lss
inner join tblUserLessonStatus uls
on uls.UserLessonStatusID = lss.LastStartedStatusID
inner join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblUnit AS u ON u.OrganisationID = tU.OrganisationID and u.UnitID = tU.UnitID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam
on cam.UserID = uls.UserID
and cam.ModuleID = uls.ModuleID
where
	(
		cam.LessonCompletionDate is null 
		and DateDiff(day,getutcdate(), dateadd(month, cam.LessonFrequency, uls.DateCreated)) <= 0
	)
	or 
	(
		isnull(DateDiff(day, getutcdate(), cam.LessonCompletionDate), 1) <= 0
	)
	and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
--Expired





--##################################################################################################################
-- Extend completion dates
	update tblOrganisation 
		set DefaultLessonCompletionDate = dateadd(year, 1, [DefaultLessonCompletionDate])
		where DefaultLessonCompletionDate < getutcdate() and OrganisationID = @OrgID

--##################################################################################################################
	update tblUnitRule
		set LessonCompletionDate = dateadd(year, 1, [LessonCompletionDate])
		where LessonCompletionDate < getutcdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
-- /Extend completion dates
--##################################################################################################################
	
	
	

SET QUOTED_IDENTIFIER ON
' 
END
GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]
GO


IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/* Summary:
Update lesson status for each user
This schedule task only updates three status:
Unassigned Modules (0)
New Assigned Modules (Not Started(1))
Expired Modules (Time Elapsed)(4)

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user lesson status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''''Not started''''.
If a module is unassigned from a user, the status will be ''''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''''unassinged''''

------------ Decision Processes -------------

1. Get CurrentAssignedModules and PreviousAssignedModules
1.1  CurrentAssignedModules
Get all modules that are currently assigned to each users
and compliance rules

1.2  PreviousAssignedModules
Get a list of modules that is in the lesson status table that the last statuses are not Unassigned (0)

2. Add New lesson status
2.1. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)

2.2. New Assigned Modules (Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)

2.3. Expired Modules (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson date/frequency, the new status is Expired (Time Expired)(4)



------------ Data need to be recorded -------------

LessonFrequency
0  Unassigned:  		-
1  Not Started: 		Y
4  Expired (Time Elapsed): 	Y


Author: Jack Liu
Date Created: 21 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added LessonCompletionDate

prcUserLessonStatus_Update

**/
CREATE Procedure [prcUserLessonStatus_Update_NO_TRIGGER_CurrentStatus_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On



--##################################################################################################################
/*
2. Add New lesson status

2.1.     N O T      A S S I G N E D      M O D U L E S
(0) (PreviousAssignedModules - CurrentAssignedModules)
Add record of 0 (unassigned) to tblUserLessonStatus for each User-Module that has been started but now has no Course access or is specifically excluded at unit/user level
*/
--##################################################################################################################
insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID
)
select pam.UserID,
pam.ModuleID,
0  as QuizStatusID --Unassigned (0)
from  

(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
 

left join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam -- Current Assigned Modules
               
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)



--##################################################################################################################
/*
2.2.      N E W     A S S I G N E D     M O D U L E S
(Not Started(1)) (CurrentAssignedModules- PreviousAssignedModules)
*/
--##################################################################################################################


insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
1  as LessonStatusID,--Not Started(1)
cam.LessonFrequency, 
cam.LessonCompletionDate
from 
(
		SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
		FROM  dbo.tblUser AS tU INNER JOIN
		tblUnit on tU.UnitID = tblUnit.UnitID and tblUnit.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)
 ) cam 
left join 
(
		SELECT LessonStatus.UserID, LessonStatus.ModuleID
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
		AND (LessonStatus.UserLessonStatusID <> 0)
        and 	LessonStatus.LessonStatusID<>0 --not Unassigned (0)
)  pam
on cam.UserID = pam.UserID
and cam.ModuleID = pam.ModuleID
where pam.moduleID is null



--##################################################################################################################
/*
2.3.       E X P I R E D    M O D U L E S
 (Time Elapsed)(4): Expired a lesson if the cycle started date is past the lesson frequency
a)Get the last cycle started date which current lesson status is In Progress (2), or Completed(3)
b)If the cycle started date is past the current lesson frequency, the new status is Expired (Time Expired)(4)
*/
--##################################################################################################################




insert into tblUserLessonStatus
(
UserID,
ModuleID,
LessonStatusID,
LessonFrequency, 
LessonCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as LessonStatusID, --(Time Elapsed)(4)
cam.LessonFrequency, cam.LessonCompletionDate
from (
	select 	max(LastStarted.UserLessonStatusID) LastStartedStatusID
	from tblUserLessonStatus LastStarted
	inner join 
	(
		SELECT LessonStatus.UserLessonStatusID, LessonStatus.UserID, LessonStatus.ModuleID, m.CourseID, LessonStatus.LessonStatusID, LessonStatus.LessonFrequency, 
					   LessonStatus.DateCreated
		FROM  dbo.tblUserCurrentLessonStatus as LessonStatus 
		inner join tblUser on tblUser.UserID = LessonStatus.UserID and tblUser.OrganisationID = @OrgID 
		inner join tblModule m on m.ModuleID = LessonStatus.ModuleID
							
		WHERE  (LessonStatus.Excluded = 0) OR (LessonStatus.Excluded IS NULL)
	) CurrentStatus
	on  LastStarted.UserID = CurrentStatus.UserID
	and  LastStarted.ModuleID = CurrentStatus.ModuleID
	and CurrentStatus.LessonStatusID in (2,3)
	where LastStarted.LessonStatusID = 2
	and LastStarted.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
	group by LastStarted.UserID, LastStarted.moduleID
) lss
inner join tblUserLessonStatus uls
on uls.UserLessonStatusID = lss.LastStartedStatusID
inner join (SELECT tU.UserID, tM.ModuleID, CASE WHEN (ur.LessonFrequency IS NULL AND ur.LessonCompletionDate IS NULL AND o.DefaultLessonCompletionDate IS NULL) 
               THEN o.DefaultLessonFrequency ELSE ur.LessonFrequency END AS LessonFrequency, CASE WHEN (ur.LessonFrequency IS NULL AND 
               ur.LessonCompletionDate IS NULL AND NOT (o.DefaultLessonCompletionDate IS NULL)) 
               THEN o.DefaultLessonCompletionDate ELSE ur.LessonCompletionDate END AS LessonCompletionDate
FROM  dbo.tblUser AS tU INNER JOIN
               dbo.tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID AND tOCA.OrganisationID = @OrgID INNER JOIN
               dbo.tblOrganisation AS o ON o.OrganisationID = tOCA.OrganisationID INNER JOIN
               dbo.tblUnit AS u ON u.OrganisationID = tU.OrganisationID and u.UnitID = tU.UnitID INNER JOIN
               dbo.tblModule AS tM ON tM.Active = 1 AND tOCA.GrantedCourseID = tM.CourseID LEFT OUTER JOIN
               dbo.tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID LEFT OUTER JOIN
               dbo.tblUnitRule AS ur ON ur.ModuleID = tM.ModuleID AND ur.UnitID = tU.UnitID
WHERE (tU.Active = 1) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
               (tUsrMA.Granted = 1)) cam
on cam.UserID = uls.UserID
and cam.ModuleID = uls.ModuleID
where
	(
		cam.LessonCompletionDate is null 
		and DateDiff(day,getutcdate(), dateadd(month, cam.LessonFrequency, uls.DateCreated)) <= 0
	)
	or 
	(
		isnull(DateDiff(day, getutcdate(), cam.LessonCompletionDate), 1) <= 0
	)
	and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
--Expired





--##################################################################################################################
-- Extend completion dates
	update tblOrganisation 
		set DefaultLessonCompletionDate = dateadd(year, 1, [DefaultLessonCompletionDate])
		where DefaultLessonCompletionDate < getutcdate() and OrganisationID = @OrgID

--##################################################################################################################
	update tblUnitRule
		set LessonCompletionDate = dateadd(year, 1, [LessonCompletionDate])
		where LessonCompletionDate < getutcdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
-- /Extend completion dates
--##################################################################################################################
	
	
	

SET QUOTED_IDENTIFIER ON
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_AssignUnit]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_AssignUnit]
GO

SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_AssignUnit]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Updates a Users Unit, if no user is specified then it updates all unassigned users 
	to be members of the specified unit. This function does not ever update Salt Admin Type users

Parameters:
	@userID		(Optional)
	@unitID 		(Mandatory)
	@updatedByUserID	(Mandatory)
	@organisationID		(Mandatory)

Returns:
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: 
	User.cs.

Calls:
	Nothing

Assumptions:
	None

Logic:
	Updates the user and includes them in the appropriate unit
		

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	7. IntegrityConstraintException
	10. BusinessServiceException (General)		


Author: Peter Kneale
Date Created: 23 February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Peter Kneale	27/2			Added Organisation ID parameter

**/
CREATE  Procedure [prcUser_AssignUnit]
(
	@userID 		Integer = Null,		-- User ID that should be assigned to the unit
	@unitID 		Integer = Null,		-- Unit ID that the user should be assigned to
	@updatedByUserID 	Integer = Null,		-- UserID of the user performing the update
	@organisationID		Integer = Null		-- Organisation ID that the user is to be assigned to.
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) 		-- Holds the error message
	Declare @intErrorNumber Integer 		-- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0


	-- PARAMETER VALIDATION
	--==============================================================
	
	--Validate Parameter @unitID
	If(@unitID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @unitID in stored procedure prcUser_UpdateUnit''
		Goto Finalise
	End

	--Validate Parameter @updatedByUserID
	If(@updatedByUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @updatedByUserID in stored procedure prcUser_UpdateUnit''
		Goto Finalise
	End

	--Validate Parameter @organisationID
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure prcUser_UpdateUnit''
		Goto Finalise
	End

	-- Validate User Exists
	--=========================================================
	If Not (@userID is null)
	Begin
		If Not Exists(Select * From tblUser Where UserID = @userID)
		Begin
			Set @intErrorNumber = 1
			Set @strErrorMessage = ''This user record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
			Goto Finalise
		End 
	End
	-- Validate Updated By User ID Exists
	--=========================================================
	If Not Exists(Select * From tblUser Where UserID = @updatedByUserID)
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This user record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		Goto Finalise
	End 

	-- Validate Organisation ID Exists
	--=========================================================
	If Not Exists(Select * From tblOrganisation Where OrganisationID = @organisationID)
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This user record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		Goto Finalise
	End 

	-- Validate Unit Exists
	--=========================================================
	If Not Exists(Select * From tblUnit Where UnitID = @unitID and Active=1)
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = ''This unit record no longer exists please refresh your screen.  If the problem persists please contact your administrator.''
		Goto Finalise
	End 

	If (@userID is null)
		Begin
			-- Update All Unassigned Active Users
			--=======================
			Update
				tblUser
			Set 
				UnitID = @unitID,
				DateUpdated=getutcDate(),
				UpdatedBy=@updatedByUserID
			Where
				UnitID = null
				And Active = 1
				And UserTypeID <> 1
				And OrganisationID = @organisationID
		End
	Else
		Begin
			-- Update  a Single User
			--=======================
			Update
				tblUser
			Set 
				UnitID = @unitID,
				DateUpdated=getutcDate(),
				UpdatedBy=@updatedByUserID
			Where
				UserID = @userID
				And OrganisationID = @organisationID
		End
	

	
	
	-- Set the error message to successfull
	Set @strErrorMessage = ''Successfully Updated''

	-- Finalise the procedure
	Goto Finalise


Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As ''ErrorNumber'',
		@strErrorMessage As ''ErrorMessage''
End
' 
END
GO


/* send email certificates task */

/****** Object:  StoredProcedure [dbo].[prcUser_GetAdministratorsEmailAddress]    Script Date: 07/01/2011 12:18:32 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetAdministratorsEmailAddress]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcUser_GetAdministratorsEmailAddress]
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetAdministratorsEmailAddress]    Script Date: 07/01/2011 12:18:32 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcUser_GetAdministratorsEmailAddress]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 01/07/2011
-- Description:	Gets nearest admin for user
-- =============================================
CREATE PROCEDURE [dbo].[prcUser_GetAdministratorsEmailAddress] 
	@UserId int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT dbo.udfUser_GetAdministratorsEmailAddress(@UserId)
END
' 
END
GO





IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTimeZone_GetTimeZoneFLBName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE Procedure [prcTimeZone_GetTimeZoneFLBName]
(
	@TimeZoneID int
)

As

select FLB_Name from tblTimeZone where TimeZoneID = @TimeZoneID
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcGetMailThroughputPagedandSorted]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcGetMailThroughputPagedandSorted]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcGetMailThroughputPagedandSorted]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		Hitendra Jagtap
-- Create date: 21/06/2011
-- Description:	Custom paging and sorting of mail throughput
-- =============================================
CREATE PROCEDURE [prcGetMailThroughputPagedandSorted] 
    @sortExpression nvarchar(100),
    @startRowIndex int,
    @maximumRows int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	IF LEN(@sortExpression) = 0
		SET @sortExpression = ''Percent of Expected Emails''

	SELECT ''OrganisationName'', ''Emails delivered in last hour'', ''Emails delivered in last day'', ''Percent of Expected Emails''
		FROM (SELECT o.OrganisationName AS OrganisationName, dbo.udfGetEmailsinHour(o.OrganisationName) AS "Emails delivered in last hour", dbo.udfGetEmailsinDay(o.OrganisationName) AS "Emails delivered in last day", dbo.udfGetPercentExpectedEmails(o.OrganisationName) AS "Percent of Expected Emails",
			ROW_NUMBER() OVER (ORDER BY @sortExpression) AS RowRank 
			FROM tblEmail AS e INNER JOIN tblOrganisation AS o ON e.OrganisationID = o.OrganisationID) AS MailWithRowNumbers
			WHERE ''RowRank'' > CONVERT(nvarchar(10), @startRowIndex)
				AND ''RowRank'' <= (CONVERT(nvarchar(10), @startRowIndex) + CONVERT(nvarchar(10), @maximumRows))
END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcJobMaintainUnitHierarchies]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcJobMaintainUnitHierarchies]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcJobMaintainUnitHierarchies]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcJobMaintainUnitHierarchies] AS

if (select count(*) from sysobjects where [name] = ''tblUnitHierarchy'') = 0
BEGIN

CREATE TABLE [dbo].[tblUnitHierarchy] (
	[UnitID] [int] NOT NULL ,
	[Hierarchy] [nvarchar] (500) COLLATE Latin1_General_CI_AS NULL ,
	[HierarchyName] [nvarchar] (2000) COLLATE Latin1_General_CI_AS NULL 
) ON [PRIMARY]


CREATE  INDEX [IX_tblUnitHierarchy] ON [dbo].[tblUnitHierarchy]([Hierarchy]) ON [PRIMARY]
END


if (select count(*) from sysobjects where [name] = ''utg_UpdateUnitHierarchy'') = 0
BEGIN

	EXEC(''CREATE TRIGGER utg_UpdateUnitHierarchy ON tblUnit AFTER INSERT, UPDATE AS '' +
	--Update Existing hierarchies
	''UPDATE '' +
		''tblUnitHierarchy '' +
	''SET '' +
		''Hierarchy = B.Hierarchy, '' +
		''HierarchyName = dbo.udfGetUnitPathway(B.UnitID) '' + 
	''FROM '' +
		''tblUnitHierarchy A, tblUnit B '' +
	''WHERE '' +
		''A.UnitID = B.UnitID AND '' +
		''B.UnitID IN (Select A.UnitID FROM tblUnit A, INSERTED B WHERE A.Hierarchy LIKE ''''%'''' + CAST(B.UnitID AS VARCHAR(10)) + ''''%'''') '' +
	''INSERT INTO '' +
		''tblUnitHierarchy '' +
	''SELECT '' +
		''A.UnitID, A.Hierarchy, dbo.udfGetUnitPathway(A.UnitID) '' +
	''FROM '' +
		''INSERTED A '' +
	''WHERE '' +
		''A.UnitID NOT IN (SELECT B.UnitID FROM tblUnitHierarchy B WHERE B.UnitID = A.UnitID)'')
END



if (select count(*) from sysobjects where [name] = ''utg_DeleteUnitHierarchy'') = 0
BEGIN

EXEC(''CREATE TRIGGER utg_DeleteUnitHierarchy ON tblUnit AFTER DELETE AS '' +
''DELETE FROM tblUnitHierarchy '' +
''WHERE UnitID IN (SELECT UnitID FROM Deleted) '')

END

--Dummy to fill tblUnitHierarchy table
UPDATE tblUnit SET Hierarchy = Hierarchy
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTotalNumberofMails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcTotalNumberofMails]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcTotalNumberofMails]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [prcTotalNumberofMails] 
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

SELECT COUNT(*) FROM tblEmail

END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_GetEarliestLessonStatus]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfReport_GetEarliestLessonStatus]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_GetEarliestLessonStatus]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'

CREATE FUNCTION [udfReport_GetEarliestLessonStatus]
(
@UserID int,
@ModuleID int
)
RETURNS INT
 AS
BEGIN
	DECLARE @strStatus INT
	
	SELECT  TOP 1 @strStatus = LessonStatusID
	FROM tblUserLessonStatus uls
	ORDER BY uls.DateCreated ASC
	RETURN @strStatus
END
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLessonSession_StartLesson]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcLessonSession_StartLesson]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcLessonSession_StartLesson]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	-- Check that the lesson has not already been started
	-- if it has - return false
	-- if it has not, start it and return true
Returns:
	boolean (bit) OKToStart true = 1, false = 0
		
Called By: 
	Businessservices.Toolbook.StartLesson
Calls:

Remarks:
	
Author:
Stephen Kennedy-Clark
Date Created: 2 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
#2 Removed unnecessary transactions

-----------
prcLessonSession_StartLesson @LessonSessionID = ''4986F67F-FF29-4979-9A97-D7846839E0DB''


**/

CREATE     Procedure [prcLessonSession_StartLesson]
(
	@lessonSessionID varchar(50) -- ToolBook Session ID - GUID
)

As
Set NoCount On
Set Xact_Abort On



------------------------------------------
-- Declerations
------------------------------------------
Declare @bitReturnValue bit -- Return Value

------------------------------------------
-- Check that the lesson has not already been started
-- if it has - return false
-- if it has not, start it and return true
-- Start the lesson ( insert a start date )
------------------------------------------
if exists (select LessonSessionID from tblLessonSession where LessonSessionID=@LessonSessionID and DateTimeStarted is null)
Begin -- it is ok to start, record start and return true
	--< do update >--
	Update 
		tblLessonSession
	Set
		[DateTimeStarted] = GETUTCDATE()
	Where
		[LessonSessionID] = @LessonSessionID
	--< set return value >--
	Set @bitReturnValue = 1
End
Else
Begin  -- it is NOT ok to start, return false
	--< set return value >--
	Set @bitReturnValue = 0
End


------------------------------------------
-- select SessionID
------------------------------------------

Select @bitReturnValue as ''OKToStart''
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcProfilePeriod_RollOver]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcProfilePeriod_RollOver]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcProfilePeriod_RollOver]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE procedure [prcProfilePeriod_RollOver]
as begin

-- AC notes:
-- Get all periods that are active and end date has passed then
-- a) if there are instructions to make a future period then populate a new
-- record with the future period (+ instructions with what to do with the period following
-- that

/*
-- b) if there are no instructions to make a future period then populate a new record
-- with no current period or future period instructions (so user can create a period 
-- at a later time */
-- c) then make the active period inactive
-- d) following this need to go through all code that references profile periods and add 
-- sql to that code to take into account the profileperiodactive field
	
	declare @tmptable table
	(
		ppid int,
		pid int,
		newppid int
	)

	/*	get all the periods that have been, 
		and have a future period that havnt been created yet*/
	/*insert into @tmptable (ppid, pid)
	select 
		p2.profileperiodid, p2.profileid
	from
		tblprofileperiod p1 
		right join tblprofileperiod p2 on p1.profileid = p2.profileid
		and p1.datestart = p2.futuredatestart and p1.dateend = p2.futuredateend
	where
		p1.profileperiodid is null 
		and dateadd(hh,24,p2.dateend) <getutcdate()
		and p2.endofperiodaction in (2,3,4)*/
	
	insert into @tmptable (ppid, pid)
	select 
		profileperiodid, profileid
	from
		tblProfilePeriod
	where
		profileperiodactive = 1
	and dateadd(hh,24,dateend) < getutcdate()
	order by profileid


	
	--	add them into the profile period table	
	insert into tblprofileperiod (profileid,datestart,dateend, points, applytoquiz, applytolesson, endofperiodaction, monthincrement, futuredatestart, futuredateend, futurepoints, profileperiodactive)
	select 
		pid, 
		futuredatestart, 
		futuredateend, 
		futurepoints,
		applytoquiz, 
		applytolesson,
		case when endofperiodaction = 4 then 1 
			else endofperiodaction end 
			as futureendofperiodaction,
		monthincrement,
		case when endofperiodaction = 4 then null 
			else dateadd(day, 1, futuredateend) end 
			as newfuturedatestart,
		case when endofperiodaction = 4 then null 
			when endofperiodaction = 3 then dateadd(month, monthincrement, futuredateend)
			when endofperiodaction = 2 then dateadd(day, 1, dateadd(day, datediff(day, futuredatestart, futuredateend), futuredateend)) end
			as newfuturedateend,
		futurepoints,
		1
	from 
		tblprofileperiod 
		join @tmptable on ppid = profileperiodid 


	-- make the active period inactive
	update tblprofileperiod 
	set 
		profileperiodactive = 0
	where
		profileperiodid in
	(select ppid from @tmptable)


	-- remove the ones we dont need to do anything with 
	delete from @tmptable where ppid not  in 
	(
		select profileperiodid from 
		tblprofileperiod 
		join @tmptable on ppid = profileperiodid and endofperiodaction in (2,3,4)
	)
	
	-- get the ids for the new profile periods
	update @tmptable set newppid = p1.profileperiodid
	from 
		tblprofileperiod p1 
		--right join tblprofileperiod p2 on p1.profileid = p2.profileid
		--and p1.datestart = p2.futuredatestart and p1.dateend = p2.futuredateend
		join @tmptable t2 on t2.pid = p1.profileid 
		and p1.profileperiodactive = 1


	--copy across the points from the previous period into the new one
	insert into tblprofilepoints 
		(profileperiodid, profilepointstype,typeid, points,active, dateassigned)
	select
		newppid,
		p1.profilepointstype,
		p1.typeid,
		p1.points,
		p1.active,
		getutcdate()
	from
		tblprofilepoints p1
		join @tmptable on ppid = profileperiodid

	
	/* initialise user access to the period 
		(will give the same users access as previously assigned)*/
	insert into tbluserprofileperiodaccess
		(profileperiodid, userid, granted)
	select 
		newppid,
		pa.userid,
		pa.granted
	from tbluserprofileperiodaccess pa
	join @tmptable on ppid = profileperiodid
	
	/* initialise unit access to the period
		(will give the same unit access as previously assigned)*/
	insert into tblunitprofileperiodaccess
		(profileperiodid, unitid, granted)
	select
		newppid,
		pa.unitid,
		pa.granted
	from tblunitprofileperiodaccess pa
	join @tmptable on ppid = profileperiodid

end
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_CreateQuizAudit]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcQuizSession_CreateQuizAudit]
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_CreateQuizAudit]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	Given a QuizSessionID and ToolbookPageID creates an entry in the 
	tblQuizAudit Table.

Returns:
	Nothing
		
Called By: 
	ToolbookListener.cs

Calls:
	dbo.udfGetQuizIDBySessionID
	dbo.udfGetQuizQuestionIDByToolbookPageID

Remarks:
	The duration of the quiz is set to be 0 because toolbook does not
	currently return this information, it may be added at a later date.

Author:
Peter Kneale
Date Created: 10 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	

**/

CREATE    Procedure [prcQuizSession_CreateQuizAudit]
(
	@strQuizSessionID varchar(50),		-- Users Session ID
	@strToolbookPageID varchar(50)	-- the Toolbook Page ID of the Quiz
)

As

	Set NoCount On
	Set Xact_Abort On
	Begin Tran
	
	------------------------------------------
	-- Declerations
	------------------------------------------
	Declare @intQuizQuestionID  Integer		-- QuizQuestionID from Salt database.
	Declare @intQuizID 	       Integer		-- QuizID from Salt database.

	------------------------------------------
	-- Get Quiz ID by SessionID
	------------------------------------------
	Set @intQuizID =  dbo.udfGetQuizIDBySessionID (@strQuizSessionID)
	If (@intQuizID Is NULL or datalength(@intQuizID) = 0)
		Begin
			ROLLBACK
			Raiserror (''Procedure prcQuizSession_CreateQuizAudit could not determine the @intQuizID using udfGetQuizIDBySessionID'', 16, 1)
			Return
		End

	------------------------------------------
	-- Get Question ID by SessionID
	------------------------------------------
	Set @intQuizQuestionID 	= dbo.udfGetQuizQuestionIDByToolbookPageID (@strToolbookPageID,@intQuizID)
	If (@intQuizQuestionID Is NULL or datalength(@intQuizQuestionID) = 0)
		Begin
			ROLLBACK
			Raiserror (''Procedure prcQuizSession_CreateQuizAudit could not determine the @intQuizQuestionID using udfGetQuizQuestionIDByToolbookPageID'', 16, 1)
			Return
		End

	------------------------------------------
	-- Insert
	------------------------------------------
	Insert Into 
		tblQuizQuestionAudit
		(
		QuizSessionID, 
		QuizQuestionID, 
		Duration,
		DateAccessed
		)
	Values
		(
		@strQuizSessionID,
		@intQuizQuestionID,
		0,			-- Duration is recorded as 0 becuase the duration per question is not returned from Toolbook.
		getutcDate()
		)
Commit Tran
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_EndQuiz]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcQuizSession_EndQuiz]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_EndQuiz]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	this proc records that a Quiz has ended by updating tblQuizSession
	is Sets
	-- DateTimeCompleted from getutcDate();
	-- Duration from Toolbook
	-- QuizScore from Toolbook
	-- QuizPassMark passmark (Using prcQuiz_GetPassMark).
	it also:
	-- Checks that the Quiz has started -- if it has NOT -> return false
	-- Checks that the Quiz has not already ended -- if it has -> return false

	
	
Returns:
	boolean (bit) OK true = 1, false = 0
		
Called By: 
	ToolbookListener.cs via Businessservices.Toolbook.EndQuizSession

Calls:
	udfQuiz_GetPassMark
	udfGetUserIDBySessionID
	udfGetQuizIDBySessionID

Remarks:
	
Author:
Stephen Kennedy-Clark
Date Created: 11 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


-----------
prcQuizSession_EndQuiz @quizSessionID = 
select * from tblQuizSession

**/

CREATE   Procedure  [prcQuizSession_EndQuiz]
(
	@quizSessionID	varchar(50) 	-- unique GUID that identifies this toolbook quiz session
	, @duration	int		-- The duration in seconds of the quiz as messured by toolbook
	, @score	int		-- the score as mesured by toolbook
)

As
	--Begin Transaction
	Set NoCount On
	Set Xact_Abort On

------------------------------------------
-- Declerations
------------------------------------------
Declare   @intRetVal 	bit 		-- return value indicating sucess or failure
	, @intUserID 	int		-- user id
	, @intQuizID 	int		-- Quiz id
	, @intPassMark 	int		-- Pass Mark
	, @intUnitID 	int		-- Unit ID
	, @intModuleID 	int		-- Module ID

------------------------------------------
-- initations
------------------------------------------
Set @intUserID	   = dbo.udfGetUserIDBySessionID(@quizSessionID)
Set @intQuizID	   = dbo.udfGetQuizIDBySessionID(@quizSessionID)
Select @intUnitID  = (Select Top 1 UnitID From tblUser Where UserID = @intUserID)
Select @intModuleID= (Select Top 1 ModuleID From tblQuiz Where QuizID = @intQuizID)
Set @intPassMark   = dbo.udfQuiz_GetPassMark(@intUnitID,@intModuleID)


------------------------------------------
-- Checks that the Quiz has started - if it has not -> return false
-- and
-- Checks that the Quiz has not already ended - if it has -> return false
-- If all is OK then end the Quiz by recording end time, duration and score
------------------------------------------
If Exists
	( 
	Select
		QuizSessionID
	From
		tblQuizSession
	Where
		QuizSessionID=@quizSessionID
		--< Check that the Quiz has started >--
		And DateTimeStarted Is Not Null
		--< Check that the @quizSessionID has not already ended >--
		And DateTimeCompleted Is Null
	)


Begin --< it is ok to End, record End and return true >--
	Update
		[tblQuizSession]
	Set	
		[DateTimeCompleted]	= getutcdate()
		, [Duration]		= @duration
		, [QuizScore]		= @score
		, [QuizPassMark]	= @intPassMark

	Where
		[QuizSessionID]  	= @quizSessionID
	set @intRetVal = 1 --< return 1 indicates sucess >--


End
Else
Begin  -- it is NOT ok to End, return false
	set @intRetVal = 0
End


------------------------------------------
-- return
------------------------------------------

Select @intRetVal as ''OKToEnd''

--Commit Tran
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_StartQuiz]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcQuizSession_StartQuiz]
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcQuizSession_StartQuiz]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*Summary:
	-- Check that the quiz has not already been started
	-- if it has - return false
	-- if it has not, start it and return true
Returns:
	boolean (bit) OKToStart true = 1, false = 0
		
Called By: 
	ToolbookListener.cs
Calls:

Remarks:
	
Author:
Peter Kneale
Date Created: 10 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	


-----------
prcQuizSession_StartQuiz @QuizSessionID = ''4986F67F-FF29-4979-9A97-D7846839E0DB''


**/

CREATE Procedure  [prcQuizSession_StartQuiz]
(
	@QuizSessionID varchar(50)
)
	
As
	
	Set NoCount On
	Set Xact_Abort On
	Begin Tran
	
	
	------------------------------------------
	-- Declerations
	------------------------------------------
	Declare @RetVal bit 		-- Return value holding bit indicating success condition as described above
	
	------------------------------------------
	-- Check that the quiz has not already been started
	-- if it has - return false
	-- if it has not, start it and return true
	-- Start the quiz ( insert a start date )
	------------------------------------------
	If Exists 
		(
		Select 
			QuizSessionID
		From 
			tblQuizSession
		Where 
			QuizSessionID = @QuizSessionID 
		And 
			DateTimeStarted is Null
		)
	
		Begin 	
			-- it is ok to start, record start and return true
			--< do update >--
			Update 
				tblQuizSession
			Set
				DateTimeStarted =	GETUTCDATE()
			Where
				QuizSessionID = @QuizSessionID
			--< set return value >--
			Set @RetVal = 1
		End
	
	Else
	
		Begin  -- it is NOT ok to start, return false
			--< set return value >--
			Set @RetVal = 0
		End
	
Commit Tran

	------------------------------------------
	-- select SessionID
	------------------------------------------
	
	Select @RetVal as ''OKToStart''
	Return
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Warning]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_Warning]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_Warning]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		Name: prcReport_Warning
**
**		Called by:   
**      
**		Auth: Mark Donald
**		Date: 7 Dec 2009
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**    
*******************************************************************************/


CREATE PROCEDURE [prcReport_Warning]
(
	@organisationID int,
	@unitIDs varchar(8000),
	@courseIDs varchar(8000),
	@classificationID int,
	@warningPeriod int,
	@warningUnit varchar(2)
)
AS
	SET NOCOUNT ON;

	DECLARE @Units TABLE (UnitID INT PRIMARY KEY(UnitID))
	DECLARE @Courses TABLE(CourseID INT PRIMARY KEY(CourseID))
	DECLARE @CoursesWithAccess 	TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @tblCurrentAssignedModules TABLE (
		CourseID int,
		UserID int,
		UnitID int,
		ModuleID int,
		QuizFrequency int,
		QuizCompletionDate datetime
	)
	DECLARE @tblStartedModules TABLE (
		UserID int,
		ModuleID int,
		DateTimeCompleted datetime
	)
	
	INSERT INTO
		@Courses
			SELECT
				*
				FROM
					dbo.udfCsvToInt(@courseIDs)
	
	INSERT INTO
		@Units
			SELECT
				*
				FROM
					dbo.udfCsvToInt(@unitIDs)

	-- Get users for specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
		SELECT
			DISTINCT A.UserID, A.UnitiD 
			FROM 
				tblUser A 
				JOIN @Units B on A.UnitID = B.UnitID
				JOIN tblUnit C on B.UnitID = C.UnitID AND C.Active = 1
				LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
			WHERE
				A.Active = 1
				AND ((@classificationID =0) OR (classificationID = @classificationID))
				--If classification is Any (0), This will find users of any Custom Classification

	-- Get compliance rules for in-scope modules
	INSERT INTO @tblCurrentAssignedModules
		SELECT
			CourseID, UserID, um.UnitID, um.ModuleID, QuizFrequency, QuizCompletionDate
			FROM
				(SELECT
					tU.UserID, tU.UnitID, tM.ModuleID
					FROM
						dbo.tblUser tU
						INNER JOIN dbo.tblOrganisationCourseAccess tOCA ON tOCA.OrganisationID = tU.OrganisationID
						INNER JOIN dbo.tblCourse tC ON tC.CourseID = tOCA.GrantedCourseID
						INNER JOIN dbo.tblModule tM ON tM.CourseID = tC.CourseID AND tM.Active = 1
						LEFT OUTER JOIN dbo.tblUserModuleAccess tUsrMA ON tUsrMA.UserID = tU.UserID
							AND tUsrMA.ModuleID = tM.ModuleID
						LEFT OUTER JOIN dbo.tblUnitModuleAccess tUnitMA ON tUnitMA.UnitID = tU.UnitID
							AND tUnitMA.DeniedModuleID = tM.ModuleID
					WHERE
						tU.OrganisationID = @organisationID
						AND	tU.Active = 1
						AND tu.UnitID IS NOT NULL
						AND dbo.udfUserCourseComplete(tu.userid, tm.courseid) = 1
						AND ((tUnitMA.DeniedModuleID IS NULL AND tUsrMA.ModuleID IS NULL)
							OR tUsrMA.Granted=1)
				) um
				INNER JOIN (
					SELECT
						u.UnitID, m.CourseID, m.ModuleID,
						CASE
							WHEN (
								ur.QuizFrequency IS NULL
								AND ur.QuizCompletionDate IS NULL
								AND o.DefaultQuizCompletionDate IS NULL
							) THEN
								o.DefaultQuizFrequency
							ELSE
								ur.QuizFrequency
							END AS QuizFrequency,
						CASE
							WHEN (
								ur.QuizFrequency IS NULL
								AND ur.QuizCompletionDate IS NULL
								AND o.DefaultQuizCompletionDate IS NOT NULL
							) THEN
								o.DefaultQuizCompletionDate
							ELSE
								ur.QuizCompletionDate
							END AS QuizCompletionDate
						FROM
							tblOrganisationCourseAccess c
							INNER JOIN tblModule m ON m.CourseID = c.GrantedCourseID
							INNER JOIN tblOrganisation o ON o.OrganisationID = c.OrganisationID -- default compliance rules
							INNER JOIN tblUnit u ON u.OrganisationID = c.OrganisationID
							LEFT JOIN tblUnitRule ur ON ur.ModuleID = m.ModuleID AND ur.UnitID = u.unitID -- unit specific rules
						WHERE o.OrganisationID = @organisationID
				) umr ON umr.ModuleID  = um.ModuleID
					AND umr.UnitID = um.UnitID
					AND um.UnitID IN (SELECT DISTINCT UnitID FROM @users)
					AND um.UserID IN (SELECT DISTINCT UserID FROM @users)
					AND umr.CourseID IN (SELECT CourseID FROM @courses)

	-- Get module completion details
	INSERT INTO @tblStartedModules
		SELECT
			um.userID, um.moduleID, qs.DateTimeCompleted
			FROM
				@tblCurrentAssignedModules um
				INNER JOIN (
					SELECT
						um.userID, um.moduleID, max(DateTimeCompleted) AS DateTimeCompleted
						FROM
							@tblCurrentAssignedModules um
							INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
							INNER JOIN tblQuizSession qs ON qs.QuizID= q.quizID
								AND qs.userID = um.userID
								AND qs.DateTimeCompleted IS NOT NULL
						GROUP BY
							um.userID, um.moduleID
				) AS LastQuizDate ON
					LastQuizDate.userID = um.userID
					AND LastQuizDate.ModuleID = um.ModuleID
				INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
				INNER JOIN tblQuizSession qs ON
					qs.QuizID= q.quizID
					AND qs.userID = um.userID
					AND qs.DateTimeCompleted = LastQuizDate.DateTimeCompleted

	-- User/course combos where the courses are about to be marked incomplete due to module expiry
	BEGIN
		SELECT
			c.[name] as CourseName, HierarchyName AS UnitPathway, LastName, FirstName,
			ExternalID, Email, UserName, max(DateTimeCompleted) AS CompletionDate,
			min(isnull(QuizCompletionDate, dateadd(month, QuizFrequency, DateTimeCompleted))) AS ExpiryDate
			FROM
				@tblCurrentAssignedModules cam
				INNER JOIN @tblStartedModules sm ON sm.UserID = cam.UserID AND sm.ModuleID = cam.ModuleID,
				tblCourse c,
				tblUser u,
				tblUnitHierarchy h
			WHERE
				c.CourseID = cam.CourseID
				AND u.UserID = cam.UserID
				AND h.UnitID = cam.UnitID
			GROUP BY
				c.[name], HierarchyName,  LastName, FirstName, ExternalID, Email, Username
			HAVING
				min(isnull(
					QuizCompletionDate,
					dateadd(month, QuizFrequency, DateTimeCompleted)
				)) < CASE @warningUnit
						WHEN ''mm'' THEN
							dateadd(mm, @warningPeriod, getutcdate())
						ELSE
							dateadd(dd, @warningPeriod, getutcdate())
						END
			ORDER BY
				CourseName, UnitPathway, LastName, FirstName
	END
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_WarningGrandTotal]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_WarningGrandTotal]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_WarningGrandTotal]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		Name: prcReport_WarningGrandTotal
**		Desc: a copy of prcreport_Warning, but with select statements
**				altered to return a total, instead of a list of data.
**
**		Return values: Grand Total distinct users in Warning report
** 
**		Auth: Mark Donald
**		Date: 17 Nov 2009
**
*******************************************************************************/

CREATE       Procedure [prcReport_WarningGrandTotal]
(
	@organisationID		int,
	@unitIDs 		varchar(8000),
	@courseIDs 		varchar(8000),
	@classificationID int,
	@warningPeriod int,
	@warningUnit varchar(2)
)
AS
	SET NOCOUNT ON;

	DECLARE @Units TABLE (UnitID INT PRIMARY KEY(UnitID))
	DECLARE @Courses TABLE(CourseID INT PRIMARY KEY(CourseID))
	DECLARE @CoursesWithAccess 	TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @tblCurrentAssignedModules TABLE (
		CourseID int,
		UserID int,
		UnitID int,
		ModuleID int,
		QuizFrequency int,
		QuizCompletionDate datetime
	)
	DECLARE @tblStartedModules TABLE (
		UserID int,
		ModuleID int,
		DateTimeCompleted datetime
	)
	
	INSERT INTO
		@Courses
			SELECT
				*
				FROM
					dbo.udfCsvToInt(@courseIDs)
	
	INSERT INTO
		@Units
			SELECT
				*
				FROM
					dbo.udfCsvToInt(@unitIDs)

	-- Get users for specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
		SELECT
			DISTINCT A.UserID, A.UnitiD 
			FROM 
				tblUser A 
				JOIN @Units B on A.UnitID = B.UnitID
				JOIN tblUnit C on B.UnitID = C.UnitID AND C.Active = 1
				LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
			WHERE
				A.Active = 1
				AND ((@classificationID =0) OR (classificationID = @classificationID))
				--If classification is Any (0), This will find users of any Custom Classification

	-- Get compliance rules for in-scope modules
	INSERT INTO @tblCurrentAssignedModules
		SELECT
			CourseID, UserID, um.UnitID, um.ModuleID, QuizFrequency, QuizCompletionDate
			FROM
				(SELECT
					tU.UserID, tU.UnitID, tM.ModuleID
					FROM
						dbo.tblUser tU
						INNER JOIN dbo.tblOrganisationCourseAccess tOCA ON tOCA.OrganisationID = tU.OrganisationID
						INNER JOIN dbo.tblCourse tC ON tC.CourseID = tOCA.GrantedCourseID
						INNER JOIN dbo.tblModule tM ON tM.CourseID = tC.CourseID AND tM.Active = 1
						LEFT OUTER JOIN dbo.tblUserModuleAccess tUsrMA ON tUsrMA.UserID = tU.UserID
							AND tUsrMA.ModuleID = tM.ModuleID
						LEFT OUTER JOIN dbo.tblUnitModuleAccess tUnitMA ON tUnitMA.UnitID = tU.UnitID
							AND tUnitMA.DeniedModuleID = tM.ModuleID
					WHERE
						tU.OrganisationID = @organisationID
						AND	tU.Active = 1
						AND tu.UnitID IS NOT NULL
						AND dbo.udfUserCourseComplete(tu.userid, tm.courseid) = 1
						AND ((tUnitMA.DeniedModuleID IS NULL AND tUsrMA.ModuleID IS NULL)
							OR tUsrMA.Granted=1)
				) um
				INNER JOIN (
					SELECT
						u.UnitID, m.CourseID, m.ModuleID,
						CASE
							WHEN (
								ur.QuizFrequency IS NULL
								AND ur.QuizCompletionDate IS NULL
								AND o.DefaultQuizCompletionDate IS NULL
							) THEN
								o.DefaultQuizFrequency
							ELSE
								ur.QuizFrequency
							END AS QuizFrequency,
						CASE
							WHEN (
								ur.QuizFrequency IS NULL
								AND ur.QuizCompletionDate IS NULL
								AND o.DefaultQuizCompletionDate IS NOT NULL
							) THEN
								o.DefaultQuizCompletionDate
							ELSE
								ur.QuizCompletionDate
							END AS QuizCompletionDate
						FROM
							tblOrganisationCourseAccess c
							INNER JOIN tblModule m ON m.CourseID = c.GrantedCourseID
							INNER JOIN tblOrganisation o ON o.OrganisationID = c.OrganisationID -- default compliance rules
							INNER JOIN tblUnit u ON u.OrganisationID = c.OrganisationID
							LEFT JOIN tblUnitRule ur ON ur.ModuleID = m.ModuleID AND ur.UnitID = u.unitID -- unit specific rules
						WHERE o.OrganisationID = @organisationID
				) umr ON umr.ModuleID  = um.ModuleID
					AND umr.UnitID = um.UnitID
					AND um.UnitID IN (SELECT DISTINCT UnitID FROM @users)
					AND um.UserID IN (SELECT DISTINCT UserID FROM @users)
					AND umr.CourseID IN (SELECT CourseID FROM @courses)

	-- Get module completion details
	INSERT INTO @tblStartedModules
		SELECT
			um.userID, um.moduleID, qs.DateTimeCompleted
			FROM
				@tblCurrentAssignedModules um
				INNER JOIN (
					SELECT
						um.userID, um.moduleID, max(DateTimeCompleted) AS DateTimeCompleted
						FROM
							@tblCurrentAssignedModules um
							INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
							INNER JOIN tblQuizSession qs ON qs.QuizID= q.quizID
								AND qs.userID = um.userID
								AND qs.DateTimeCompleted IS NOT NULL
						GROUP BY
							um.userID, um.moduleID
				) AS LastQuizDate ON
					LastQuizDate.userID = um.userID
					AND LastQuizDate.ModuleID = um.ModuleID
				INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
				INNER JOIN tblQuizSession qs ON
					qs.QuizID= q.quizID
					AND qs.userID = um.userID
					AND qs.DateTimeCompleted = LastQuizDate.DateTimeCompleted

	BEGIN
		SELECT
			count(DISTINCT UserID) AS TotalDistinctUsers
			FROM
				-- User/course combos where the courses are about to be marked incomplete due to module expiry
				(SELECT
					cam.UserID, max(DateTimeCompleted) AS CompletionDate,
					min(isnull(QuizCompletionDate, dateadd(month, QuizFrequency, DateTimeCompleted))) AS ExpiryDate
					FROM
						@tblCurrentAssignedModules cam
						INNER JOIN @tblStartedModules sm ON sm.UserID = cam.UserID AND sm.ModuleID = cam.ModuleID
					GROUP BY
						cam.UserID
					HAVING
						min(isnull(
							QuizCompletionDate,
							dateadd(month, QuizFrequency, DateTimeCompleted)
						)) < CASE @warningUnit
								WHEN ''mm'' THEN
									dateadd(mm, @warningPeriod, getutcdate())
								ELSE
									dateadd(dd, @warningPeriod, getutcdate())
								END) AS warning_report
	END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetUnitNames]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUnit_GetUnitNames]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUnit_GetUnitNames]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary:
Convert unit IDs  array such as  ''''1,2,5,7'''' to Unit names array  ''''Unit 1, Unit 1 > Unit 2 > Unit 5 > Unit 7, Unit 1 > Unit 2 > Unit 5 > Unit 7''''

Called By:

Calls:

Remarks:


Author: Jack Liu
Date Created: 1 Apr 2005

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1

exec prcUnit_GetUnitNames ''''19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,84''''

**/
CREATE  Procedure [prcUnit_GetUnitNames]
(
	@unitIDs varchar(4000)
)
as
	declare	@unitNames varchar(8000)

	select @UnitIDs='',''+@UnitIDs+'',''

	--Convert unit IDs  ''''1,2,5,7'''' to Unit names ''''Unit 1, Unit 1 > Unit 2 > Unit 5 > Unit 7, Unit 1 > Unit 2 > Unit 5 > Unit 7''''


	--dbo.udfGetUnitPathway(u.UnitID) as Pathway,

	--char(13)+char(10)
	select @unitNames=IsNull(@unitNames+'' , '','''')+dbo.udfGetUnitPathway(tblUnit.UnitID)
	from tblUnit
	where charindex(@UnitIDs, '',''+cast(UnitID as varchar)+'','')>0
	order by Hierarchy 

	select @unitNames as UnitNames
' 
END
GO





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUSER_ArchiveUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUSER_ArchiveUsers]
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUSER_ArchiveUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		File: 
**		Name: Stored_Procedure_Name
**		Desc: Uses user defined function to return full unit path
**
**		This template can be customized:
**              
**		Return values:
** 
**		Called by:   
**              
**		Parameters:
**		Input							Output
**     ----------							-----------
**
**		Auth: Li Zhang
**		Date: July 2008
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		--------		--------				-------------------------------------------
**    
*******************************************************************************/
CREATE PROCEDURE [prcUSER_ArchiveUsers]
(@userIDs varchar(1000),
@updatedBy int)
AS

UPDATE tblUser set Active = ''False'', DateArchived = getutcdate(), updatedBy = @updatedBy,
DateUpdated = getutcdate() WHERE UserID in ( SELECT * FROM dbo.udfCsvToInt(@userIDs))
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Import]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_Import]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_Import]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Insert/Update the details of tblUser table
Parameters: 
		@userXML text The XML document containing the User data.
		@ID Integer ID of either the Organisation or Unit
		@hierachy VarChar(12) hierachy where the call to upload useres was made from. can only be Organisation or Unit.
		@userID Integer = null -- ID of user inporting the xmlData
Returns: 
		
		
Called By: 
		User.cs
Calls: 
		
Author: Li Zhang
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date		Description

*/

Create    Procedure [prcUser_Import]
(
	@userName nvarchar(200),
	@password nvarchar(100),
	@firstName nvarchar(200),
	@lastName nvarchar(200),
	@email nvarchar(255),
	@unitID int,
	@classificationName nvarchar(100),
	@classificationOption nvarchar(100),
	@externalID	nvarchar(100),
	@archival	bit,
	@isUpdate bit,
	@uniqueField int,
	@userID int,
	@orgID int
)

As

Set NoCount On

Set Xact_Abort On
Begin Transaction

	
	--Declarations
	Declare @uniqueField_Email int 
	Declare @uniuqeField_Username int

	set @uniqueField_Email = 1
	set @uniuqeField_Username = 2

	--update 
	IF (@isUpdate = 1)
	BEGIN
	
		IF (@uniqueField = @uniqueField_Email)
		BEGIN
			update tblUser
			set UserName = ISNULL(@userName,u.UserName),
				FirstName = ISNULL(@firstName, u.FirstName),
				LastName = ISNULL(@lastName, u.LastName),
				Password = ISNULL(@password, u.password),
				ExternalID = ISNULL(@externalID, u.externalID),
				UnitID = ISNULL(@unitID, u.UnitID),
				Active = Case @archival when 1 then 0 -- archive user = true
										when 0 then 1 -- archive user = false
										else u.Active end,--remain unchanged
				DateArchived = Case @archival when 1 then getutcdate()
												when 0 then null
												else u.DateArchived end,
				DateUpdated = getutcdate(),
				UpdatedBy = @userID
			FROM tblUser u
			WHERE
				u.Email = @email
				and 
				u.OrganisationID = @orgID
		END
	
		IF (@uniqueField = @uniuqeField_Username)
		BEGIN
			update tblUser
			set FirstName = ISNULL(@firstName, u.FirstName),
				LastName = ISNULL(@lastName, u.LastName),
				Password = ISNULL(@password, u.password),
				Email = ISNULL(@Email, u.Email),
				ExternalID = ISNULL(@externalID, u.externalID),
				UnitID = ISNULL(@unitID, u.UnitID),
				Active = Case @archival when 1 then 0 
										when 0 then 1
										else u.Active end,
				DateArchived = Case @archival when 1 then getutcdate()
												when 0 then null
												else u.DateArchived end,
				DateUpdated = getutcdate(),
				UpdatedBy = @userID
			FROM tblUser u
			WHERE
				u.Username = @username
				and 
				u.OrganisationID = @orgID
		END
	END
	IF @isUpdate = 0
	BEGIN
		insert into tblUser
				(
					Username,
					Password,
					Firstname,
					Lastname,
					Email,
					ExternalID,
					OrganisationID,
					UnitID,
					CreatedBy,
					Active,
					DateArchived,
					NewStarter
				) values
				(
					@username,
					@password,
					@firstname,
					@lastname,
					@email,
					@externalID,
					@orgID,
					@unitID,
					@userID,
					case @archival when 1 then 0 else 1 end,
					case @archival when 1 then getutcdate() else null end,
					1
				)
		declare @t int
		select @t = UserID from tblUser where Username = @username and Email = @email

		--Insert the classification data into the tblUserCalssification table.
		Insert Into tblUserClassification
		(
			UserID,
			ClassificationID
		)
		select
			@t,
			cls.ClassificationID
		From
			tblClassificationType As c, tblClassification As cls
		where c.Name = @classificationName
					And (c.OrganisationID = @orgID)
					and cls.ClassificationTypeID = c.ClassificationTypeID
					AND cls.Value = @classificationOption
					And (cls.Active = 1)
					
		
		--insert course licencing for the imported user
		INSERT INTO tblCourseLicensingUser(CourseLicensingID, UserID) 
			SELECT 		DISTINCT 
				tblCourseLicensing.CourseLicensingID, 
				vwUserModuleAccess.UserID
				
			FROM
				tblCourseLicensing 
				INNER JOIN vwUserModuleAccess ON tblCourseLicensing.CourseID = vwUserModuleAccess.CourseID 
					AND tblCourseLicensing.OrganisationID = vwUserModuleAccess.OrganisationID 
				INNER JOIN tblUser ON vwUserModuleAccess.UserID = tblUser.UserID 
				LEFT OUTER JOIN	tblCourseLicensingUser ON tblUser.UserID = tblCourseLicensingUser.UserID 
					AND tblCourseLicensing.CourseLicensingID = tblCourseLicensingUser.CourseLicensingID
			WHERE 
				tblCourseLicensing.DateStart <= GETUTCDATE() 
				AND tblCourseLicensing.DateEnd >= GETUTCDATE() 
				AND tblCourseLicensingUser.CourseLicensingID IS NULL 
				AND tblUser.userid = @t


		-- Get ProfilePeriodIDs for Organisation
		create table #ProfilePeriod
		(
			ProfilePeriodID int
		)
		
		insert into #ProfilePeriod
			select ProfilePeriodID 
			from tblProfilePeriod  pp 
			join tblprofile p 
			on pp.profileid = p.profileid 
			where p.organisationid = @orgID
		
		
		-- insert user into profileperiodaccess against all profileperiodids
		-- for the organisation
		insert into tblUserProfilePeriodAccess
		select ProfilePeriodID, @t, 0 from #ProfilePeriod

		drop table #ProfilePeriod

		-- Get Policies for Organisation
		create table #Policy
		(
			PolicyID int
		)
		
		insert into #Policy
			select PolicyID
			from tblPolicy 
			where OrganisationID = @orgID
			and deleted = 0

		-- insert user  policy access for all policies associated with organisation
		insert into tbluserpolicyaccess (PolicyID, UserID,Granted)
		select PolicyID, @t, 0 from #Policy
		
		-- insert user policy acceptance for all policies for this org
		insert into tblUserPolicyAccepted (PolicyID, UserID, Accepted)
		select PolicyID, @t, 0 from #Policy

		drop table #Policy
	END
commit
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblExpiredNewContent]') AND type in (N'U'))
DROP TABLE [tblExpiredNewContent]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[tblExpiredNewContent]') AND type in (N'U'))
BEGIN
CREATE TABLE [tblExpiredNewContent](
	[ExpiredContentID] [int] IDENTITY(1,1) NOT NULL,
	[ModuleID] [int] NOT NULL,
	[OrganisationID] [int] NOT NULL,
	[UserID] [int] NOT NULL,
 CONSTRAINT [PK_tblExpiredNewContent] PRIMARY KEY CLUSTERED 
(
	[ExpiredContentID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetOne]    Script Date: 07/05/2011 13:30:01 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

ALTER Procedure [dbo].[prcUser_GetOne]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror('The Parameter @userID was null.  @userID does not accept Null values.', 16, 1)
	Return
End

	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUTCtoDaylightSavingTime(LastLogin, OrganisationID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies,
		EmailInOrgDomain
	From
		tblUser
	Where
		UserID = @userID
		


GO

/****** Object:  StoredProcedure [dbo].[prcUser_GetOneWithOwnTime]    Script Date: 07/05/2011 13:31:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Summary: Gets the details of one User
Parameters: @userID integer
Returns: UserID, FirstName, LastName, UserName, Password, Email, ExternalID, OrganisationID, UnitID, UserTypeID, Active, CreatedBy, DateCreated, UpdatedBy, DateUpdated

Called By: User.cs
Calls: None

Remarks: Raises an error if the parameter is null

Author: Gavin Buddis
Date Created: 10th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

ALTER Procedure [dbo].[prcUser_GetOneWithOwnTime]
(
	@userID Integer = null -- User ID
)

As
Set NoCount On

If @userID Is Null
Begin
	Raiserror('The Parameter @userID was null.  @userID does not accept Null values.', 16, 1)
	Return
End

	Select
		UserID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		ExternalID,
		OrganisationID,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateCreated, OrganisationID) as DateCreated,
		UpdatedBy,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, OrganisationID) as DateUpdated,
		dbo.udfUserUTCtoDaylightSavingTime(LastLogin, @userID) as LastLogin,
		TimeZoneID,
		DelinquencyManagerEmail,
		NotifyOfPendingDelinquencies,
		EmailInOrgDomain
	From
		tblUser
	Where
		UserID = @userID

		
		

GO
/****** Object:  StoredProcedure [dbo].[prcUser_Update]    Script Date: 07/05/2011 14:18:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[prcUser_Update] (
	@userID Integer = Null,
	@unitID Integer = Null,
	@firstName nvarchar(50) = Null,
	@lastName nvarchar(50) = Null,
	@userName nvarchar(100) = Null, 
	@email nvarchar(100) = null,
	@active bit = null,	
	@userTypeID Integer = Null,
	@updatedByUserID Integer = Null,
	@dateUpdated datetime = Null,
	@password nvarchar(50) = Null,
	@oldPassword nvarchar(50) = Null,
	@externalID nvarchar(50) = Null,
	@TimeZoneID Integer = Null,
	@DelinquencyManagerEmail nvarchar(100) = Null,
	@NotifyOfPendingDelinquencies bit = Null,
	@EmailInOrgDomain nvarchar(100) = Null
)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @OrgTimeZone Integer -- Holds the ORG timezone
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @UpdatedByUserTypeID Integer -- Holds the UserTypeID for the Updating user.
	Declare @blnChangePassword bit			-- Boolean value to indentify update of the password
	Declare @strCurrentPassword nvarchar(50) -- Holds the current password in the DB for this user
	Declare @strCurrentUserName nvarchar(100) -- Holds the current username in the DB for this user
	Declare @strCurrentEmail nvarchar(100) -- Holds the current email in the DB for this user
	Declare @organisationID Integer -- Used to set the OrgID to null when updating a SALT Administrator
	Declare @dteCurrentDateUpdated datetime -- Holds the current dateupdated in the DB for this user
	
	-- Initialise variables
	Set @strErrorMessage = ''
	Set @intErrorNumber = 0
	Set @blnChangePassword = 0

	-- PARAMETER VALIDATION
	--==============================================================

	-- Verify @UnitID and OrgID
	Select
		@organisationID = OrganisationID
	From 
		tblUser
	Where
		UserID = @userID

	--==================================================
	-- If 0 passed in (for a SALT Admin), insert nulls for 
	-- Unit and Org IDs
	if (@UnitID = 0)
	begin
		Set @UnitID = null
		Set @OrganisationID = null
	end
	
		Select
		@OrgTimeZone = TimeZoneID
	From 
		tblOrganisation
	Where
		OrganisationID = @OrganisationID
	
	if (@OrgTimeZone = @TimeZoneID)
	begin
		Set @TimeZoneID = null
	end
	
--Missing or Null parameter {0} in stored procedure prcUser_Update
	--Validate Parameter @userID
	If(@userID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @userID in stored procedure prcUser_Update'
		Goto Finalise
	End
	
	-- If user type is not SALT Administrator, validate parameter @UnitID
	If(@userTypeID <> 1)
	Begin
		If(@unitID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = 'Missing or Null parameter @unitID in stored procedure prcUser_Update'
			Goto Finalise
		End
	End

	--Validate Parameter @firstName
	If(@firstName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @firstName in stored procedure prcUser_Update'
		Goto Finalise
	End

	--Validate Parameter @lastName
	If(@lastName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @lastName in stored procedure prcUser_Update'
		Goto Finalise

	End
	
	--Validate Parameter @userName
	If(@userName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @userName in stored procedure prcUser_Update'
		Goto Finalise
	End
	
	--Validate Parameter @email
	If(@email Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @email in stored procedure prcUser_Update'
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @active in stored procedure prcUser_Update'
		Goto Finalise
	End

	--Validate Parameter @userTypeID
	If(@userTypeID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @userTypeID in stored procedure prcUser_Update'
		Goto Finalise
	End

	--Validate Parameter @updatedByUserID
	If(@updatedByUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @updatedByUserID in stored procedure prcUser_Update'
		Goto Finalise
	End

	--Validate Parameter @dateUpdated
	If(@dateUpdated Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @dateUpdated in stored procedure prcUser_Update'
		Goto Finalise
	End

	-- Validate User Exists
	--=========================================================
	If Not Exists(Select * From tblUser Where UserID = @userID)
	Begin
		Set @intErrorNumber = 1
		Set @strErrorMessage = 'This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.'
		Goto Finalise
	End 
	
	-- If a unit was specified make sure it exists
	--=========================================================
	If (@unitID Is Not Null)
	Begin
		If Not Exists(Select * From tblUnit Where UnitID = @unitID)
		Begin
			Set @intErrorNumber = 11
			Set @strErrorMessage = 'The specified unit could be found or may not be active.'
			Goto Finalise
		End
	End

	-- Integrity Constraint
	--=========================================================
	Select 
		@dteCurrentDateUpdated = DateUpdated
	from 
		tblUser
	Where 
		UserID = @userID


	/*If (DateDiff(s, @dteCurrentDateUpdated, @dateUpdated) <> 0)
	Begin
		Set @intErrorNumber = 7
		Set @strErrorMessage = 'This record has already been updated by another user, please refresh your screen. If the problem persists please contact your administrator.'
		Goto Finalise
	End */
	

	-- Validate Passwords
	--=======================
	
	-- get Updating User, UserTypeID
	Select 
		@UpdatedByUserTypeID = UserTypeID 
	from 
		tblUser
	Where
		UserID = @updatedByUserID
	
	if(@UpdatedByUserTypeID = 4)
	Begin
		
		-- SALT User
		If (@password Is Not Null or @oldPassword Is Not Null)
		Begin
			If(@password Is Null)
			Begin
				Set @intErrorNumber = 5
				Set @strErrorMessage = 'Missing or Null parameter @password in stored procedure prcUser_Update'
				Goto Finalise
			End
			
			If(@oldPassword Is Null)
			Begin
				Set @intErrorNumber = 5
				Set @strErrorMessage = 'Missing or Null parameter @oldPassword in stored procedure prcUser_Update'
				Goto Finalise
			End
		
			-- Get the current password in the DB
			Select 
				@strCurrentPassword = Password
			From 
				tblUser
			Where 
				UserID = @userID

			-- Ensure old password match current password otherwise error
			if(@oldPassword <> @strCurrentPassword)
			Begin
				Set @intErrorNumber = 4
				Set @strErrorMessage = 'Your old password was entered incorrectly so the user details have not been saved. '
				Set @strErrorMessage = @strErrorMessage + 'Please try again and if the problem persists please contact your administrator.'
				Goto Finalise
			End 
				
			Set @blnChangePassword = 1
		End 		
	End
	else
	Begin
		-- Administrator
		-- if there is a value in @oldPassword then admin is attempting to update their own password
		if(@oldPassword Is Not Null)
		Begin
			-- Get the current password in the DB
			Select 
				@strCurrentPassword = Password
			From 
				tblUser
			Where 
				UserID = @userID

			-- Ensure old password match current password otherwise error
			if(@oldPassword <> @strCurrentPassword)
			Begin
				Set @intErrorNumber = 4
				Set @strErrorMessage = 'Your old password was entered incorrectly so the user details have not been saved. '
				Set @strErrorMessage = @strErrorMessage + 'Please try again and if the problem persists please contact your administrator.'
				Goto Finalise
			End 
				
			Set @blnChangePassword = 1		
		End

		If(@password Is Not Null)
		Begin
			Set @blnChangePassword = 1
		End 
	End

	-- Validate Permisions
	--========================================
	if(@UpdatedByUserTypeID = 4)
	Begin
		-- Salt User can only update themselves
		if(@UpdatedByUserID <> @UserID)
		Begin
			Set @intErrorNumber = 41
			Set @strErrorMessage = 'You do not have the permissions required to update this user.'
			Goto Finalise
		End 
	End
	

	-- Validate Unique UserName
	--========================================
	Select
		@strCurrentUserName = UserName
	From 
		tblUser
	Where
		UserID = @userID
	
	-- Check for uniqueness if the username is changing
	if(@strCurrentUserName <> @userName)
	Begin
		If(@userTypeID <> 1)
		begin
			if Exists(Select * from tblUser where UserName = @userName and (organisationID=@organisationID or organisationID is null))
			Begin
				Set @intErrorNumber = 42
				Set @strErrorMessage = @userName
				Goto Finalise
			End 
		end
		else
		begin
			if Exists(Select * from tblUser where UserName = @userName)
			Begin
				Set @intErrorNumber = 42
				Set @strErrorMessage = @userName
				Goto Finalise
			End 
		end
	End 


	-- Validate Unique UserName
	--========================================
	Select
		@strCurrentEmail = Email
	From 
		tblUser
	Where
		UserID = @userID

	-- Check for uniqueness if the email address is changing
	if(@strCurrentEmail <> @email)
	If Exists(Select * From tblUser Where Email = @email)
	Begin
		Set @intErrorNumber = 43
		Set @strErrorMessage = @email
		Goto Finalise
	End


	-- only update if the user is moved to a new unit (so new unit is diff from the current unit)
	if (select unitid from tblUser where userid=@userid) <> @unitid
	begin


	-- update the profile access of the user 
	-- give the user access to profiles for the selected unit
	update tbluserprofileperiodaccess set granted = 1		
		where	userid = @userid 
			and profileperiodid in (
				select profileperiodid from tblunitprofileperiodaccess where 
				unitid = @unitID and granted = 1)
				
    -- give the user access to the policies for the selected unit.
	/*update tbluserpolicyaccess set granted = 1		
		where	userid = @userid
			and policyid in (
				select policyid from tblunitpolicyaccess where 
				unitid = @unitID and granted = 1)*/

	update upa1
	set upa1.granted = upa2.granted
	from tbluserpolicyaccess upa1
	inner join tblunitpolicyaccess upa2
	on upa1.policyid=upa2.policyid
	inner join tblPolicy p
	on upa1.policyid=p.policyid
	where
	upa1.userid=@userid and upa2.unitid=@unitid
	and p.deleted=0

	end	
	


	-- Execute Update
	--===============================================================	
	-- Update the record in tblUser
	if(@blnChangePassword = 1)
	Begin
		-- Update with password change
		Update tblUser
		Set 
			FirstName = @firstName,
			LastName = @lastName,
			UserName = @userName,
			Password = @password,
			Email = @email,
			OrganisationID = @organisationID,
			UnitID = @unitID,
			UserTypeID = @userTypeID,
			Active = @active,
			UpdatedBy = @updatedByUserID,
			DateUpdated = getutcDate(),
			ExternalID = @externalID,
			TimeZoneID = @TimeZoneID,
			DelinquencyManagerEmail = @DelinquencyManagerEmail,
			NotifyOfPendingDelinquencies = @NotifyOfPendingDelinquencies,
			EmailInOrgDomain = @EmailInOrgDomain
		Where
			UserID = @userID
	End			
	Else
	Begin
		Update tblUser
		Set 
			FirstName = @firstName,
			LastName = @lastName,
			UserName = @userName,
			Email = @email,
			UnitID = @unitID,
			UserTypeID = @userTypeID,
			Active = @active,
			UpdatedBy = @updatedByUserID,
			DateUpdated = getutcDate(),
			ExternalID = @externalID,
			TimeZoneID = @TimeZoneID,
			DelinquencyManagerEmail = @DelinquencyManagerEmail,
			NotifyOfPendingDelinquencies = @NotifyOfPendingDelinquencies,
			EmailInOrgDomain = @EmailInOrgDomain
		Where
			UserID = @userID
	End
	

	update tblUser set DateArchived = getutcdate() where Active = 0 and DateArchived IS NULL AND UserID = @userID
	update tblUser set DateArchived = null where Active = 1 and NOT(DateArchived IS NULL) AND UserID = @userID
	
	
	-- update the user current status
	declare courseIDCursor cursor
	for 
	select
	grantedcourseid
	from
	tblOrganisationCourseAccess oca
	where
	organisationid = (select organisationid from tblUser where userid=@userid)


	/*-- update course status for users
	declare @intOldCourseStatus int
	declare @intNewCourseStatus int
	declare @courseID int
	declare @moduleID int


	open courseIDCursor

	fetch next from courseIDCursor into @courseid
	while (@@FETCH_STATUS <> -1) 
	begin 
		if (@@FETCH_STATUS <> -2) 
		begin 
			exec @intOldCourseStatus = prcUserCourseStatus_GetStatus @courseID, @userID 
			exec @intNewCourseStatus = prcUserCourseStatus_Calculate @courseID, @userID

			--select * from tbluser where userid=@userid

			--select * from tblUsercoursestatus where userid=@userid and courseid=@courseid 

			print 'CourseID: ' + convert(varchar(10), @courseid)
			print 'Old Course Status : ' + convert(varchar(10), @intOldCourseStatus)
			print 'New Course Status : ' + convert(varchar(10), @intNewCourseStatus)

			if (@intOldCourseStatus <> -1) and (@intOldCourseStatus <> @intNewCourseStatus) 
			begin
			print 'Insert'

			set @moduleID = (select top 1 m.moduleId from tblModule m where CourseID = @courseID)
			--print 'ModuleID: ' + convert(varchar(10), @moduleid)  + '\n'
			exec prcUserCourseStatus_Insert @userID, @ModuleID, @intNewCourseStatus 
			end
		end 

		fetch next from courseIDCursor into @courseid
	end 

	close courseIDCursor deallocate courseIDCursor*/


	
	-- Set the error message to successfull
	Set @strErrorMessage = 'Successfully Updated'

	-- Finalise the procedure
	Goto Finalise


Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
	@intErrorNumber As 'ErrorNumber',
		@strErrorMessage As 'ErrorMessage'
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As 'ErrorNumber',
		@strErrorMessage As 'ErrorMessage'
End


GO

/****** Object:  StoredProcedure [dbo].[prcUser_Create]    Script Date: 07/05/2011 14:22:13 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*Summary:
	Inserts a new user.

Parameters:
	@organisationID		(Mandatory)
	@unitID 			(Mandatory)
	@firstName 			(Mandatory)
	@lastName			(Mandatory)
	@userName			(Mandatory)
	@email				(Mandatory)
	@active			(Mandatory)
	@userTypeID			(Mandatory)
	@actionUserID			(Mandatory)
	@password			(Mandatory)

Returns:
	@intErrorNumber As 'ErrorNumber',
	@strErrorMessage As 'ErrorMessage'
		
Called By: 
	User.cs.

Calls:
	Nothing

Assumptions:
	The majority of business logic related to password
	lengths, confirmation passwords, valid emails etc. 
	are implemented through the UI.
	Assumption is that the parameters when passed in 
	contain valid data.

Remarks:
	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	7. IntegrityConstraintException
	10. BusinessServiceException (General)		


Author: Peter Vranich
Date Created: 20th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	15/09/2005		User name is only unique per organisation

**/
ALTER  Procedure [dbo].[prcUser_Create]
(
	@organisationID Integer = Null,
	@unitID Integer = Null,
	@firstName nvarchar(50) = Null,
	@lastName nvarchar(50) = Null,
	@userName nvarchar(100) = Null,
	@email nvarchar(100) = null,
	@active bit = null,	
	@userTypeID Integer = Null,
	@actionUserID Integer = Null,
	@password nvarchar(50) = Null,
	@externalID nvarchar(50) = Null,
	@TimeZoneID Integer = Null,
	@DelinquencyManagerEmail nvarchar(100) = Null,
	@NotifyOfPendingDelinquencies bit = Null,
	@EmailInOrgDomain nvarchar(100) = Null

)

As

Set NoCount On
Set Xact_Abort On

Begin Transaction

	-- Declarations
	Declare @strErrorMessage Varchar(200) -- Holds the error message
	Declare @intErrorNumber Integer -- Holds the error number
	Declare @UserID integer -- Holds the UserID once created
	
	-- Initialise variables
	Set @strErrorMessage = ''
	Set @intErrorNumber = 0

	-- PARAMETER VALIDATION
	--==============================================================

	-- If user type is not SALT Administrator, check that a OrgID and UnitID has been supplied
	If(@userTypeID <>1)
	Begin
		If(@organisationID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = 'Missing or Null parameter @organisationID in stored procedure prcUser_Create'
			Goto Finalise
		End
		
		--Validate Parameter @unitID
		If(@unitID Is Null)
		Begin
			Set @intErrorNumber = 5
			Set @strErrorMessage = 'Missing or Null parameter @unitID in stored procedure prcUser_Create'
			Goto Finalise
		End
	End

	--Validate Parameter @firstName
	If(@firstName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @firstName in stored procedure prcUser_Create'
		Goto Finalise
	End

	--Validate Parameter @lastName
	If(@lastName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @lastName in stored procedure prcUser_Create'
		Goto Finalise
	End
	
	--Validate Parameter @userName
	If(@userName Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @userName in stored procedure prcUser_Create'
		Goto Finalise
	End
	
	--Validate Parameter @email
	If(@email Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @email in stored procedure prcUser_Create'
		Goto Finalise
	End

	--Validate Parameter @active
	If(@active Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @active in stored procedure prcUser_Create'
		Goto Finalise
	End

	--Validate Parameter @userTypeID
	If(@userTypeID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @userTypeID in stored procedure prcUser_Create'
		Goto Finalise
	End

	--Validate Parameter @createdByUserID
	If(@actionUserID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = 'Missing or Null parameter @updatedByUserID in stored procedure prcUser_Create'
		Goto Finalise
	End
	
	-- If a unit was specified make sure it exists
	--=========================================================
	If (@unitID Is Not Null)
	Begin
		If Not Exists(Select * From tblUnit Where UnitID = @unitID)
		Begin
			Set @intErrorNumber = 1
			Set @strErrorMessage = 'The specified unit could be found or may not be active.'
			Goto Finalise
		End
	End
	
	If(@userTypeID <>1)
	begin	
		-- User name is unique per organisation
		If Exists(Select * From tblUser Where Username = @userName and (organisationID=@organisationID or organisationID is null))
		Begin
			Set @intErrorNumber = 4
			Set @strErrorMessage = @userName
			Goto Finalise
		End
	end
	else
	begin	
		If Exists(Select * From tblUser Where Username = @userName)
		Begin
			Set @intErrorNumber = 4
			Set @strErrorMessage = @userName
			Goto Finalise
		End
	end
	

	If Exists(Select * From tblUser Where Email = @email)
	Begin
		Set @intErrorNumber = 41
		Set @strErrorMessage = 'The email address ' + @email + ' already exists.  <BR>Please choose another email address.'
		Goto Finalise
	End
	
	Insert Into tblUser
	(
		OrganisationID,
		FirstName,
		LastName,
		UserName,
		Password,
		Email,
		UnitID,
		UserTypeID,
		Active,
		CreatedBy,
		DateCreated,
		ExternalID,
		NewStarter,
		TimeZoneID,DelinquencyManagerEmail,NotifyOfPendingDelinquencies,
		EmailInOrgDomain

	)
	Values
	(
		@organisationID,
		@firstName,
		@lastName,
		@userName,
		@password,
		@email,
		@unitID,
		@userTypeID,
		@active,
		@actionUserID,
		GETUTCDATE(),
		@externalID, -- http://bugs.salt.devbdw.com/edit_bug.aspx?id=274
		1,
		@TimeZoneID, @DelinquencyManagerEmail, @NotifyOfPendingDelinquencies,
		@EmailInOrgDomain
	)
	
	update tblUser set DateArchived = getutcdate() where Active = 0 and DateArchived IS NULL AND UserID = @@Identity
	update tblUser set DateArchived = null where Active = 1 and NOT(DateArchived IS NULL) AND UserID = @@Identity
	
	-- Set the error message to successfull
	Set @strErrorMessage = @@Identity
	Set @UserID = @@Identity


	-- Get ProfilePeriodID's for Organisation
	create table #ProfilePeriod
	(
		ProfilePeriodID int
	)
	
	insert into #ProfilePeriod
		select ProfilePeriodID 
		from tblProfilePeriod  pp 
		join tblprofile p 
		on pp.profileid = p.profileid 
		where p.organisationid = @OrganisationID
	
	
	-- insert user into profileperiodaccess against all profileperiodid's
	-- for the organisation
	insert into tblUserProfilePeriodAccess
	select 
		pp.ProfilePeriodID, 
		@UserID,
		uppa.granted
	from #ProfilePeriod pp
	join tblUnitProfilePeriodAccess uppa 
	on uppa.ProfilePeriodID = pp.ProfilePeriodID
	where uppa.UnitID = @UnitID

	drop table #ProfilePeriod

	-- Get Policies for Organisation
	create table #Policy
	(
		PolicyID int,
		Granted bit
	)
	
	insert into #Policy
		select p.PolicyID, 
		case when (select distinct granted from tblUnitPolicyAccess where unitID = @unitID and policyid = p.policyid) is null then 0 
		else (select distinct granted from tblUnitPolicyAccess where unitID = @unitID and policyid = p.policyid) end
		from tblPolicy p where
		OrganisationID = @OrganisationID
		and deleted = 0


	-- insert user into policy for all policy's associated with organisation
	insert into tblUserPolicyAccepted (PolicyID, UserID, Accepted)
	select PolicyID, @UserID, 0 from #Policy
	
	-- insert user into policyaccess for all policies
	insert into tblUserPolicyAccess (PolicyID, UserID, Granted)
	select PolicyID, @UserID, Granted  from #Policy

	drop table #Policy

	-- Finalise the procedure
	Goto Finalise


Finalise:
If(@intErrorNumber > 0)
Begin
	Rollback Transaction
	Select
		@intErrorNumber As 'ErrorNumber',
		@strErrorMessage As 'ErrorMessage'
End
Else
Begin
	Commit Transaction
	Select
		@intErrorNumber As 'ErrorNumber',
		@strErrorMessage As 'ErrorMessage'
End




-- Wednesday, 6 July 2011 - 11:22:26 AM - Page title of Edit Daylight Saving Rule screen
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'lblPageTitle'), 
					'Edit Daylight Saving Rule', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]
					
					
					
					
-- Wednesday, 6 July 2011 - 12:06:36 PM -- validators for Edit Daylight Saving Rule screen
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorTimezone', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:06:37 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorTimezone'), 
					'You must specify the Timezone name.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:01 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorFirstYearStart', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:01 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorFirstYearStart'), 
					'You must specify the First Year Start.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:22 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorLastYearStart', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:22 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorLastYearStart'), 
					'You must specify the Last Year Start.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:45 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorOffset', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:07:45 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorOffset'), 
					'You must specify the Offset.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:08:06 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorTimeStart', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:08:06 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorTimeStart'), 
					'You must specify the Start Time.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:08:33 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('validatorTimeEnd', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


-- Wednesday, 6 July 2011 - 12:08:33 PM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorTimeEnd'), 
					'You must specify the End Time.', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]



-- Wednesday, 6 July 2011 - 12:20:59 PM
UPDATE tblLangValue set LangEntryValue = 'Last year rule ends: ', DateModified = getdate() 
					WHERE LangID = (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU')
						AND LangInterfaceID = (SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx')
						AND LangResourceID = (SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'lblLastYearStart')
				


-- Wednesday, 6 July 2011 - 12:21:11 PM
UPDATE tblLangValue set LangEntryValue = 'You must specify the Last Year End.', DateModified = getdate() 
					WHERE LangID = (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU')
						AND LangInterfaceID = (SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx')
						AND LangResourceID = (SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'validatorLastYearStart')




-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'AcceptPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'AcceptPolicy', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'action') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'action', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'assign') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'assign', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'bg-BG') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'bg-BG', 'language name', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnAdd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnAdd', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnAddPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnAddPolicy', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnArchiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnArchiveUsers', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnAssign') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnAssign', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnBack') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnBack', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnBackToMain') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnBackToMain', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnCancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnCancel', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnCommitImport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnCommitImport', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnCreateProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnCreateProfile', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnDeleteFuturePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnDeleteFuturePeriod', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnFind') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnFind', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnFinish') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnFinish', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnGenerate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnGenerate', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnGenerateEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnGenerateEmail', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnHome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnHome', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnImport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnImport', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnLogin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnLogin', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnMove') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnMove', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnMoveDown') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnMoveDown', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnMoveUp') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnMoveUp', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnNew') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnNew', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnNewLicensePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnNewLicensePeriod', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnNewProfilePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnNewProfilePeriod', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnNext') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnNext', 'button', '&gt; is >', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnOrgEditDaylightCancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnOrgEditDaylightCancel', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnOrgEditDaylightSave') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnOrgEditDaylightSave', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnOrgMailSetupCancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnOrgMailSetupCancel', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnOrgMailSetupSave') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnOrgMailSetupSave', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnPopulateAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnPopulateAll', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnPrev') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnPrev', 'button', '&lt; is <', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnPreview') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnPreview', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnPreviewContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnPreviewContent', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnPublishContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnPublishContent', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnRecover') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnRecover', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnReset') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnReset', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnResetStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnResetStatus', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnRunModuleStatusUpdate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnRunModuleStatusUpdate', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnRunReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnRunReport', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSave') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSave', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSave_Click') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSave_Click', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSaveAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSaveAll', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSaveProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSaveProfile', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSearch') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSearch', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnSendEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSendEmail', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowAddedUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowAddedUsers', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowComplianceRules') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowComplianceRules', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowDetectedError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowDetectedError', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowUnitAdministrators') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowUnitAdministrators', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowUnits', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowUpdatedUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowUpdatedUsers', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnShowUserDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnShowUserDetails', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnUpload', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnUploadCSV') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnUploadCSV', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnUploadMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnUploadMsg', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'btnUploadXML') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnUploadXML', 'button', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butCancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butCancel', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butDelete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butDelete', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butEdit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butEdit', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butNew') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butNew', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butRamdonPwd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butRamdonPwd', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butRunAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butRunAll', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'butSaveAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'butSaveAll', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'capTblOrgMailSetupTop') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'capTblOrgMailSetupTop', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'capTblOrgSetupBottom') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'capTblOrgSetupBottom', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cboResetUserRange.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cboResetUserRange.1', 'dropdown item', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cboResetUserRange.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cboResetUserRange.2', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cboResetUserRange.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cboResetUserRange.3', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkAddUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkAddUser', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkAdminSub') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkAdminSub', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkAssignAllUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkAssignAllUsers', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkCertLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkCertLogo', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkClearAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkClearAll', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkEnabled') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkEnabled', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkIncludeLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkIncludeLogo', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkIncludeNewUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkIncludeNewUser', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkIncludeNewUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkIncludeNewUsers', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkSelctAll.Deselect') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkSelctAll.Deselect', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkSelctAll.Deselected') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkSelctAll.Deselected', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkSelctAll.Select') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkSelctAll.Select', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkSelectAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkSelectAll', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkSelectAll.Deselect') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkSelectAll.Deselect', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkTopLevel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkTopLevel', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'chkUserStatus.ToolTip') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'chkUserStatus.ToolTip', 'checkbox', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnActive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnActive', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnAssign') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnAssign', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnCancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnCancel', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnEmail', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnExpiryWarning') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnExpiryWarning', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnFirstName', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnInactive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnInactive', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnLastEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnLastEmail', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnLastName', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnLesson', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnLicensePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnLicensePeriod', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnLicenses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnLicenses', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnName', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnNoUsersAffected') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnNoUsersAffected', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnOrgRep') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnOrgRep', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnQuiz', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnRecordNotExist') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnRecordNotExist', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnReturn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnReturn', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnReturnUnitDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnReturnUnitDetails', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnSaltRep') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnSaltRep', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnSave') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnSave', '', '', 1, null, null, getdate(), null, null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnSelect') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnSelect', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnSelectDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnSelectDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnStatus', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnUnitName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnUnitName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnUserName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cmnUserWarning') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cmnUserWarning', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ConfirmExit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ConfirmExit', 'confirm message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ConfirmMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ConfirmMessage', 'confirm message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ConfirmUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ConfirmUpload', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Correct') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Correct', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CorrectAnswer') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CorrectAnswer', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CourseStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CourseStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CPDReturn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CPDReturn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cpvOldPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cpvOldPassword', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cpvPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cpvPassword', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Create') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Create', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critActive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critActive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critActive.False') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critActive.False', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critActive.True') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critActive.True', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critFirstName', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critGroupedBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critGroupedBy', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critHistoric') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critHistoric', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critLastName', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critQuizDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critQuizDate', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critQuizScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critQuizScore', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critReportRunAt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critReportRunAt', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critReportRunBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critReportRunBy', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'critUnitUserSortBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'critUnitUserSortBy', 'report criteria', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cs-CZ') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cs-CZ', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVGenerator.cs.Generate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVGenerator.cs.Generate', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVGenerator.cs.Generate2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVGenerator.cs.Generate2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVGenerator.cs.GenerateContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVGenerator.cs.GenerateContent', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVGenerator.cs.GenerateContent2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVGenerator.cs.GenerateContent2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Generate.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Generate.1', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Generate.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Generate.2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.1', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.10', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.11', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.12') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.12', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.13') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.13', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.3', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.4', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.5', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.6', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.7', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.8', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'CSVtoXMLConverter.cs.Write.9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'CSVtoXMLConverter.cs.Write.9', 'message', '{0} is an output of the error row', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Current') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Current', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'current_period') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'current_period', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Customvalidator1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Customvalidator1', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cvlConfirmPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cvlConfirmPassword', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cvldParentUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cvldParentUnit', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cvlOldPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cvlOldPassword', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'cvlUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'cvlUnit', 'validation message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'da-DK') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'da-DK', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclActive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclActive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclCourse', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclLessonStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclLessonStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclModule') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclModule', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclQuizScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclQuizScore', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclQuizStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclQuizStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclQuizStatusDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclQuizStatusDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'dclUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'dclUser', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'de-DE') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'de-DE', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'DefaultConfirmationMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'DefaultConfirmationMsg', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'DisclaimerText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'DisclaimerText', 'text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'edit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'edit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EffectiveDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EffectiveDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'el-GR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'el-GR', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Email_ExpiryWarn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Email_ExpiryWarn', '', '{0} receipient name, {1} number days till expiry, {2} course name, {3} expiry date, {4} Salt rep name, {5} org name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Email_ExpiryWarn_Subject') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Email_ExpiryWarn_Subject', '', '{0} course name, {1} org name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Email_LicenseWarn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Email_LicenseWarn', '', '{0} receipient name, {1} license warning amount, {2} course name, {3} license limit, {4} name of contact person, {5} org name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Email_LicenseWarn_Subject') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Email_LicenseWarn_Subject', '', '{0} course name, {1} org name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EmailAddress') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EmailAddress', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EmailReportSent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EmailReportSent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EmailSubject') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EmailSubject', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EmailUserCopyBody') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EmailUserCopyBody', 'label', '{0} is the application name, {1} is the date sent, {2} is the body of email, {3} is a list of users. NOTE: \n means new line. Leave it in there.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'en-AU') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'en-AU', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'EndDateBeforeToday') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'EndDateBeforeToday', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error.1', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error.2', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error.3', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error.4', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error.Password') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error.Password', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error1', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error2', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Error3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Error3', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ErrorFile6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ErrorFile6', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'es-ES') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'es-ES', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ExceedOrgSizeAllocation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ExceedOrgSizeAllocation', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ExitPreviewText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ExitPreviewText', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ExitText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ExitText', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'fi-FI') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'fi-FI', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError1', 'codebehind error', '{0} is the filename', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError2', 'codebehind error', '{0} is a directory name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError3', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError4', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError5', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileError6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileError6', 'codebehind error', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FileExists') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FileExists', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'first_name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'first_name', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'fr-FR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'fr-FR', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'From') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'From', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FSZTOOBIG') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FSZTOOBIG', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Future') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Future', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'future_period') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'future_period', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FuturePointsNone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FuturePointsNone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'FuturePointsNotNumeric') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'FuturePointsNotNumeric', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'GapBetweenPeriods') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GapBetweenPeriods', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'GivenAnswer') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GivenAnswer', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Action') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Action', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_AddAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_AddAdmin', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_AddButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_AddButton', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_AllowAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_AllowAccess', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Avg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Avg', 'grid heading', 'leave content enclosed with <nobr>CONTENT</nobr> tags', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Grid_Body') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Grid_Body', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_btnRemove') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_btnRemove', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Cancel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Cancel', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_ClassValue') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_ClassValue', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Course') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Course', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_CourseName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_CourseName', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_CPDPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_CPDPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Grid_DateSent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Grid_DateSent', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Default') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Default', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Delete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Delete', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Description') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Description', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Email') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Email', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_FirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_FirstName', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_FreqDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_FreqDate', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_GrantAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_GrantAccess', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_hierarchyname') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_hierarchyname', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LastLogin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LastLogin', 'grid heading', '`', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LastName', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LastUpdated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LastUpdated', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LessDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LessDate', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LessFreq') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LessFreq', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LessonStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LessonStatus', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_LinkCap') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_LinkCap', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_lnkCustomiseButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_lnkCustomiseButton', 'grid button', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_lnkModifyButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_lnkModifyButton', 'grid button', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_lnkRemoveButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_lnkRemoveButton', 'grid button', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_lnkRevert') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_lnkRevert', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_lnkUpdateButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_lnkUpdateButton', 'grid button', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Modify') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Modify', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Module') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Module', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_ModuleName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_ModuleName', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Name', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Org') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Org', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_PageTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_PageTitle', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_PageType') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_PageType', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_PassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_PassMark', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Pathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Pathway', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_PolicyBuilder') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_PolicyBuilder', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizCount', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizFreq') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizFreq', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizPassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizPassMark', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizScore', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_QuizStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_QuizStatus', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Reason') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Reason', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Record') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Record', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Remove') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Remove', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_ShowDisclaimer') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_ShowDisclaimer', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Sort') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Sort', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Status') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Status', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Grid_Subject') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Grid_Subject', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Summary') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Summary', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_To') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_To', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Unit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Unit', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_UnitID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_UnitID', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_UnitPathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_UnitPathway', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Update') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Update', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Url') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Url', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_UserDefault') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_UserDefault', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_Value') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_Value', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid_YourMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid_YourMark', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid1_Module') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid1_Module', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid1_Name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid1_Name', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid1_QuizScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid1_QuizScore', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid2_Correct') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid2_Correct', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid2_CorrectAnswers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid2_CorrectAnswers', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid2_Question') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid2_Question', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'grid2_YourAnswer') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'grid2_YourAnswer', 'grid heading', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'headerBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'headerBy', 'message', '{0} is LastName, {1} is firstName', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'headingRunOn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'headingRunOn', 'message', '{0} is a date', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'headingRunOn2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'headingRunOn2', 'message', '{0} is the run date, {1} is an effective date', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help10', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help11', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help111') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help111', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help112') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help112', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help2', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help3', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help31') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help31', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help32') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help32', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help33') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help33', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help34') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help34', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help35') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help35', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help36') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help36', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help4', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help5', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help51') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help51', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help52') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help52', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help53') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help53', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help54') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help54', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help7', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help8', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help9', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help91') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help91', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help92') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help92', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help93') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help93', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help94') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help94', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help95') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help95', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help96') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help96', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help97') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help97', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Help98') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Help98', 'help page text', '{0} is the application name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpA') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpA', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpB') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpB', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpC') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpC', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpD') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpD', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpE') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpE', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpF') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpF', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpG') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpG', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HelpH') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HelpH', 'tree control help', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'HomeText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'HomeText', 'home link on quiz', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hr-HR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hr-HR', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hu-HU') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hu-HU', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hypEdit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hypEdit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hypLanguageTranslation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hypLanguageTranslation', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hypLicensing') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hypLicensing', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'hypModify') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'hypModify', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'id-ID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'id-ID', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ImageUploadError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ImageUploadError', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'imgLaunchLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'imgLaunchLesson', 'image alt text', 'image alt text', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'imgLaunchQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'imgLaunchQuiz', 'image alt text', 'image alt text', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'imgQuickFacts') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'imgQuickFacts', 'image alt text', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'Importer.cs.IsLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Importer.cs.IsLesson', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'importMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'importMessage', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'InstructionsText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'InstructionsText', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'InvalidDateRange') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'InvalidDateRange', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'InvalidMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'InvalidMessage', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'InvalidPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'InvalidPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'is-IS') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'is-IS', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'it-IT') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'it-IT', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ja-JP') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ja-JP', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'ko-KR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ko-KR', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'last_name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'last_name', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbActiveInactiveReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbActiveInactiveReport', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbCPDEmailReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbCPDEmailReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbCPDReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbCPDReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAcceptance') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAcceptance', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAction', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblActivatePassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblActivatePassword', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblActive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblActive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAddLink') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAddLink', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAddValue') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAddValue', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdministrationWelcome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdministrationWelcome', 'label', '{0} is the application name, {1} is the trademark', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminMenuConfiguration') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminMenuConfiguration', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminMenuCourseContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminMenuCourseContent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminMenuOrganisation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminMenuOrganisation', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminMenuUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminMenuUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminMenuUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminMenuUser', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdminPrivileges') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdminPrivileges', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdvancedReporting') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdvancedReporting', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAdvReporting') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAdvReporting', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAllUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAllUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAnd', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAny') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAny', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblApplicationAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblApplicationAdmin', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblApplyChanges') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblApplyChanges', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblArchive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblArchive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAssignPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAssignPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAssignUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAssignUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblAssignUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblAssignUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblBackToCoarseList') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblBackToCoarseList', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblBetween') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblBetween', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblBody') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblBody', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblBuiltOnNet') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblBuiltOnNet', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCaption') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCaption', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCC') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCC', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCertificateComplete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCertificateComplete', 'label', '{0} is the username, {1} is the organisation, {2} is the course, {3} is the date complete', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCertLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCertLogo', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblChooseCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblChooseCourse', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblClassification') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblClassification', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblConfirmationMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblConfirmationMsg', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblConfirmPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblConfirmPassword', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblConfirmWarning') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblConfirmWarning', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblContentStyle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblContentStyle', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCources') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCources', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourse', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourse.None') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourse.None', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourse.Selected') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourse.Selected', 'label', '{0} is the course', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourseHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourseHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourseLabel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourseLabel', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourseName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourseName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourses', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCourseStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCourseStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCPDPeriodHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCPDPeriodHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCPDPointsAvailableHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCPDPointsAvailableHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCPDProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCPDProfile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCPDProfileHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCPDProfileHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCPDReportName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCPDReportName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCSVExample') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCSVExample', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCSVFileUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCSVFileUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCSVFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCSVFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCSVNote') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCSVNote', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCurrentLicensePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCurrentLicensePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCurrentPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCurrentPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCustomClasification') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCustomClasification', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCustomClassification') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCustomClassification', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblCustomClassLabel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblCustomClassLabel', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDateFrom') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDateFrom', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDateRange') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDateRange', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDateTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDateTo', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDayLight') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDayLight', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDefaultLayout') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDefaultLayout', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDelete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDelete', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDescription') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDescription', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDetails', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDisclaimerContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDisclaimerContent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDiskSpace') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDiskSpace', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDisplayName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDisplayName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDocumentType') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDocumentType', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblDuration') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblDuration', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.1', 'label', '{0} is the name of the application', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.10', 'label', 'IP is the ip address number', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.3', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.4', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.5', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.6', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.7', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.8', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmail.9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmail.9', 'label', 'Host is the server address of the person', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmailBody') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmailBody', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmailLanguage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmailLanguage', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEmailSent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEmailSent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblEndOfPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEndOfPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.Caution') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.Caution', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.Date') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.Date', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.Date2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.Date2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.InvalidDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.InvalidDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoCourse', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoCoursePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoCoursePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoDataFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoDataFound', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoPolicy', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoProfile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoQuiz', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoResults') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoResults', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoUser', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.NoUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.NoUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.OnCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.OnCourse', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.OneRecip') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.OneRecip', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.SearchDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.SearchDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.Select') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.Select', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.SelectUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.SelectUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.SelectUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.SelectUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblError.Unable') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblError.Unable', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblErrorDetails1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblErrorDetails1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblErrorDetails2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblErrorDetails2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblErrorDetails3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblErrorDetails3', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblErrorDetails4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblErrorDetails4', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExceeded') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExceeded', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExceededWarn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExceededWarn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExistingFile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExistingFile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExpiredIn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExpiredIn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExternalID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExternalID', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblExternalIDLabel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblExternalIDLabel', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFactSheet') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFactSheet', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFailCounter') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFailCounter', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFailed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFailed', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFileName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFileName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFirstName', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFirstYearStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFirstYearStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFormat', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFormatInstruction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFormatInstruction', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFormatInstruction2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFormatInstruction2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFrequency') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFrequency', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFrom') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFrom', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFutureLicensePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFutureLicensePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFuturePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFuturePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFutureProfilePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFutureProfilePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblFutureRequiredPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblFutureRequiredPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblGrantAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblGrantAll', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblGroupBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblGroupBy', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHelp') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHelp', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHi') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHi', 'label', '(0} is the username (context is greeting to user)', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHistoric') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHistoric', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHistoricCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHistoricCourse', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHistoricDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHistoricDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHomepageWelcome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHomepageWelcome', 'label', '{0} is the application name, {1} is the trademark', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblHomepageWelcome.Add1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblHomepageWelcome.Add1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblInactiveUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblInactiveUnits', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblInactiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblInactiveUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblInclInactiveUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblInclInactiveUser', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblInclLogoMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblInclLogoMsg', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblIncludeInactive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblIncludeInactive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:02 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblIncludeInactiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblIncludeInactiveUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:02 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblIncludeLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblIncludeLogo', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblIncludeNewUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblIncludeNewUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblIntroduction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblIntroduction', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLastLogin.Never') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLastLogin.Never', 'codebehind label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLastLoginLabel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLastLoginLabel', 'form label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLastName', 'form label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLastRun') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLastRun', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLastYearStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLastYearStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Certificate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Certificate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Complete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Complete', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Completed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Completed', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Expired') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Expired', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Failed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Failed', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Incomplete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Incomplete', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_InProgress') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_InProgress', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_NewContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_NewContent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_NotStarted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_NotStarted', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_Passed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_Passed', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegend_StatusKey') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegend_StatusKey', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLegendNote') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLegendNote', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessFreq') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessFreq', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessionWorkSite') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessionWorkSite', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonDetails', 'label', '{0} is the uploaded file, {1} is the date uploaded', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonDetails.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonDetails.1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonDetails.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonDetails.2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonDetails.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonDetails.3', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonOnly') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonOnly', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLessonQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLessonQuiz', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLinks') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLinks', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLocalizedTest') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLocalizedTest', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblLWorksiteMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblLWorksiteMsg', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage', 'message', 'Message on add of user', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.1', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.1000') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.1000', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.3', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.4', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.5', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Added') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Added', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Caption') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Caption', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Error') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Error', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.ExceedsLengthLimit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.ExceedsLengthLimit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Inactive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Inactive', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Invalid') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Invalid', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.InvalidDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.InvalidDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.InvalidXML') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.InvalidXML', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.LengthError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.LengthError', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.MinimumLength') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.MinimumLength', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoCourse', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoCourseAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoCourseAccess', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoCSV') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoCSV', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoDLS') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoDLS', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoOrg', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoParent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoParent', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NotFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NotFound', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoTimezone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoTimezone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoUnits', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoUser', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoUserFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoUserFound', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoUsersFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoUsersFound', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.NoXML') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.NoXML', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Populated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Populated', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.RequiredField') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.RequiredField', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SaveAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SaveAccess', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Saved') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Saved', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SavePoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SavePoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SaveUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SaveUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SaveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SaveUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SelectDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SelectDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SelectPastDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SelectPastDate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SelectUniqueField') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SelectUniqueField', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Sent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Sent', 'message', '{0} is the email address', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.SpecifyCaption') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.SpecifyCaption', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.StyleSheet') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.StyleSheet', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Success') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Success', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Supply') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Supply', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.Updated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.Updated', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.UserNotFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.UserNotFound', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage.UsersArchived') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage.UsersArchived', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage1', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage3', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage4', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage5', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessage6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessage6', 'message', '{0} is the file path', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMessageUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMessageUnit', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModList') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModList', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModuleList') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModuleList', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModuleMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModuleMessage', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModulePoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModulePoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModules') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModules', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModuleStatusUpdate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModuleStatusUpdate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblModuleStatusUpdateLastRun') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblModuleStatusUpdateLastRun', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMonth') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMonth', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMonthEnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMonthEnd', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMonths') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMonths', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMonthsExpiredIn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMonthsExpiredIn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMonthStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMonthStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblMoreInformation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblMoreInformation', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNever') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNever', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNewContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNewContent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNewLocation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNewLocation', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNewPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNewPassword', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNoAdminPrivileges') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNoAdminPrivileges', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNoCourses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNoCourses', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNoLicenses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNoLicenses', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNoPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNoPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNormal') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNormal', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNoSubUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNoSubUnits', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNote') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNote', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblNotes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblNotes', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOffset') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOffset', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOldPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOldPassword', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrganisation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrganisation', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrganisationAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrganisationAdmin', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrganisationSelect') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrganisationSelect', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrgEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrgEmail', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrgLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrgLogo', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrgName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrgName', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblOrgNotes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblOrgNotes', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageLevelLayout') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageLevelLayout', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.2', 'label', 'Title on add of user', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.3', 'label', 'Title on add of user', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.4', 'label', 'Title on edit user', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.Add') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.Add', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitle.Modify') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitle.Modify', 'label', '{0} is the classification name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPageTitleTimezoneEdit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPageTitleTimezoneEdit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPassed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPassed', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPassMark', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPassMarkText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPassMarkText', 'label', '{0} is a number, {1} is a number', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPassword', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPasswordInstruction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPasswordInstruction', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPastCourses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPastCourses', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPathwayLabel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPathwayLabel', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPointsEarnedHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPointsEarnedHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPointsTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPointsTo', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicy', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyBuilder') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyBuilder', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyDateRange') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyDateRange', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyEmailReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyEmailReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyInstructions') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyInstructions', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPolicyStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPolicyStatus', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPreview') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPreview', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPreviewMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPreviewMessage', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPrintCertificateHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPrintCertificateHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblProductLicensedTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblProductLicensedTo', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblProfile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblProfileName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblProfileName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblProfilePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblProfilePeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPublish') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPublish', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblPublishedTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblPublishedTo', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQFWorksiteMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQFWorksiteMsg', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuickFact') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuickFact', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDateRange') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDateRange', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDetails.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDetails.1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDetails.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDetails.2', 'label', '{0} is the quiz name, {2} is the date uploaded', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDetails.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDetails.3', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizDetails.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizDetails.4', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizFreq') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizFreq', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizLessonInstruction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizLessonInstruction', '', '{0} will be quiz only, lesson only or both lesson and quiz', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizOnly') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizOnly', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQuizWorkSite') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQuizWorkSite', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblQWorksiteMsg.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblQWorksiteMsg.1', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblRecip') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblRecip', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblReportingWelcome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblReportingWelcome', 'label', '{0} is the application name, {1} is the trademark', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblReportName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblReportName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblReports') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblReports', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblReportType') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblReportType', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblRequiredPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblRequiredPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblRequiredPointsHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblRequiredPointsHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblRowNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblRowNumber', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSaltEnterprise') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSaltEnterprise', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSaltUnavailable') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSaltUnavailable', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSearchEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSearchEmail', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSearchEmailSent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSearchEmailSent', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSearchMessage.Non') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSearchMessage.Non', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSearchResults') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSearchResults', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSectionTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSectionTitle', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSelect') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSelect', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSelectInfoPath') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSelectInfoPath', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSelectOrganisation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSelectOrganisation', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSelectUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSelectUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSendEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSendEmail', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblServerTimeZone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblServerTimeZone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSetAllRules') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSetAllRules', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSetIndivid') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSetIndivid', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblShortfall') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblShortfall', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblShortFallUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblShortFallUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblShowInactive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblShowInactive', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSortBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSortBy', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSqlagentStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSqlagentStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStartOn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStartOn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatus.Assigned') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatus.Assigned', 'label', '{0} is the unit name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatus.Assigned2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatus.Assigned2', 'label', '{0} is the number of users added, {1} is a unit name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatus.Permission') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatus.Permission', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatus.Supply') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatus.Supply', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStatusHeading') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStatusHeading', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStep1Label') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStep1Label', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStep1Text') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStep1Text', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStep2Label') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStep2Label', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStep2Text') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStep2Text', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblStep2Text.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblStep2Text.2', 'label', '{0} is the course name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSubject') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSubject', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblSubUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblSubUnits', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblText', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTimeEnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTimeEnd', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTimeStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTimeStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTimeZone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTimeZone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTimeZoneName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTimeZoneName', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTo', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblToolBook') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblToolBook', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTrendDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTrendDate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblTypeNewContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblTypeNewContent', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUniqueField') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUniqueField', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitAdmin', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitAdminstratorReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitAdminstratorReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitComplianceReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitComplianceReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitCount', 'label', '{0} is the number of search results.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitHier') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitHier', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnitID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnitID', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnits', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnits2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnits2', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUnlock') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUnlock', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUpload', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblURL') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblURL', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserAcceptance') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserAcceptance', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserActive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserActive', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserCount', 'label', '{0} is the number of users found.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserCreate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserCreate', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserCreate2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserCreate2', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserName', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblUserStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblUserStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblValue') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblValue', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblViewQuizStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblViewQuizStatus', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblViewUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblViewUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWarning') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWarning', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWarningMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWarningMessage', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWeekdayEnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWeekdayEnd', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWeekdayStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWeekdayStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWeekEnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWeekEnd', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblWeekStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblWeekStart', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblXmlFileUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblXmlFileUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lblXMLFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblXMLFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbPolicyBuilderReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbPolicyBuilderReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbPolicyEmailReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbPolicyEmailReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbUnitPathwayReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbUnitPathwayReport', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lbUserDetailsReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lbUserDetailsReport', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'LessonStatusPreviewMode') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'LessonStatusPreviewMode', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'LessonUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'LessonUpload', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'listTimeZone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'listTimeZone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litAbout') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litAbout', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litAdministration') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litAdministration', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litClick') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litClick', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litCourseList') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litCourseList', 'text block', 'This is a dual column list. &gt; is a greater than sign. Ensure it is written like this.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litCSV') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litCSV', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litDetectedError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litDetectedError', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litDisplayed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litDisplayed', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litError', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litError1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litError1', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litError2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litError2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litError3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litError3', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litExcel') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litExcel', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litExit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litExit', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litExpand') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litExpand', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litExport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litExport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litExportTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litExportTitle', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litFeedbackMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litFeedbackMessage', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litForgotPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litForgotPassword', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelp') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelp', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText10', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText11', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText111') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText111', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText112') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText112', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText2', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText31') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText31', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText32') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText32', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText33') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText33', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText34') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText34', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText35') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText35', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText36') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText36', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText4', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText51') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText51', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText52') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText52', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText53') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText53', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText54') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText54', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText6', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText7', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText8', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText9', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText91') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText91', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText92') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText92', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText93') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText93', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText94') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText94', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText95') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText95', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText96') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText96', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText97') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText97', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpText98') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpText98', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHelpTextIntro') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHelpTextIntro', 'help text block', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litHome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litHome', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litLinks') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litLinks', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litLogoNote') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litLogoNote', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litMegabytes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litMegabytes', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litMessage', 'label', '{0} is the organisation name, {1} is a link to "Unit Details" which is translated somewhere else.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litMyTraining') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litMyTraining', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litNote') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litNote', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litOf') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litOf', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litOR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litOR', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litOverLess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litOverLess', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litOverQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litOverQuiz', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litPage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litPage', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litPassword', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litPDF') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litPDF', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litPreviewData') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litPreviewData', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litReports') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litReports', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litSampleCSVLink') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litSampleCSVLink', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litSelectFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litSelectFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litSelectReportExportFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litSelectReportExportFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litSelectUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litSelectUnit', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litShowDisclaimer') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litShowDisclaimer', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litTableSummary.AddUpdate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litTableSummary.AddUpdate', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litTableSummary.ErrorDetected') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litTableSummary.ErrorDetected', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litUserName', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litUsers', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litUsersAdded') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litUsersAdded', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'litUsersUpdated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'litUsersUpdated', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddAdmin', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddCourse', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddNewUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddNewUser', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddOrganisation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddOrganisation', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddOrganisationAdministrator') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddOrganisationAdministrator', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddUnit', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAddUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAddUser', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdminCurrentReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdminCurrentReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdminHistoricalPointReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdminHistoricalPointReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedAtRiskReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedAtRiskReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedCompletedUsersReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedCompletedUsersReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedCourseStatusReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedCourseStatusReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedEmailSentReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedEmailSentReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedProgressReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedProgressReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedSummaryReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedSummaryReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedTrendReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedTrendReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAdvancedWarningReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAdvancedWarningReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAppAuditing') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAppAuditing', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAppConfig') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAppConfig', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAppDependencies') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAppDependencies', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkApplicationAdministrators') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkApplicationAdministrators', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkArchiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkArchiveUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAssign') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAssign', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAssignPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAssignPoints', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAssignUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAssignUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkAssignUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkAssignUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkBack') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkBack', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkBulkAssignUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkBulkAssignUsers', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkCourseAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkCourseAccess', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkCPDProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkCPDProfile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkDeleteButton') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkDeleteButton', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkDomainName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkDomainName', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkEdit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkEdit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkEditCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkEditCourse', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkEmailReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkEmailReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkEmailUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkEmailUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkFurtherInformation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkFurtherInformation', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkHome') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkHome', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkImportUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkImportUsers', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkLanguageTranslation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkLanguageTranslation', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkLicensing') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkLicensing', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkLicensingReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkLicensingReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkMailThroughput') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkMailThroughput', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkManagaeUnitAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkManagaeUnitAdmin', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkModAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkModAccess', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkModifyClassificationOptions') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkModifyClassificationOptions', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkModifyLinks') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkModifyLinks', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkModuleAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkModuleAccess', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkMoreUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkMoreUsers', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkMoveUsersToUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkMoveUsersToUnit', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkMyReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkMyReport', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkMyTraining') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkMyTraining', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrgAdministrators') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrgAdministrators', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrganisationConfiguration') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrganisationConfiguration', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:03 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrganisationDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrganisationDetails', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:03 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrgApplicationAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrgApplicationAccess', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrgImportUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrgImportUsers', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkOrgMailSetup') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkOrgMailSetup', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPeriodicReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPeriodicReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPersonalReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPersonalReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPersonDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPersonDetails', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPolicyBuilder') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPolicyBuilder', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPreview') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPreview', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPreviousScreen') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPreviousScreen', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPreviousScreen2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPreviousScreen2', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPrivacyPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPrivacyPolicy', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkPublishContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkPublishContent', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkQuestionStatusReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkQuestionStatusReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkQuizSummaryReport') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkQuizSummaryReport', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReportPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReportPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkResetLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkResetLesson', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkResetQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkResetQuiz', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkResetUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkResetUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturn', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnAssign') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnAssign', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo.3', 'link', 'link to return to previous page', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo.5', 'link', 'link to return to previous page', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo.6', 'link', 'link to return to previous page', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo.7', 'link', 'link to return to previous page', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnTo.8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnTo.8', 'link', 'link to return to previous page', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnToCourseDetail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnToCourseDetail', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnToModuleDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnToModuleDetails', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnToOrgAdmin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnToOrgAdmin', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkReturnToSearchScreen') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkReturnToSearchScreen', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkSetRules') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkSetRules', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkTermsOfUse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkTermsOfUse', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkTimeZone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkTimeZone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUnitDetails') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUnitDetails', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUnitMangement') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUnitMangement', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUnitSearch') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUnitSearch', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUpdateButton.Add') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUpdateButton.Add', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUpload', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUploadContent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUploadContent', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkUserSearch') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkUserSearch', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkViewCertificate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkViewCertificate', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkViewErrorLog') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkViewErrorLog', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnkViewUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnkViewUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lnl;Message.SaveUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lnl;Message.SaveUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'localizedBadDateMsg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'localizedBadDateMsg', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Localizedliteral1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Localizedliteral1', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'locBegin') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'locBegin', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'locLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'locLesson', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'locModule') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'locModule', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'locQuickFacts') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'locQuickFacts', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'locQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'locQuiz', 'link', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lstWithinUserSort.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lstWithinUserSort.1', 'dropdown list item', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lstWithinUserSort.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lstWithinUserSort.2', 'dropdown list item', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lstWithinUserSort.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lstWithinUserSort.3', 'dropdown list item', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lt-LT') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lt-LT', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrModuleWarnings') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrModuleWarnings', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrNoWarn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrNoWarn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrNumberofDaysDelinq') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrNumberofDaysDelinq', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrNumberofDaysWarns') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrNumberofDaysWarns', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrNumberofWarns') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrNumberofWarns', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrQuizResults') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrQuizResults', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrReminders') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrReminders', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrWarnMgrs') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrWarnMgrs', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ltrWarnUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ltrWarnUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'lv-LV') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lv-LV', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.From') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.From', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.LoginFailure') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.LoginFailure', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.LoginFailure2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.LoginFailure2', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.Moved') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.Moved', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.NoLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.NoLesson', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.NoQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.NoQuiz', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.PasswordLockout') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.PasswordLockout', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.Permission') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.Permission', 'message', '{0} is the name of the application, SALT.', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Message.To') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Message.To', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'mgrEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'mgrEmail', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'module_name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'module_name', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'MonthNone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'MonthNone', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'MonthNotNumeric') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'MonthNotNumeric', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Months') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Months', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgEndDateAfter') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgEndDateAfter', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgEndDateFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgEndDateFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgExpireEmailDateBeforeAfter') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgExpireEmailDateBeforeAfter', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgExpireEmailDateFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgExpireEmailDateFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgNever') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgNever', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgNoCourses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgNoCourses', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgNoCoursesExistInThisOrganisation') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgNoCoursesExistInThisOrganisation', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgStartDateAfterBefore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgStartDateAfterBefore', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgStartDateFormat') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgStartDateFormat', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgStartEndDateGap') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgStartEndDateGap', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgStartEndDateOverlap') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgStartEndDateOverlap', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgValidationSummary') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgValidationSummary', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'msgWarnEmailNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'msgWarnEmailNumber', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NA') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NA', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NameExists') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NameExists', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'New') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'New', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NextAltText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NextAltText', 'image alt text', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'nl-NL') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'nl-NL', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NO') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NO', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoAccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoAccess', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoCourses') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoCourses', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoPeriod', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoPolicies') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoPolicies', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoProfiles') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoProfiles', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoUnits') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoUnits', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoUploadFile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoUploadFile', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoUsers', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'NoUsersFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'NoUsersFound', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'OfText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'OfText', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optReportType.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optReportType.1', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optReportType.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optReportType.2', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optReportType.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optReportType.3', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optReportType.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optReportType.4', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.1', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.2', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.3', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.4', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.5', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optStatus.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optStatus.6', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optUnitLevel_CreateSub') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optUnitLevel_CreateSub', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'optUnitLevel_CreateTop') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'optUnitLevel_CreateTop', 'radio selection', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'orgEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'orgEmail', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'OrgNoSpaceAllocated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'OrgNoSpaceAllocated', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PageContext.cs.CacheControlFile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PageContext.cs.CacheControlFile', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PageContext.cs.CacheDataFile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PageContext.cs.CacheDataFile', 'message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PageContext.cs.FindPageIndex') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PageContext.cs.FindPageIndex', 'message', '{0} is a record number', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PageText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PageText', 'label', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'pagTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'pagTitle', 'browser title bar', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PassMarkError') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PassMarkError', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PeriodOverlap') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PeriodOverlap', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'permissionConfirm') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'permissionConfirm', 'confirm message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PlayersInvolved') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PlayersInvolved', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'pl-PL') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'pl-PL', 'language name', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'policy_name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'policy_name', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PolicyExists') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PolicyExists', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PolicySaved') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PolicySaved', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcAppConfig_Update.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcAppConfig_Update.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcClassification_AddClassification.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcClassification_AddClassification.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcClassification_AddType.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcClassification_AddType.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcClassification_UpdateClassification.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcClassification_UpdateClassification.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcClassification_UpdateType.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcClassification_UpdateType.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcCourse_Create.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcCourse_Create.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcLink_Add.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcLink_Add.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcLink_Delete.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcLink_Delete.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcLink_Update.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcLink_Update.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcModule_Create.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcModule_Create.4', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcModule_Update.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcModule_Update.4', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Add.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Add.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Add.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Add.6', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_RemoveAdministrator.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_RemoveAdministrator.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_RemoveAdministrator.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_RemoveAdministrator.6', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_RemoveAdministrator.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_RemoveAdministrator.7', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_SetAdministrator.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_SetAdministrator.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_SetAdministrator.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_SetAdministrator.6', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_SetAdministrator.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_SetAdministrator.7', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Update.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Update.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Update.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Update.4', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Update.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Update.6', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_Update.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_Update.7', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisation_UpdateDomainName.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisation_UpdateDomainName.4', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisationConfig_Delete.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisationConfig_Delete.2', 'error message', '{0} is a record number', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisationConfig_Delete.21') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisationConfig_Delete.21', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisationConfig_Update.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisationConfig_Update.2', 'error message', '{0} is a record number', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcOrganisationConfig_Update.21') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcOrganisationConfig_Update.21', 'error message', '{0} is a record name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_AddAdministrator') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_AddAdministrator', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Create') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Create', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.11', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.12') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.12', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.13') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.13', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.14') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.14', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.15') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.15', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Move.16') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Move.16', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_MoveToTopLevel.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_MoveToTopLevel.1', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_MoveToTopLevel.11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_MoveToTopLevel.11', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_RemoveAdministrator') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_RemoveAdministrator', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Update.10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Update.10', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Update.101') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Update.101', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Update.102') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Update.102', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUnit_Update.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUnit_Update.7', 'error message', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Create.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Create.1', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Create.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Create.4', 'data layer', '{0} is the user name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Create.41') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Create.41', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.11', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.4', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.41') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.41', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.42') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.42', 'data layer', '{0} is the user name', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.43') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.43', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'prcUser_Update.7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'prcUser_Update.7', 'data layer', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PreviewModeText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PreviewModeText', 'image alt text', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'PreviousAltText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'PreviousAltText', 'image alt text', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'profile_name') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'profile_name', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ProfileExists') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ProfileExists', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'pt-BR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'pt-BR', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'pt-PT') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'pt-PT', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Question') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Question', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'QuestionText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'QuestionText', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'QuickFactsText') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'QuickFactsText', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'QuizLesson_Error') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'QuizLesson_Error', 'error message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'QuizStatusPreviewMode') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'QuizStatusPreviewMode', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'QuizUpload') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'QuizUpload', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radAcceptance.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radAcceptance.1', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radAcceptance.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radAcceptance.2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radAcceptance.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radAcceptance.3', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.1', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.2', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.3', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.4', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.5', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radCourseModuleStatus.6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radCourseModuleStatus.6', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radDaysBeforeExpiry') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radDaysBeforeExpiry', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radDueBeforeDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radDueBeforeDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radFormat.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radFormat.1', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radFormat.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radFormat.2', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radGroupBy.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radGroupBy.1', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radGroupBy.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radGroupBy.2', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radInfoPath') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radInfoPath', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radLesson') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radLesson', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radPolicyModuleStatus.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radPolicyModuleStatus.1', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radPolicyModuleStatus.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radPolicyModuleStatus.2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radQuiz') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radQuiz', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radRecipientType.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radRecipientType.1', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radRecipientType.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radRecipientType.2', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'radToolbook') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'radToolbook', 'radio selection', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbAllUsersExcluding') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbAllUsersExcluding', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbAllUsersIncluding') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbAllUsersIncluding', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbAutoIncrementAsCurrent') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbAutoIncrementAsCurrent', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbAutoIncrementByMonth') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbAutoIncrementByMonth', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbNewFuturePeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbNewFuturePeriod', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rbNoAction') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rbNoAction', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason0') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason0', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason1', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason10', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason11', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason3', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason4', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason5', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason6', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason7', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason8', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Reason9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Reason9', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Recipients') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Recipients', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'RemoveConfirm') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'RemoveConfirm', 'confirm message', '{0} is the username', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'RemoveMessage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'RemoveMessage', 'confirm message', '{0} is the username', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ReportRunAt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ReportRunAt', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ReportRunBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ReportRunBy', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'Requiredfieldvalidator1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Requiredfieldvalidator1', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revCurrentPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revCurrentPoints', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revCurrentRepEmailOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revCurrentRepEmailOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revCurrentRepEmailSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revCurrentRepEmailSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revDiskSpace') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revDiskSpace', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revEmail', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revEmail2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revEmail2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revFuturePoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revFuturePoints', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revFutureRepEmailOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revFutureRepEmailOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revFutureRepEmailSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revFutureRepEmailSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revMonth') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revMonth', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revNewPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revNewPassword', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'revUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'revUserName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentLicenseNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentLicenseNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentPoints', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentRepEmailOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentRepEmailOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentRepEmailSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentRepEmailSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentRepNameOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentRepNameOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvCurrentRepNameSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvCurrentRepNameSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvDiskSpace') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvDiskSpace', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvEmail', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvEmail2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvEmail2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFile', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFirstName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFutureLicenseNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFutureLicenseNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFuturePoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFuturePoints', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFutureRepEmailOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFutureRepEmailOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFutureRepEmailSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFutureRepEmailSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFutureRepNameOrg') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFutureRepNameOrg', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvFutureRepNameSalt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvFutureRepNameSalt', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvLastName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvLWorksiteID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvLWorksiteID', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvMonth') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvMonth', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvProfile', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvProfileName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvProfileName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvQFWorksiteID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvQFWorksiteID', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvQWorksiteID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvQWorksiteID', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rfvUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rfvUserName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'ro-RO') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ro-RO', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptAccepted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptAccepted', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptActiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptActiveUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptAdministeredUnitPathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptAdministeredUnitPathway', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptArchive') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptArchive', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptAvgScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptAvgScore', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptComplete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptComplete', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCompleted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCompleted', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCompletionDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCompletionDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCourse') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCourse', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCourseName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCourseName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCoursePolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCoursePolicy', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCourseProfile') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCourseProfile', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCourseTotal') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCourseTotal', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptCurrentStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptCurrentStatus', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDate', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateAccepted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateAccepted', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateArchived') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateArchived', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateAssigned') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateAssigned', '', 'Date points Assigned', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateCreated') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateCreated', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateEffectiveFrom') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateEffectiveFrom', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDateEffectiveTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDateEffectiveTo', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDays') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDays', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptDefault') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptDefault', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptEffectiveDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptEffectiveDate', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptEmail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptEmail', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptExpiredNew') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptExpiredNew', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptExpiredTime') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptExpiredTime', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptExpiryDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptExpiryDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptExternalID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptExternalID', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptFail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptFail', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptFailNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptFailNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptFirstName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptGrandTotal') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptGrandTotal', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptGrandTotalDiscreteUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptGrandTotalDiscreteUsers', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptGroupBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptGroupBy', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptInactiveUserCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptInactiveUserCount', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptInactiveUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptInactiveUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptInComplete') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptInComplete', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptIncompleteDetail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptIncompleteDetail', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLastCompleted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLastCompleted', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLastCompletionDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLastCompletionDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLastName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLessonExpiryDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLessonExpiryDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLessonFrequency') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLessonFrequency', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLessonStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLessonStatus', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLicenseQuota') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLicenseQuota', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLicensesRemaining') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLicensesRemaining', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptLicensesUsed') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptLicensesUsed', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptModule') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptModule', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptModuleName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptModuleName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptModules') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptModules', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptMonths') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptMonths', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptNoResultsFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptNoResultsFound', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptNotStarted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptNotStarted', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptNoUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptNoUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptNumberOfUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptNumberOfUsers', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptOf') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptOf', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPage') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPage', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPassMark', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPeriod', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPoints') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPoints', '', 'Points header for cpd report', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPolicy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPolicy', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptPreviousStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptPreviousStatus', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptQuizCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptQuizCount', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptQuizExpiryDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptQuizExpiryDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptQuizFrequency') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptQuizFrequency', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptQuizStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptQuizStatus', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptReportRunAt') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptReportRunAt', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptReportRunBy') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptReportRunBy', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptReportRunFrom') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptReportRunFrom', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptReportRunTo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptReportRunTo', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptReportTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptReportTitle', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptScore') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptScore', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptStatus', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptTotalAccepted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptTotalAccepted', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptTotalNotAccepted') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptTotalNotAccepted', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptTotalNoUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptTotalNoUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptTotalUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptTotalUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:04 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnit') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnit', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:04 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnitID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnitID', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnitIDPathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnitIDPathway', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnitName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnitName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnitPathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnitPathway', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUnitTotal') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUnitTotal', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUser') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUser', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserCount') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserCount', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserFirstName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserFirstName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserFullName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserFullName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserID') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserID', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserLastName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserLastName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUserName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUserName', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptUsers') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptUsers', 'report label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptValue') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptValue', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptWarningPeriod') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptWarningPeriod', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rptYes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rptYes', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'ru-RU') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ru-RU', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvCurrentLicenseNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvCurrentLicenseNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvCurrentLicenseWarnNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvCurrentLicenseWarnNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvFutureLicenseNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvFutureLicenseNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvFutureLicenseWarnNumber') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvFutureLicenseWarnNumber', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvlConfirmPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvlConfirmPassword', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvldCourseNotes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvldCourseNotes', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvldName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvldName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'rvlPassword') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'rvlPassword', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'SaveSuccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'SaveSuccess', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'SectionTitle_Administration') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'SectionTitle_Administration', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'SectionTitle_Reporting') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'SectionTitle_Reporting', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'shortfall') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'shortfall', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'sk-SK') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'sk-SK', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'sl-SI') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'sl-SI', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'StartDateAfterEndDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'StartDateAfterEndDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'status') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'status', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Status1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Status1', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Status2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Status2', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Status3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Status3', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Status4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Status4', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'strSqlAgentRunningStatus') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'strSqlAgentRunningStatus', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'sv-SE') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'sv-SE', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading1', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading10', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading11', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading2', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading3', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading4', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading5', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading6', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading7', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading8', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termsheading9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termsheading9', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext10') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext10', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext11') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext11', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext2', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext3', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext4', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext5') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext5', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext6') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext6', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext7') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext7', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext8') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext8', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'termstext9') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'termstext9', 'text', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'To') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'To', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'totals') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'totals', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'treeClearAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'treeClearAll', 'tree help', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'treeCollapseAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'treeCollapseAll', 'tree help', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'treeExpandAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'treeExpandAll', 'tree help', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'treeHelp') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'treeHelp', 'tree help', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'treeSelectAll') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'treeSelectAll', 'tree help', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'tr-TR') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'tr-TR', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'ucHelp') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ucHelp', 'heading', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'unit_pathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'unit_pathway', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'unitConfirm') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'unitConfirm', 'confirm message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'UnitPathway') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'UnitPathway', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'UploadFail') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'UploadFail', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'UploadSuccess') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'UploadSuccess', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'UserNotFound') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'UserNotFound', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Validation.1') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Validation.1', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Validation.2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Validation.2', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Validation.3') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Validation.3', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'Validation.4') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Validation.4', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorDefaultQuizPassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorDefaultQuizPassMark', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorFirstYearStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorFirstYearStart', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorLastYearStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorLastYearStart', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorOffset') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorOffset', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorOrganisationLogo') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorOrganisationLogo', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorOrganisationName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorOrganisationName', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorOrganisationNotes') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorOrganisationNotes', 'validation message', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorPassMark') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorPassMark', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorTimeEnd') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorTimeEnd', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorTimeStart') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorTimeStart', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorTimezone') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorTimezone', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorTimezoneDisplayName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorTimezoneDisplayName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'validatorTimeZoneName') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'validatorTimeZoneName', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'ValidEndDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ValidEndDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'ValidStartDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ValidStartDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'ValidStartEndDate') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ValidStartEndDate', '', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'YES') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'YES', 'label', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'zh-CHS') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'zh-CHS', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:06:42', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangResource where LangResourceName = N'zh-CHT') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'zh-CHT', 'language name', '', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/UserDetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/UserDetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.Business') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.Business', 'business layer', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.AdminMenu.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.AdminMenu.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.Misc') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.Misc', 'misc', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Summary') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Summary', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.GLOBAL') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.GLOBAL', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/About.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/About.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Certificate.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Certificate.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/MyTraining.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/MyTraining.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Disclaimer.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Disclaimer.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Links.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Links.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'LanguageNames') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'LanguageNames', 'language list', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Login.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Login.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/PasswordRecovery.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/PasswordRecovery.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/TermsOfUse.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/TermsOfUse.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/AdministrationHome.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/AdministrationHome.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Application/ApplicationAuditing.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Application/ApplicationAuditing.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/AddOrganisationAdministrator.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/AddOrganisationAdministrator.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/BulkAssignUsers.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/BulkAssignUsers.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/CourseAccess.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/CourseAccess.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/ImportUsers.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/ImportUsers.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/ImportUsersSample.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/ImportUsersSample.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/ModifyCustomClassification.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/ModifyCustomClassification.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/ModifyLinks.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/ModifyLinks.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/OrganisationAdministrators.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/OrganisationAdministrators.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/OrganisationConfiguration.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/OrganisationConfiguration.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/OrganisationDetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/OrganisationDetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/AddUnit.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/AddUnit.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/AddUnitAdministrator.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/AddUnitAdministrator.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/ComplianceRules.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/ComplianceRules.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/ImportUsers.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/ImportUsers.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/UnitAdministrators.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/UnitAdministrators.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/UnitDetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/UnitDetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/UnitManagement.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/UnitManagement.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/UnitModuleAccess.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/UnitModuleAccess.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Unit/UnitSearch.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Unit/UnitSearch.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/ApplicationAdministrators.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/ApplicationAdministrators.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/UserModuleAccess.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/UserModuleAccess.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/UserSearch.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/UserSearch.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Courses/AddCourse.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Courses/AddCourse.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Courses/CourseDetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Courses/CourseDetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/InfoPath/PublishInfoPathContent.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Modules/ModuleDetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Modules/ModuleDetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Modules/UploadToolBookContent.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Modules/UploadToolBookContent.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/Errors/ErrorHandler.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/Errors/ErrorHandler.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/Errors/NoSuchPage.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/Errors/NoSuchPage.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/Errors/ValidationException.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/Errors/ValidationException.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/InfoPath/Rendering/TemplateQuiz.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/InfoPath/Rendering/TemplateQuiz.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/InfoPath/Rendering/TemplateLesson.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/InfoPath/Rendering/TemplateLesson.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/QuizHistory.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/QuizHistory.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/QuizResult.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/QuizResult.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/QuizSummary.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/QuizSummary.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/ReportingHome.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/ReportingHome.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Admin/AdministrationReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Admin/AdministrationReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Admin/AdminSummaryReportTesting.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Admin/AdminSummaryReportTesting.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/CompletedUsersReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/CompletedUsersReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/CourseStatusReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/CourseStatusReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/ActiveInactiveReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/ActiveInactiveReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/SummaryReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/SummaryReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/TrendReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/TrendReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/UnitPathReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/UnitPathReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/UserDetailReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/UserDetailReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/CompletedUsers/CompletedUsersReporting.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/CompletedUsers/CompletedUsersReporting.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Email/BuildEmailReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Email/BuildEmailReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Individual/IndividualReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Individual/IndividualReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Summary/SummaryReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Summary/SummaryReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Trend/TrendReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Trend/TrendReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/General/ToolBook/ToolBookListener.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/General/ToolBook/ToolBookListener.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.ImportUsers.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.ImportUsers.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.Login.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.Login.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.ReportCriteria.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.ReportCriteria.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.Header.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.Header.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.ReportsMenu.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.ReportsMenu.ascx', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Help.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Help.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.CompletedUser') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.CompletedUser', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.CourseStatus') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.CourseStatus', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.ActiveInactive') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.ActiveInactive', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Trend') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Trend', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.UnitPathway') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.UnitPathway', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.UserDetail') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.UserDetail', 'report', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Application/ApplicationConfiguration.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Application/ApplicationConfiguration.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.TreeView') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.TreeView', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.QuizLessonEntry') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.QuizLessonEntry', 'user control', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Global.Common') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Global.Common', 'common', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Modules/ResetLesson.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Modules/ResetLesson.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Modules/ResetQuiz.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Modules/ResetQuiz.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Licensing/Default.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Licensing/Default.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ContentAdministration/Licensing/Detail.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ContentAdministration/Licensing/Detail.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/LicensingReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/LicensingReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Licensing') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Licensing', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Application/OrgModAccess.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Application/OrgModAccess.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.IncompleteUserWithDetails') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.IncompleteUserWithDetails', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Application/OrganisationApplicationAccess.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Application/OrganisationApplicationAccess.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/EmailSentReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/EmailSentReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Policy/policydefault.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Policy/policydefault.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Policy/policydetails.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Policy/policydetails.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/MoveUsersToUnit.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/MoveUsersToUnit.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/ArchiveUsers.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/ArchiveUsers.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/CPD/cpddefault.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/CPD/cpddefault.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/CPD/cpddetail.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/CPD/cpddetail.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/CPD/CPDReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/CPD/CPDReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/CPD/CPDEmailReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/CPD/CPDEmailReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Policy/PolicyBuilderReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Policy/PolicyBuilderReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'GLOBAL.UserControls.UserMenu.ascx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'GLOBAL.UserControls.UserMenu.ascx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Policies') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Policies', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Default.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Default.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.CPDReport') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.CPDReport', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/ViewPolicy.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/ViewPolicy.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Admin/UnitAdministratorReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Admin/UnitAdministratorReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.UnitAdministratorReport') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.UnitAdministratorReport', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Users/EmailUsers.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Users/EmailUsers.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/WarningReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/WarningReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Warning') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Warning', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Administration') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Administration', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/AtRiskReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/AtRiskReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.AtRisk') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.AtRisk', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Admin/UnitComplianceReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Admin/UnitComplianceReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.UnitComplianceReport') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.UnitComplianceReport', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Advanced/ProgressReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Advanced/ProgressReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'Report.Progress') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'Report.Progress', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/Email/PolicyEmailReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/Email/PolicyEmailReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Reporting/PeriodicReport.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Reporting/PeriodicReport.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/TimeZone.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/TimeZone.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/TimeZoneEdit.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/TimeZoneEdit.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/OrgMailSetup.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/OrgMailSetup.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
if not exists (select * from tblLangInterface where LangInterfaceName = N'/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') insert into tblLangInterface (LangInterfaceName, InterfaceType, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx', 'aspx', 1, 1, null, getdate(), '10 Feb 2008 22:05:23', null, newid()) 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOldPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOldPassword'), N'Old Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNewPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNewPassword'), N'New Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmPassword'), N'Confirm Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserActive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserActive'), N'User Active', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastLoginLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastLoginLabel'), N'Last Logon', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPasswordInstruction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPasswordInstruction'), N'Note: leave blank if you do not wish to change password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'User Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.3'), N'Return to Application Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.5'), N'Return to Add User page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.6'), N'Return to Add Application Administrator page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.7'), N'Return to Application Administrators page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo.8'), N'Return to User Search page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'The User''s Details have been added successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2'), N'Add Application Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.3'), N'Add User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.4'), N'Personal Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastLogin.Never')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastLogin.Never'), N'Never', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkUserStatus.ToolTip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkUserStatus.ToolTip'), N'You cannot change your own User Active status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessageUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessageUnit'), N'No units exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error.Password')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error.Password'), N'That password is not secure', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.11'), N'The specified unit could be found or may not be active.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.4'), N'Your old password was entered incorrectly so the user details have not been saved. Please try again and if the problem persists please contact your administrator.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.41')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.41'), N'You do not have the permissions required to update this user.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.42')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.42'), N'The username {0} already exists.  Please choose another username for this user.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.41')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.41'), N'The email address {0} already exists.  <BR>Please choose another email address.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminPrivileges')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminPrivileges'), N'Unit Administrator Privileges', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoAdminPrivileges')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoAdminPrivileges'), N'No Administrator Privileges.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalIDLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalIDLabel'), N'External ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblApplicationAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblApplicationAdmin'), N'Application Adminstrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationAdmin'), N'Organisation Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Not assigned to a unit.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassLabel'), N'Grouping', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserStatus'), N'No User Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkModuleAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkModuleAccess'), N'Set Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleMessage'), N'(This will override the User''s default Unit Module Access)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cvlUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cvlUnit'), N'You must specify the Unit.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFirstName'), N'You must specify the First Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvLastName'), N'You must specify the Last Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvUserName'), N'You must specify the Username.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revUserName'), N'User Name must be at least 3 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cvlOldPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cvlOldPassword'), N'You must specify the "Old Password" when attempting to change the password.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvlPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvlPassword'), N'You must specify the Password.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cpvOldPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cpvOldPassword'), N'"New Password" and "Old Password" cannot be the same.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvlConfirmPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvlConfirmPassword'), N'You must specify the Confirm Password.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cvlConfirmPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cvlConfirmPassword'), N'Confirm Password is required when attempting to change your password.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cpvPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cpvPassword'), N'New Password and Confirm Password do not match. Please enter them again.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvEmail'), N'You must specify the Email.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revEmail'), N'Email address is not in the correct format. Please enter it again.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkApplicationAdministrators')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkApplicationAdministrators'), N'Application Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUserSearch')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUserSearch'), N'User Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddUser'), N'Add User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPersonDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPersonDetails'), N'Personal Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitSearch')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitSearch'), N'Unit Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitMangement')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitMangement'), N'Move Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddOrganisation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddOrganisation'), N'Add Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrganisationDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrganisationDetails'), N'Organisation Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrganisationConfiguration')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrganisationConfiguration'), N'Organisation Configuration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgAdministrators')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgAdministrators'), N'Organisation Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkModifyLinks')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkModifyLinks'), N'Modify Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgImportUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgImportUsers'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkBulkAssignUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkBulkAssignUsers'), N'Assign Users to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkCourseAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkCourseAccess'), N'Course Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPublishContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPublishContent'), N'Publish Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddCourse'), N'Add Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkEditCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkEditCourse'), N'Course Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppAuditing')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppAuditing'), N'Application Auditing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppDependencies')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppDependencies'), N'Dependent Components', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppConfig')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAppConfig'), N'Configuration Values', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkDomainName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkDomainName'), N'Organisation Domain Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hypLanguageTranslation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'hypLanguageTranslation'), N'Language Translation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewErrorLog')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewErrorLog'), N'View Error Log', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuUser'), N'User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuUnit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuOrganisation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuOrganisation'), N'Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuCourseContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuCourseContent'), N'Course Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuConfiguration')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdminMenuConfiguration'), N'Configuration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectOrganisation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectOrganisation'), N'Select Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Summary') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Summary'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptEffectiveDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptEffectiveDate'), N'Effective Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Summary') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptNoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Summary'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptNoUsers'), N'No of Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptInComplete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptInComplete'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptComplete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptComplete'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPage'), N'Page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.4'), N'The username {0} already exists.  Please choose another username.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.7'), N'This record has already been updated by another user, please refresh your screen. If the problem persists please contact your administrator.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProductLicensedTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProductLicensedTo'), N'This product is licensed to: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMoreInformation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMoreInformation'), N'For more information visit our web site at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCertificateComplete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCertificateComplete'), N'This is to certify that<br><b>{0}</b><br>from<br><b>{1}</b><br>has completed the salt™<br><b>{2}</b><br>training on <br><b>{3}</b><br><br>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse.None')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse.None'), N'You do not have access to any courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse.Selected')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse.Selected'), N'Course: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStep1Label')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStep1Label'), N'Step 1.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStep1Text')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStep1Text'), N'The courses you need to complete are: (please choose the one you would like to work through)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Label')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Label'), N'Step 2.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Text')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Text'), N'Click on a lesson or quiz icon to begin. <br />Use the status indicators to see which lessons and quizzes you have finished.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome'), N'Welcome to <span class=''ApplicationNameInline''>{0}</span><span class=''TradeMarkInline''>{1}</span>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome.Add1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome.Add1'), N'Click a lesson or quiz icon to begin.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Text.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStep2Text.2'), N'You have chosen <b>{0}</b>, your requirements are as below', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewCertificate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewCertificate'), N'Congratulations! Click here to view your certificate of completion', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'locModule')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'locModule'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'locBegin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'locBegin'), N'Begin', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'locQuickFacts')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'locQuickFacts'), N'Quick Facts', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'locLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'locLesson'), N'Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'locQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'locQuiz'), N'Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHi')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHi'), N'Hi {0},', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_StatusKey')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_StatusKey'), N'Status Key', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_NotStarted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_NotStarted'), N'Not Started', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_InProgress')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_InProgress'), N'In Progress', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Completed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Completed'), N'Completed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_NewContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_NewContent'), N'New Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Expired')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Expired'), N'Expired', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Passed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Passed'), N'Passed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Failed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Failed'), N'Failed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'imgLaunchLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'imgLaunchLesson'), N'Launch Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'imgLaunchQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'imgLaunchQuiz'), N'Launch Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'imgQuickFacts')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'imgQuickFacts'), N'Quick Facts', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Disclaimer.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Disclaimer.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Disclaimer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Disclaimer.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDisclaimerContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Disclaimer.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDisclaimerContent'), N'There are links contained within SALT Training, to linked websites. Those links are provided for convenience only and may not remain current or be maintained. When accessed, these links will appear in separate pages outside the SALT Training being undertaken. Blake Dawson has no control over the content, goods and services offered on or through that site. Links to those linked websites should not be construed as any endorsement, approval, recommendation, or preference by us of the owners of operators of the sites, or for any information, products or services referred to on those other websites. Your use of any link to a linked website is entirely at your risk.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSectionTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSectionTitle'), N'Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'fr-FR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'fr-FR'), N'French', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'bg-BG')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'bg-BG'), N'Bulgarian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'zh-CHS')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'zh-CHS'), N'Simplified Chinese', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cs-CZ')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'cs-CZ'), N'Czech', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'da-DK')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'da-DK'), N'Danish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'nl-NL')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'nl-NL'), N'Dutch', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'fi-FI')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'fi-FI'), N'Finnish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'de-DE')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'de-DE'), N'German', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'el-GR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'el-GR'), N'Greek', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hu-HU')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'hu-HU'), N'Hungarian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'is-IS')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'is-IS'), N'Icelandic', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'id-ID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'id-ID'), N'Indonesian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'it-IT')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'it-IT'), N'Italian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ja-JP')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'ja-JP'), N'Japanese', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ko-KR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'ko-KR'), N'Korean', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lv-LV')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'lv-LV'), N'Lithuanian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lt-LT')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'lt-LT'), N'Latvian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pl-PL')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'pl-PL'), N'Polish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pt-PT')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'pt-PT'), N'Portugese', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ro-RO')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'ro-RO'), N'Romainan', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ru-RU')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'ru-RU'), N'Russian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'sk-SK')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'sk-SK'), N'Slovak', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'sl-SI')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'sl-SI'), N'Slovenian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'es-ES')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'es-ES'), N'Spanish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'sv-SE')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'sv-SE'), N'Swedish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'tr-TR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'tr-TR'), N'Turkish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hr-HR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'hr-HR'), N'Croatian', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWarningMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWarningMessage'), N'<strong>Warning:</strong> This program and the data contained in or processed by this program belong to Blake Dawson and are protected by copyright law. It is a breach of copyright law to reproduce, modify or communicate to the public any part of this program or those data, without our prior consent.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkTermsOfUse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkTermsOfUse'), N'Terms of Use', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPrivacyPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPrivacyPolicy'), N'Privacy Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litAbout')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litAbout'), N'About', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litUserName'), N'Username:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litPassword'), N'Password:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnLogin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnLogin'), N'Login', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'About', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Certificate', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Login', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Password Recovery', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblText'), N'Enter your email address and your login information will be sent to you.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRecover')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRecover'), N'Email Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSaltUnavailable')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSaltUnavailable'), N'Salt is temporarily unavailable - please try again later.<P> We apologise for any inconvenience this may have caused.</P> <P>Your Salt Team</P>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Sent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Sent'), N'Login Information has been sent to:<BR>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NotFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NotFound'), N'Your email address is not currently recorded in Salt, or is recorded incorrectly. Please check that you have keyed in your email address correctly. If you have keyed in the address correctly, but still receive this message, please contact your <b>company''s Salt Administrator</b>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.1'), N'You requested a reminder for your username and password for {0}. The details are:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.2'), N'If you did not request this reminder, please contact your organisation''s IT Help Desk.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.3'), N'Request Information', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.4'), N'This request was made at: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.5'), N'Date:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.6'), N'Time:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.7'), N'Security Information', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.8'), N'This request was made from:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.9'), N'Host: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail.10'), N'IP:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Authorised User Terms of Use', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading1'), N'AUTHORISED USER TERMS OF USE', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading2'), N'Currency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading3'), N'Licence', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading4'), N'Account', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading5'), N'Restrictions', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading6'), N'Copyright', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading7'), N'Trade Marks', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading8'), N'Linked Web Sites', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading9'), N'Privacy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading10'), N'Spam', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termsheading11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termsheading11'), N'Indemnity', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext2'), N'Welcome! By using the application which Blake Dawson provides at this Website, you agree to be bound by the following terms and conditions (the &quot;Terms of Use&quot;). Blake Dawson may change these Terms of Use at any time without notice. Any amendment will be effective immediately. Your use of this Website after any amendment constitutes an agreement by you to comply with and be bound by the amended Terms of Use. Accordingly, you should read these Terms of Use from time to time for changes.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext3'), N'BD has granted you a licence to use this application. Blake Dawson has not granted you any other rights in relation to this application.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext4'), N'Your username and password are secret and confidential. You must not disclose your username or password to anyone. You are responsible for maintaining the confidentiality of your username and password. You are responsible for all uses of your account, whether or not actually or expressly authorised by you.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext5'), N'<p> You must not: </p>
<ol type="a">
<li>sublicense, assign or transfer your licence to use this application to any other Person (whether for commercial or non-commercial purposes); </li>
<li> reproduce this application, or allow any other Person to reproduce this application; </li>
<li>alter, modify or merge this application with any other information, data or material without Blake Dawson''s prior written consent; </li>
<li> except to the extent permitted by applicable law, reverse assemble, reverse compile, reverse engineer or otherwise translate this application; or </li>
<li> cause or permit anything which may damage or endanger the intellectual property of Blake Dawson or others in this application, or assist or allow any other Person to do so.</li>
</ol>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext6'), N'This application is the copyright property of Blake Dawson and its licensors. You gain no rights to the application other than the licence expressly provided. All rights are reserved.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext7'), N'<p> All trade marks, displayed in the application and otherwise on the Website (the &quot;Trade Marks&quot;) are proprietary to their respective owners and are protected by applicable trade mark and copyright laws. These Trade Marks may be registered or unregistered marks of Blake Dawson or others. The following trade marks and other Blake Dawson products and services referred to in the application Website are trade marks of Blake Dawson: </p>
<ul>
<li>BLAKE DAWSON</li>
<li> BD</li>
<li> SALT (Self Administered Legal Training) </li>
</ul>
<p> Nothing contained on the Website should be construed as granting any licence or right of use of any other person or entities trade mark which is displayed in the application or on this Website without their express permission. </p>
<p> If you use any of our Trade Marks to refer to our activities, products or services, you must include a statement attributing that Trade Mark to us. You must not use any of our Trade Marks: </p>
<ol type="a">
<li>in or as the whole or part of your own trade marks;</li>
<li>in connection with activities, products or services which are not ours;</li>
<li>in a manner which may be confusing, misleading or deceptive; and</li>
<li>in a manner that disparages us or our information, products or services.</li>
</ol>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext8'), N'<p> This Website may contain links to other websites. Those links are provided for convenience only and may not remain current or be maintained. </p>
<p> Links to those linked websites should not be construed as any endorsement, approval, recommendation, or preference by us of the owners of operators of the websites, or for any information, products or services referred to on those other websites. Your use of any link to a linked website is entirely at your risk. </p>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext9'), N'You acknowledge that Blake Dawson will collect personal information about you (such as your e-mail address) for the purposes of providing Self Administered Legal Training (&quot;<strong>Salt</strong> &trade; &quot;), recording the outcome of the <strong>Salt</strong> &trade; training and disclosing that information to your employer. Blake Dawson may also disclose your personal information to Blake Dawson employees and entities controlled by it for the same purposes. The Blake Dawson Privacy Policy can be found at <a href="http://www.blakedawson.com">http://www.blakedawson.com</a>. By engaging in this <strong>Salt</strong> &trade; training, you consent to Blake Dawson collecting, using and disclosing your personal information for the purposes set out above.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext10'), N'You consent to Blake Dawson sending to you commercial electronic messages for the purposes of providing the <strong>Salt&trade; </strong>application.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'termstext11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/TermsOfUse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'termstext11'), N'You must indemnify, defend and hold harmless Blake Dawson, its officers and agents from any and all third party claims, liability, damages and/or costs (including, but not limited to, legal fees) arising from your violation of the Terms of Use or your infringement, or infringement by any other user of your account, of any intellectual property or other right of any Person or entity.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/AdministrationHome.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdministrationWelcome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/AdministrationHome.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdministrationWelcome'), N'Welcome to <span class=''ApplicationNameInline''>{0}</span><span class=''TradeMarkInline''>{1}</span> Administration. Please choose an item on the left of the screen to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleStatusUpdateLastRun')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleStatusUpdateLastRun'), N'Never', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'strSqlAgentRunningStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'strSqlAgentRunningStatus'), N'This feature is not currently enabled. <br />To enable this feature EXECUTE permission must be enabled on object ''xp_servicecontrol''<br/>in database ''master'' for the website database user<br />If you require this feature please contact your database administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'InvalidDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'InvalidDateRange'), N'Invalid date range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchMessage.Non')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchMessage.Non'), N'No Matching Emails Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Module status update job may take a few minutes to run. Do you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/AdministrationHome.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/AdministrationHome.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Administration Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Application Auditing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Application Auditing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleStatusUpdate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleStatusUpdate'), N'Module Status Update Job', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastRun')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastRun'), N'Last run:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunModuleStatusUpdate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunModuleStatusUpdate'), N'Run now', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSqlagentStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSqlagentStatus'), N'Sqlagent running status:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchEmail'), N'Search Email Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom'), N'Date From:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo'), N'Date To:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip'), N'Recipient:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject'), N'Subject:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBody'), N'Body:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:05 AM
GO


-- Friday, 8 July 2011 - 9:47:05 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_DateSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_DateSent'), N'Date Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_To')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_To'), N'To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Subject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Subject'), N'Subject', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Body')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Body'), N'Body', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litPage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litPage'), N'Page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litOf')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litOf'), N'of', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litDisplayed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litDisplayed'), N'records displayed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnNext')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnNext'), N'Next &gt;&gt;', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPrev')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPrev'), N'&lt;&lt; Prev', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationAuditing.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Find', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Add Organisation Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Course Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Import Users Sample', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Modify Classification Options', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Modify Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Organisation Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Application Configuration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Organisation Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Add Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Add Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Compliance Rules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Move Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Application Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'User Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'User Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'User Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Add Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Course Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Publish InfoPath Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Module Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Upload Toolbook Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Error Handler', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Error Handler', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Error Handler', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/InfoPath/Rendering/TemplateLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/InfoPath/Rendering/TemplateLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/InfoPath/Rendering/TemplateQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/InfoPath/Rendering/TemplateQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Administration Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdminSummaryReportTesting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdminSummaryReportTesting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'AdminSummaryReportTesting', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Course Status Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Active / Inactive Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Path Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'User Detail Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Build Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Individual Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Quiz History', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Quiz Result', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Quiz Summary', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/ReportingHome.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/ReportingHome.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Reporting Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Add Organisation Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName'), N'First Name:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName'), N'Last Name:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Find', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_AddAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_AddAdmin'), N'Add Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_AddButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_AddButton'), N'Add', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddAdmin'), N'Add Application Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ApplicationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Application Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Assign Users to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litUsers'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litSelectUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litSelectUnit'), N'Select a Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastUpdated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastUpdated'), N'Last Updated', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkAddUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkAddUser'), N'Add To Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnAssign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnAssign'), N'Return to Assign Users to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAssign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAssign'), N'Assign Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Assign Users to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'You are about to assign users to a unit.\nAre you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Select')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Select'), N'You must select a unit to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned'), N'Assigned all users to ''{0}''.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned2'), N'Assigned {0} users to ''{1}''.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUsers'), N'You must select some users to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUnit'), N'Please select a unit to assign these users to.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No Unassigned users found in the system at this time.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Course Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_CourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_CourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_AllowAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_AllowAccess'), N'Allow Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourse'), N'No courses were found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Success')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/CourseAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Success'), N'Course Access has been saved successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Sample CSV and XML Files.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'You are about to disable this Classification. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Modify Clasification Options (For Grouping Users)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAddValue')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAddValue'), N'Add Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblValue')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblValue'), N'Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd'), N'Add Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToOrgAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToOrgAdmin'), N'Return to Organisation Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_ClassValue')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_ClassValue'), N'Classification Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.Modify')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.Modify'), N'Modify ''{0}'' Grouping Options', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Supply')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Supply'), N'You must supply a value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Added')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Added'), N'Value has been added', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Modify Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAddLink')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAddLink'), N'Add Link', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCaption')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCaption'), N'Caption', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litNote'), N'Note: Links without a URL will be treated as dividers.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblURL')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblURL'), N'URL', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litShowDisclaimer')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litShowDisclaimer'), N'Show Disclaimer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd'), N'Add Link', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LinkCap')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LinkCap'), N'Link Caption', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Url')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Url'), N'Url', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_ShowDisclaimer')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_ShowDisclaimer'), N'Show Disclaimer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkDeleteButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkDeleteButton'), N'Delete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkUpdateButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkUpdateButton'), N'Update', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkModifyButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkModifyButton'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Caption')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Caption'), N'A caption must be supplied.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SpecifyCaption')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SpecifyCaption'), N'You must specify the link caption.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'RemoveConfirm')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'RemoveConfirm'), N'You are about to remove the Administration rights for {0}.  Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Organisation Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddOrganisationAdministrator')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddOrganisationAdministrator'), N'Add Organisation Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkRemoveButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkRemoveButton'), N'Remove', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'The selected organisation administrator has been successfully removed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Configuration Values', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_UserDefault')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_UserDefault'), N'Use Application Default Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Description')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Description'), N'Description', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Value')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Value'), N'Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Delete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Delete'), N'Delete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkCustomiseButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkCustomiseButton'), N'customise', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Organisation Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgName'), N'Organisation Name:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgNotes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgNotes'), N'Organisation Notes:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgLogo'), N'Organisation Logo:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessFreq'), N'Expire Lesson Results After:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMark'), N'Default Quiz Pass Mark:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessDate'), N'Or Lesson Expiry Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDate'), N'Quiz Expiry Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdvReporting')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdvReporting'), N'Advanced Reporting:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkModifyClassificationOptions')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkModifyClassificationOptions'), N'Modify Grouping Options', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClasification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClasification'), N'Group By:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAdvancedReporting')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAdvancedReporting'), N'No', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litOverQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litOverQuiz'), N'would you like to apply this to the entire unit tree - overriding any existing exception Quiz compliance rules?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litOverLess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litOverLess'), N'would you like to apply this to the entire unit tree - overriding any existing exception Lesson compliance rules?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litLogoNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litLogoNote'), N'Width: < 200px, Height: 63px;', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.Add')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.Add'), N'Add Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'YES')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'YES'), N'Yes', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NO')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'NO'), N'No', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoOrg'), N'No Organisations Exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved'), N'The Organisation''s Details have been updated successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ImageUploadError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ImageUploadError'), N'You may upload GIF, JPG or BMP Files only', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Error')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Error'), N'The Organisation notes may contain no more than 4000 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationName'), N'You must specify the organisation name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationNotes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationNotes'), N'You must specify the organisation notes.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorOrganisationLogo'), N'You must specify the organisation logo.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorDefaultQuizPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorDefaultQuizPassMark'), N'You must specify the default quiz pass mark.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Months')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'Months'), N'months', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Add Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitHier')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitHier'), N'Unit Hierachy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optUnitLevel_CreateTop')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optUnitLevel_CreateTop'), N'Create a top level unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optUnitLevel_CreateSub')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optUnitLevel_CreateSub'), N'Create a sub unit of...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cvldParentUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cvldParentUnit'), N'You must specify a parent unit in the Unit Hierachy.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldName'), N'You must specify the Unit Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoParent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoParent'), N'Please select a parent unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Add Unit Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn'), N'Return to Administrator List', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchResults')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchResults'), N'Search Results', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAdd'), N'Add Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkAdminSub')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkAdminSub'), N'Administer Sub-units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Pathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Pathway'), N'Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUser'), N'You did not select a user!', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Are you sure you want to over-write any existing Compliance Rules with these selected values?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Compliance Rules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseLabel'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSetAllRules')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSetAllRules'), N'Set All Modules'' Rules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessFreq'), N'Lesson Frequency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizFreq'), N'Quiz Frequency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessDate'), N'Lesson completion date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDate'), N'Quiz completion date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPopulateAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPopulateAll'), N'Populate to all Modules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSetIndivid')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSetIndivid'), N'Set Module Rules Individually', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Default')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Default'), N'Default', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessFreq'), N'Lesson Freq.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizFreq'), N'Quiz Freq.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessDate'), N'Lesson Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_FreqDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_FreqDate'), N'Quiz Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkUpdateButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkUpdateButton'), N'Update', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkModifyButton')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkModifyButton'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PassMarkError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'PassMarkError'), N'Pass Mark must be integer, and between 1 to 100', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourseAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourseAccess'), N'There is no course access.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Populated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Populated'), N'The Compliance Rules have been populated to all the modules in the course.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Updated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Updated'), N'The Compliance Rules have been updated for the selected module.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'RemoveMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'RemoveMessage'), N'You are about to remove {0} as an Administrator of this Unit. Are you sure to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitAdmin'), N'Unit Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn'), N'Add Unit Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_btnRemove')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_btnRemove'), N'Remove', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLinks')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLinks'), N'Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUsers'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSubUnits'), N'Sub-Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPathwayLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPathwayLabel'), N'Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitID'), N'Unit ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no active sub-units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkImportUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkImportUsers'), N'Import Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddNewUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddNewUser'), N'Add New User to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssign'), N'Assign Modules to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkSetRules')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkSetRules'), N'Set Compliance Rules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkManagaeUnitAdmin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkManagaeUnitAdmin'), N'Manage Unit Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'permissionConfirm')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'permissionConfirm'), N'You are about to move a Unit in the hierarchy.  This may alter the rights of administrators to the Unit. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'unitConfirm')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'unitConfirm'), N'The Unit will be moved to TOP LEVEL. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Move Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no sub-units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFrom'), N'From:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTo'), N'To:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkTopLevel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkTopLevel'), N'Top Level', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnMove')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnMove'), N'Move >>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.From')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.From'), N'You must specify the From Unit to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.To')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.To'), N'You must specify the To Unit to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.Moved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitManagement.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.Moved'), N'The specified unit has been moved successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Warning:This action will change the module access of users in this Unit. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Assign Modules to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblGrantAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblGrantAll'), N'Grant Access to all children units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModList')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModList'), N'Module List', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseLabel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseLabel'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_GrantAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_GrantAccess'), N'Grant Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litMessage'), N'Please Note: When you Grant Access to a module for the first time, the {0} default compliance rules will apply. To set other compliance rules for this
unit return to the {1}
screen and then click on the Set Compliance Rules link.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUnitDetails'), N'Unit Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourseAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourseAccess'), N'There is no course access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved'), N'Unit Module Access has been saved successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no units.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitHier')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitHier'), N'Unit Hierarchy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive'), N'Show Inactive Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Find', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitCount'), N'Found {0} unit(s)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Pathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Pathway'), N'Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUnits'), N'No Matching Units Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'UnitUser - Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleList')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModuleList'), N'Module List', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_ModuleName'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_GrantAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_GrantAccess'), N'Grant Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn'), N'Return to User Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'User Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no units.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName'), N'Username', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive'), N'Show Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount'), N'Found {0} user(s)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastLogin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastLogin'), N'Last Login', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Add Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNotes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNotes'), N'Notes', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldName'), N'You must specify the Course Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldCourseNotes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/AddCourse.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldCourseNotes'), N'You must specify the Course Notes.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Course Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoCourses'), N'There are no courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModules')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModules'), N'Modules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNotes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNotes'), N'Notes', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCources')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCources'), N'Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litFeedbackMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litFeedbackMessage'), N'Select the course above and then edit its details below', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUpdateButton.Add')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUpdateButton.Add'), N'Add New Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.1000')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.1000'), N'The course notes may contain no more than 1000 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved'), N'The course details were saved successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnMoveUp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnMoveUp'), N'Move Up', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnMoveDown')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnMoveDown'), N'Move Down', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Publish Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPublishedTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPublishedTo'), N'Published To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPublish')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPublish'), N'Publish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPreview'), N'Preview', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNote'), N'Note: These override the default layout for individual pages.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageLevelLayout')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageLevelLayout'), N'Page Level Layout', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDefaultLayout')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDefaultLayout'), N'Default Layout', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblContentStyle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblContentStyle'), N'Content Style', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload'), N'Upload', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFactSheet')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFactSheet'), N'Select Quick Fact Sheet (if necessary)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectInfoPath')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectInfoPath'), N'Select Info Path Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTypeNewContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTypeNewContent'), N'Type of new content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radLesson'), N'Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radQuiz'), N'Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFile'), N'<br/>Select a file to upload', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPreviewContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPreviewContent'), N'Build Preview', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreview'), N'Preview Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPublishContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPublishContent'), N'Publish Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PageTitle'), N'Page Title', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PageType')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PageType'), N'Page Type', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPreviewMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPreviewMessage'), N'Preview Generated', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.1'), N'Error Creating Directories:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.2'), N'Error Uploading Content File:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.3'), N'Error Uploading Fact Sheet File:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.4'), N'Error Loading File:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.5'), N'Error converting infopath content: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error.1'), N'No content provided', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error.2'), N'No Quick Fact Sheet provided. A lesson requires a one.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error.3'), N'Quick Fact Sheet provided. This cannot be used with a quiz.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error.4'), N'no file specified', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Module Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuickFact')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuickFact'), N'Quick Fact Sheet Worksite ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessionWorkSite')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessionWorkSite'), N'Lesson Worksite ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizWorkSite')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizWorkSite'), N'Quiz Worksite ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblToolBook')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblToolBook'), N'Toolbook Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload'), N'User selection', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDescription')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDescription'), N'Description', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldName'), N'Please enter a Module Name to proceed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnResetStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnResetStatus'), N'Commit - Quiz Status Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvQWorksiteID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvQWorksiteID'), N'* Required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvLWorksiteID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvLWorksiteID'), N'* Required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvQFWorksiteID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvQFWorksiteID'), N'* Required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUploadContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUploadContent'), N'Upload New Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToCourseDetail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToCourseDetail'), N'Return to Course Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.1'), N'All users who have started the quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.NoLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.NoLesson'), N'No Lesson loaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.NoQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.NoQuiz'), N'No Quiz loaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.1'), N'No Quiz loaded. This module cannot be made active until a Quiz is uploaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.2'), N'Quiz: {0} uploaded on {1}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.3'), N'Error: More than 1 Quiz available. Please correct this before saving.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDetails.4'), N'Cannot upload a Quiz until the Module has been saved', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQWorksiteMsg.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQWorksiteMsg.1'), N'No Quiz Loaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.1'), N'No Lesson loaded. This module cannot be made active until a Lesson is uploaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLWorksiteMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLWorksiteMsg'), N'No Lesson Loaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQFWorksiteMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQFWorksiteMsg'), N'No Lesson Loaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails'), N'Lesson: {0} uploaded on {1}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.2'), N'Error: More than 1 Lesson available. Please correct this before saving.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonDetails.3'), N'Cannot upload a Lesson until the Module has been saved', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'InvalidMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'InvalidMessage'), N'Module status set inactive as there is no lesson or quiz loaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'The module description may contain no more than 1000 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.2'), N'The module details were saved succesfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Upload Content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToModuleDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToModuleDetails'), N'Return to Module Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnUpload'), N'Upload', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDetails'), N'Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNewContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNewContent'), N'Type of new content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNewLocation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNewLocation'), N'Location of new content', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radInfoPath')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radInfoPath'), N'InfoPath', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radToolbook')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radToolbook'), N'Toolbook', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFormatInstruction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFormatInstruction'), N'This is the directory that contains the new content on the server.
<br>
It should be in the format:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFormatInstruction2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFormatInstruction2'), N'Example:
<br>
If new content was uploaded into a directory named ''UpdatedContent''
<br>
then enter:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadMsg'), N'Do you really want to upload new content?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage1'), N'Unknown error uploading new content.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage2'), N'Error uploading new content: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage3'), N'Unknown error uploading new content.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage4'), N'Unknown error uploading new content.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage5'), N'Error uploading new content.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage6'), N'The specified physical path does not exist on {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError1'), N'Cannot find file: {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError2'), N'Cannot find directory: {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError3'), N'Cannot find the control file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError4'), N'Cannot find the data file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError5'), N'Cannot find the default.aspx', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ErrorFile6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ErrorFile6'), N'Cannot find the InfoPathContent file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:06 AM
GO


-- Friday, 8 July 2011 - 9:47:06 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileError6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileError6'), N'Cannot find the InfoPathContent file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'System Error', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litError1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litError1'), N'The requested page cannot be displayed because an error has occurred.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litError2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litError2'), N'Please select the back button on your browser and try again.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litError3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litError3'), N'Please help us to improve our site by reporting persistent errors to: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails1'), N'Error Details: Salt (or Reporting) is temporarily unavailable - please try again later.<P> We apologise for any inconvenience this may have caused.</P> <P>Your Salt Team</P>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails2'), N'Error Details: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails3'), N'Error Details: Salt (or Reporting) is temporarily unavailable - please try again later.<P> We apologise for any inconvenience this may have caused.</P> <P>Your Salt Team</P>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ErrorHandler.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblErrorDetails4'), N'It has been logged: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'System Error', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/NoSuchPage.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litError'), N'The requested page cannot be found
<br>
<br>
<br>
Please select the back button on your browser and try again.
<br>
<br>
Please help us to improve our site by reporting persistent errors to: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'System Error', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/Errors/ValidationException.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litError'), N'The application has detected  an attempt to enter a potentially dangerous value.
<br>
This could have been in a text field or in the querystring. Under no
circumstance is this allowed in this application.
<br>
Please do not attempt to enter <b>&lt;HTML&gt;</b> or <b>&lt;Script&gt;</b> tags.
<br>
<br>
Please select the back button on your browser and try again.
<br>
<br>
Please help us to improve our site by reporting persistent errors to', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Validation.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'Validation.1'), N'You can only specify a Frequency or the Completion Date, not both.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Validation.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'Validation.2'), N'You must enter Frequency or Completion Date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Validation.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'Validation.3'), N'Invalid date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Validation.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'Validation.4'), N'Completion Date must be a current or future date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error1'), N'Please make sure you do not use your browser''s backwards and forwards buttons. Navigate lessons and quizzes using the buttons in the bottom right hand corner.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error2'), N'There is a problem with the page you are visiting, either you have already finished this lesson, or the page should not exist', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Error3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/General/ToolBook/ToolBookListener.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Error3'), N'There was a problem recording the finishing of your lesson, details may not have been saved', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litSampleCSVLink')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litSampleCSVLink'), N'Sample CSV and XML Files', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblXmlFileUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblXmlFileUsers'), N'XML File of Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadXML')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadXML'), N'Preview Users From XML', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVFileUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVFileUsers'), N'CSV File of Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadCSV')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnUploadCSV'), N'Preview Users From CSV', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkMoreUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkMoreUsers'), N'Import More Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Record')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Record'), N'Record', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitID'), N'UnitID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Reason')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Reason'), N'Reason', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCSV')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCSV'), N'An CSV file must be provided to upload.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Invalid')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Invalid'), N'This is an invalid CSV file.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoXML')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoXML'), N'An XML file must be provided to upload.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.Permission')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.Permission'), N'An illegal action was performed or your role has been changed. You have been logged out of {0}.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.LoginFailure')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.LoginFailure'), N'The login details you have entered are not correct.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.LoginFailure2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.LoginFailure2'), N'Your login was not successful.  Please see your Organisation Administrator.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportCriteria.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litClick')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportCriteria.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litClick'), N'Click to Collapse Report Criteria', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportCriteria.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litExpand')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportCriteria.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litExpand'), N'Click to Expand Report Criteria', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litReports')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litReports'), N'Reports', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litLinks')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litLinks'), N'Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelp'), N'Help', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPersonalReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPersonalReport'), N'Personal Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdminCurrentReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdminCurrentReport'), N'Current Admin Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdminHistoricalPointReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdminHistoricalPointReport'), N'Historic Admin Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedCourseStatusReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedCourseStatusReport'), N'Course Status Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedCompletedUsersReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedCompletedUsersReport'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedSummaryReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedSummaryReport'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedTrendReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedTrendReport'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkEmailReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkEmailReport'), N'Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbUnitPathwayReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbUnitPathwayReport'), N'Unit Pathway Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbUserDetailsReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbUserDetailsReport'), N'User Detail Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbActiveInactiveReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbActiveInactiveReport'), N'Active / Inactive Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkQuestionStatusReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkQuestionStatusReport'), N'Question Status Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReports')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReports'), N'Reports', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Trend Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Personal Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Completed Users Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Trend Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Summary Report?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Licensing Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Completed Users Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Examining Quiz Histories?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Admin Reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Examining Quiz Answers?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Administration Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFormat'), N'Format', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSortBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSortBy'), N'Sort By<br>(Within Course)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblGroupBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblGroupBy'), N'Group By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoricDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoricDate'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<br>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.1'), N'Unit/User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.2'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.1'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.2'), N'Quiz Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.3'), N'Quiz Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radFormat.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radFormat.1'), N'On Screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radFormat.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radFormat.2'), N'CSV File', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen'), N'Return to Search Screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1'), N'Current Admin Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2'), N'Historic Admin Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclUnit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclUser'), N'User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclModule')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclModule'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizStatus'), N'Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizScore'), N'Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizStatusDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclQuizStatusDate'), N'Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclLessonStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclLessonStatus'), N'Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoResults')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoResults'), N'No results found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critGroupedBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critGroupedBy'), N'Grouped By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critUnitUserSortBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critUnitUserSortBy'), N'Within Unit/User Sort By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critQuizScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critQuizScore'), N'Quiz Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critQuizDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critQuizDate'), N'Quiz Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'headingRunOn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'headingRunOn'), N'Admin Summary Report. Run On: {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'headingRunOn2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'headingRunOn2'), N'Admin Summary Report. Run On: {0} Effective: {1}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'headerBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'headerBy'), N'By: {0}, {1}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate'), N'The date/s supplied are invalid. <BR> Date ranges must encompass at least one day.<BR>You cannot run a historic report on future dates.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Course Status Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizStatus'), N'Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3'), N'Fail', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.4'), N'Not Started', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.5'), N'Expired (Time Elapsed)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.6'), N'Expired (New Content)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Quiz Date Range<BR>(Both blank for current date)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective from date must be less than to date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Active / Inactive Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAllUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAllUsers'), N'Blank for all users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCreate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCreate'), N'User creation date (from) :', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCreate2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCreate2'), N'User creation date (to) :', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The date must be valid and from date cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReportType')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReportType'), N'Report Type', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.1'), N'Table', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.2'), N'Stacked Column Chart', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.3'), N'Stacked Bar Chart', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.4'), N'Pie Chart', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTrendDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTrendDate'), N'Trend Date Range<BR>(Both blank for current date)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective from date must be less than to date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Path Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUnits'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUnits'), N'Include Inactive Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UnitPathReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'User Detail Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUserDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUserDetails'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/UserDetailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Unit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Unit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen'), N'Return to Search Screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1'), N'Completed Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2'), N'Incomplete Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No users found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EffectiveDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CompletedUsers/CompletedUsersReporting.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EffectiveDate'), N'Effective Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain'), N'Return', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent'), N'The email has been sent successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail'), N'Send Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBack')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBack'), N'Back', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerateEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerateEmail'), N'Preview Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDateRange'), N'Quiz Date Range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip'), N'Recipient', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseStatus'), N'Course Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.1'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.2'), N'Incomplete - Includes Failed and Not Started', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.3'), N'Failed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.4'), N'Not Started', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.5'), N'Expired (Time Elapsed)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radCourseModuleStatus.6'), N'Expired (New Content)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Courses<BR>(Blank for all courses)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailUserCopyBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailUserCopyBody'), N'The following email text has been sent from {0} on {1}: \n {2}\n\nIt has been sent to the following users:\n{3}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailReportSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailReportSent'), N'Email Report Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate'), N'Error: Invalid date selected', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.1'), N'Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.2'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OneRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OneRecip'), N'To send an email you must have at least one recipient, an email subject and an email body.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CourseStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'CourseStatus'), N'Course Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Recipients')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Recipients'), N'Recipients', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'From')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'From'), N'From', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'To')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'To'), N'To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Caution')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Caution'), N'Caution: Sending many emails may impact server performance.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser'), N'No users found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Personal Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Course')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Course'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Module')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Module'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessonStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LessonStatus'), N'Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizStatus'), N'Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizScore'), N'Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizPassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No Courses found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Summary/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnToSearchScreen'), N'Search again', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Unit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Unit'), N'Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Module')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Module'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizCount'), N'Quiz Count', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Avg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Avg'), N'<nobr>Avg. Score</nobr>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no sub-units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser'), N'No users found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1'), N'Trend Report - {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OnCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Trend/TrendReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OnCourse'), N'You must select at least one course.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Quiz History', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturn'), N'Return to previous screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Status')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Status'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Summary')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Summary'), N'Summary', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_YourMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_YourMark'), N'Your Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Supply')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Supply'), N'You must supply a User ID and Module ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Permission')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Permission'), N'You are not allowed to access these results', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NA')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizHistory.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NA'), N'N/A', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'You have now completed your quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassed'), N'Well done, you passed the <b>"{0}"</b> quiz.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFailed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFailed'), N'You have failed the "{0}" quiz.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMarkText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassMarkText'), N'The passmark for this quiz is <b>{0}%</b> and you scored <b>{1}%</b>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblViewQuizStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblViewQuizStatus'), N'To view your quiz results, click Quiz Summary Report.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkQuizSummaryReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizResult.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkQuizSummaryReport'), N'Quiz Summary Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:08 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Quiz Summary', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:08 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkHome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkHome'), N'EXIT', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreviousScreen')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreviousScreen'), N'Return to previous screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid1_Module')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid1_Module'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid1_Name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid1_Name'), N'Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid1_QuizScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid1_QuizScore'), N'Quiz Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid2_Question')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid2_Question'), N'Question', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid2_CorrectAnswers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid2_CorrectAnswers'), N'Correct Answers', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid2_YourAnswer')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid2_YourAnswer'), N'Your Answer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid2_Correct')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid2_Correct'), N'Correct', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreviousScreen2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPreviousScreen2'), N'Return to previous screen', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Question')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Question'), N'Question', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CorrectAnswer')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'CorrectAnswer'), N'CorrectAnswer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'GivenAnswer')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'GivenAnswer'), N'GivenAnswer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Correct')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Correct'), N'Correct', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoQuiz'), N'No quiz summary information could be found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Unable')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/QuizSummary.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Unable'), N'Unable to retrieve your quiz summary.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/ReportingHome.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReportingWelcome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/ReportingHome.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReportingWelcome'), N'Welcome to <span class=''ApplicationNameInline''>{0}</span><span class=''TradeMarkInline''>{1}</span> Reporting. Please choose an item on the left of the screen to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Help', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Help', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkBack')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkBack'), N'Back to top', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIntroduction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIntroduction'), N'INTRODUCING <span style="TEXT-TRANSFORM: uppercase">{0}</span>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help2'), N'SELECTING A COURSE', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help3'), N'HOW TO TRAIN', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help31')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help31'), N'Navigating a Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help32')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help32'), N'Lesson Material', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help33')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help33'), N'Optional Information Available', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help34')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help34'), N'Finishing and Exiting', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help35')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help35'), N'Lesson Status Indicators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help51')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help51'), N'Navigating a Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help52')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help52'), N'Quiz Material', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help53')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help53'), N'Scoring and Results', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help7'), N'COMPLETING A COURSE', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help8'), N'COMPLIANCE RULES', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help91')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help91'), N'Personal Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help92')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help92'), N'Quiz History', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help93')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help93'), N'Quiz Answers', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText53')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText53'), N'<p>When you have finished a quiz, you will be asked to submit your answers. Before
submitting your answers for marking, you can review or change them by using the
navigation buttons at the bottom right of the screen. When you are happy with
your answers, click ''Submit Answers''.
</p>
<p>You will be given a percentage score for the quiz, and be told whether you
passed.
</p>
<p>You will be given the option to view your "Quiz Summary Report" , or exit to the
Home page.
</p>
<p>You can see an overview showing your scores for each quiz, by going to your
Individual Report under the Report tab on the menu bar.
</p>
<p>The {0} Administrator for your organisation will also be able to
review your scores.
</p>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText54')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText54'), N'<p>The pass mark for each quiz is set by the {0} Administrator for
your organisation.
</p>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText52')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText52'), N'<p>Quizzes consist of a series of multiple choice questions, chosen randomly from a
database of questions. Your answers will be recorded.
</p>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText51')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText51'), N'<p>Each module contains a lesson and a quiz. You can complete quizzes in any order,
but we recommend that you work through the quizzes in the order that they
appear on the home page after you complete the lesson.
</p>
<p>To navigate through a quiz, simply answer the question presented, and click the
page forward button. The button will not appear on the page until you have
provided an answer to that question.
</p>
<p>You should only use the navigation buttons within the {0} program.
Do not use your browser''s navigation buttons as this will cause the program to
exit.
</p>
<p>Note that in order to save your quiz results, you must complete the quiz
session. You are advised not to use the exit function in the middle of a quiz
session. If you do, your results will not be saved.
</p>', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Customvalidator1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/BulkAssignUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Customvalidator1'), N'You have chosen not to assign these users at this time.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldName'), N'You must specify the Course Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Requiredfieldvalidator1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Courses/CourseDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Requiredfieldvalidator1'), N'You must specify the Course Notes.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvldName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvldName'), N'You must enter a location to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReturnTo'), N'Return to ...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptName'), N'Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDate'), N'Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptExternalID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptExternalID'), N'External ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserName'), N'User Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptOf')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptOf'), N'of', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal'), N'Unit Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotal'), N'Grand Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUsers'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCompleted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCompleted'), N'Completed', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveFrom'), N'Date Effective From', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveTo'), N'Date Effective To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Course Status Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseTotal'), N'Course Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFail'), N'Fail', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptNotStarted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptNotStarted'), N'Not Started', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiredTime')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiredTime'), N'Expired (Time Elapsed)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiredNew')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiredNew'), N'Expired (New Content)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Active / Inactive Users Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunFrom'), N'Report run from', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportRunTo'), N'Report run to', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalUsers'), N'Total Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptActiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptActiveUsers'), N'Active Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptInactiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptInactiveUsers'), N'Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFullName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFullName'), N'User Full Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserCount'), N'User count:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptInactiveUserCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptInactiveUserCount'), N'Inactive user count:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Trend Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizCount'), N'Quiz Count', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptAvgScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptAvgScore'), N'Avg. Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptModule')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptModule'), N'Module', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Unit Pathway Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitName'), N'Unit Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitID'), N'Unit ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitIDPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitPathway'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitIDPathway'), N'Unit ID Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'User Detail Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserID'), N'User ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptGroupBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptGroupBy'), N'Group By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalNoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalNoUsers'), N'Total Number of Users:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcAppConfig_Update.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcAppConfig_Update.1'), N'Record not found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_AddClassification.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_AddClassification.4'), N'The Classification Value {0} already exists for this ClassificationType please choose another value for your ClassificationType.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_AddType.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_AddType.4'), N'The ClassificationType Name {0} already exists for this organisation please choose another name for your ClassificationType.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_UpdateType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_UpdateType.1'), N'This record no longer exists please refresh your screen.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcCourse_Create.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcCourse_Create.4'), N'The Course Name {0} already exists please choose another Course Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_UpdateClassification.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcClassification_UpdateClassification.4'), N'The Classification Value {0} already exists for this ClassificationType please choose another value for your ClassificationType.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Add.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Add.4'), N'The Caption {0} already exists please choose another Caption.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Update.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Update.4'), N'The Caption {0} already exists please choose another Caption.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Delete.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcLink_Delete.1'), N'This record you tried to delete no longer exists.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcModule_Create.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcModule_Create.4'), N'There is already a module of that name within this course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcModule_Update.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcModule_Update.4'), N'There is already a module of that name within this course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_UpdateDomainName.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_UpdateDomainName.4'), N'Domain name is used by another organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.1'), N'Record not found @userID in stored procedure prcOrganisation_SetAdmin', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.6'), N'You do not have access to modify this User.  Click here to return to the login page.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_RemoveAdministrator.7'), N'The user''s details have been updated by another user, you will need to refresh the user''s details and re-enter your changes.  Click here to refresh.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.6'), N'You do not have access to modify this User.  Click here to return to the login page.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.1'), N'Record not found @userID in stored procedure prcOrganisation_SetAdmin', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_SetAdministrator.7'), N'The user''s details have been updated by another user, you will need to refresh the user''s details and re-enter your changes.  Click here to refresh.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.7'), N'The organisation''s details have been updated by another user, <br>you will need to refresh the organisation''s details and re-enter your changes.  <br><a href="OrganisationDetails.aspx">Click here to refresh</a>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.1'), N'Record not found in stored procedure prcOrganisation_Update', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.4'), N'The Organisation Name {0} already exists <br>please choose another name for your Organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Add.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Add.6'), N'You do not have access to modify this Organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Add.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Add.4'), N'The Organisation Name {0} already exists <br>please choose another name for your Organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisation_Update.6'), N'You do not have access to modify this Organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Update.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Update.2'), N'The Organisation {0} doesnt exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Update.21')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Update.21'), N'The Name {0} doesnt exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Delete.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Delete.2'), N'The Organisation {0} doesn''t exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Delete.21')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcOrganisationConfig_Delete.21'), N'The Name {0} doesn''t exist.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.7'), N'The unit''s details have been updated by another user, you will need to refresh the unit''s details and re-enter your changes.  <a href="[Url]">Click here</a> to refresh.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.10'), N'You can not deactivate a unit which contains users.  Please move the users to another unit.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.101')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.101'), N'You can not deactivate a unit which contains active sub-units.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.102')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Update.102'), N'You cannot activate a unit whose parent unit is inactive.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Create')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Create'), N'You cannot create an active unit whose parent unit is inactive.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_AddAdministrator')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_AddAdministrator'), N'You are not the administrator of the system', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_RemoveAdministrator')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_RemoveAdministrator'), N'You are not the administrator of the system', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.1'), N'You are not the administrator of the system', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.11'), N'You are not administrator of the "From" unit and all its sub-units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.12')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.12'), N'You don''t have permission to administer sub-units of the "To" unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.13')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.13'), N'The "From" unit can''t be the same as the "To" unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.14')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.14'), N'The "From" and the "To" unit should be in the same organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.15')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.15'), N'The "From" unit can''''t be the parent of the "To" unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.16')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_Move.16'), N'The "To" unit can''''t be the direct parent of the "From" unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_MoveToTopLevel.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_MoveToTopLevel.1'), N'You do not have permission to move a unit to the top level.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_MoveToTopLevel.11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUnit_MoveToTopLevel.11'), N'The ''From'' unit already exists at the top level.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'QuizLesson_Error')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'QuizLesson_Error'), N'Please make sure you do not use your browser''s backwards and forwards buttons. Navigate lessons and quizzes using the buttons in the bottom right hand corner.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Importer.cs.IsLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'Importer.cs.IsLesson'), N'Could not determine if file was a InfoPath Lesson or an InfoPath Quiz.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.FindPageIndex')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.FindPageIndex'), N'Page ID not found: {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.CacheControlFile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.CacheControlFile'), N'Cannot find control file.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.CacheDataFile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'PageContext.cs.CacheDataFile'), N'Cannot find Data file.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.Generate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.Generate'), N'CSVGenerator.Generate: Filename must be five characters or longer.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.Generate2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.Generate2'), N'CSVGenerator.Generate: No file extension suppled for CSV File.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.GenerateContent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.GenerateContent'), N'CSVGenerator.GenerateContent: The number of column names specified is not equal to the number of column names in the DataTable object', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.GenerateContent2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVGenerator.cs.GenerateContent2'), N'Cannot Display', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Generate.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Generate.1'), N'Cant read from input file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Generate.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Generate.2'), N'Cant write to output file', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.1'), N'This row has the wrong number of columns{0}...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.2'), N'Wrong number of columns', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.3'), N'This row has the wrong number of columns{0}...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.5'), N'UserName column contains a value that is too long (100 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.6'), N'First Name column contains a value that is too long (50 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.7'), N'Last Name column contains a value that is too long (50 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.8'), N'Password column contains a value that is too long (50 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.9'), N'Email column contains a value that is too long (100 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.10'), N'External ID column contains a value that is too long (50 Char Max)<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.11'), N'Email address is not in the correct format<br>The error occurred in this line:<br>{0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.12')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.12'), N'Classification Name column contains a value that is too long (50 Char Max){0}...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.13')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.13'), N'Classification Option column contains a value that is too long (50 Char Max){0}...', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSave_Click')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSave_Click'), N'The Unit''s Details have been updated successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.UserNotFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.UserNotFound'), N'User found but cannot send email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoCourse'), N'There is no course access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserModuleAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Saved'), N'User Module Access has been saved successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound'), N'No Matching Users Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.LengthError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.LengthError'), N'The course notes may contain no more than 1000 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Application Configuration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Configuration Values', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNote'), N'Note: If you are running a web farm, you will have to restart each web site if you change any configuration values.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Value')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Value'), N'Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Update')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Update'), N'Update', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Action'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.StyleSheet')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.StyleSheet'), N'Style Sheet not found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Error')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/ApplicationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Error'), N'The value you have entered is invalid.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'treeClearAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'treeClearAll'), N'Clear All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'treeExpandAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'treeExpandAll'), N'Expand All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'treeSelectAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'treeSelectAll'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'treeCollapseAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'treeCollapseAll'), N'Collapse All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'treeHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'treeHelp'), N'Help', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpA')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpA'), N'A: This is how you expand the entire unit tree', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpB')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpB'), N'B: This is how you fold the entire unit tree', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpC')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpC'), N'C: This is how you select all the units within the tree', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpD')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpD'), N'D: This is how you clear all selections within the unit tree', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpE')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpE'), N'E: Click here to see an explanatory graph', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpF')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpF'), N'F: Click on unit to selec that unit and all units within it', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpG')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpG'), N'G: Click on the tick boxes to manually select or unselect the units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HelpH')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.TreeView'),  (select LangResourceID from tblLangResource where LangResourceName = 'HelpH'), N'H: To expand/fold individual units and subunits', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'SectionTitle_Administration')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'SectionTitle_Administration'), N'Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'SectionTitle_Reporting')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'SectionTitle_Reporting'), N'Reporting', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAny')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAny'), N'Any', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revNewPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revNewPassword'), N'The New Password must be at least 8 characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litOR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litOR'), N'OR', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/InfoPath/PublishInfoPathContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnUpload'), N'Upload', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'en-AU')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'en-AU'), N'English', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Remove')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Remove'), N'Remove Administrator', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Links.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Links', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmExit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmExit'), N'Are you sure you want to exit this Quiz? Your answers will not be stored unless you submit your answers on the last page.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'QuestionText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'QuestionText'), N'Question', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'OfText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'OfText'), N'of', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'HomeText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'HomeText'), N'Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'QuickFactsText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'QuickFactsText'), N'Quick Facts', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PageText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'PageText'), N'Page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ExitPreviewText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'ExitPreviewText'), N'Exit Preview', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NextAltText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'NextAltText'), N'Next', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PreviousAltText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'PreviousAltText'), N'Previous', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'DisclaimerText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'DisclaimerText'), N'Disclaimer', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PreviewModeText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'PreviewModeText'), N'Preview mode - No results will be saved.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PlayersInvolved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'PlayersInvolved'), N'The players involved in this scenario are:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litPDF')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litPDF'), N'PDF File', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litExcel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litExcel'), N'Excel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litCSV')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litCSV'), N'CSV (comma delimited)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litExport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litExport'), N'Export', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litSelectFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litSelectFormat'), N'Select a format', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litExportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litExportTitle'), N'Export report to another format', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturn'), N'Return to Administration Homepage', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnSave')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnSave'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnActive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnActive'), N'Active', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnName'), N'Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturnUnitDetails')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturnUnitDetails'), N'Return to Unit Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnInactive'), N'Inactive', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnUnitName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnUnitName'), N'Unit Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnUserName'), N'User Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnCancel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnCancel'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnRecordNotExist')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnRecordNotExist'), N'This record no longer exists please refresh your screen.  If the problem persists please contact your administrator.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBuiltOnNet')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/About.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBuiltOnNet'), N'built on .net', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litAdministration')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litAdministration'), N'Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Reset Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Reset Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Reset Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Reset Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetLesson'), N'Reset Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ModuleDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetQuiz'), N'Reset Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.2'), N'All users who have started a previous version of the quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:09 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.3'), N'All users who have started the current version of the quiz.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:09 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationSelect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationSelect'), N'Select the organisation/s the user/s will be reset for', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'QuizStatusPreviewMode')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'QuizStatusPreviewMode'), N'The following number of users in organisation/s will be affected:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview'), N'Preview', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'The quiz status has been reset.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.1'), N'All Users who have started the lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.2'), N'All Users who have started a previous version of the lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cboResetUserRange.3'), N'All Users who have started the current version of the lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUpload'), N'User Selection', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationSelect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisationSelect'), N'Select the organisation/s the user/s will be reset for', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview'), N'Preview', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPreview'), N'The following number of users in organisation/s will be affected:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnResetStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnResetStatus'), N'Commit - Lesson Status Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'LessonStatusPreviewMode')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'LessonStatusPreviewMode'), N'The following number of users in organisation/s will be affected:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'The lesson status has been reset.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptValue')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UserDetail'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptValue'), N'Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/AddUnitAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Find', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.InvalidXML')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.InvalidXML'), N'This is an invalid XML file.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVFormat'), N'CSV Document Format', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblXMLFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblXMLFormat'), N'XML Document Format', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No users found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/AddOrganisationAdministrator.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No users found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'UserNotFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Certificate.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'UserNotFound'), N'Can not find a record of user having passed that course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptNoResultsFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptNoResultsFound'), N'No results found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnUsers'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'UnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'UnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkRevert')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationConfiguration.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_lnkRevert'), N'Revert To Default', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorPassMark'), N'A pass mark between 1 and 100 is required.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetLesson.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Do you really want to reset lesson status?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/ResetQuiz.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Do you really want to reset quiz status?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNever')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNever'), N'Never', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVExample')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVExample'), N'UserName, Password, First Name, Last Name, Email, External ID, Unit ID, Archive, Classification Name, Classification Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsersSample.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCSVNote'), N'* Note - Column names do not need to appear in the .CSV File.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Modify'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Update')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyCustomClassification.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Update'), N'Update', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason1'), N'Organisation Admin: Permission Denied.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason2'), N'Unit Admin: Permission Denied.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Status1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Status1'), N'You may not perform this action.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Status2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Status2'), N'Failure: Too many records in XML file.(1000 Max)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason3'), N'Specified unit does not exist', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason4'), N'User Name exists in database already', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason5'), N'Email Address exists in database already', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason6'), N'User Name duplicates found in import', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason7'), N'Username is the same as password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason8'), N'Email Address duplicates found in import', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason9'), N'First or Last Name missing.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Status3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Status3'), N'The import users process was successful.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason0')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason0'), N'Valid Record', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Status4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Status4'), N'Failure: The import users process failed. No records have been uploaded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Status')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Status'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'You are about to delete this Link. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/ComplianceRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_QuizDate'), N'Quiz Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litSelectReportExportFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Misc'),  (select LangResourceID from tblLangResource where LangResourceName = 'litSelectReportExportFormat'), N'Please select a export format!', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'QuizUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'QuizUpload'), N'Quiz content successfully uploaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'LessonUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Modules/UploadToolBookContent.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'LessonUpload'), N'Lesson content successfully uploaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnNoUsersAffected')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnNoUsersAffected'), N'No users will be affected.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Unit/UnitAdministrators.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.43')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Update.43'), N'The email address {0} already exists.  Please choose another email address for this user.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizFreq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizFreq'), N'Expire Quiz Results After:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'InstructionsText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'InstructionsText'), N'Instructions', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnQuiz'), N'Quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnLesson')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnLesson'), N'Lesson', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litForgotPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litForgotPassword'), N'Forgot your password?', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAddUnit'), N'Add Unit', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIntroduction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIntroduction'), N'<b>salt™</b> provides training to assist you in understanding the legal obligations of your company and you.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkFurtherInformation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkFurtherInformation'), N'(Click here to request further information)', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litCourseList')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Login.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litCourseList'), N'<td vAlign="top">The following courses are now available:<br>
<br>
&nbsp;&gt; <b>salt™</b> Code of Banking Practice<br>
&nbsp;&gt; <b>salt™</b> Commerce Act<br>
&nbsp;&gt; <b>salt™</b> Consumer Guarantees<br>
&nbsp;&gt; <b>salt™</b> Contract Fundamental<br>
&nbsp;&gt; <b>salt™</b> Employment<br>
&nbsp;&gt; <b>salt™</b> Fair Trading<br>
&nbsp;&gt; <b>salt™</b> Health and Safety<br>
&nbsp;&gt; <b>salt™</b> Money Laundering<br>
&nbsp;&gt; <b>salt™</b> Official Information Act<br>
&nbsp;&gt; <b>salt™</b> Privacy<br>
&nbsp;&gt; <b>salt™</b> Resource Management
</td>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help94')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help94'), N'CHANGING YOUR PASSWORD', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help54')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help54'), N'Pass Mark', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help95')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help95'), N'Quiz Status Indicators', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help96')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help96'), N'QUIZ AND LESSON STATUS', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help36')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help36'), N'Repeating Training Sessions', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litExit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litExit'), N'Exit', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpTextIntro')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpTextIntro'), N'<p>Welcome to {0} - an interactive Self Administered Legal Training
product developed by Blake Dawson Lawyers. {0} will teach
you about an area of law that is important to your organisation.</p>
<p>Each {0} course is divided into a number of legal topics, or "modules" which are listed on the home page. Each module contains a lesson and
a quiz.
</p>
<p>Successful {0} training is usually achieved by a status of "Passed", indicated by a tick symbol in the Quiz column, for each module shown on the user Home page.  However, there may be additional requirements for you set by the {0} Administrator for your organisation.</p>
<p>The level of access assigned to your {0} login will determine the options available for Reporting and Administration. {0} Administrators should refer to the Administration Guide for details, please contact Blake Dawson for a copy of the most recent revision.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText2'), N'<p>If you have been assigned more than one course there will be a course selector below the welcome message on your Home page. Select the course you need to complete from the dropdown list. If you only have access to one course then you will only see module(s) for that course listed on the Home page. If you have not been allocated a course, the message "You do not have access to any courses" will be displayed.
</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText31')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText31'), N'<p>Modules relevant to you are listed on the Home page. Each module contains a lesson and a quiz. You can complete lessons in any order, but we recommend that you work through each lesson and quiz in the order that they appear on the Home page.</p>
<p>To <strong>begin</strong> a lesson, click on the ''Lesson'' icon next to the first module.</p> 
<p>To <strong>navigate</strong> through the lesson use the ''Previous'' and ''Next'' buttons in the bottom right-hand corner of the screen. The page indicator in the top left-hand corner of the screen tells you what page you are on and how many pages there are in the lesson. The items to the right of the page indicator such as ''Home'', ''Quick Facts'', ''Disclaimer'' and ''Exit'' form the lesson menu bar.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText32')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText32'), N'<p>As you work through the lesson you will be presented with screens of information about the law. You will also be introduced to some fictitious ''players'' who are involved in hypothetical situations. You may also be asked to answer some questions. In the lessons your answers are not recorded and explanations are displayed once you make a choice, so feel free to explore different answers to the questions. This only occurs in lesson pages, assistance is not provided within a quiz.
</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText33')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText33'), N'<p>At various stages throughout the lessons optional information has been provided. Click hyperlinks to see examples of relevant cases, additional information, helpful reminders or to navigate to other useful websites. To close an additional information box you have displayed on the lesson page, scroll to the bottom of the dialog box and click on the ''[Hide]'' link.
</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help10'), N'HOW TO VIEW LINKS ', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help4'), N'VIEW AND PRINT QUICK FACTS', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText4'), N'<p>A Quick Facts page is available for each lesson. It is a short summary of the information contained in the lesson, and is a useful as a preview or as a refresher.</p> 
<p>To <strong>view</strong> the Quick Facts click the Quick Facts button, which appears to the right of each lesson name on the Home page. You can also open the Quick Facts page from within a lesson by clicking on "Quick Facts" in the lesson menu bar, top right of the lesson page.</p>
<p>To <strong>print</strong> the Quick Facts click with your right mouse button on the displayed page, and select "Print" or follow the printing instructions at the bottom of the Quick Facts screen.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help5'), N'HOW TO SUBMIT A QUIZ', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText34')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText34'), N'<p>On the final page of each lesson is a button labelled ''End Lesson''. If you click on this button you will automatically be taken back to your Home page. You can then choose to undertake a quiz for that module, or you can start another lesson.</p> 
<p>If you decide to exit {0} when you are part-way through a lesson, simply click the ''Exit'' tab on the lesson menu bar. {0} will bookmark the page you are exiting so that when you return to that lesson, you will be automatically be returned to the same page.</p> 
<p>The status icon in the Lesson column on your Home page will only show as "Completed" if you have navigated to every page in the lesson.  If you have viewed some but not all of the pages in a lesson, your status icon will display as "In Progress".</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText35')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText35'), N'<p>On the Home page, to the right of the module headings, there are icons which indicate your lesson and quiz status. These icons indicate your progress for that module. The Status Key displayed below the modules identifies the icon for each status and further detail is listed here:</p> 
<p>"Not Started" - In the Lesson column. This indicates that none of the lesson pages have been viewed (in the Quiz column this indicates that a set of quiz answers has not yet been submitted for this module).</p>
<p>"In Progress" - This indicates that you have navigated to some but not all of the pages in the lesson.</p>
<p>"Completed" - This indicates that you have navigated to every page in the lesson.</p>
<p>"New Content" – This symbol indicates that the lesson has been updated since you last viewed it.  Organisations usually require you to navigate through the lesson and re-submit answers to the quiz for this module when you see the New Content symbol(s).  New Content may be required because of updates to the relevant legislation or because of changes to policy in your organisation.</p>
<p>"Expired" - The lesson status icon for a module will only remain as "Completed" for a period of time set by the {0} Administrator for your organisation.  The "Expired" status icon indicates that it has been longer than the period allowed since you last completed the lesson. For the status icon to change back to "Completed" you must go back into the lesson and navigate through every page.</p>
<p>"Passed" and "Failed" status icons relate to the Quiz column and do not display as Lesson status indicators.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText36')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText36'), N'<p>You can work through the lessons for each module as many times as you like. There is also a quick fact sheet to assist you to summarise what you have read in each lesson. See the section on ''View and Print Quick Facts''. The lessons are there to give you confidence with your understanding of the subject matter. When you understand the lesson you are more likely to pass the quiz. Even so, you are also permitted to work through and submit a quiz for each module as many times as you like. The intention of {0} is to work with you to build your knowledge of your compliance responsibilities in your job role.
</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText94')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText94'), N'<p>It is good practice to change your password when you first login to {0} and at regular intervals afterwards.  Once you have logged into {0} the steps to change your password are:</p>
<ul>
<li>Select Administration on the Home page, this displays the Personal Details screen
<li>In the Old Password box, enter your existing password
<li>In the New Password box, enter your new password (minimum of 8 characters)
<li>In the Confirm Password box, re-enter your new password
</ul>
<p>Click the Save button</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText95')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText95'), N'<p>On the Home page, to the right of the module headings, there are icons which indicate your lesson and quiz status. These icons indicate your progress for that module. The Status Key displayed below the modules identifies the icon for each status and further detail is listed here:</p> 
<p>"Not Started" - In the Quiz column this indicates that a set of quiz answers has not yet been submitted for this module (in the Lesson column this indicates that none of the lesson pages have been viewed).</p>
<p>"Passed" - This indicates that you have submitted a set of quiz answers that have met or exceeded the criteria for this module.</p>
<p>"Failed" - This indicates that you have submitted a set of quiz answers but they have not met the criteria set for this module.</p>
<p>"New Content" - This star indicates that the quiz has been updated since you last viewed it.  Organisations usually require you to re-submit answers to the quiz for this module when you see "New Content" star(s).  New Content may be required because of updates to the relevant legislation or because of changes to policy in your organisation.</p>
<p>"Expired" - The quiz status icon for a module will only remain as "Passed" for a period of time set by the {0} Administrator for your organisation.  The "Expired" status icon indicates that it has been longer than the period allowed since you last successfully completed the quiz. For the status icon to change back to "Passed" you must go back into the quiz and submit another set of answers that meet or exceed the criteria for this module.</p>
<p>"In Progress" and "Completed" status icons relate to the Lesson column and do not display as Quiz status indicators.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText6'), N'<p>When you complete a lesson for the first time, the status changes from "Not Started" to "Completed." If you exit a lesson before reaching the last page, the status will change from "Not Started" to "In Progress".</p> 
<p>When you complete a quiz for the first time, your quiz status will change from "Not Started" to "Passed" or "Failed" depending on your score. Other events and considerations that may change the status of your quiz or lesson include:</p> 
<ul>
<li>Content updates to a lesson or quiz 
<li>A change in the Compliance Rules relevant to your organisational Unit 
<li>Your {0} administrator moving you to an organisational Unit which has different Compliance Rules
<li>Expiry of lesson or quiz due to period of time elapsed since completion/pass
</ul>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText7')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText7'), N'A course is considered complete when you have successfully passed the quiz for each module assigned to you.  To pass each quiz you are required to submit a complete set of quiz answers that have met or exceeded the criteria relevant to the module.  The course will then remain complete for as long as the period set by the {0} Administrator or until quiz content is updated, whichever comes first.  The pass marks and expiry periods are referred to as Compliance Rules and are stipulated by the {0} Administrator for your organisation.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help97')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help97'), N'Printing a Certificate of Completion', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText97')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText97'), N'If a course has been successfully completed, a Certificate of Completion hyperlink will appear under the course heading on your Home page. This hyperlink will stay visible and active for as long as the period set by the {0} Administrator or until quiz content is updated.  Click on this hyperlink to print your certificate of completion.  If you have been allocated multiple courses, select each course with the selector below the Welcome message on the Home page and print the certificate from each course where the Certificate of Completion hyperlink appears.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText8')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText8'), N'<p>Each module in each course has its own set of Compliance Rules. Compliance Rules refer to training and testing frequency periods and pass marks.</p> 
<p>A compliance period indicates how often you must complete your training and testing for a module. For example, you may need to complete a lesson and a quiz for a module every 12 months. The compliance period is set by the {0} Administrator for your organisation.</p> 
<ul>
<li>Quiz Frequency Period - The frequency with which the Users in an organisational unit need to repeat the quiz. If you do not repeat the quiz within this period, your status for the quiz will change to "Expired (Time Elapsed)". 
<li>Lesson Frequency Period - The frequency with which the Users in an organisational unit need to repeat the lesson. If you do not restart the lessons within this period, your status for the lesson will change to "Expired (Time Elapsed)". 
<li>Pass Mark - The mark on the quiz that members of this organisational unit must achieve to be regarded as "Passed". If you submit a quiz and do not achieve the Pass Mark your status for the quiz will display as "Failed".
</ul>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help9'), N'HOW TO CREATE REPORT', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText9')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText9'), N'The report available to a User training on {0} is the Personal Report, which covers all courses and modules assigned to them. {0} Administrators can access a suite of reports, and should refer to the Administration Guide for details.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText91')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText91'), N'<p>This report will show you a list of all Courses and modules which are currently assigned to you, along with the status of each module. If you are a {0} User this is accessed by clicking the ''Reports'' link. If you are a {0} Administrator this report is accessed by clicking the ''Personal Reports''.</p> 
<p>The following details are displayed on this page:</p>
<ul>
<li>Course 
<li>Modules within the course you have been assigned (links to Quiz History, see below) 
<li>Current Lesson Status 
<li>Current Quiz Status 
<li>Quiz Score 
<li>Current Pass Mark for Quiz
</ul>
<p>The Module names / headings will display as active hyperlinks where you have submitted a set of answers to a quiz for that module.  You can use these hyperlinks to review the history of quiz answers you have submitted.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText92')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText92'), N'<p>You can click on a module heading to see the Quiz History for that module.</p> 
<p>The Quiz History view enables you to "drill down" into your history for a particular quiz. It is accessed by clicking on the module heading hyperlink in the Personal Report.</p> 
<p>This page is formatted as a list of the dates when sets of quiz answers have been submitted and will show the following:</p>
<ul>
<li>Quiz History table with the following columns 
<li>Status (Pass/Fail/New Content/Expired) 
<li>Summary (date hyperlink to Quiz Answers) 
<li>Pass Mark 
<li>Your Mark (displayed as text and graphically)
</ul>
<p>The dates in the list will display as active hyperlinks.  You can use these hyperlinks to review each set of quiz answers you have submitted.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText93')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText93'), N'<p>To view the set of answers you gave for a quiz, click on the date of the quiz attempt you are interested in. You cannot update or amend the answers recorded in a set.  This report shows the answers you gave in that particular quiz attempt.</p> 
<p>This page is titled "Quiz Summary" and will show the quiz information in a grid:</p> 
<ul>
<li>Question 
<li>Correct Answer 
<li>Your Answer 
<li>Result (Correct or Incorrect shown by a tick or a cross)
</ul>
<p>The following detail will also be shown at the top of the page:</p>
<ul>
<li>Module (name / heading)
<li>Your First and Last Name 
<li>Quiz score
</ul>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText10'), N'<p>{0} may incorporate links to websites and written information (such as the full text of legislation) relevant to the area of law in which you are training. As well as the hyperlinks within the lesson pages there is a Links tab on your Home page where your {0} Administrator can provide you with access to relevant materials outside of the {0} program.</p>
<p>To view links related to the {0} course you are using, click the Links tab on the menu bar.</p>
<p>To navigate to the site or information you wish to view click the corresponding hyperlink. This will open a new browser window displaying the contents of the link. Simply close the new browser window when you are finished and you will return to the {0} application.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText98')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText98'), N'<p>When you click on a hyperlink from the Links tab, you may see a Disclaimer dialog open.  This is a short message that your {0} Administrator may activate to notify you that if you click the OK button you will be navigating to a website outside of the {0} program. The disclaimer exists so that you may be aware of Blake Dawson''s policy as it relates to sites external to {0}.</p>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText96')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText96'), N'<p>When you complete a lesson for the first time, the status changes from "Not Started" to "Completed." If you exit a lesson before reaching the last page, the status will change from "Not Started" to "In Progress".</p> 
<p>When you complete a quiz for the first time, your quiz status will change from "Not Started" to "Passed" or "Failed" depending on your score. Other events and considerations that may change the status of your quiz or lesson include:</p> 
<ul>
<li>Content updates to a lesson or quiz 
<li>A change in the Compliance Rules relevant to your organisational Unit 
<li>Your {0} administrator moving you to an organisational Unit which has different Compliance Rules
<li>Expiry of lesson or quiz due to period of time elapsed since completion/pass
</ul>', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help98')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help98'), N'Disclaimer Message on Links', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'CSVtoXMLConverter.cs.Write.4'), N'UserName column contains a value that is too short (3 Char Min)<br>The error occurred in this line:<br>{0}', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.Business'),  (select LangResourceID from tblLangResource where LangResourceName = 'prcUser_Create.1'), N'The specified unit could not be found or may not be active.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help11'), N'CONTACT US', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help111')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help111'), N'Email Assitance', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Help112')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Help112'), N'Telephone Support', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText11'), N'If you are unsure of how to proceed with your Salt™ training or need further information about how to use Salt™, you may contact the Product Support helpdesk at Blake Dawson using the information provided below. We would also like to know if you notice any error messages that display regularly whilst you are using Salt™.  This will alert us to problems that we may otherwise be unaware of and we would value your comments.
Blake Dawson is unable to assist you with providing hints or answers to the quiz questions, please contact your organisation''s Salt™ Administrator for this type of assistance.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText111')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText111'), N'To contact us via email, please send a message to productsupport@blakedawson.com.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText112')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Help.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHelpText112'), N'To contact us via telephone, please call the Product Support helpdesk at Blake Dawson on 1800 676 011.', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help Running Course Status Reports?', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ExitText')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.QuizLessonEntry'),  (select LangResourceID from tblLangResource where LangResourceName = 'ExitText'), N'Exit', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litHome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litHome'), N'Home', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'zh-CHT')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'zh-CHT'), N'Chinese (Traditional)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pt-BR')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'LanguageNames'),  (select LangResourceID from tblLangResource where LangResourceName = 'pt-BR'), N'Portuguese (Brazil)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hypLicensing')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'hypLicensing'), N'Course Licensing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Course Licensing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Course Licensing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Course Licensing Detail', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Course Licensing Detail', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Email_ExpiryWarn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Email_ExpiryWarn'), N'Dear {0}

This is a to inform you that your Salt license is due to expire within the next {1} days for the course: {2}

The date of expiry is: {3}

Please contact {4} to further discuss this matter. 

Kind Regards

Your Salt Team
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Email_ExpiryWarn_Subject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Email_ExpiryWarn_Subject'), N'License expiry warning for {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Email_LicenseWarn_Subject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Email_LicenseWarn_Subject'), N'License usage warning for {0}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkLicensingReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkLicensingReport'), N'Licensing Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Licensing Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Licensing Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkReportPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkReportPeriod'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butRunAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butRunAll'), N'Report All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNote'), N'(runs for all courses for current active period)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Licensing Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPeriod'), N'Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLicenseQuota')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLicenseQuota'), N'License Quota', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLicensesUsed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLicensesUsed'), N'Licenses Used', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLicensesRemaining')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLicensesRemaining'), N'Licenses Remaining', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFullName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFullName'), N'User Full Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated'), N'Date Created', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptArchive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptArchive'), N'Archived', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptYes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Licensing'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptYes'), N'Yes', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod'), N'Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAction'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod'), N'Current Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod'), N'Future Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAction'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hypEdit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'hypEdit'), N'Edit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegendNote')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegendNote'), N'The left column indicates the status of the course licensing.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNormal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNormal'), N'Within normal license parameters', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExceededWarn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExceededWarn'), N'Warning, the course has exceeded warning license number or warning date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExceeded')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExceeded'), N'The course has exceeded the licensing number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoPeriod'), N'The course has no current licensing period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkModAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkModAccess'), N'Organisation Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Organisation Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Organisation Module Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butSaveAll'), N'Save All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrganisation'), N'Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyBuilder')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrgModAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyBuilder'), N'Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Sort')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ModifyLinks.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Sort'), N'Sort', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailSubject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailSubject'), N'Login Information', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CompletedUsersReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3'), N'Incomplete (with details)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptIncompleteDetail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CompletedUser'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptIncompleteDetail'), N'Incomplete (with details)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHelp'), N'Help', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Incomplete Users (with details) Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptModules')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptModules'), N'Modules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal'), N'Unit Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgApplicationAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgApplicationAccess'), N'Organisation Application Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Organisation Application Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Application Access', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Org')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Org'), N'Organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_CPDPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_CPDPoints'), N'CPD Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_PolicyBuilder')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_PolicyBuilder'), N'Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll'), N'Save All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedEmailSentReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedEmailSentReport'), N'Sent Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Sent Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom'), N'Date From:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo'), N'Date To:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip'), N'Recipient:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject'), N'Subject:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBody'), N'Body:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litOf')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litOf'), N'Of', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Localizedliteral1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Localizedliteral1'), N'&nbsp;', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litPage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litPage'), N'&nbsp;', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litDisplayed')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litDisplayed'), N'&nbsp;', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Find', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Sent Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnReturn'), N'Return to Administration Homepage ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_DateSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_DateSent'), N'Date Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_To')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_To'), N'To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Subject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Subject'), N'Subject', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Body')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Grid_Body'), N'Body', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'InvalidDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'InvalidDateRange'), N'Invalid date range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchMessage.Non')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchMessage.Non'), N'No Matching Emails Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInclInactiveUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInclInactiveUser'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'dclActive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'dclActive'), N'Active', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critActive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critActive'), N'Include Inactive User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critActive.True')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critActive.True'), N'True', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'critActive.False')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'critActive.False'), N'False', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkCPDProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkCPDProfile'), N'CPD Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPolicyBuilder')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPolicyBuilder'), N'Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDiskSpace')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDiskSpace'), N'Allocated Disk Space', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litMegabytes')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litMegabytes'), N'Megabytes', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyName'), N'Policy Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFileName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFileName'), N'File Name (Size)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblActive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblActive'), N'Active', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAction'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAddPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAddPolicy'), N'Add New Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Policy Builder Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Policy Builder Details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblName'), N'Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserAcceptance')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserAcceptance'), N'User Acceptance', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExistingFile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExistingFile'), N'Existing File', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkResetUsers'), N'Reset Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkUpload'), N'Upload New File', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvName'), N'You must specify the Policy Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUploadFile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUploadFile'), N'Please select a file to upload', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'UploadSuccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'UploadSuccess'), N'File successfully uploaded', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'UploadFail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'UploadFail'), N'There was an error uploading the policy file. Please try again.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FileExists')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FileExists'), N'File already exists with this name and this file will not be uploaded. It is advised that you upload unique filenames and store versions on your network. It is your legal obligation to retain your own file history.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.IncompleteUserWithDetails'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptStatus'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLocalizedTest')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLocalizedTest'), N'testlocalizedlabel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInclLogoMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInclLogoMsg'), N'Include the Organisation Logo on the certificate', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ExceedOrgSizeAllocation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ExceedOrgSizeAllocation'), N'Upload was unsuccessful as it will cause the Organisation disk space allocation to be exceeded.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'OrgNoSpaceAllocated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'OrgNoSpaceAllocated'), N'Upload unsuccessful as no disk space has been allocated to this Organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFind')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFind'), N'Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastLogin')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastLogin'), N'Last Login
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.LengthError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.LengthError'), N'The course notes may contain no more than 1000 characters.
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound'), N'No Matching Users Found
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNever')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNever'), N'Never
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoSubUnits'), N'There are no units.
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Move Users to Unit
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblShowInactive'), N'Show Inactive Users
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnit'), N'Unit
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount'), N'Found {0} user(s) 
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName'), N'Username
', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Move Users to Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkMoveUsersToUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkMoveUsersToUnit'), N'Move Users To Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'hypModify')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'hypModify'), N'Modify', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnAssign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnAssign'), N'Assign', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litUsers'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll'), N'Clear All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litSelectUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litSelectUnit'), N'Select Target Unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No unit found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Select')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Select'), N'You must select a unit to continue', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUsers'), N'No user found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUnit'), N'Please select a unit to assign these users to.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned'), N'Assigned all users to ''{0}''.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus.Assigned2'), N'Assigned {0} users to ''{1}''.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'You are about to assign users to a unit.\nAre you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PolicyExists')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'PolicyExists'), N'A policy already exists with this name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SelectUsers'), N'You must select some users to continue.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkAddUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/MoveUsersToUnit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkAddUser'), N'Add to unit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmUpload'), N'Are You Sure?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Archive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage'), N'Archive users who have not logged in since the date entered.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SearchDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.SearchDate'), N'Please enter a past date before todays''s date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeNewUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeNewUser'), N'Include users who have never logged in and their modified data ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnPreview'), N'Preview ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Archive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkArchiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkArchiveUsers'), N'Archive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeNewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeNewUsers'), N'Include users who have never logged in and their modified data ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeNewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeNewUsers'), N'Include users who have never logged in and their modified data ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.InvalidDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.InvalidDate'), N'Please select valid date to continue', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectDate'), N'Please select a date to continue ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectPastDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectPastDate'), N'Please select a valid past date before today''s date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PolicySaved')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'PolicySaved'), N'Policy Saved Successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'CPD Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'CPD Profile Detail', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'CPD Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile'), N'Profile Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod'), N'Current Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod'), N'Future Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAction'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnCreateProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnCreateProfile'), N'Create New Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoPolicies')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoPolicies'), N'No policies exist for this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoProfiles')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoProfiles'), N'No CPD Profiles found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkEdit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkEdit'), N'Edit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserCount'), N'Found {0} user(s)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUserFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUserFound'), N'No User Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoUsersFound'), N'No Users Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnArchiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnArchiveUsers'), N'Archive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.UsersArchived')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.UsersArchived'), N'User(s) Archived!', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNever')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/ArchiveUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNever'), N'Never', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NameExists')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NameExists'), N'A policy with this name already exists for this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkEnabled')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkEnabled'), N'Profile Enabled', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentPeriod'), N'Current Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfilePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfilePeriod'), N'Profile Period:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRequiredPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRequiredPoints'), N'Required Points:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFuturePeriod'), N'Future Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTo'), N'to', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbAutoIncrementAsCurrent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbAutoIncrementAsCurrent'), N'Automatic increment by the duration of the current period.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbAutoIncrementByMonth')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbAutoIncrementByMonth'), N'Automatic increment by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMonth')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMonth'), N'month', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbNewFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbNewFuturePeriod'), N'Create a new Future Period with following details', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureProfilePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureProfilePeriod'), N'Profile Period:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureRequiredPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureRequiredPoints'), N'Required Points:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnDeleteFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnDeleteFuturePeriod'), N'Delete Future Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignPoints'), N'Assign Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUnits'), N'Assign Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUsers'), N'Assign Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewUsers'), N'View Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignPoints'), N'Assign Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPointsTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPointsTo'), N'Assign Points to', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourse'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy'), N'Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblApplyChanges')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblApplyChanges'), N'Assign points to', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbAllUsersIncluding')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbAllUsersIncluding'), N'All users, including the users who have completed the modules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:10 AM
GO


-- Friday, 8 July 2011 - 9:47:10 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbAllUsersExcluding')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbAllUsersExcluding'), N'All users, excluding the users who have completed the modules', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveProfile'), N'Save Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUnits'), N'Assign Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectUnits'), N'Select Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnAssign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnAssign'), N'Assign', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUsers'), N'Assign Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblViewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblViewUsers'), N'View Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll'), N'Save All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSearch')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSearch'), N'Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID'), N'External ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod'), N'Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEndOfPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEndOfPeriod'), N'At the End of Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rbNoAction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rbNoAction'), N'No action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUniqueField')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUniqueField'), N'Unique Field', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectUniqueField')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SelectUniqueField'), N'Please select a unique field', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyName'), N'Policy Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPoints'), N'Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'New')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'New'), N'New', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Current')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Current'), N'Current', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Future')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Future'), N'Future', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfileName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfileName'), N'Profile Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Create')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Create'), N'Create', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvProfileName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvProfileName'), N'You need to specify the Profile Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.RequiredField')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.RequiredField'), N'{0} is a required field.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowAddedUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowAddedUsers'), N'Show Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUpdatedUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUpdatedUsers'), N'Show Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowDetectedError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowDetectedError'), N'Show Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnCommitImport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnCommitImport'), N'Commit - users without errors', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnCancel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnCancel'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litPreviewData')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litPreviewData'), N'<b><u>Preview report. Review and Commit.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litUsersAdded')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litUsersAdded'), N'{0} users will be added.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litUsersUpdated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litUsersUpdated'), N'{0} users will be updated.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litDetectedError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litDetectedError'), N'{0} errors detected.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litTableSummary.AddUpdate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litTableSummary.AddUpdate'), N'Showing {0} users to be {1}. These users will be auctioned on commit. ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litTableSummary.ErrorDetected')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litTableSummary.ErrorDetected'), N'Showing {0} errors. These users will not be actioned on commit.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentPoints'), N'Invalid characters. Only numbers are allowed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revFuturePoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revFuturePoints'), N'Please Enter a numeric value for Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revMonth')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revMonth'), N'Please enter a whole number of Months', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvMonth')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvMonth'), N'Please enter number of Months to autoincrement by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFuturePoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFuturePoints'), N'Please enter required points for Future period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ValidStartDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ValidStartDate'), N'Please enter a valid start date for the period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ValidEndDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ValidEndDate'), N'You need to specify the end date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EndDateBeforeToday')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EndDateBeforeToday'), N'Please enter an end date that is today''s date or later', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'StartDateAfterEndDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'StartDateAfterEndDate'), N'The Profile Period must not end before the start date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'PeriodOverlap')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'PeriodOverlap'), N'The period overlaps with other periods.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'SaveSuccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'SaveSuccess'), N'Profile saved successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentPoints'), N'You need to specify the Required Points.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Confirm import users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.ExceedsLengthLimit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.ExceedsLengthLimit'), N'{0} exceeds the limit of {1} characters.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ProfileExists')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ProfileExists'), N'A Profile with this name already exists for this organisation. Please choose another Profile Name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.MinimumLength')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.MinimumLength'), N'{0} must be at least {1} characters', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRowNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRowNumber'), N'Row Number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName'), N'Username', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassword'), N'Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID'), N'External ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitID'), N'Unit ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblClassification'), N'Classification', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmUpload')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmUpload'), N'Confirm import users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/ImportUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Confirm import users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUsersFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUsersFound'), N'No Users Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbCPDReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbCPDReport'), N'CPD Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Continuous Professional Development Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError'), N'Error Generating CPD Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile'), N'Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPeriod'), N'Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName'), N'User Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblShortFallUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblShortFallUsers'), N'Show only users with Shortfall', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoProfile'), N'There are no profiles for the currently selected organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Continuous Professional Development Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoProfile'), N'No profile exists for the currently selected organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbCPDEmailReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbCPDEmailReport'), N'CPD Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile'), N'Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblModulePoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblModulePoints'), N'Total Points for all the modules:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyPoints'), N'Total Points for policies:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbPolicyBuilderReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbPolicyBuilderReport'), N'Policy Builder Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Policy Builder Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Policy Builder Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits2'), N'(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerate'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy'), N'Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoPolicy'), N'No Policy was found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateRange'), N'Date Range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.1'), N'Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.2'), N'Not&nbsp;Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radAcceptance.3'), N'Both', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAcceptance')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAcceptance'), N'Acceptance', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInclInactiveUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInclInactiveUser'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_hierarchyname')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_hierarchyname'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_Email')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_Email'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_LastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_FirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_FirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'grid_UnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBack')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBack'), N'Back', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail'), N'Send Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent'), N'The email has been sent successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent'), N'The email has been sent successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain'), N'Return', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSaltEnterprise')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSaltEnterprise'), N'SALT ENTERPRISE', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkHome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkHome'), N'Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkMyTraining')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkMyTraining'), N'My Training', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkMyReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.UserMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkMyReport'), N'My Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoDataFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoDataFound'), N'There is no data for the selected Period.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPolicy'), N'Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptAccepted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptAccepted'), N'Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateAccepted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateAccepted'), N'Last Date Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeLogo'), N'Certificate Logo', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDReportName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDReportName'), N'CPD Report Name:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHi')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHi'), N'Hi {0},', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHomepageWelcome'), N'Welcome to <span class=''ApplicationNameInline''>{0}</span><span class=''TradeMarkInline''>{1}</span>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'My Training', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Policies', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalAccepted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalAccepted'), N'Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalNotAccepted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalNotAccepted'), N'Not Accepted', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Continuous Professional Development Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDProfile'), N'The CPD Profile assigned to you: (please choose the one you would like to view below).', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblChooseCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblChooseCourse'), N'The courses you need to complete are: (please choose the one you would like to work through).', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDProfileHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDProfileHeading'), N'CPD Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDPeriodHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDPeriodHeading'), N'Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRequiredPointsHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRequiredPointsHeading'), N'Required Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPointsEarnedHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPointsEarnedHeading'), N'Points Earned', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourseHeading'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatusHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatusHeading'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPrintCertificateHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPrintCertificateHeading'), N'Print Certificate', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDPointsAvailableHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCPDPointsAvailableHeading'), N'CPD Points Available', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyHeading')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyHeading'), N'Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Incomplete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Incomplete'), N'Incomplete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Complete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Complete'), N'Complete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Certificate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLegend_Certificate'), N'Certificate', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Email_LicenseWarn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Email_LicenseWarn'), N'Dear {0}
This is to inform you that you have now exceeded {1} users for the course: {2}.

Your license limit for {2} is: {3}.

Please Contact {4} to further discuss this matter.

Kind Regards

Your Salt Team', 1, 0, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizLessonInstruction')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizLessonInstruction'), N'You need to complete the <b> {0} </b> to earn the points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizOnly')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizOnly'), N'quiz only', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonOnly')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonOnly'), N'lesson only', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonQuiz')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLessonQuiz'), N'lesson and quiz', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnLicensePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnLicensePeriod'), N'License Period:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnUserWarning')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnUserWarning'), N'Send user warning email @', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnExpiryWarning')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnExpiryWarning'), N'Send expiry warning email @', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnLicenses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnLicenses'), N'Licenses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnSaltRep')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnSaltRep'), N'Salt Rep:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnOrgRep')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnOrgRep'), N'Org Rep:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnLastEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnLastEmail'), N'Last Email -', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll'), N'Save All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnDeleteFuturePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnDeleteFuturePeriod'), N'Delete Future License Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnNewLicensePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnNewLicensePeriod'), N'New License Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnUsers'), N'users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBackToCoarseList')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBackToCoarseList'), N'Back to Course List', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailLanguage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailLanguage'), N'Email Language:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureLicensePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFutureLicensePeriod'), N'Future License Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentLicensePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCurrentLicensePeriod'), N'Current License Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureLicenseNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureLicenseNumber'), N'[Future License Period] Number of Licenses is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvFutureLicenseNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvFutureLicenseNumber'), N'[Future License Period] Number of Licenses must be a valid number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvFutureLicenseWarnNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvFutureLicenseWarnNumber'), N'[Future License Period] The warning number should be valid and not more than the number of licenses.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepNameSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepNameSalt'), N'[Future License Period] Salt Rep Name is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepEmailSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepEmailSalt'), N'[Future License Period] Salt Rep Email is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revFutureRepEmailSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revFutureRepEmailSalt'), N'[Future License Period] Salt Rep Email address is not in the correct format.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepNameOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepNameOrg'), N'[Future License Period] Org Rep Name is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepEmailOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvFutureRepEmailOrg'), N'[Future License Period] Org Rep Email is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revFutureRepEmailOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revFutureRepEmailOrg'), N'[Future License Period] Org Rep Email address is not in the correct format.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentLicenseNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentLicenseNumber'), N'[Current License Period] Number of Licenses is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepNameSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepNameSalt'), N'[Current License Period] Salt Rep Name is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepEmailSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepEmailSalt'), N'[Current License Period] Salt Rep Email is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentRepEmailSalt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentRepEmailSalt'), N'[Current License Period] Salt Rep Email address is not in the correct format.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepNameOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepNameOrg'), N'[Current License Period] Org Rep Name is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepEmailOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvCurrentRepEmailOrg'), N'[Current License Period] Org Rep Email is required', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentRepEmailOrg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revCurrentRepEmailOrg'), N'[Current License Period] Org Rep Email address is not in the correct format.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgWarnEmailNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgWarnEmailNumber'), N'Send warning email at license usage, positive number is required and cannot be greater than the actual license number.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgEndDateFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgEndDateFormat'), N'End date is incorrect.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgStartDateFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgStartDateFormat'), N'Start date is incorrect.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgStartDateAfterBefore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgStartDateAfterBefore'), N'Start date must be after todays date and before end date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgEndDateAfter')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgEndDateAfter'), N'End date must be after todays date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgExpireEmailDateFormat')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgExpireEmailDateFormat'), N'Expiry warning email date is incorrect.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgExpireEmailDateBeforeAfter')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgExpireEmailDateBeforeAfter'), N'Expiry warning email date must be between the start and end date. It also must be after todays date date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgStartEndDateOverlap')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgStartEndDateOverlap'), N'[Future License Period] start date is overlapping [Current License Period] end date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgStartEndDateGap')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgStartEndDateGap'), N'Save was successful, however please note that there is a gap between the end date of Current and start date of Future.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgValidationSummary')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgValidationSummary'), N'* Save Unsuccessful', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'MonthNone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'MonthNone'), N'You need to specify the number of month', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'MonthNotNumeric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'MonthNotNumeric'), N'Invalid Characters. Only numbers are allowed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'MonthNone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'MonthNone'), N'You need to specify the number of month', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'MonthNotNumeric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'MonthNotNumeric'), N'Invalid characters. Only whole numbers are allowed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FuturePointsNotNumeric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FuturePointsNotNumeric'), N'Invalid characters. Only numbers are allowed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FuturePointsNone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FuturePointsNone'), N'You need to specify the required points.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ValidStartEndDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ValidStartEndDate'), N'You need to specify the start and the end date.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnNewProfilePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnNewProfilePeriod'), N'New Profile Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoPeriod'), N'No Period for this Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Home', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUnits'), N'No units exist within this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUsers'), N'No users exist within this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoCourses'), N'No courses exist for this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoPolicies')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoPolicies'), N'No policies exist for this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'GapBetweenPeriods')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'GapBetweenPeriods'), N' Please note that there is a gap between the end date of Current and start date of Future.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkLicensing')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkLicensing'), N'Course Licensing', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkLanguageTranslation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkLanguageTranslation'), N'Language Translation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'litMyTraining')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Header.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'litMyTraining'), N'My Training', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated'), N'Date Created', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CourseStatus'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived'), N'Date Archived', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ActiveInactiveReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived'), N'Date Archived', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated'), N'Date Created', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserSearch.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'View Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'AcceptPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'AcceptPolicy'), N'I have read and understood the policy.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnFinish')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnFinish'), N'Finish', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvCurrentLicenseNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvCurrentLicenseNumber'), N'[Current License Period] Number of Licenses must be a valid number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rvCurrentLicenseWarnNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rvCurrentLicenseWarnNumber'), N'[Current License Period] The warning number should be valid and not more than the number of licenses.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgNoCoursesExistInThisOrganisation')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgNoCoursesExistInThisOrganisation'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgNoCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgNoCourses'), N'No courses exist within this organisation. ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Default.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblNoLicenses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblNoLicenses'), N'No current licenses exist for this course.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/EmailSentReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSearchEmailSent'), N'Search Email Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCoursePeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/LicensingReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCoursePeriod'), N'No courses with licensing periods exist within the organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmationMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmationMsg'), N'Confirmation Message', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'DefaultConfirmationMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'DefaultConfirmationMsg'), N'I have read and understood the policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason10')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason10'), N'Invalid email address', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvDiskSpace')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvDiskSpace'), N'Please enter a value for Disk Space', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revDiskSpace')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revDiskSpace'), N'Please enter a whole number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPoints'), N'Points', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateAssigned')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateAssigned'), N'Date Assigned', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPastCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/AdministrationReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPastCourses'), N'Past Courses', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPassword'), N'Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblActivatePassword')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblActivatePassword'), N'Activate Password Lockout', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnlock')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnlock'), N'Unlock Account', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Message.PasswordLockout')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.Login.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Message.PasswordLockout'), N'You have unsuccessfully attempted to login three times and your account is locked. Please contact an administrator to unlock your account.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'msgNever')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ContentAdministration/Licensing/Detail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'msgNever'), N'Never', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective from date must be less than to date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date2'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Policy/PolicyBuilderReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Added')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Added'), N'The Organisation''s Details have been added successfully', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUsers'), N'The selected users have been assigned to the profile.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnl;Message.SaveUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnl;Message.SaveUnits'), N'The selected units have been assigned to the profile.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUnits'), N'The selected units have been assigned to the profile.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SavePoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SavePoints'), N'The points have been saved successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Application/OrganisationApplicationAccess.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveAccess'), N'Organisation access has been saved successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'FSZTOOBIG')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'FSZTOOBIG'), N'The file size cannot be bigger than 2 MB.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess'), N'You do not have access to CPD', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblArchive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblArchive'), N'Archive', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Reason11')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Reason11'), N'Archive field cannot be blank.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess'), N'You do not have Access to the Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess'), N'You do not have Access to the Policy Builder', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoAccess'), N'You do not have access to CPD', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'profile_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'profile_name'), N'Profile Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'current_period')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'current_period'), N'Current Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'future_period')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'future_period'), N'Future Period', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'status')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'status'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'action')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'action'), N'Action', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'edit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddefault.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'edit'), N'Edit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'module_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'module_name'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'policy_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'policy_name'), N'Policy Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'unit_pathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'unit_pathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'last_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'last_name'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'first_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'first_name'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'assign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'assign'), N'Assign', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvProfile'), N'Please select a profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUnits'), N'Assign Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAssignUsers'), N'Assign Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkViewUsers'), N'View Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSaveAll'), N'Save All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSearch')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSearch'), N'Search', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExternalID'), N'External ID', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSelectUnits'), N'Select Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblViewUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblViewUsers'), N'View Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUsers'), N'Assign Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAssignUnits'), N'Assign Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUnits'), N'The selected units have been assigned to the policy.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUsersFound')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUsersFound'), N'No Users Found', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'NoUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'NoUnits'), N'No units exist within this organisation', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.SaveUsers'), N'The selected users have been assigned to the policy.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'assign')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'assign'), N'Assign', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'last_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'last_name'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'first_name')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'first_name'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'unit_pathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'unit_pathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkAssignAllUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Policy/policydetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkAssignAllUsers'), N'Assign to all users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/ViewPolicy.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExit'), N'Exit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailAddress')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ImportUsers.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailAddress'), N'Email Address', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'CPD Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'CPD Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'totals')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'totals'), N'Totals', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'shortfall')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Individual/IndividualReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'shortfall'), N'Shortfall', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'CPDReturn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'CPDReturn'), N'Return to CPD Profile Page', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'InvalidPoints')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/CPD/cpddetail.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'InvalidPoints'), N'Invalid characters. Only numbers are allowed.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyInstructions')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/MyTraining.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyInstructions'), N'The policy area below contains documents that are assigned to you. Please click on the links below to read and acknowledge these documents.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseProfile'), N'Course / Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCoursePolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.CPDReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCoursePolicy'), N'Course / Policy', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/CPD/CPDReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.ActiveInactive'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/CourseStatusReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/SummaryReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastCompleted')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastCompleted'), N'Last Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Inactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/PasswordRecovery.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.Inactive'), N'<b>You do not have access to Salt. Please contact your company''s Salt Administrator</b>.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitAdminstratorReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitAdminstratorReport'), N'Unit Administrator Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUnitAdministrators')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowUnitAdministrators'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Administrator Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Unit Administrator Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptGroupBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptGroupBy'), N'Group By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUserLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUserLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptValue')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptValue'), N'Value', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<br/>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkEmailUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkEmailUsers'), N'Email Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Email Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<br />(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject'), N'Subject', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailBody'), N'Email Body', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBack')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBack'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail'), N'Send Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCC')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCC'), N'CC', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWarning')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWarning'), N'Warning: you are about to send emails to all the users in the selected units. Please proceed with caution.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent'), N'The email has been sent successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnHome')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnHome'), N'Back to Administration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.GLOBAL'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptTotalUsers'), N'Total Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotalDiscreteUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Policies'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotalDiscreteUsers'), N'Grand Total Distinct Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitAdministratorReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Administrator Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Email Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmWarning')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/EmailUsers.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblConfirmWarning'), N'Warning: you are about to send emails to all the users in the selected units.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptAdministeredUnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitAdministratorReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptAdministeredUnitPathway'), N'Administered Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedWarningReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedWarningReport'), N'Warning Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Warning Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Warning Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ucHelp'), N'Help running Warning reports?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthsExpiredIn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthsExpiredIn'), N'Expired (Time Elapsed) in', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMonths')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/WarningReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMonths'), N'month/s', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Warning Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateCreated'), N'Date Created', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateArchived'), N'Date Archived', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCompletionDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCompletionDate'), N'Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiryDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptExpiryDate'), N'Expiry Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptMonths')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptMonths'), N'months', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDays')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDays'), N'days', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptWarningPeriod')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Warning'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptWarningPeriod'), N'Expired (Time Elapsed) in', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Administration Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizStatus'), N'Quiz Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonStatus'), N'Lesson Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptScore')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptScore'), N'Score', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Administration'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUser'), N'User', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedAtRiskReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedAtRiskReport'), N'At Risk Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'At Risk Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Quiz Date Range<br>(Both blank for current date)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'At Risk Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFailCounter')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFailCounter'), N'Fail Counter', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/AtRiskReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'At Risk Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourse'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptModuleName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptModuleName'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptFailNumber')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptFailNumber'), N'Fail Number', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCurrentStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCurrentStatus'), N'Current Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal'), N'Unit Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptGrandTotal'), N'Grand Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveFrom'), N'Date Effective From', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.AtRisk'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDateEffectiveTo'), N'Date Effective To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitComplianceReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnitComplianceReport'), N'Unit Compliance Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Unit Compliance Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Unit Compliance Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<br/>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUnits'), N'Include Inactive Units', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnShowComplianceRules')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnShowComplianceRules'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Admin/UnitComplianceReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Unit Compliance Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCourseName'), N'Course Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptModuleName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptModuleName'), N'Module Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonFrequency')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonFrequency'), N'Lesson Frequency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizFrequency')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizFrequency'), N'Quiz Frequency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonExpiryDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLessonExpiryDate'), N'Lesson Expiry Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizExpiryDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptQuizExpiryDate'), N'Quiz Expiry Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPassMark')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPassMark'), N'Pass Mark', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptDefault')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.UnitComplianceReport'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptDefault'), N'Default', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedProgressReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkAdvancedProgressReport'), N'Progress Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Progress Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Progress Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Advanced/ProgressReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblInactiveUsers'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptReportTitle'), N'Progress Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptUnitTotal'), N'Unit Total', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptCurrentStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptCurrentStatus'), N'Current Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptPreviousStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptPreviousStatus'), N'Previous Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptLastCompletionDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Progress'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptLastCompletionDate'), N'Last Completion Date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rptNumberOfUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Report.Trend'),  (select LangResourceID from tblLangResource where LangResourceName = 'rptNumberOfUsers'), N'Number of Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Select')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Select'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll'), N'Clear All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lbPolicyEmailReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lbPolicyEmailReport'), N'Policy Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyEmailReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyEmailReport'), N'Policy Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Policy Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBack')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBack'), N'Back', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnBackToMain'), N'Return', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerateEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnGenerateEmail'), N'Preview Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSendEmail'), N'Send Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkClearAll'), N'Clear All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Select')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelctAll.Select'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll'), N'Select All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkSelectAll.Deselect'), N'Deselect All', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailReportSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailReportSent'), N'Email Report Sent', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'EmailUserCopyBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'EmailUserCopyBody'), N'The following email text has been sent from {0} on {1}: \n {2}\n\nIt has been sent to the following users:\n{3}', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'From')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'From'), N'From', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAnd'), N'and', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBetween'), N'Between', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmailSent'), N'The email has been sent successfully.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Caution')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Caution'), N'Caution: Sending many emails may impact server performance.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.InvalidDate'), N'Error: Invalid date selected', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No policies exist within this organisation.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUser'), N'No users found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OneRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.OneRecip'), N'To send an email you must have at least one recipient, an email subject and an email body.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactive'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblQuizDateRange'), N'Quiz Date Range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblRecip'), N'Recipient', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Policy Email Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.1'), N'Administrators', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radRecipientType.2'), N'Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'Recipients')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'Recipients'), N'Recipients', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunAt'), N'Report run at', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ReportRunBy'), N'Report run by', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'To')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'To'), N'To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'UnitPathway')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'UnitPathway'), N'Unit Pathway', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/BuildEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicy'), N'Policy to report on', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyDateRange')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyDateRange'), N'Policy Date Range', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPolicyStatus'), N'Policy Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radPolicyModuleStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radPolicyModuleStatus.1'), N'Accepted - All students who have accepted the lastest Policy Document.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radPolicyModuleStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/Email/PolicyEmailReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radPolicyModuleStatus.2'), N'Not Accepted - All students who have NOT accepted the latest Policy Document.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkPeriodicReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkPeriodicReport'), N'Periodic Report', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Periodic Report Delivery', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Periodic Report Delivery', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butSaveAll')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butSaveAll'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butNew')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butNew'), N'New Schedule', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReportName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReportName'), N'Report Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFrequency')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFrequency'), N'Frequency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStartOn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStartOn'), N'Start On', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDocumentType')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDocumentType'), N'Document Type', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblStatus'), N'Status', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFailCounter')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFailCounter'), N'Fail Counter', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoricCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoricCourse'), N'Historic Course', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO




-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblExpiredIn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblExpiredIn'), N'Expired In', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblGroupBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblGroupBy'), N'Group By', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstName'), N'First Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastName'), N'Last Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUserName'), N'User Name', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEmail'), N'Email', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactiveUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeInactiveUsers'), N'Include Inactive Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSubject'), N'Subject', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblBody')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblBody'), N'Body', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateTo'), N'Date To', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDateFrom'), N'Date From', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblProfile'), N'Profile', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblShortfall')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblShortfall'), N'Show only users with Shortfall', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDuration')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDuration'), N'Duration', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Time Zones', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblServerTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblServerTimeZone'), N'WebServer Timezone:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkTimeZone'), N'Time Zone', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnNew')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnNew'), N'Add New Timezone', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnImport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnImport'), N'Reimport All Timezones', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnSelect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnSelect'), N'Select', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'cmnSelectDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'cmnSelectDate'), N'Select a Date and press - Select .', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'localizedBadDateMsg')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'Global.Common'),  (select LangResourceID from tblLangResource where LangResourceName = 'localizedBadDateMsg'), N'is not a valid date!', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'listTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'listTimeZone'), N'TimeZone:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrganisationDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone'), N'TimeZone :', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone'), N'TimeZone : ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkMailThroughput')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkMailThroughput'), N'Mail Throughput', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Edit User Defined TimeZone', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZoneName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZoneName'), N'Timezone:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeZoneName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeZoneName'), N'You must specify the timezone name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOffset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOffset'), N'Offset to UTC', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:11 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDisplayName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDisplayName'), N'Name to display in listboxes:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:11 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimezoneDisplayName')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimezoneDisplayName'), N'You must specify the timezone display name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSave')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSave'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDelete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDelete'), N'Delete(hide) this TimeZone', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoDLS')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoDLS'), N'No Daylight Saving found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoTimezone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMessage.NoTimezone'), N'No Timezones found.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDayLight')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDayLight'), N'Daylight Saving Rules:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDayLight')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDayLight'), N'Daylight Saving Rules:', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgMailSetup')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.AdminMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lnkOrgMailSetup'), N'Organisation Mail Setup', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Organisation Mail Setup', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrWarnMgrs')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrWarnMgrs'), N'Warn Managers of Delinquent Users', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrWarnUsers')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrWarnUsers'), N'Warn Users of pending delinquency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofWarns')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofWarns'), N'Number of warnings', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofDaysDelinq')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofDaysDelinq'), N'Number of days before Delinquency', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofDaysWarns')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrNumberofDaysWarns'), N'Number of days before warnings', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrReminders')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrReminders'), N'For example with ''delinquency'' set to 120 and 2 warnings with 30 days between the warnings the user will be warned at 60 days then they are notified of their expiry at the end of day 120', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCertLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCertLogo'), N'Certificate Logo', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkCertLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkCertLogo'), N'Include the Organisation Logo on the certificate', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'capTblOrgSetupBottom')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'capTblOrgSetupBottom'), N'Warnings may be sent before Quiz results expire', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrQuizResults')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrQuizResults'), N'Quiz results for modules in courses that have not been completed will expire (cease to be counted towards the course completion) after the ‘expiry period’', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrModuleWarnings')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrModuleWarnings'), N'Warnings may be sent to users that modules in some of their incomplete courses will expire shortly', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radDaysBeforeExpiry')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radDaysBeforeExpiry'), N'Days before expiry to warn the user', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radDueBeforeDate')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radDueBeforeDate'), N'Or Due before date', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ltrNoWarn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ltrNoWarn'), N'Enter 0 to never issue warnings to user', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'capTblOrgMailSetupTop')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'capTblOrgMailSetupTop'), N'Reminders may be sent when a user does not complete a course in a given time', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Warning:This action will replace all timezones(and their daylight saving rules) whose names match a StandardName from the System timezone list. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'importMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'importMessage'), N'Warning:This action will replace all timezones(and their daylight saving rules) whose names match a StandardName from the System timezone list. Are you sure you wish to proceed?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgMailSetupSave')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgMailSetupSave'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgMailSetupCancel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgMailSetupCancel'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeZone'), N'Timezone: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstYearStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblFirstYearStart'), N'First year rule starts: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblLastYearStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblLastYearStart'), N'Last year rule ends: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOffset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOffset'), N'Offset: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeStart'), N'Time of day that rule starts: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekdayStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekdayStart'), N'Weekday that rule starts: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekStart'), N'Week of month that rule starts: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthStart'), N'Month that rule starts: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeEnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblTimeEnd'), N'Time of day that rule ends: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekdayEnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekdayEnd'), N'Weekday that rule ends: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekEnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblWeekEnd'), N'Week of month that rule ends: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthEnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblMonthEnd'), N'Month that rule ends: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblDelete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblDelete'), N'Delete this rule ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgEditDaylightSave')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgEditDaylightSave'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgEditDaylightCancel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnOrgEditDaylightCancel'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblIncludeLogo'), N'Logo: ', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeLogo')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'chkIncludeLogo'), N'Include Logo on Student Emails', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitleTimezoneEdit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitleTimezoneEdit'), N'Edit User Defined TimeZone', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSave')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSave'), N'Save', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSelect')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSelect'), N'Select schedule (or New Schedule)', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'rfvEmail2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'rfvEmail2'), N'You must specify the manager Email.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'revEmail2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'revEmail2'), N'Managers Email address is not in the correct format. Please enter it again.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'mgrEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'mgrEmail'), N'Manager to notify of delinquencies', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSendEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSendEmail'), N'Notify me by Email when I am nearing Course completion deadlines?', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butRamdonPwd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butRamdonPwd'), N'Randomise Password', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'orgEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'orgEmail'), N'Email in Organisation Domain', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgEmail')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Users/UserDetails.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblOrgEmail'), N'Email in Organisation Domain', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'pagTitle'), N'Edit Daylight Saving Rule', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Edit Daylight Saving Rule', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimezone')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimezone'), N'You must specify the Timezone name.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorFirstYearStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorFirstYearStart'), N'You must specify the First Year Start.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorLastYearStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorLastYearStart'), N'You must specify the Last Year End.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorOffset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorOffset'), N'You must specify the Offset.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeStart')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeStart'), N'You must specify the Start Time.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeEnd')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'validatorTimeEnd'), N'You must specify the End Time.', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butEdit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butEdit'), N'Edit', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butDelete')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butDelete'), N'Delete', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO


-- Friday, 8 July 2011 - 9:47:12 AM
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'butCancel')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'butCancel'), N'Cancel', 1, 1, getdate(), newid()end 


-- Friday, 8 July 2011 - 9:47:12 AM
GO









IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcToolbook_Preview]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcToolbook_Preview]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcToolbook_Preview]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Displays a preview of the data from an XML document before inserting it into the tblLesson,tblLessonPage,tblQuiz, tblQuizQuestion, tblQuizAnswer table
Parameters: 
		@strXMLData Text = null, 	-- XML document
		@intModuleID	Integer		-- Module Id of the module
Returns: 
		two Result sets

		-- Return Results
		One: The first result set has the totals for the Upload
			The Upload Type - Correction or Update
			The Toolbook Type - Lesson or Quiz
		
		Two: The second result set holds the detail of the records that will be inserted if spImportToolbook is called.

		
Called By: 
		Toolbook.cs
Calls: 
		sp_xml_preparedocument -- system stored procedure to ALTER  an internal representation of the XML document.
		udfGetQuizIDByToolbookIDAndModuleID
		udfGetLessonIDByToolbookIDAndModuleID
		
Remarks: The XML document must be well formed otherwise the process will fail.

Author: Peter Kneale
Date Created: 23rd of February 2004

Modification History
-----------------------------------------------------------
v#	Author			Date			Description
#1	Jack Liu		12/09/2005		Add extra validation for Quiz CORRECTION
									For Quiz CORRECTION, the correct answer can''t be changed.
#2	Liz Dionisio	28/09/2005		Modified Quiz Correction validation
#3	mikev			4/5/2007		Removed correction logic
*/
CREATE Procedure [prcToolbook_Preview]
	(
		@strXMLData     NText = null, 	-- XML document
		@intModuleID	Integer       = null,		-- Module Id of the module
		@intUserID int
	)

As
	Set NoCount On
	Set Xact_Abort On
	
	-- Check if the XML document was passed.
	If(@strXMLData Is Null)
	Begin
		Raiserror(''The @strXMLData parameter was Null.  You must supply a valid XML document.'', 16, 1)
		Return
	End
	If(@intModuleID Is Null)
	Begin
		Raiserror(''The @intModuleID parameter was Null.  You must supply a valid XML document.'', 16, 1)
		Return
	End



Begin Transaction

	Declare @intDocHeader			 	Integer		-- 
	Declare @strRowPattern 				Varchar(50)	-- Pattern to match on when calling OpenXML
	Declare @strToolbookType 			Varchar(50)	-- Lesson or Quiz
	Declare @strUploadType				Varchar(50)	-- Correction or Update
	Declare @strToolbookID				Varchar(50)	-- Toolbook ID
	Declare @DatePublished				DateTime	-- Date new content was published
	Declare @intXMLUpdates				Integer		-- Number of updates contained in the XML file.
	
	-- Quiz specific
	Declare @intQuizID				Integer		-- Salt QuizID
	Declare @intQuestions				Integer		-- Number of Questions
	Declare @intAnswers				Integer		-- Number of Answers
	Declare @intDocQuizQuestions			Integer		-- Number of Questions in new content
	Declare @intDocQuizAnswers			Integer		-- Number of Answer in new content
	
	-- Lesson specific
	Declare @intLessonID				Integer		-- Salt Lesson ID
	Declare @intLessons				Integer		-- Number of Lesson pages 
	Declare @intDocLessons				Integer		-- Number of Lesson pages in new content
	
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------
	----------- Create Necessary Temporary Tables
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------
	
	----------------------------------------------------------------------------
	-------- Create Temporary Table for Quiz Questions
	----------------------------------------------------------------------------
	Create Table #xmlUploadQuizQuestions
		(
		ToolbookPageID	Varchar(50),		-- Toolbook Page ID for new Quiz Question
		PageTitle 		Varchar(255)		-- Toolbook Question for new Quiz Question
		)
		
	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Quiz Answers
	----------------------------------------------------------------------------
	Create Table #xmlUploadQuizAnswers
		(
		ToolbookQuestionID	Varchar(50),		-- Toolbook Question ID for new Quiz Answer
		ToolbookAnswerID	Varchar(50),		-- Toolbook Answer ID for new Quiz Answer
		Correct 		Varchar(255),		-- ''True'' or ''False'' indicating whether this answer is correct or not
		bCorrect 		bit,			-- 0 or 1 indicating if the answer is correct, this is derived from the Correct Column
		AnswerText		Varchar(255),		-- The answer
		QuizQuestionID		Integer			-- Salt Quiz Question ID column is a placeholder but is later populated to assist in the upload
		)
	
	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Lessons
	----------------------------------------------------------------------------
	Create Table #xmlUploadLessons
		(
		ToolbookPageID	Varchar(50),		    -- Toolbook Page ID for new Lesson
		PageTitle 	Varchar(255)		    -- Toolbook Page Title for new Lesson
		)
	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Upload Information
	----------------------------------------------------------------------------
	Create Table #xmlUploadHeader
		(
		ToolBookID		Varchar(50),		    	-- Toolbook ID for new Content
		ToolBookType 		Varchar(50),		    	-- Toolbook type, Quiz or Lesson
		NumberOfPages 	   	Integer,			-- Number of Pages in new content
		DatePublished		DateTime,		        -- Date new content was published
		UploadType		Varchar(50)		        -- New Content type, ''Correction'' , ''Update''
		)

	-- Temporary Tables used for validating the number of questions and answers in the
	-- new content compared to the old content
	Declare @xmlExisting Table
		(
		QuizQuestionID	Varchar(50),		-- Toolbook Page ID for new Quiz Question
		Answers 	Varchar(255)		-- Toolbook Question for new Quiz Question
		) 
	Declare @xmlNew Table
		(
		QuizQuestionID	Varchar(50),		-- Toolbook Page ID for new Quiz Question
		Answers 	Varchar(255)		-- Toolbook Question for new Quiz Question
		) 
				

	----------------------------------------------------------------------------
	-------- Insert Upload Information Into Imaginary Table

	----------------------------------------------------------------------------
	Set @strRowPattern = ''/BDWToolBookUpload''
	Exec sp_xml_preparedocument @intDocHeader Output, @strXMLData

	Insert into #xmlUploadHeader
		(
		ToolBookID,
		ToolBookType,
		NumberOfPages,
		DatePublished,
		UploadType
		)

	Select 
		ToolBookID,
		ToolBookType,
		NumberOfPages,
		DatePublished,
		UploadType
	From

		OpenXml 
			(@intDocHeader, @strRowPattern)
		With
			(
			ToolBookID		Varchar(50) 	''ToolBookID'',
			ToolBookType		Varchar(50)		''ToolBookType'',
			NumberOfPages		Integer			''NumberOfPages'',
			DatePublished		DateTime		''DatePublished'',
			UploadType		Varchar(50)		''UploadType''
			)

	
	----------------------------------------------------------------------------
	-------- Insert Lessons Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page''
	Exec sp_xml_preparedocument @intDocLessons Output, @strXMLData

	Insert into #xmlUploadLessons
		(
		ToolbookPageID,
		PageTitle
		)


	Select 
		ToolbookPageID,
		PageTitle
	From

		OpenXml 
			(@intDocLessons, @strRowPattern)
		With
			(
			ToolbookPageID	Varchar(50) 	''@ID'',
			PageTitle		Varchar(255)	''PageTitle''
			)
		
	----------------------------------------------------------------------------
	-------- Insert Quiz Questions Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page''
	Exec sp_xml_preparedocument @intDocQuizQuestions Output, @strXMLData

	Insert into #xmlUploadQuizQuestions
		(
		ToolbookPageID,
		PageTitle
		)

	Select 

		ToolbookPageID,
		PageTitle
	From

		OpenXml 
			(@intDocQuizQuestions, @strRowPattern)
		With
		(
		ToolbookPageID	Varchar(50) 	''@ID'',
		PageTitle		Varchar(255)	''PageTitle''
		)
		
	----------------------------------------------------------------------------
	-------- Insert Quiz Answers Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page/Answers/Answer''
	Exec sp_xml_preparedocument @intDocQuizAnswers Output, @strXMLData

	Insert into #xmlUploadQuizAnswers
		(
		ToolbookQuestionID,
		ToolbookAnswerID,
		AnswerText,
		Correct
		)
	Select 
		ToolbookQuestionID,
		ToolbookAnswerID,
		AnswerText,
		Correct
	From

		OpenXml 
			(@intDocQuizAnswers, @strRowPattern)
			With
			(
			ToolbookQuestionID	Varchar(50) 	''../../@ID'',  -- navigate back up to the question 
			ToolbookAnswerID	Varchar(50) 	''@ID'',
			AnswerText			Varchar(255)	''AnswerText'',
			Correct				Varchar(255)	''@correct''
			)
			


	----------------------------------------------------------------------------------------------------
	-------- Determine if we are uploading a Quiz or a Lesson and whether its an update or a correction
	----------------------------------------------------------------------------------------------------
	Select 
		@strToolbookType = ToolBookType, @strUploadType = UploadType
	From
		#xmlUploadHeader

		
		
	If (ltrim(rtrim(@strToolbookType)) = ''quiz'')
	Begin
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Process Upload from Imaginary Tables
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------
		Select 	@strToolbookID 	= ToolBookID From #xmlUploadHeader
		Select 	@DatePublished 	= DatePublished From #xmlUploadHeader
		Set 	@intQuizID 		= dbo.udfGetQuizIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)
	
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Perform an update 
		-------------------------------------------------------------------------------------------------------------------------------------
		-- Return message
		Select @strUploadType as ''Message'', @strToolbookType as ''ToolbookType''
		
		-- Return Results
		Select 
			#xmlUploadQuizQuestions.PageTitle as ''Updated Questions'',
			#xmlUploadQuizAnswers.AnswerText  as ''Updated Answers''
		From
			#xmlUploadQuizQuestions,#xmlUploadQuizAnswers 
		Where 
			#xmlUploadQuizAnswers.ToolbookQuestionID = #xmlUploadQuizQuestions.ToolbookPageID

	End   -- End Quiz
		
		
		
		
	-- Lesson
	If (ltrim(rtrim(@strToolbookType)) = ''LESSON'')
	Begin
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Process Upload from Imaginary Tables
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------
		Select 	
			@strToolbookID = ToolBookID 
		From 
			#xmlUploadHeader
		Select 	
			@DatePublished = DatePublished
		From 	
			#xmlUploadHeader

		-- Get the lesson ID
		Set 	@intLessonID 		= dbo.udfGetLessonIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)
		
		
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Perform an update 
		-------------------------------------------------------------------------------------------------------------------------------------
		-- Return message
		Select 
			@strUploadType 	as ''Message'', 
			@strToolbookType 	as ''ToolbookType'', 
			GETDATE() 		as ''Time now'',
			@intLessonID
		
		-- Return Results
		Select 
			#xmlUploadLessons.PageTitle as ''Updated Lesson''
		From
			#xmlUploadLessons

		
	End



Commit
Return

ErrorHandler:
rollback
Return
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcToolbook_Import]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcToolbook_Import]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcToolbook_Import]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Uploads the details from an XML document to the tblLesson,tblLessonPage,tblQuiz, tblQuizQuestion, tblQuizAnswer table
Parameters: 
		@strXMLData Text = null, 	        	-- XML document
		@intUserID Integer = null,          		-- ID of user inporting the xmlData
		@intModuleID Integer = null,        		 -- Module Id that this quiz or lesson is associated with.
		@intCourseID Integer = null,         	-- Course Id that this quiz or lesson is associated with.
		@strToolLocation Varchar(500) = Null	-- Relative path to the toolbook content
Returns: 
		two Result sets

		-- Return Results
		One: The first result set has the totals for the Upload
			The Upload Type - Lesson or Quiz
			The time the upload took place.
			The LessonID or the Quiz ID
		
		Two: The second result set holds the detail of the records that were inserted
			
		
Called By: 
		Toolbook.cs
Calls: 
		sp_xml_preparedocument -- system stored procedure to ALTER  an internal representation of the XML document.
		udfGetQuizIDByToolbookIDAndModuleID
		udfGetLessonIDByToolbookIDAndModuleID

Remarks: The XML document must be well formed otherwise the process will fail.

Author: Peter Kneale
Date Created: 23rd of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	Jack Liu	12/09/2005		Comment out the update answer correct status if the quiz is CORRECTION
						For Quiz CORRECTION, the correct answer can''t be changed, this is validated in the prcToolbook_preview	
#2	mikev		4/5/2007		Added worksiteIDs for Quiz and Lesson and that the value is copied from the old quiz/lesson to the new one.
#3	mike		4/5/2007		There is no longer a concept of corrections. All uploads are now considered updates. I have removed the updatetype variable, update statement logic and the insert logic remains.
						 	
*/
CREATE  Procedure [prcToolbook_Import]
	(
		@strXMLData NText = null, 	        	-- XML document
		@intUserID Integer = null,          		-- ID of user inporting the xmlData
		@intModuleID Integer = null,        		 -- Module Id that this quiz or lesson is associated with.
		@intCourseID Integer = null,         	-- Course Id that this quiz or lesson is associated with.
		@strToolLocation Varchar(500) = Null	-- Relative path to the toolbook content
	)

As
	Set NoCount On
	Set Xact_Abort On

	-- Check if the XML document was passed.
	If(@strXMLData Is Null)
	Begin
		Raiserror(''The @strXMLData parameter was Null.  You must supply a valid XML document.'', 16, 1)
		Return
	End
	
	-- Check if the ID was passed.
	If(@intUserID Is Null)
	Begin
		Raiserror(''The @intUserID parameter was Null.  You must supply a value.'', 16, 1)
		Return
	End
	
	-- Check if the Module ID was passed.
	If(@intModuleID Is Null)
	Begin
		Raiserror(''The @intModuleID parameter was Null.  You must supply a value.'', 16, 1)
		Return
	End
	
	-- Check if the Course ID was passed.
	If(@intCourseID Is Null)
	Begin
		Raiserror(''The @intCourseID parameter was Null.  You must supply a value.'', 16, 1)
		Return
	End
	
	-- Check if the Toolbook Location was passed.
	If(@strToolLocation Is Null)
	Begin
		Raiserror(''The @strToolLocation parameter was Null.  You must supply a value.'', 16, 1)
		Return
	End




	Declare @intDocHeader			 	Integer
	Declare @strRowPattern 				nVarchar(50)
	Declare @strToolbookType 			nVarchar(50)
	Declare	@strUploadType				nVarchar(50)
	Declare @strToolbookID				Varchar(50)
	Declare @DatePublished				DateTime
	Declare @intXMLUpdates				Integer
	
	-- Quiz Specific
	Declare @intQuizID				Integer
	Declare @intDocQuizQuestions			Integer
	Declare @intDocQuizAnswers			Integer
	Declare @intQuestions				Integer
	Declare @intAnswers				Integer
	
	-- Lesson
	Declare @intLessonID				Integer
	Declare @intDocLessons				Integer
	Declare @intLessons				Integer
	
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------
	----------- Create Necessary Temporary Tables
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------



	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Quiz Answers
	----------------------------------------------------------------------------
	Create Table #xmlUploadQuizAnswers
		(
		ToolbookQuestionID	Varchar(50),	-- The toolbook Question ID of from the new content
		ToolbookAnswerID	Varchar(50),	-- The toolbook Answer ID of from the new content
		Correct 		Varchar(255),	-- ''True'' or ''False'' indicating if the answer is correct
		bCorrect 		bit,		-- 0 or 1 indicating if the answer is correct, this is derived from the Correct Column
		AnswerText		nVarchar(1000),	-- The textual answer
		QuizQuestionID		Integer		-- The QuizQuestion ID from the Salt Database.
		)
		
	----------------------------------------------------------------------------
	-------- Create Temporary Table for Quiz Questions
	----------------------------------------------------------------------------
	Create Table #xmlUploadQuizQuestions
		(
		ToolbookPageID	Varchar(50),
		PageTitle 		nVarchar(1000),
		)
		
	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Quiz Answers
	----------------------------------------------------------------------------
	Create Table #xmlUploadLessons
		(
		ToolbookPageID	Varchar(50),
		PageTitle 		nVarchar(1000),
		)
		
	----------------------------------------------------------------------------
	-------- Create Imaginary Table for Upload Information
	----------------------------------------------------------------------------
	Create Table #xmlUploadHeader
		(
		ToolBookID		Varchar(50),
		ToolBookType 		Varchar(50),
		NumberOfPages 		Integer,
		DatePublished		DateTime,
		UploadType		Varchar(50)
		)


Begin Transaction

	----------------------------------------------------------------------------
	-------- Insert Upload Information Into Imaginary Table
	----------------------------------------------------------------------------
	Set @strRowPattern = ''/BDWToolBookUpload''
	Exec sp_xml_preparedocument @intDocHeader Output, @strXMLData

	Insert into #xmlUploadHeader
		(
		ToolBookID,
		ToolBookType,
		NumberOfPages,
		DatePublished,
		UploadType
		)

	Select 
		ToolBookID,
		ToolBookType,
		NumberOfPages,
		DatePublished,
		UploadType
	From
	
		OpenXml 
			(@intDocHeader, @strRowPattern)
		With
		(
		ToolBookID		Varchar(50) 	''ToolBookID'',
		ToolBookType		Varchar(50)	''ToolBookType'',
		NumberOfPages		Integer		''NumberOfPages'',
		DatePublished		DateTime	''DatePublished'',
		UploadType		Varchar(50)	''UploadType''
		)

	----------------------------------------------------------------------------
	-------- Insert Lessons Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page''
	Exec sp_xml_preparedocument @intDocLessons Output, @strXMLData

	Insert into #xmlUploadLessons
		(
		ToolbookPageID,
		PageTitle
		)

	Select 
		ToolbookPageID,
		PageTitle
	From

		OpenXml 
			(@intDocLessons, @strRowPattern)
		With
		(
		ToolbookPageID	Varchar(50) 	''@ID'',
		PageTitle	nVarchar(1000)	''PageTitle''
		)


	----------------------------------------------------------------------------
	-------- Insert Quiz Questions Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page''
	Exec sp_xml_preparedocument @intDocQuizQuestions Output, @strXMLData

	Insert into #xmlUploadQuizQuestions
		(
		ToolbookPageID,
		PageTitle

		)

	Select 
		ToolbookPageID,
		PageTitle
	From

		OpenXml 
			(@intDocQuizQuestions, @strRowPattern)
		With
		(
		ToolbookPageID	Varchar(50) 	''@ID'',
		PageTitle	nVarchar(1000)	''PageTitle''
		)
		
		
		
	----------------------------------------------------------------------------
	-------- Insert Quiz Answers Into Imaginary Table
	----------------------------------------------------------------------------	
	Set @strRowPattern = ''/BDWToolBookUpload/Pages/Page/Answers/Answer''
	Exec sp_xml_preparedocument @intDocQuizAnswers Output, @strXMLData

	Insert into #xmlUploadQuizAnswers
		(
		ToolbookQuestionID,
		ToolbookAnswerID,
		AnswerText,
		Correct
		)
	Select 
		ToolbookQuestionID,
		ToolbookAnswerID,
		AnswerText,
		Correct
	From

		OpenXml 
			(@intDocQuizAnswers, @strRowPattern)
		With
		(
		ToolbookQuestionID	Varchar(50) 	''../../@ID'',	-- Navigate back up to the question Id from this grandchild node
		ToolbookAnswerID	Varchar(50) 	''@ID'',
		AnswerText		nVarchar(1000)	''AnswerText'',
		Correct			Varchar(255)	''@correct''
		)	

	----------------------------------------------------------------------------------------------------
	-------- Determine if we are uploading a Quiz or a Lesson and whether its an update or a correction
	----------------------------------------------------------------------------------------------------

	Select 
		@strToolbookType 	= ToolBookType 	-- ''Quiz or Lesson''
	From
		#xmlUploadHeader

	-- Get Toolbook ID
	Select 	
		@strToolbookID = ToolBookID 
	From 
		#xmlUploadHeader

	-- Get Date Published
	Select 	
		@DatePublished = DatePublished
	From 
		#xmlUploadHeader
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		

		
		
		
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------
	----------- Process Upload from Imaginary Tables
	-------------------------------------------------------------------------------------------------------------------------------------
	-------------------------------------------------------------------------------------------------------------------------------------
		
		
		
	If (ltrim(rtrim(@strToolbookType)) = ''QUIZ'')
	Begin
		-- Get the quiz ID if it exists
		Set 	@intQuizID 		= dbo.udfGetQuizIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)


		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Perform an update 
		-------------------------------------------------------------------------------------------------------------------------------------

		Declare @WorksiteID nvarchar(50)
		
		Select @WorksiteID = WorksiteID From tblQuiz Where QuizID = @intQuizID
				
		---- Deactivate the existing quiz if it exists
		Update
			tblQuiz
		Set
			Active = 0 
		Where
			ModuleID = @intModuleID
			
		
		INSERT INTO 
			tblQuiz
			(
				ModuleID, 
				ToolbookID, 
				ToolbookLocation, 
				DatePublished, 
				LoadedBy, 
				DateLoaded, 
				Active,
				WorkSiteID
			)
		VALUES
			(
				@intModuleID, 
				@strToolbookID, 
				@strToolLocation, 
				@DatePublished, 
				@intUserID,     -- Loaded By
				GETDATE(),      -- Date Loaded 
				1,              -- Active
				@WorksiteID
			)

		-- With the new values

		
		-- Get the new quiz ID for the active quiz
		Set 	@intQuizID 		= dbo.udfGetQuizIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)		
		-- Verify that the new quiz was inserted
		If (@intQuizID = null)
		Begin
			Select ''Could not find the new Quiz to provide questions and answers for.'' as ''Error''
			Goto ErrorHandler
		End	
		
		-- Insert the new questions
		Insert Into tblQuizQuestion
			(
			QuizID,
			ToolbookPageID,
			Question
			)

			Select
				@intQuizID,
				ToolbookPageID,
				PageTitle
			From 
				#xmlUploadQuizQuestions
		
		
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Update this temporary table with the appropriate quiz question ids to simplify the update
		-------------------------------------------------------------------------------------------------------------------------------------
		Update
			LogicalTable
		Set
			LogicalTable.QuizQuestionID = PhysicalTable.QuizQuestionID
		From
			tblQuizQuestion PhysicalTable
		Inner Join
			#xmlUploadQuizAnswers LogicalTable
		On	
			PhysicalTable.QuizID = @intQuizID
		And
			PhysicalTable.ToolbookPageID = LogicalTable.ToolbookQuestionID
		
		-- Update the table with boolean 0 and 1 instead of the string ''True'' and ''False''
		Update 
			#xmlUploadQuizAnswers
		set
			bCorrect = 1
		Where
			Correct like ''%true%''
		
		-- Update the table with boolean 0 and 1 instead of the string ''True'' and ''False''
		Update 
			#xmlUploadQuizAnswers
		set
			bCorrect = 0
		Where
			Correct like ''%false%''
		
		
		-- Insert new answers
		Insert Into tblQuizAnswer
			(
			QuizQuestionID,
			ToolbookAnswerID,
			Answer,
			Correct
			)
			Select 
			QuizQuestionID,
			ToolbookAnswerID,
			AnswerText,
			bCorrect
		From
			#xmlUploadQuizAnswers


		
		-- Return message
		Select @strUploadType as ''Message'', GETDATE() as ''Time now'', @intQuizID
		
	
		-- Return Results
		Select 
			#xmlUploadQuizQuestions.PageTitle as ''Corrected Question'',
			#xmlUploadQuizAnswers.AnswerText  as ''Corrected Answer''
		From
			#xmlUploadQuizQuestions,#xmlUploadQuizAnswers 
		Where 
			#xmlUploadQuizAnswers.ToolbookQuestionID = #xmlUploadQuizQuestions.ToolbookPageID
		
	End   -- End Quiz
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	-- Lesson
	If (ltrim(rtrim(@strToolbookType)) = ''LESSON'')
	Begin
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Process Upload from Imaginary Tables
		-------------------------------------------------------------------------------------------------------------------------------------
		-------------------------------------------------------------------------------------------------------------------------------------

		-- Get the new lesson ID for the active lesson
		Set @intLessonID 	= dbo.udfGetLessonIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)

		-------------------------------------------------------------------------------------------------------------------------------------
		----------- Perform an update 
		-------------------------------------------------------------------------------------------------------------------------------------

		-- mikev(2)
		Declare @LWorkSiteID nvarchar(50)
		Declare @QFWorkSiteID nvarchar(50)
		
		Select @LWorkSiteID = LWorkSiteID, @QFWorkSiteID = QFWorkSiteID From tblLesson Where LessonID = @intLessonID
		
		---- Deactive the existing lesson if it exists
		Begin
			Update
				tblLesson
			Set
				Active = 0 
			Where
				ModuleID = @intModuleID
		End

		-- mikev(2)
		-- Create the new lesson
		Insert Into tblLesson
		(
		ModuleID,
		ToolbookID, 
		ToolbookLocation,
		DatePublished,
		LoadedBy, 
		DateLoaded, 
		Active,
		LWorkSiteID,
		QFWorkSiteID
		)
		-- With the values from the old lesson
		VALUES
		(
			@intModuleID,
			@strToolbookID,
			@strToolLocation,
			@DatePublished,
			@intUserID,		-- Loaded By
			GETDATE(),		-- Date Loaded
			1,				-- Active
			@LWorkSiteID,
			@QFWorkSiteID
		)
		-- Get the new lesson id
		Set 	@intLessonID 		= dbo.udfGetLessonIDByToolbookIDAndModuleID (@strToolbookID,@intModuleID)		

		-- Verify that the new lesson was created
		If (@intLessonID = null)
		Begin
			Select ''Could not find the new Lesson to provide pages for.'' as ''Error''
			Goto ErrorHandler
		End	
	
		-- Insert the new lesson pages
		Insert Into tblLessonPage
			(
			LessonID,
			ToolbookPageID,
			Title
			)

			Select
				@intLessonID,
				ToolbookPageID,
				PageTitle
			From 
				#xmlUploadLessons


		-- Return message
		Select @strUploadType as ''Message'', GETDATE() as ''Time now'',@intLessonID as ''Lesson ID''
		
		-- Return Results
		Select 
			#xmlUploadLessons.PageTitle as ''Corrected Lesson''
		From
			#xmlUploadLessons
	End



	Commit

	Return


--------------------------------------------------------------------
-----------------
--------------------------------------------------------------------

ErrorHandler:

	Rollback
	Return
' 
END
GO




UPDATE tblOrganisation  SET TimeZoneID = 52

GO


				

DELETE from tblUserCourseDetails


INSERT INTO tblUserCourseDetails (UserID,CourseID,UserCourseStatusID,NumberOfDelinquencyNotifications, NewStarterFlag, AtRiskQuizList, NotifiedModuleList, LastDelinquencyNotification)

select U.UserID,CourseID,UserCourseStatusID,0,null,'''','''',null
FROM  tblUser U inner join tblUserCourseStatus tUCS ON U.UserID = tUCS.UserID   INNER JOIN
(SELECT MAX(UserCourseStatusID) AS MaxUserCourseStatusID
FROM   dbo.tblUserCourseStatus
GROUP BY UserID, CourseID) AS currentStatus ON tUCS.UserCourseStatusID = currentStatus.MaxUserCourseStatusID

where  CourseStatusID in (1,2)


GO






IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_UsersToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_UsersToNotify]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_UsersToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [prcAutomatedEmails_UsersToNotify]
(
@OrganisationID int
)


AS

BEGIN

declare @OrgMidnight datetime

set @OrgMidnight =  DATEADD(d,-1,dbo.udfGetSaltOrgMidnight(@OrganisationID))



--                    H O U S E K E E P I N G
--tblUserCourseDetails contains information on notifications about courses that have ''at risk'' quizes
--add any new courses
INSERT INTO tblUserCourseDetails (UserID,CourseID,UserCourseStatusID,NumberOfDelinquencyNotifications, NewStarterFlag, AtRiskQuizList, NotifiedModuleList, LastDelinquencyNotification)

select U.UserID,CourseID,UserCourseStatusID,0,null,'''','''',null
FROM  tblUser U inner join tblUserCourseStatus tUCS ON U.UserID = tUCS.UserID and U.OrganisationID = @organisationID  INNER JOIN
(SELECT MAX(UserCourseStatusID) AS MaxUserCourseStatusID
FROM   dbo.tblUserCourseStatus
GROUP BY UserID, CourseID) AS currentStatus ON tUCS.UserCourseStatusID = currentStatus.MaxUserCourseStatusID

where  CourseStatusID in (1,2) and UserCourseStatusID NOT IN (SELECT UserCourseStatusID FROM tblUserCourseDetails)






--remove data on courses that are now unassigned
DELETE FROM tblUserCourseDetails WHERE UserCourseStatusID IN
(SELECT UserCourseStatusID
FROM  tblUser U inner join tblUserCourseStatus tUCS ON U.UserID = tUCS.UserID and U.OrganisationID = @organisationID  INNER JOIN
(SELECT MAX(UserCourseStatusID) AS MaxUserCourseStatusID
FROM   dbo.tblUserCourseStatus
GROUP BY UserID, CourseID) AS currentStatus ON tUCS.UserCourseStatusID = currentStatus.MaxUserCourseStatusID

where  CourseStatusID = 0
)








--                    S E L E C T    T H E    R E S U L T S

--declare @OrganisationID int
--set @OrganisationID = 109

create table #UsersToNotify
(userid int not null
,NewContent nvarchar(max) null
,PassedCourses nvarchar(max) null
,PassedModules nvarchar(max) null
,AtRiskContent nvarchar(max) null
,AtRiskOfdelinquency nvarchar(max) null)



insert into #UsersToNotify
SELECT distinct UsersToNotify.userid , UsersToNotify.NewContent , PassedCourses, PassedModules ,AtRiskContent,AtRiskOfdelinquency FROM
(

SELECT '''' as UserCourseStatusID, tblExpiredNewContent.UserID , tblCourse.Name + '' - ''+ tblModule.Name as NewContent , '''' as PassedCourses ,'''' as PassedModules , '''' as AtRiskContent, '''' as AtRiskOfdelinquency
FROM  tblExpiredNewContent INNER JOIN
tblModule ON tblExpiredNewContent.ModuleID = tblModule.ModuleID INNER JOIN
tblCourse ON tblModule.CourseID = tblCourse.CourseID
WHERE tblExpiredNewContent.organisationID = @OrganisationID



-- users with passed courses
UNION all SELECT '''' as UserCourseStatusID, CS.userid , '''' as NewContent, C.Name as PassedCourses,'''' as PassedModules, '''' as AtRiskContent, '''' as AtRiskOfdelinquency
FROM tblUserCourseStatus CS
inner join tblUser U ON U.UserID = CS.UserID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
where U.OrganisationID = @OrganisationID and CS.CourseStatusID=2 and DATEDIFF(d,CS.DateCreated,@OrgMidnight) < 1


-- users with passed modules
UNION all SELECT '''' as UserCourseStatusID, QuizStatus.userid ,
'''' as NewContent, '''' as PassedCourses,
c.name  + '' - '' + m.name as PassedModules, '''' as AtRiskContent,
'''' as AtRiskOfdelinquency
from
tblUserQuizStatus QuizStatus
join tblUser  u on u.UserID = QuizStatus.UserID and u.OrganisationID = @OrganisationID
inner join tblModule m on m.ModuleID = QuizStatus.ModuleID
join tblCourse c on c.CourseID = m.CourseID
inner join
(
select
max(UserQuizStatusID) UserQuizStatusID, uqs.UserID, uqs.ModuleID --UserQuizStatusID is identity
from
tblUserQuizStatus uqs
join tblUser  u on u.UserID = uqs.UserID
WHERE DATEDIFF(d,uqs.DateCreated,@OrgMidnight) < 1
and u.OrganisationID = @OrganisationID
group by
uqs.UserID,moduleID
) currentStatus
on QuizStatus.UserQuizStatusID = currentStatus.UserQuizStatusID
where m.active = 1
and QuizStatusID =2




-- users with quizes at risk ( N O R M A L    R U L E S )
UNION all SELECT DISTINCT '''' as UserCourseStatusID, AR.userID,  '''' as NewContent , '''' as PassedCourses,'''' as PassedModules, C.Name as AtRiskContent, '''' as AtRiskOfdelinquency
from tblQuizExpiryAtRisk AR
INNER JOIN tblUser U On U.UserID = AR.UserID
inner join tblModule M on m.ModuleID = AR.ModuleID and m.Active = 1 and AR.OrganisationID = @OrganisationID
INNER JOIN tblCourse C ON C.CourseID = M.CourseID
where U.Active = 1 AND daysToExpiry > 0 and Notified = 0

-- users with quizes at risk ( N O R M A L    R U L E S )
UNION all SELECT DISTINCT '''' as UserCourseStatusID, AR.userID,  '''' as NewContent , '''' as PassedCourses,'''' as PassedModules, C.Name +'' ( ''+M.name +'') ''                       + convert(varchar (11),DATEADD(d,daysToExpiry, dbo.udfGetSaltOrgDate(@OrganisationID) ) ,113)  as AtRiskContent, '''' as AtRiskOfdelinquency
from tblQuizExpiryAtRisk AR
INNER JOIN tblUser U On U.UserID = AR.UserID
inner join tblModule M on m.ModuleID = AR.ModuleID and m.Active = 1 and AR.OrganisationID = @OrganisationID
INNER JOIN tblCourse C ON C.CourseID = M.CourseID
where U.Active = 1 AND daysToExpiry > 0 and Notified = 0




-- users with courses at risk of delinquency (1ST WARNING)
UNION all SELECT DISTINCT CD.UserCourseStatusID as UserCourseStatusID, CS.userID ,  '''' as NewContent , '''' as PassedCourses,'''' as PassedModules, '''' as AtRiskContent, C.Name +'' '' + convert(varchar (11),DATEADD(d,o.DelinquencyPeriod, dbo.udfUTCtoDaylightSavingTime(CS.DateCreated,@OrganisationID)),113)  as AtRiskOfdelinquency
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID 
where U.Active = 1 AND CD.LastDelinquencyNotification IS NULL AND coursestatusid=1 AND o.OrganisationID = @OrganisationID AND (DATEADD(d,o.DelinquencyPeriod-O.NumberOfReminders*O.DelinquencyReminderPeriod, CS.DateCreated) > GETUTCDATE()) AND (O.NumberOfReminders > cd.NumberOfDelinquencyNotifications)
and U.NotifyOfPendingDelinquencies = 1

-- users with courses at risk of delinquency (SUBSEQUENT WARNINGS)
UNION all SELECT DISTINCT CD.UserCourseStatusID as UserCourseStatusID, CS.userID ,  '''' as NewContent , '''' as PassedCourses,'''' as PassedModules, '''' as AtRiskContent,C.Name +'' '' + convert(varchar (11),DATEADD(d,o.DelinquencyPeriod, dbo.udfUTCtoDaylightSavingTime(CS.DateCreated,@OrganisationID)),113)  as AtRiskOfdelinquency
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID 
where  U.Active = 1 AND coursestatusid=1 AND o.OrganisationID = @OrganisationID AND CD.LastDelinquencyNotification IS NOT NULL AND (O.NumberOfReminders > cd.NumberOfDelinquencyNotifications) AND ( DATEADD(D,O.DelinquencyReminderPeriod, CD.LastDelinquencyNotification) > GETUTCDATE())
and U.NotifyOfPendingDelinquencies = 1
) UsersToNotify


create index in_1 on #UsersToNotify(userid)



create table #UsersToNotifyList
(userid int not null
,NewContent nvarchar(max) null
,PassedCourses nvarchar(max) null
,PassedModules nvarchar(max) null
,AtRiskContent nvarchar(max) null
,AtRiskOfdelinquency nvarchar(max) null)

create index in_2 on #UsersToNotifyList(userid)

declare @userid int
,@NewContent nvarchar(max)
,@PassedCourses nvarchar(max)
,@PassedModules nvarchar(max)
,@AtRiskContent nvarchar(max)
,@AtRiskOfdelinquency nvarchar(max)

while exists (select 1 from #UsersToNotify)
begin
set rowcount 1
select @userid = userid
,@NewContent = NewContent
, @PassedCourses = PassedCourses
,@PassedModules = PassedModules
,@AtRiskContent = AtRiskContent
,@AtRiskOfdelinquency = AtRiskOfdelinquency

from #UsersToNotify
if exists (select * from #UsersToNotifyList where userid = @userid)
begin
update #UsersToNotifyList set
NewContent = rtrim(CAST(#UsersToNotifyList.NewContent + (case when #UsersToNotifyList.NewContent = '''' or @NewContent = '''' then '''' else ''<BR>'' end ) + @NewContent AS VARCHAR(max)))
, PassedCourses = rtrim(CAST(#UsersToNotifyList.PassedCourses + (case when #UsersToNotifyList.PassedCourses = '''' or @PassedCourses = '''' then '''' else ''<BR>'' end)+ @PassedCourses AS VARCHAR(max)))
,PassedModules = rtrim(CAST(#UsersToNotifyList.PassedModules + (case when #UsersToNotifyList.PassedModules = '''' or @PassedModules = '''' then '''' else ''<BR>'' end)+ @PassedModules AS VARCHAR(max)))
,AtRiskContent = rtrim(CAST(#UsersToNotifyList.AtRiskContent + (case when #UsersToNotifyList.AtRiskContent = '''' or @AtRiskContent = '''' then '''' else ''<BR>'' end)+ @AtRiskContent AS VARCHAR(max)))
,AtRiskOfdelinquency = rtrim(CAST(#UsersToNotifyList.AtRiskOfdelinquency + (case when #UsersToNotifyList.AtRiskOfdelinquency = '''' or @AtRiskOfdelinquency = '''' then '''' else ''<BR>'' end)+ @AtRiskOfdelinquency AS VARCHAR(max)))
from #UsersToNotifyList
where #UsersToNotifyList.userid = @userid
end
else
begin
insert #UsersToNotifyList(userid,NewContent,PassedCourses,PassedModules,AtRiskContent,AtRiskOfdelinquency)
values (@userid,@NewContent,@PassedCourses,@PassedModules,@AtRiskContent,@AtRiskOfdelinquency)

end
delete #UsersToNotify where
@userid = userid
and @NewContent = NewContent
and  @PassedCourses = PassedCourses
and  @PassedModules = PassedModules
and @AtRiskContent = AtRiskContent
and  @AtRiskOfdelinquency = AtRiskOfdelinquency
set rowcount 0
end


SELECT l.UserID,
-- Recipient Email Address
(SELECT Email FROM tblUser WHERE UserID = l.UserID) as RecipientEmail,

-- Sender Email Address
(SELECT dbo.udfUser_GetAdministratorsEmailAddress (l.UserID)) as SenderEmail,

-- Subject
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_Subject'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_Subject''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Subject,



-- Header
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_Header'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_Header''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName'')))

--New Content

+ case when NewContent = '''' then '''' else
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_ExpiredContent'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_ExpiredContent'')))+NewContent+ ''<BR>'' end

--Passed Courses
+ case when PassedCourses = '''' then '''' else
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_PassedCourses'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_PassedCourses'')))+PassedCourses+ ''<BR>'' end

--Passed Modules
+ case when PassedModules = '''' then '''' else
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_PassedModules'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_PassedModules'')))+PassedModules+ ''<BR>'' end

--AtRiskContent
+ case when AtRiskContent = '''' then '''' else
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_AtRiskOfExpiry'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_AtRiskOfExpiry'')))+AtRiskContent+ ''<BR>'' end

--AtRiskOfdelinquency
+ case when AtRiskOfdelinquency = '''' then '''' else
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''SStudent_Summary_AtRiskOfBeingOverdue'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''SStudent_Summary_AtRiskOfBeingOverdue'')))+AtRiskOfdelinquency+ ''<BR>'' end

--Email Sig
+     (select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_Sig'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_Sig'')))+ ''<BR>''  ,''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Body
, -- Sender"On Behalf Of" Email Address
(SELECT dbo.udfUser_GetAdministratorsOnBehalfOfEmailAddress (l.UserID))  as OnBehalfOfEmail,


*

FROM
#UsersToNotifyList l




--                    H O U S E K E E P I N G  (tidy up for tomorrow)

-- Update record of "at risk of Delinquency" notifications
-- Update tblUserCourseDetails.LastDelinquencyNotification
UPDATE tblUserCourseDetails  SET LastDelinquencyNotification = GETUTCDATE()
WHERE  UserCourseStatusID in (-- users with courses at risk of delinquency (1ST WARNING)
SELECT DISTINCT CD.UserCourseStatusID
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID where  CD.LastDelinquencyNotification IS NULL AND coursestatusid=1 AND o.OrganisationID = @OrganisationID AND (DATEADD(d,o.DelinquencyPeriod, CS.DateCreated) > GETUTCDATE()) AND (O.NumberOfReminders > cd.NumberOfDelinquencyNotifications)
)

UPDATE tblUserCourseDetails  SET LastDelinquencyNotification = GETUTCDATE(), NumberOfDelinquencyNotifications = NumberOfDelinquencyNotifications + 1
WHERE  UserCourseStatusID in (-- users with courses at risk of delinquency (SUBSEQUENT WARNINGS)
SELECT DISTINCT CD.UserCourseStatusID
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID where  coursestatusid=1 AND o.OrganisationID = @OrganisationID AND CD.LastDelinquencyNotification IS NOT NULL AND (O.NumberOfReminders > cd.NumberOfDelinquencyNotifications) AND ( DATEADD(D,O.DelinquencyReminderPeriod, CD.LastDelinquencyNotification) > GETUTCDATE())
)

/*-- Update Record of notified NEW Modules
UPDATE tblUserCourseDetails  SET NotifiedModuleList =  ModulesAssigned  from
(SELECT UserCourseStatusID, ModulesAssigned
FROM (select tUCS.ModulesAssigned, tUCS.CourseID,tUCS.CourseStatusID,tUCS.UserCourseStatusID as UCSUserCourseStatusID
FROM  tblUser U inner join tblUserCourseStatus tUCS ON U.UserID = tUCS.UserID and U.OrganisationID = 9   INNER JOIN

(SELECT MAX(UserCourseStatusID) AS MaxUserCourseStatusID
FROM   dbo.tblUserCourseStatus
GROUP BY UserID, CourseID) AS currentStatus ON tUCS.UserCourseStatusID = currentStatus.MaxUserCourseStatusID) CS
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
Inner join tblUserCourseDetails CD on  CD.UserCourseStatusID = CS.UCSUserCourseStatusID
and  CS.CourseStatusID=1
) temp
where tblUserCourseDetails.UserCourseStatusID = temp.UserCourseStatusID*/


DELETE FROM tblExpiredNewContent WHERE organisationID = @OrganisationID



-- Update record of notified "At Risk Quizes"
-- users with quizes at risk ( N O R M A L    R U L E S )
update tblQuizExpiryAtRisk SET Notified = 1 WHERE organisationID = @OrganisationID and Notified = 0


if OBJECT_ID(''#UsersToNotifyList'') is not null
begin
drop table #UsersToNotifyList
end

if  OBJECT_ID(''#UsersToNotify'')is not null
begin
drop table #UsersToNotify
END

END
' 
END
GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetUnassigned]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUser_GetUnassigned]
GO

SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUser_GetUnassigned]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/*
Summary: Returns the users that are not currently assigned to a unit.
	This function never returns users who are salt administrators

Parameters: @OrganisationID 	Integer
Returns:
		UserID,
		First Name,
		Last Name,
		DateUpdated
	@intErrorNumber As ''ErrorNumber'',
	@strErrorMessage As ''ErrorMessage''
		
Called By: User.cs
Calls: Nothing

Remarks: Raises an error if the parameter is null

	Exception:
	0. Succeed
	1. RecordNotFound
	2. FK constraint
	3. PKViolationException
	4. UniqueViolationException
	5. MissingParameterException
	7. IntegrityConstraintException
	10. BusinessServiceException (General)		

Author: Peter Kneale
Date Created: 9th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

-- prcUser_GetUnassigned 1
*/
CREATE Procedure [prcUser_GetUnassigned]
	@OrganisationID 	Integer
AS

Set NoCount On

	-- Declarations
	Declare @strErrorMessage Varchar(200) 		-- Holds the error message
	Declare @intErrorNumber Integer			-- Holds the error number
	
	-- Initialise variables
	Set @strErrorMessage = ''''
	Set @intErrorNumber = 0

	-- Validation
	If(@organisationID Is Null)
	Begin
		Set @intErrorNumber = 5
		Set @strErrorMessage = ''Missing or Null parameter @organisationID in stored procedure prcUser_GetUnassigned''
		Goto Finalise
	End	
	
	-- Logic
	Select     
		UserID,
		LastName,
		FirstName,
		UserName,
		dbo.udfUTCtoDaylightSavingTime(DateUpdated, @OrganisationID) as DateUpdated
	From         
		tblUser
	Where
		OrganisationID=@OrganisationID
	And	
		UnitID is null
	And
		UserTypeID <> 1
    order by
        LastName,
        FirstName
	-- Set the error message to successfull
	Set @strErrorMessage = ''User successfully selected.''

	-- Finalise the procedure
	Goto Finalise

Finalise:
If(@intErrorNumber > 0)
Begin
	Select
		@intErrorNumber 	As ''ErrorNumber'',
		@strErrorMessage 	As ''ErrorMessage''
End
' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcProfile_GetModulePointsByCourse]    Script Date: 07/07/2011 13:29:44 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
/*
Summary: Gets a list of Modules per Course
Parameters: 
		@courseID Integer ID of the Course to return the Modules for.
Returns: 
		
Called By: 
		Module.cs
Calls: 

Remarks:

Author: Gavin Buddis
Date Created: 16th of February 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

ALTER Procedure [dbo].[prcProfile_GetModulePointsByCourse]
(
	@courseID int, -- ID of the Course to return the Modules for.
	@ProfilePeriodID int,
	@OrgID int
)

As

BEGIN

	Set Nocount On

	If(@courseID Is Null)
	Begin
		Raiserror('The @courseID parameter was Null.  You must supply a value.', 16, 1)
		Return
	End

	create table  #Modules 
	(
		ModuleID int,
		CourseID int,
		Name nvarchar(100),
		Sequence int,
		Description nvarchar(1000),
		Active bit,
		CreatedBy int,
		DateCreated datetime,
		UpdatedBy int,
		DateUpdated datetime
	)

	insert into #Modules
	exec prcModule_GetListByCourse @CourseID, @OrgID

	alter table #modules add [ptsid] int, pts numeric(10,1)

	update #modules set ptsid = pp.ProfilePointsID, pts = pp.Points
	from 
		#Modules m 
		left outer join tblProfilePoints pp	on m.ModuleID = pp.typeID
	where 
		(pp.profilepointstype = 'M'
		and pp.active = 1
		and pp.ProfilePeriodID = @ProfilePeriodID)

	select
		ptsid as ProfilePointsID,
		m.ModuleID, 
		m.Name as [Module Name],
		coalesce(pts,0) as Points
	from #modules m
	where m.active = 1
	
	drop table #modules
END

/****** Object:  StoredProcedure [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]    Script Date: 07/07/2011 13:54:32 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
/*
Summary:		Mainly just returns a list of unit admins that meet the flagged conditions

Parameters:		Comma separated list of userID:courseID
Returns:		table (lastname nvarchar(50), firstname nvarchar(50), userid int, email nvarchar(100), policy_name varchar(8000))
		
Called By:		BusinessServices.{Policy.GetAdminsInOrgPendingPolicy in Policy.cs
Calls:			None

Remarks:		None

Author:			John H
Date Created:	21 MAy 2010

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	
*/

ALTER PROCEDURE [dbo].[prcPolicy_GetAdminsInOrgPendingPolicy]
	@policy_ids varchar(8000),
	@unit_ids varchar(8000),
	@accepted varchar (20),
	@acceptedDateFrom 		datetime,
	@acceptedDateTo 		datetime
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @policies TABLE (policyid int)
	DECLARE @selected_units TABLE (unitid int)
	DECLARE @result TABLE (firstname nvarchar(50), lastname nvarchar(50), userid int, email nvarchar(100), new_policy_names varchar(8000), modified_policy_names varchar(8000), HierarchyName nvarchar(500))
	DECLARE
		@pos int,
		@colon_pos int,
		@temp varchar(50),
		@userid int, @admid int,
		@new_policy_names varchar(8000),
		@users_with_policies varchar(8000),
		@modified_policy_names varchar(8000),
		@strAccepted varchar(5),
		@aunit int,@orgID int

	IF @accepted = '0'
	BEGIN
		SELECT @strAccepted = 'True'
	END
	ELSE
	BEGIN
		SELECT @strAccepted = 'False'
	END

	
	
	-- rip the unit selection
	INSERT INTO @selected_units
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@unit_ids)

	SELECT @policy_ids = replace(rtrim(ltrim(replace(replace(replace(@policy_ids,' ',''),',,',','),',',' '))),' ',',') + ','
	SELECT @aunit = (SELECT TOP (1) unitid FROM @selected_units)
	SELECT @orgID = OrganisationID FROM tblUnit WHERE tblUnit.UnitID = @aunit
	
	
	set @acceptedDateFrom = dbo.udfDaylightSavingTimeToUTC(@acceptedDateFrom, @orgID)
	set @acceptedDateTo = dbo.udfDaylightSavingTimeToUTC(@acceptedDateTo, @orgID)

	-- rip the policies into a table
	INSERT INTO @policies
		SELECT
			*
			FROM
				dbo.udfCsvToInt(@policy_ids)



--	SELECT DISTINCT adm.UserID, hier.HierarchyName, adm.LastName, adm.FirstName,  adm.email, '',''
	SELECT DISTINCT adm.UserID, unt.Name as HierarchyName, adm.LastName, adm.FirstName,  adm.email, '',''
		FROM
			@policies pols 
			INNER JOIN tblUserPolicyAccess polacs ON polacs.policyid = pols.policyid AND polacs.granted = 'True'
			INNER JOIN tblUserPolicyAccepted polacd ON polacd.policyid = pols.policyid AND polacd.Accepted = @strAccepted 
				AND (
				((COALESCE(polacd.DateAccepted,CAST('1/1/1980' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST('1/1/2999' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = 'False'))
			INNER JOIN tblUser usr ON usr.userid = polacs.userid AND usr.userid = polacd.userid AND usr.active = 'True' 
			INNER JOIN @selected_units su ON usr.unitid = su.unitid
			INNER JOIN udf_GetAdminEmailsForORG(@orgID) uadm ON uadm.UnitID = su.unitid  
			INNER JOIN tblUnitHierarchy hier ON hier.UnitID = usr.UnitID 
			INNER JOIN tblUnit unt ON unt.UnitID = usr.UnitID 
			INNER JOIN tblUser adm ON adm.userid = uadm.userid 
		WHERE NOT EXISTS
	(SELECT *
		FROM
			@policies Spols 
			INNER JOIN tblUserPolicyAccess Spolacs ON Spolacs.policyid = Spols.policyid AND Spolacs.granted = 'True'
			INNER JOIN tblUserPolicyAccepted Spolacd ON Spolacd.policyid = Spols.policyid AND Spolacd.Accepted = @strAccepted 
				AND (
				((COALESCE(polacd.DateAccepted,CAST('1/1/1980' AS DateTime)) >= @acceptedDateFrom) AND (COALESCE(polacd.DateAccepted,CAST('1/1/2999' AS DateTime)) < @acceptedDateTo))OR (@strAccepted = 'False'))
			INNER JOIN tblUser Susr ON Susr.userid = Spolacs.userid AND Susr.userid = Spolacd.userid AND Susr.active = 'True' 
			INNER JOIN @selected_units Ssu ON Susr.unitid = Ssu.unitid
			INNER JOIN udf_GetAdminEmailsForORG(@orgID) Suadm ON Suadm.UnitID = Ssu.unitid  
     		INNER JOIN tblUnitHierarchy Shier ON Shier.UnitID = Susr.UnitID 
			INNER JOIN tblUnit Sunt ON Sunt.UnitID = Susr.UnitID 
			INNER JOIN tblUser Sadm ON Sadm.userid = Suadm.userid and Sadm.UserID = adm.UserID
			WHERE (hier.hierarchy LIKE Shier.hierarchy+',%') )

 



END

/****** Object:  StoredProcedure [dbo].[prcProfilePoints_Add]    Script Date: 07/07/2011 17:22:53 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*Summary:
Adds Profile

Parameters:
	@ProfilePointsType nvarchar(1),
	@TypeID int, 
	@ProfilePeriodID int,
	@Points numeric(10,1),
	@Active bit,
	@DateAssigned datetime

Returns:
Nothing

Called By:
Profile.cs.

Calls:
Nothing

Remarks:
None

Author: Aaron Cripps
Date Created: July 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description

**/

ALTER procedure [dbo].[prcProfilePoints_Add]
(
@ProfilePointsType nvarchar(1),
@TypeID int, 
@ProfilePeriodID int,
@Points numeric(10,1),
@Active bit,
@OrgID int
--@ApplyToQuiz bit,
--@ApplyToLesson bit
)

as



-- insert values into tblProfilePoints
insert into tblProfilePoints
(
ProfilePointsType,
TypeID,
ProfilePeriodID,
Points,
Active,
DateAssigned --,
--ApplyToQuiz,
--ApplyToLesson
)
values
(
@ProfilePointsType,
@TypeID,
@ProfilePeriodID,
@Points,
@Active,
GETUTCDATE() --,
--@ApplyToQuiz,
--@ApplyToLesson
)

/****** Object:  Table [dbo].[tbllogInstall42]    Script Date: 07/07/2011 17:05:54 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[tbllogInstall42]') AND type in (N'U'))
DROP TABLE [dbo].[tbllogInstall42]
GO


/****** Object:  Table [dbo].[tbllogInstall42]    Script Date: 07/07/2011 17:05:54 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[tbllogInstall42](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[logdatetime] [datetime] NULL,
	[logmessage] [varchar](500) NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUser_GetAdministratorsOnBehalfOfEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfUser_GetAdministratorsOnBehalfOfEmailAddress]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfUser_GetAdministratorsOnBehalfOfEmailAddress]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'




create function [udfUser_GetAdministratorsOnBehalfOfEmailAddress]
(
@UserID	int
)
Returns varchar(100)
AS
BEGIN
DECLARE @UnitID int
SELECT @UnitID = UnitID FROM tblUser WHERE UserID = @UserID

DECLARE @Email VARCHAR(100)
SELECT @Email = coalesce(
-- try to get the closest unit admin then search further afield
(Select top 1	u.EmailInOrgDomain
from tblUnitAdministrator ua
inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
and u.usertypeID=3 --Unit administrator(3)
and u.unitID=@unitID
and u.Email is not null),


(Select top 1	u.EmailInOrgDomain
from tblUnitAdministrator ua
inner join tblUser u on ua.userID = u.UserID
where ua.unitID=@unitID
and u.usertypeID=3 --Unit administrator(3)
and u.Email is not null),

(Select top 1	u.EmailInOrgDomain
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 2
and Email is not null),


(Select top 1	u.EmailInOrgDomain
from tblUser u inner join tblUnit un on un.OrganisationID = u.OrganisationID
where un.unitID=@unitID
and UserTypeID = 1
and Email is not null),

--all else failed so get the salt admin
(Select top 1	u.Email
from tblUser u
where UserTypeID = 1
and Email is not null))



return @Email
END' 
END

GO




IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_New StartersToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_New StartersToNotify]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_New StartersToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [prcAutomatedEmails_New StartersToNotify] 
(
	@OrganisationID int
)


AS

BEGIN

-- New Starter
SELECT userid,email,(SELECT dbo.udfUser_GetAdministratorsEmailAddress (U.UserID)) as SenderEmail, (SELECT Value + '' login details '' FROM tblAppConfig where Name = ''AppName''), REPLACE
(
 (SELECT REPLACE
   (
	(SELECT REPLACE
	  (
	   (select 
		 REPLACE( 
		  (SELECT coalesce
			( 
			  (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Student_Summary_NewStarter'')
			  ,
			  (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Student_Summary_NewStarter'')
			)
		  )
		  ,''%APP_NAME%'',
		  (SELECT Value FROM tblAppConfig where Name = ''AppName'')
		 )
		)
		 ,''%PASSWORD%'',U.PASSWORD
	  )
	)
    ,''%USERNAME%'',U.USERNAME 
   )
  )
  ,''%URL%'',(select(''<a href="'')+(SELECT CASE WHEN ''true'' = [Value] THEN ''HTTPS://'' ELSE ''http://'' END FROM tblAppConfig where Name = ''SSL'' )+(SELECT DOMAINNAME + ''/Restricted/Login.aspx'' FROM tblOrganisation ORG WHERE ORG.OrganisationID =  @OrganisationID )+(''">'')+(SELECT Value FROM tblAppConfig where Name = ''AppName'')+(''</a>''))
 )
, -- Sender"On Behalf Of" Email Address
(SELECT dbo.udfUser_GetAdministratorsOnBehalfOfEmailAddress (U.UserID))  as OnBehalfOfEmail

 from tblUser U where  U.OrganisationID = @OrganisationID and U.active = 1 and U.NewStarter = 1 
 
 update tblUser set NewStarter = 0  where  OrganisationID = @OrganisationID and active = 1 and NewStarter = 1 


END
' 
END
GO

/* updated managers to notify on delinquent users script */

/*
   Friday, 8 July 20111:41:14 PM
   User: salt_user
   Server: BDW2008R2
   Database: bd_dev_42
   Application: 
*/



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_ManagersToNotify]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcAutomatedEmails_ManagersToNotify]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcAutomatedEmails_ManagersToNotify]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE [prcAutomatedEmails_ManagersToNotify]
(
@OrganisationID int
)


AS

BEGIN







--                    S E L E C T    T H E    R E S U L T S

--declare @OrganisationID int
--set @OrganisationID = 109

;with UsersToNotify (userid,DelinquentCourse) as (
SELECT distinct UsersToNotify.userid , UsersToNotify.DelinquentCourse FROM
(


-- delinquent users
SELECT DISTINCT CD.UserCourseStatusID as UserCourseStatusID, CS.userID , u.username, C.Name     as DelinquentCourse
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID
INNER JOIN tblUserCourseDetails UCD ON (UCD.UserID = u.UserID AND UCD.CourseID = C.CourseID)
where coursestatusid = 1 AND o.OrganisationID = @OrganisationID AND (GETUTCDATE() > DATEADD(d,o.DelinquencyPeriod+1, CS.DateCreated))
AND UCD.LastDelNoteToMgr = 0 and WarnMgrsofDeliquentUsers = 1 and U.active = 1



)  UsersToNotify
)

, UsersToNotifyList(numb, userid,DelinquentCourse) as
(
select 1,null,CAST('''' AS VARCHAR(max))
UNION ALL

SELECT cte.numb + 1,pl.userid,CAST(cte.DelinquentCourse + (case when cte.DelinquentCourse = '''' or pl.DelinquentCourse = '''' then '''' else CHAR(13)+ CHAR(10) end ) + pl.DelinquentCourse AS VARCHAR(max))
from (  SELECT

RowNum = Row_Number() OVER (partition BY userid order by userid)
,userid,DelinquentCourse

FROM UsersToNotify
) AS pl
join UsersToNotifyList cte on pl.RowNum = cte.numb and (cte.userid is null or pl.userid = cte.userid)
)




, ManagersToNotify(numb, username, ManagerEmail ,DelinquentCourse) as
(
select numb, U.username, CAST(COALESCE(U.DelinquencyManagerEmail,dbo.udfUser_GetAdministratorsEmailAddress(U.UserID)) AS VARCHAR(max)),DelinquentCourse
FROM UsersToNotifyList UL
INNER JOIN tblUser U ON U.UserID = UL.UserID
)

, ManagersToNotifyList(numb, ManagerEmail, UserCourseList) as
(
select 1,CAST(null AS VARCHAR(max)),CAST('''' AS VARCHAR(max))
UNION ALL

SELECT cte.numb + 1,pl.ManagerEmail,CAST(cte.UserCourseList + (case when cte.UserCourseList = '''' or pl.UserCourseList = '''' then '''' else CHAR(13)+ CHAR(10) end ) + pl.UserCourseList AS VARCHAR(max))
from (  SELECT

RowNum = Row_Number() OVER (partition BY ManagerEmail order by ManagerEmail)
,cast(ManagerEmail AS VARCHAR(max)) as ManagerEmail, CAST(username + '' '' + DelinquentCourse AS VARCHAR(max)) as UserCourseList

FROM ManagersToNotify
) AS pl
join ManagersToNotifyList cte on pl.RowNum = cte.numb and (cte.ManagerEmail is null or pl.ManagerEmail = cte.ManagerEmail)
)

--select * from ManagersToNotify
--select * from ManagersToNotifyList




SELECT l.ManagerEmail,
-- Recipient Email Address
l.ManagerEmail as RecipientEmail,

-- Sender Email Address
l.ManagerEmail as SenderEmail,

-- Subject
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Subject'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Subject''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Subject,



-- Header
(select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Header'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Header''))),''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName'')))



--delinquent
+ UserCourseList+ CHAR(13)+ CHAR(10)

--Email Sig
+     (select REPLACE(
(SELECT coalesce( (SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID = @OrganisationID AND Name = ''Overdue_Summary_Sig'')

,(SELECT  Value FROM tblOrganisationConfig WHERE OrganisationID IS NULL AND Name = ''Overdue_Summary_Sig'')))+ CHAR(13)+ CHAR(10)  ,''%APP_NAME%'',(SELECT Value FROM tblAppConfig where Name = ''AppName''))) as Body
,


*

FROM
ManagersToNotifyList l

join (select max(s.numb) numb ,ManagerEmail from ManagersToNotifyList s group by ManagerEmail)m on m.ManagerEmail = l.ManagerEmail and m.numb = l.numb
ORDER BY l.numb DESC



UPDATE tblUserCourseDetails SET LastDelNoteToMgr  = 1
from tblUserCourseDetails
join (
SELECT U.userID , C.CourseID
FROM tblUserCourseStatus CS
INNER JOIN tblUserCourseDetails CD ON CD.UserID = CS.UserID AND CD.CourseID = CS.CourseID
INNER JOIN tblCourse C ON C.CourseID = CS.CourseID
INNER JOIN tblUser U On U.UserID = CS.UserID
INNER JOIN tblOrganisation O on o.OrganisationID = u.OrganisationID
INNER JOIN tblUserCourseDetails UCD ON (UCD.UserID = u.UserID AND UCD.CourseID = C.CourseID)
where coursestatusid = 1 AND o.OrganisationID = @OrganisationID AND (GETUTCDATE() > DATEADD(d,o.DelinquencyPeriod+1, CS.DateCreated))
AND UCD.LastDelNoteToMgr = 0
) a on a.userid = tblUserCourseDetails.UserID and a.CourseID = tblUserCourseDetails.CourseID


END
' 
END
GO



/* ------------------------------------------------ */




-- Monday, July 11, 2011 - 10:02:45 AM
UPDATE tblLangValue set LangEntryValue = 'New', DateModified = getdate() 
					WHERE LangID = (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU')
						AND LangInterfaceID = (SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Reporting/PeriodicReport.aspx')
						AND LangResourceID = (SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'butNew')

GO








-- Monday, July 11, 2011 - 1:47:28 PM
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('lblLicensingPeriod', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]

GO

INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Reporting/PeriodicReport.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'lblLicensingPeriod'), 
					'Licensing Period', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]



GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [udfReport_HistoricAdminSummaryOptimised]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'/****** Object:  User Defined Function dbo.udfReport_HistoricAdminSummary    Script Date: 20/04/2004 8:25:58 AM ******/
/*Summary:
Get the Current or historic user module status  based on the search criteria
See the remarks below.
Returns: table
Called By: Current historic Admin Report
Calls:
Remarks:
1. Get User and course List based on search criteria
1.1 Get Unit List
1.1.1 If unit ids are passed in, convert the CSV format to a table
1.1.2 If no unit is selected, get a list of of all units that the admin user has permission to access
1.2 Get User list Based on the first name and last name in the search cirteria
1.3 Get Course list Based on the selected course in the search criteria and Used can select multiple Courses
2. Get the User Quiz and Lesson status up to the effective date
2.1 If there is no effective date is passed in, get the current module status
2.2 If there is effective date, get the module status up to the effective date
3.  Get a list of the user''s quiz and lesson historic status
Author: Jack Liu
Date Created: 1 Mar 2004
Modification History
-----------------------------------------------------------
v#    Author            Date                    Description
#1.1  Usman Tjiudri     10/11/2005  Performance tuning:
- use temp-table to populate Unit Pathway
- join the temp-table to populate tblResult
instead of using udfGetUnitPathway function in the join.
#2.0  Serguei Chkaroupine 28/02/06 -New insert statement for histric admin report
- it will insert all lessons that match current quizmodule pair
- Current admin report performance fix. Added WHERE statement to
most of the insert statements.
#3    Mark Donald 27/07/2009              add userName and userEmail params
**          24/03/11    John Hedlefs                  Timezone conversions

select * from dbo.udfReport_HistoricAdminSummary(3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',4)
--------------------
**/

CREATE             Function [udfReport_HistoricAdminSummaryOptimised]
(
@organisationID   Int,
@unitIDs                Varchar(MAX),
@courseIDs              Varchar(8000),
@userFirstName          Varchar(50),
@userLastName           Varchar(50),
@userName               Varchar(100),
@userEmail              Varchar(100),
@effectiveDateOrg             Datetime,
@adminUserID            Int,
@classificationID       Int,
@defaultDateOrg         DateTime,
@inclInactive           int
)
Returns @tblResult Table
(
-- General
Unit              nVarchar(200),
[User]                  nVarchar(100),
Course                  nVarchar(100),
Module                  nVarchar(100),
[Sequence]        Int,
-- Quiz Specific
QuizStatus        Varchar(50),
QuizScore         Int,
QuizStatusDate    Datetime,
-- Lesson Specific
LessonStatus      Varchar(50),
-- Hidden
UnitID                  Int,
UserID                  Int,
UserName          nVarchar(100),
ExternalID        nVarchar(50),
CourseID          Int,
ModuleID          Int,
Active      int
)
As Begin

--Variables declarations
DECLARE     @effectiveDate Datetime
DECLARE     @defaultDate      DateTime
DECLARE @UserTypeID     INT
DECLARE @tblUnit                    Table(UnitID INT PRIMARY KEY(UnitID))
DECLARE @tblUser                    Table(UserID INT, UnitID INT, Active INT)
DECLARE @tblCourse                        Table(CourseID INT, [Name] NVARCHAR(100) PRIMARY KEY(CourseID))
DECLARE @CoursesWithAccess          TABLE (CourseID INT PRIMARY KEY(CourseID))
DECLARE @UserModuleWithAccess       TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
DECLARE @AllModules                 TABLE(ModuleID INT PRIMARY KEY(ModuleID))
DECLARE @tblUserQuizStatus          Table
(
[UserQuizStatusID] [int] Not Null,
[UserID] [int] Not Null,
[ModuleID] [int] Not Null,
[QuizStatusID] [int] Not Null,
[QuizScore] [int] Null,
[DateCreated] [datetime] Not Null
)
DECLARE @tblUserLessonStatus Table
(
[UserLessonStatusID] [int] ,
[UserID] [int] ,
[ModuleID] [int] ,
[LessonStatusID] [int] ,
[DateCreated] [datetime]
)
DECLARE @vwUserModuleAccess table
(
UserID INT not null,
FirstName varchar(255),
LastName varchar(255),
UnitID INT,
OrganisationID INT,
ModuleID INT,
CourseID INT,
CourseName nvarchar(100),
[Name] nvarchar(100),
Sequence INT,
Description nvarchar(1000)
)

DECLARE @tblOrganisationCourseAccess table
(
OrganisationID int,
GrantedCourseID int
)

set   @effectiveDate = dbo.udfDaylightSavingTimeToUTC(@effectiveDateOrg,@OrganisationID)
set   @defaultDate = dbo.udfDaylightSavingTimeToUTC(@defaultDate,@OrganisationID)


---------------------------------------------------------------------------------------------

--set the default date depending on effective date
set @defaultdate = coalesce (@effectivedate,@defaultdate)
---------------------------------------------------------------------------------------------

--Check If Unit ID is specified
IF @unitIDs IS NULL
BEGIN
--Check User Type
SELECT
@UserTypeID = UserTypeID
FROM
tblUser
WHERE UserID = @adminUserID

--Get all units in Organisation if user is Salt Admin(1) or Org admin (2)
IF (@UserTypeID = 1 Or @UserTypeID = 2)
BEGIN
INSERT INTO
@tblUnit (UnitID)
SELECT
UnitID
FROM
tblUnit
WHERE OrganisationID = @OrganisationID
END

--Get units that the user is admministrator if user is Unit Admin(3)
IF (@UserTypeID = 3)
BEGIN
INSERT INTO
@tblUnit (UnitID)
SELECT
U.UnitID
FROM
tblUnit U INNER JOIN tblUnitAdministrator UA ON
UA.UnitID = U.UnitID AND
UA.UserID = @adminUserID
WHERE
U.OrganisationID = @OrganisationID
END
END
ELSE
BEGIN
--Seperate comma seperated values as Table rows
INSERT INTO @tblUnit SELECT * FROM  dbo.udfCsvToInt(@unitIDs)
END
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--FirstName, Last Name, etc specified in search criteria
IF (@userFirstName IS NULL)   SET @userFirstName = ''''
IF (@userLastName IS NULL)          SET @userLastName = ''''
IF (@userName IS NULL)              SET @userName = ''''
IF (@userEmail IS NULL)             SET @userEmail = ''''

INSERT INTO
@tblUser (UserID, UnitID, Active)
SELECT DISTINCT
U.UserID, U.UnitID, U.Active
FROM
tblUser U INNER JOIN @tblUnit UN ON U.UnitID = UN.UnitID
and datediff(day,U.datecreated,@defaultdate)>=0-- created on or b4 specified date
LEFT JOIN tblUserClassification UC ON UC.UserID  = U.UserID
WHERE
U.FirstName Like ''%'' + @userFirstName + ''%'' AND
LastName Like ''%'' + @userLastName + ''%'' AND
UserName Like ''%'' + @userName + ''%'' AND
Email Like ''%'' + @userEmail + ''%'' AND
--AND have the Custom Classification option
--If classification is Any (0), This will find users of any Custom Classification
((@classificationID = 0) OR (UC.classificationID = @classificationID)) AND
--inclInactive = 0: do not include inactive user
--inclInactive = 1: include inactive user
(U.Active = CASE @inclInactive WHEN 0 THEN 1 ELSE U.Active END) AND
(U.OrganisationID = @OrganisationID)

---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- Search criteria contains Course ID''s
INSERT INTO
@tblCourse (CourseID, [Name])
SELECT
C.CourseID, C.[Name]
FROM
dbo.udfCsvToInt(@courseIDs) CA INNER JOIN tblCourse C ON
CA.intValue = C.CourseID AND C.Active = 1

-- added to deal with past courses - adds past course to intermediate @tblOrganisationCourseAccess table
-- to mimic it being a current course so results will be returned
insert into
@tblOrganisationCourseAccess (OrganisationID, GrantedCourseID)
select
@Organisationid, C.CourseID
from
dbo.udfCsvToInt(@courseIDs) CA inner join tblCourse C on
CA.intValue = C.CourseID and C.Active = 1

INSERT INTO @vwUserModuleAccess   SELECT   tU.UserID, tU.FirstName, tU.LastName, tU.UnitID, tU.OrganisationID, tM.ModuleID, tM.CourseID, tC.Name AS CourseName, tM.Name, tM.Sequence,
tM.Description
FROM         tblUser AS tU INNER JOIN
@tblUser tbU on tbU.UserID = tU.UserID
inner join
@tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID
WHERE     tM.CourseID in (SELECT courseid from @tblCourse ) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
(tUsrMA.Granted = 1)
--select * from @vwUserModuleAccess where UnitID is null

INSERT INTO @UserModuleWithAccess
SELECT DISTINCT UserID, ModuleID, UnitID FROM @vwUserModuleAccess where UnitID is not null

INSERT INTO @tblUserQuizStatus
(
[UserQuizStatusID],
[UserID],
[ModuleID],
[QuizStatusID],
[QuizScore],
[DateCreated]
)
SELECT
A.[UserQuizStatusID],
A.[UserID],
A.[ModuleID],
A.[QuizStatusID],
A.[QuizScore],
A.[DateCreated]
FROM
(
SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND B.QuizStatusID <> 0
--AND DateDiff(day, B.DateCreated, @effectiveDate)=0
GROUP BY
A.UserID, A.ModuleID
) B, tblUserQuizStatus A, @tblUser C
WHERE
A.UserQuizStatusID = B.LatestQuizID AND B.UserID = C.UserID AND A.UserID = C.UserID
-- li June 2008:
-- User who has access to a module but doesn''t have a record in tblUserQuizStatus is a new user
-- this logic will include new user in the current and historic admin report before user quiz status
-- is updated by overnight job

INSERT INTO @tblUserQuizStatus
(
[UserQuizStatusID],
[UserID],
[ModuleID],
[QuizStatusID],
[QuizScore],
[DateCreated]
)
SELECT
0, -- UserQuizStatusID
A.[UserID],
A.[ModuleID],
1, -- QuizStatus: Not Started
null, -- QuizScore
@defaultDateOrg -- DateCreated (here set to @defaultdate which is passed in as getDate())
FROM @UserModuleWithAccess A
join  @tblUser B on A.UserID = B.UserID
-- User doesn''t have quiz activities
where  A.UserID  + ''-'' + A.MODULEID NOT IN
(     Select D.UserID + ''-'' + D.Moduleid
from @tblUserQuizStatus D
where datediff(day, d.datecreated, @defaultdate)>=0)
-- end logic for including new user''s quiz status

Insert Into @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
Select
A.[UserLessonStatusID],
A.[UserID],
A.[ModuleID],
A.[LessonStatusID],
A.[DateCreated]

FROM
(
SELECT
B.UserID, B.ModuleID, MAX(B.UserLessonStatusID) AS ''LatestLessonStatusID''
FROM
@UserModuleWithAccess A, tblUserLessonStatus B
WHERE
A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
--DateDiff(day, B.DateCreated, @effectiveDate)>=0 AND
B.LessonStatusID <> 0 --Unassigned
GROUP BY
B.UserID, B.ModuleID
) B, tblUserLessonStatus A, @tblUser C
WHERE
A.UserLessonStatusID = B.LatestLessonStatusID AND B.UserID = C.UserID AND A.UserID = C.UserID

-- start logic for including new user''s lesson status
INSERT INTO @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
SELECT
0, -- UserLessonStatusID
A.[UserID],
A.[ModuleID],
1, -- LessonStatus: Not Started
@defaultDateOrg -- DateCreated (here set to @defaultdate which is passed in as getDate())
FROM @UserModuleWithAccess A
join  @tblUser B on A.UserID = B.UserID
where
-- User doesn''t have lesson activities for the date entered
A.UserID + ''-'' + A.Moduleid NOT IN
(     Select D.UserID + ''-'' + D.Moduleid
from @tblUserLessonStatus D
where datediff(day, d.datecreated, @defaultdate)>=0 )
-- end logic for including new user''s lesson status

---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- This part fixes migration issue (note this will affect historic admin report only as it does supply effective date)
-- It will insert userid, moduleid and earliest lesson status for each quiz that does not have lesson record yet
-- into @tblUserLessonStatus
Insert Into @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
SELECT 1,
A.[UserID],
A.[ModuleID],
B.LessonStatusID,
A.DateCreated
FROM (
SELECT
A.UserID, A.ModuleID, MIN(A.DateCreated) AS ''DateCreated''
FROM
tblUserLessonStatus A, @tblUser B
WHERE
A.UserID = B.UserID
GROUP BY
A.UserID, A.ModuleID
) A , tblUserLessonStatus B WHERE

A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND A.DateCreated = B.DateCreated AND
(CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)))
NOT IN (SELECT CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)) FROM @tblUserLessonStatus)


---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
Insert Into @tblResult
(
Unit,
[User],
Course,
Module,
[Sequence],
QuizStatus,
QuizStatusDate,   -- These columns have been reordered
QuizScore,      -- These columns have been reordered
LessonStatus,
UnitID,
UserID,
UserName,
ExternalID,
CourseID,
ModuleID
)
Select distinct
-- General
up.HierarchyName                    As Unit, -- Unit Name
[User] = CASE u.Active when 0 then u.LastName + '' '' + u.FirstName + ''(i)'' ELSE u.LastName + '' '' + u.FirstName End , -- User Full Name
c.Name                                          As Course, -- Course Name
m.Name                                          As Module, -- Module Name
m.Sequence                                As Sequence,
-- Quiz Specific
qs.Status                                 As QuizStatus,
dbo.udfUTCtoDaylightSavingTime(uqs.DateCreated,@OrganisationID)                   as QuizStatusDate,  -- These columns have been reordered
uqs.QuizScore                           as QuizScore,       -- These columns have been reordered
-- Lesson Specific
ls.status                                 As LessonStatus,
-- Hidden
u.UnitID                                  As UnitID,
u.UserID                                  As UserID,
u.UserName                                As UserName,
u.ExternalID                                    As ExternalID,
c.CourseID                                As CourseID,
m.ModuleID                                As ModuleID
--u.Active                                As Active
From @tblUserQuizStatus uqs
Inner Join tblQuizStatus qs On qs.QuizStatusID = uqs.QuizStatusID
inner Join @tblUser us On us.UserID = uqs.UserID
Inner Join tblUser u On u.UserID = us.UserID
INNER Join tblUnitHierarchy up On up.UnitID = u.UnitID
INNER Join tblModule m On m.ModuleID = uqs.ModuleID
INNER Join @tblCourse c On c.CourseID = m.CourseID
INNER Join @tblUserLessonStatus uls On uls.UserID = u.UserID And uls.ModuleID = m.ModuleID
INNER Join tblLessonStatus ls On ls.LessonStatusID = uls.LessonStatusID
where @effectivedate is null or (datediff(day,uqs.datecreated,@effectivedate)>=0 and datediff(day, uls.datecreated, @effectivedate)>=0)
RETURN
END





' 
END

GO



/****** Object:  View [dbo].[vwUserCourseStatus]    Script Date: 07/12/2011 13:18:51 ******/
IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[vwUserCourseStatus]'))
DROP VIEW [dbo].[vwUserCourseStatus]
GO


/****** Object:  View [dbo].[vwUserCourseStatus]    Script Date: 07/12/2011 13:18:52 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[vwUserCourseStatus]
AS
SELECT     tUCS.UserCourseStatusID, tUCS.UserID, tUCS.CourseID, tUCS.CourseStatusID, tUCS.ModulesAssigned, tUCS.DateCreated,
                          (SELECT     MAX(DateCreated) AS Expr1
                            FROM          dbo.tblUserCourseStatus
                            WHERE      (tUCS.CourseStatusID = 1) AND (UserID = tUCS.UserID) AND (CourseID = tUCS.CourseID) AND (CourseStatusID = 2) AND 
                                                   (UserCourseStatusID < tUCS.UserCourseStatusID)) AS LastCompleted
FROM         dbo.tblUserCourseStatus AS tUCS INNER JOIN
                      dbo.tblCourse AS tC ON tC.CourseID = tUCS.CourseID AND tC.Active = 1 INNER JOIN
                          (SELECT     MAX(UserCourseStatusID) AS UserCourseStatusID
                            FROM          dbo.tblUserCourseStatus AS tblUserCourseStatus_1
                            GROUP BY UserID, CourseID) AS currentStatus ON tUCS.UserCourseStatusID = currentStatus.UserCourseStatusID



GO



/****** Object:  UserDefinedFunction [dbo].[udfReport_HistoricUserCourseStatus]    Script Date: 07/13/2011 13:37:08 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfReport_HistoricUserCourseStatus]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfReport_HistoricUserCourseStatus]
GO


/****** Object:  UserDefinedFunction [dbo].[udfReport_HistoricUserCourseStatus]    Script Date: 07/13/2011 13:37:08 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO





/*Summary:
gets the last historic course results for each user prior to the effective date

Returns:
Table

Called By:
Calls:

Remarks:


Author:
Stephen Clark
Date Created: 21 September 2004

Modification History
-----------------------------------------------------------
Author		Date			Description

Mark DOnald	24/07/2009		Added LastCompleted column to select

--------------------
select * from udfReport_HistoricUserCourseStatus('September 5 2004')

**/

CREATE  function [dbo].[udfReport_HistoricUserCourseStatus]
(
    @effectiveDate datetime
)
Returns table
as
-----------------------------------------------------------

return select
--< Historic User Course Status Clause >---
    tUCS.UserCourseStatusID
    , tUCS.UserID
    , tUCS.CourseID
    , tUCS.CourseStatusID
    , tUCS.ModulesAssigned
    , tUCS.DateCreated
    , (SELECT
			 max(DateCreated)
		FROM
			tblUserCourseStatus
		WHERE
			tUCS.CourseStatusID = 1 --incompleted users only
			AND UserID =tUCS.UserID
			AND CourseID =tUCS.CourseID
			AND CourseStatusID = 2
			AND UserCourseStatusID < tUCS.UserCourseStatusID) as  LastCompleted
From
    tblUserCourseStatus tUCS
    --< only get data on active courses >--
    inner join tblCourse tC
    on tC.CourseID = tUCS.CourseID
        and tC.Active = 1
        --< only get the latest result for each user - prior to the efective date >--
    inner join(
        select
            max(UserCourseStatusID) UserCourseStatusID --UserQuizStatusID is identity
        from
            tblUserCourseStatus
        where
           tblUserCourseStatus.DateCreated < DATEADD(DD, 1, @effectiveDate)
        group by
            UserID,CourseID
    ) currentStatus
    on tUCS.UserCourseStatusID = currentStatus.UserCourseStatusID
  --< / Historic User Course Status Clause >---

GO



/****** Object:  UserDefinedFunction [dbo].[udfReport_IncompleteUsersLogic]    Script Date: 07/12/2011 13:21:09 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfReport_IncompleteUsersLogic]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfReport_IncompleteUsersLogic]
GO



/****** Object:  UserDefinedFunction [dbo].[udfReport_IncompleteUsersLogic]    Script Date: 07/12/2011 13:21:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE                  function [dbo].[udfReport_IncompleteUsersLogic]
(
@organisationID		Integer=null,		-- Organisation ID to search if the unit is empty
@unitIDs 		varchar(MAX) = null,	-- string of unit id's
@courseID		Integer = null,		-- course ID to restrict search to
@effectiveDate 		datetime = null		-- effective date of report

)

-------------------------------------------------------------------
Returns @tblReturn table
(
UserID		Int,
UnitID		Int,
FirstName		nvarchar(255),
LastName 	nvarchar(255),
UnitPathway 	nvarchar(4000),
LastCompleted	varchar(23),
Username		nvarchar(100),
Email		nvarchar(100),
ExternalID		nvarchar(50)
)

as
Begin --1
	if (@effectiveDate is null)
	Begin
		----------------------------------------------------
		--- Report on the current date
		----------------------------------------------------
		if (@unitIDs is null)
		begin --2
			----------------------------------------------------
			--- Report on the current date on all units
			----------------------------------------------------
			Insert into
			@tblReturn
			SELECT
				tU1.userID
				, tU1.UnitID
				, tU1.FirstName
				, tU1.LastName
				--, dbo.udfGetUnitPathway(tU1.UnitID) as 'UnitPathway'
				, tUH.HierarchyName as 'UnitPathway'
				, LastCompleted
				, tU1.Username as 'Username'
				, tU1.Email as 'Email'
				, tU1.ExternalID as 'ExternalID'
			FROM
				tblUser tU1
				inner join tblUnit on
					tU1.UnitID = tblUnit.UnitID
					and tblUnit.organisationID = @organisationID
					and tU1.Active = 1 --< only want active users >--
					and tu1.userTypeID <> 1 --< not interested in saltadmins >--
				inner join vwUserCourseStatus vUCS
					on vUCS.UserID = tU1.userID
					and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
					and vUCS.CourseID = @courseID
				inner join tblUnitHierarchy tUH
					on tU1.UnitID = tUH.UnitID
		end --/2
		else
		begin --3
			----------------------------------------------------
			--- Report on the current date on a specific unit
			----------------------------------------------------
			Insert into
			@tblReturn
			SELECT
				tU1.userID
				, tU1.UnitID
				, tU1.FirstName
				, tU1.LastName
				--, dbo.udfGetUnitPathway(tU1.UnitID) as 'UnitPathway'
				, tUH.HierarchyName as 'UnitPathway'
				, LastCompleted
				, tU1.Username as 'Username'
				, tU1.Email as 'Email'
				, tU1.ExternalID as 'ExternalID'
			FROM
				tblUser tU1
				inner join tblUnit on
					tU1.UnitID = tblUnit.UnitID
					and tblUnit.organisationID = @organisationID
					and tU1.Active = 1 --< only want active users >--
					and tu1.userTypeID <> 1 --< not interested in saltadmins >--
				inner join vwUserCourseStatus vUCS
					on vUCS.UserID = tU1.userID
					and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
					and vUCS.CourseID = @courseID
				inner join dbo.udfCsvToInt(@unitIDs) tU
					on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
				inner join tblUnitHierarchy tUH
					on tU1.UnitID = tUH.UnitID
		end --/3
	End

	Else

	Begin
		----------------------------------------------------
		--- Report on the historic date provided
		----------------------------------------------------
		if (@unitIDs is null)
		begin --2
			----------------------------------------------------
			--- Report on the historic date provided for all units
			----------------------------------------------------
			Insert into
			@tblReturn
			SELECT
				tU1.userID
				, tU1.UnitID
				, tU1.FirstName
				, tU1.LastName
				--, dbo.udfGetUnitPathway(tU1.UnitID) as 'UnitPathway'
				, tUH.HierarchyName as 'UnitPathway'
				, LastCompleted
				, tU1.Username as 'Username'
				, tU1.Email as 'Email'
				, tU1.ExternalID as 'ExternalID'
			FROM
				tblUser tU1
				inner join tblUnit on
					tU1.UnitID = tblUnit.UnitID
					and tblUnit.organisationID = @organisationID
					and tU1.Active = 1 --< only want active users >--
					and tu1.userTypeID <> 1 --< not interested in saltadmins >--
				inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
					on vUCS.UserID = tU1.userID
					and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
					and vUCS.CourseID = @courseID
				inner join tblUnitHierarchy tUH
					on tU1.UnitID = tUH.UnitID

		end --/2
		else
		begin --3
			----------------------------------------------------------------
			--- Report on the historic date provided for the specified units
			----------------------------------------------------------------
			Insert into
			@tblReturn
			SELECT
				tU1.userID
				, tU1.UnitID
				, tU1.FirstName
				, tU1.LastName
				--, dbo.udfGetUnitPathway(tU1.UnitID) as 'UnitPathway'
				, coalesce(tUH.HierarchyName,'')  as 'UnitPathway'
				, LastCompleted
				, tU1.Username as 'Username'
				, tU1.Email as 'Email'
				, tU1.ExternalID as 'ExternalID'
			FROM
				tblUser tU1
				inner join tblUnit on
					tU1.UnitID = tblUnit.UnitID
					and tblUnit.organisationID = @organisationID
					and tU1.Active = 1 --< only want active users >--
					and tu1.userTypeID <> 1 --< not interested in saltadmins >--
				inner join  dbo.udfReport_HistoricUserCourseStatus(@effectiveDate) vUCS
					on vUCS.UserID = tU1.userID
					and vUCS.CourseStatusID = 1 --< want users that are incomplete >--
					and vUCS.CourseID = @courseID
				inner join dbo.udfCsvToInt(@unitIDs) tU
					on tU.IntValue = tblUnit.UnitID --< restrict units to thoes in the list >--
				inner join tblUnitHierarchy tUH
					on tU1.UnitID = tUH.UnitID

		end --/3
	End
	
	return
end -- /1
GO


/****** Object:  StoredProcedure [dbo].[prcReport_CompletedUsersDetails]    Script Date: 07/12/2011 13:20:49 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_CompletedUsersDetails]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcReport_CompletedUsersDetails]
GO


/****** Object:  StoredProcedure [dbo].[prcReport_CompletedUsersDetails]    Script Date: 07/12/2011 13:20:49 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

/*
Summary:
Given an list of incomplete users, derive all of the module status explaining why the users
are incomplete

Returns:
Table of Incomplete Users with the module status details

Called By:
Reporting/Advanced/CompletedUsersReport.aspx

Calls:
udfReport_IncompletUsers_logic

Remarks:


Author:
Yoppy Suwanto

Date Created: 05 Mar 2008

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1  Mark Donald	24/07/2009		Add LastCompleted col to selects

prcReport_CompletedUsersDetails @unitIDs='1,2,3,4' , @courseID=1 , @completed = 0
prcReport_CompletedUsersDetails @organisationid=11, @unitIDs=null , @courseID=53, @effectivedate = null

--------------------

**/
CREATE            Proc [dbo].[prcReport_CompletedUsersDetails]
(
	@organisationID Integer,	-- Organisation of the current user
	@unitIDs varchar(8000) = '',	-- string of unit id's
	@courseID int,					-- course ID to restrict search to
	@effectiveDateOrg datetime = Null	-- Effective date as at when to run the report
	--@completed bit = 0 			-- always run for incomplete status
)
AS
begin 
	/*
	declare @orgid int 
	declare @courseid int 
	declare @unitids varchar(8000) 
	declare @effectivedate datetime 

	set @orgid = 11 
	set @courseid = 53 
	set @unitids = null 
	set @effectivedate = '4 August 2007' 
	*/
	
	DECLARE @effectiveDate DateTime
	SET @effectiveDate = dbo.udfDaylightSavingTimeToUTC(@effectiveDateOrg,@OrganisationID)

	if (@effectiveDateOrg is null)
	/*
	-- Report on current latest date
	*/
	Begin

	select max(userquizstatusid) userquizstatusid
	into #tmpUserQuizStatus
	from tblUserQuizStatus
	where userid in (select userid from tblUser where organisationid = @organisationID)
		and moduleid in (select moduleid from tblModule where courseid = @courseid)
	group by userid, moduleid

	Select
		IU.userID 
		, IU.unitID 
		, IU.FirstName
		, IU.LastName 
		, IU.UnitPathway 
		, case when lastcompleted is null then 'Never' else convert(varchar(10),dbo.udfUTCtoDaylightSavingTime(LastCompleted,@OrganisationID),103) end  as LastCompleted
		, IU.Username 
		, IU.Email 
		, IU.ExternalID 
		, tM.[name] as 'Module'
		, tQS.status
		--,tM.moduleid
		--,tUQS.quizstatusid
		--,tUQS.userquizstatusid

	From 
		dbo.udfReport_IncompleteUsersLogic(@organisationID, @unitIDs, @courseID,null) IU 
		inner join tblUserQuizStatus tUQS 
			on tUQS.userid = IU.userid 
		--inner join tmpUserQuizStatis UQS
		--      on tUQS.userquizstatusid = UQS.userquizstatusid
		inner join tblModule tM
			on tUQS.moduleid = tM.moduleid
		inner join tblQuizStatus tQS
			on tQS.quizstatusid = tUQS.quizstatusid

	Where 
		--tUQS.quizstatusid <> 2 --Every status except pass quiz status
		tUQS.quizstatusid in (1,3,4,5)
		and tUQS.moduleid in (select moduleid from tblModule where courseid = @courseid)
		and tUQS.userquizstatusid in (select userquizstatusid from #tmpUserQuizStatus)

	Order By 
			UnitPathway, LastName, FirstName,  tM.sequence

	drop table #tmpUserQuizStatus

	end

	Else
	-- Report results up to the effective date
	Begin

	
	select max(userquizstatusid) userquizstatusid
	into #tmpUserQuizStatusDate
	from tblUserQuizStatus
	where userid in (select userid from tblUser where organisationid = @organisationID)
		and moduleid in (select moduleid from tblModule where courseid = @courseid)
		and Datecreated < @effectiveDate
	group by userid, moduleid

	Select
		IU.userID 
		, IU.unitID 
		, IU.FirstName
		, IU.LastName 
		, IU.UnitPathway 
		, case when lastcompleted is null then 'Never' else convert(varchar(10),dbo.udfUTCtoDaylightSavingTime(LastCompleted,@OrganisationID),103) end  as LastCompleted
		, IU.Username 
		, IU.Email 
		, IU.ExternalID 
		, tM.[name] as 'Module Name'
		, tQS.status
		--,tM.moduleid
		--,tUQS.quizstatusid
		--,tUQS.userquizstatusid

	From 
		dbo.udfReport_IncompleteUsersLogic(@organisationID, @unitIDs, @courseID,@effectiveDate) IU 
		inner join tblUserQuizStatus tUQS 
			on tUQS.userid = IU.userid 
		--inner join tmpUserQuizStatis UQS
		--      on tUQS.userquizstatusid = UQS.userquizstatusid
		inner join tblModule tM
			on tUQS.moduleid = tM.moduleid
		inner join tblQuizStatus tQS
			on tQS.quizstatusid = tUQS.quizstatusid

	Where 
		--tUQS.quizstatusid <> 2 --Every status except pass quiz status
		tUQS.quizstatusid in (1,3,4,5)
		and tUQS.moduleid in (select moduleid from tblModule where courseid = @courseid)
		and tUQS.userquizstatusid in (select userquizstatusid from #tmpUserQuizStatusDate)

	Order By 
			UnitPathway, LastName, FirstName, tM.sequence

	drop table #tmpUserQuizStatusDate

	end
END

GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserQuizStatus_Update_Quick]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcUserQuizStatus_Update_Quick]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcUserQuizStatus_Update_Quick]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/****** Object:  Stored Procedure dbo.prcUserQuizStatus_Update_Quick    Script Date: 3/05/2004 10:56:48 AM ******/

/* Summary:
Update quiz status for each user

Returns:

Called By:

Calls:
Nothing

Remarks:
This is a schedule job running every night to check there are any changes in the user quiz status based on current compliance rules.
If they are the same as the current status, ignore it, otherwise a new status will be created.

If a module is assigned to a user, and there is no activity for this module, the status will be  ''Not started''.
If a module is unassigned from a user, the status will be ''unassinged"(There are records in status table, but the module is not assigned to this user now)
If a module is set to inactive, the status will be ''unassinged''

All user-module pair need to be re-evaluated, as compliance rules may be changed since the user''s last toolbook activity.

------------ Decision Processes -------------

1. Get Current User Quiz status
-----------------------------------
1.1  Get all modules that are currently assigned to each users (CurrentAssignedModules)
and compliance rules

1.2. Get the last quiz activity for each user and module pair (StartedModules)

1.3. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
a) Get a list of modules that is in the quiz status table that the last statuses are not Unassigned (0)(PreviousAssignedModules)
b) Get rid off all modules that are currently assigned to the users (from step 1)
c)All modules left are Unassigned(0)

1.4. Not Started Modules (1) (CurrentAssignedModules- StartedModules)
All currently assigned modules that don''t have any activity is Not Started (1)

1.5. Started Modules
a)If the last quiz is inactive, the status is Expired (New Content)(5)
b)If the last quiz is past the current quiz date/frequency, the status is Expired (Time Expired)(4)
c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
If user Failed the quiz, the status is Failed (3)
If user Passed the quiz, the status is Passed (2)

2. Update User Quiz status
----------------------------
If the last quiz status for each user is not the same as the current status, add the new status



------------ Data need to be recorded -------------

QuizFrequency	QuizPassMark	QuizScore
0  Unassigned:  		-		-		-
1  Not Started: 		Y		Y		-
2  Passed: 	 		Y		Y		Y
3  Failed: 	 		Y		Y		Y
4  Expired (Time Elapsed): 	Y		Y		-
5  Expired (New Content): 	Y		Y		-


Author: Jack Liu
Date Created: 20 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1	mikev		1/5/2007		Added logic for new fields LessonCompletionStatus & QuizCompletionStatus
#2	mikev		9/5/2007		Added course completion logic. If a module is marked active or not active; to calculate if the course is complete.
#3	Mark Donald	21/9/2009		Added OrganisationName (control character) to License Warning emails

prcUserQuizStatus_Update_Quick

**/
CREATE   Procedure [prcUserQuizStatus_Update_Quick]
(
@OrgID int	-- comma separated organisationID
)
AS
Set Nocount On
declare @intHistoryID int

insert into tblModuleStatusUpdateHistory(startTime) values(getUTCdate());
set @intHistoryID = @@identity

--1. Get Current User Quiz status
--mikev : added QuizCompletionDate
/* UNITTEST: CurrentAssignedModules */
CREATE TABLE #tblCurrentUserQuizStatus
(
UserID int NOT NULL ,
ModuleID int NOT NULL ,
QuizStatusID int not NULL ,
QuizFrequency int NULL ,
QuizPassMark int NULL ,
QuizCompletionDate DateTime NULL,
QuizScore int NULL,
QuizSessionID uniqueidentifier NULL
)


/*
1.1  Get all modules that are currently assigned to each users (CurrentAssignedModules)
and current compliance rules
*/
-- mikev(1): added completion date

select
um.UserID,
um.ModuleID,
umr.QuizFrequency,
umr.QuizPassMark,
umr.QuizCompletionDate
into
#tblCurrentAssignedModules
from
(
Select
tU.UserID
, tU.FirstName
, tU.LastName
, tU.UnitID
, tU.OrganisationID
, tM.ModuleID
, tM.CourseID
, tC.Name ''CourseName''
, tM.Name
, tM.Sequence
, tM.Description
From
dbo.tblUser tU
--< get the courses a user has access to >--
Inner Join dbo.tblOrganisationCourseAccess tOCA
On  tOCA.OrganisationID = tU.OrganisationID
--< get the course details >--
Inner join dbo.tblCourse tC
On tC.CourseID = tOCA.GrantedCourseID
--< get the Active modules in a course >--
inner join dbo.tblModule tM
On tM.CourseID = tC.CourseID
and tM.Active = 1
--< get the details on which moduels a user is configured to access >--
Left Outer join dbo.tblUserModuleAccess tUsrMA
On  tUsrMA.UserID = tU.UserID
And tUsrMA.ModuleID = tM.ModuleID
--< get the details on which moduels a user''s Unit is excluded from  >--
Left Outer Join dbo.tblUnitModuleAccess tUnitMA
On  tUnitMA.UnitID = tU.UnitID
And tUnitMA.DeniedModuleID = tM.ModuleID
Where
tU.OrganisationID = @OrgID AND
tU.Active = 1
--< Active users only >--
and tu.UnitID is not null
--< Get the modules that the user''s Unit is not denied >--
and (tUnitMA.DeniedModuleID  is null
--<  and the user does not have special access to  it>--
And tUsrMA.ModuleID is null)
--< or Get modules that the user has been specially  granted
or tUsrMA.Granted=1
) um
inner join
(
Select 	u.UnitID,
m.CourseID,
m.ModuleID,
m.Name,
case
when ur.unitID is null then cast(1 as bit)
else cast(0 as bit)
end as UsingDefault,
case
when (ur.LessonFrequency is null and ur.LessonCompletionDate is null and o.DefaultLessonCompletionDate is null) then
o.DefaultLessonFrequency
else
ur.LessonFrequency
end
as LessonFrequency,
case
when (ur.QuizFrequency is null and ur.QuizCompletionDate is null and o.DefaultQuizCompletionDate is null) then
o.DefaultQuizFrequency
else
ur.QuizFrequency
end
as QuizFrequency,
isNull(ur.QuizPassMark, o.DefaultQuizPassMark) as QuizPassMark,
case
when (ur.LessonFrequency is null and ur.LessonCompletionDate is null and not(o.DefaultLessonCompletionDate is null)) then
o.DefaultLessonCompletionDate
else
ur.LessonCompletionDate
end
as LessonCompletionDate,
case
when (ur.QuizFrequency is null and ur.QuizCompletionDate is null and not(o.DefaultQuizCompletionDate is null)) then
o.DefaultQuizCompletionDate
else
ur.QuizCompletionDate
end
as QuizCompletionDate
From tblOrganisationCourseAccess c
inner join tblModule m
on m.CourseID = c.GrantedCourseID
inner join tblOrganisation o  -- Get default compliance rules
on o.OrganisationID = c.OrganisationID
inner join tblUnit u
on u.OrganisationID = c.OrganisationID
left join tblUnitRule ur --Get the unit specific rules
on ur.ModuleID = m.ModuleID
and ur.UnitID=u.unitID
WHERE o.OrganisationID = @OrgID
) umr
on
umr.ModuleID  = um.ModuleID
and umr.UnitID = um.UnitID
and um.UnitID in (select UnitID from tblUnit where OrganisationID = @OrgID)
and um.UserID IN (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: CurrentAssignedModules */

-- select * from #tblCurrentAssignedModules
/*
1.2. Get the last quiz activity for each user and module pair (StartedModules)
*/
/* UNITTEST: StartedModules */
select
um.userID,
um.moduleID,
q.active,
qs.QuizScore,
qs.QuizSessionID,
qs.DateTimeCompleted
into
#tblStartedModules
from
#tblCurrentAssignedModules um
inner join
(
select
um.userID, um.moduleID, max(DateTimeCompleted)  as DateTimeCompleted
from
#tblCurrentAssignedModules um
inner join tblQuiz q
on q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted is not null
group by um.userID, um.moduleID
)
as LastQuizDate

on
LastQuizDate.userID = um.userID
and LastQuizDate.ModuleID = um.ModuleID

inner join tblQuiz q
on
q.ModuleID = um.ModuleID
inner join tblQuizSession qs
on
qs.QuizID=	q.quizID
and qs.userID = um.userID
and qs.DateTimeCompleted  = LastQuizDate.DateTimeCompleted
/* /UNITTEST: StartedModules */


-- select * from #tblStartedModules

/*
1.3. Unassigned Modules (0) (PreviousAssignedModules - CurrentAssignedModules)
a) Get a list of modules that is in the quiz status table that the last statuses are not Unassigned (0)(PreviousAssignedModules)
b) Get rid off all modules that are currently assigned to the users (from step 1)
c)All modules left are Unassigned(0)
*/

/* UNITTEST: Status_Unassigned */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID
)
select
uqs.UserID,
uqs.ModuleID,
0  as QuizStatusID --Unassigned (0)
from
(
select
QuizStatus.UserQuizStatusID
, QuizStatus.UserID
, QuizStatus.ModuleID
, m.CourseID
, QuizStatus.QuizStatusID
, QuizStatus.QuizFrequency
, QuizStatus.QuizPassMark
, QuizStatus.QuizSessionID
, QuizStatus.QuizScore
, QuizStatus.DateCreated

from
tblUserQuizStatus QuizStatus
inner join tblModule m on m.ModuleID = QuizStatus.ModuleID
inner join
(
select
max(UserQuizStatusID) UserQuizStatusID --UserQuizStatusID is identity
from
tblUserQuizStatus
WHERE
tblUserQuizStatus.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
group by
UserID,moduleID
) currentStatus
on QuizStatus.UserQuizStatusID = currentStatus.UserQuizStatusID
where m.active = 1
) uqs
left join
#tblCurrentAssignedModules cam
on
cam.UserID = uqs.UserID
and cam.ModuleID = uqs.ModuleID
where
uqs.QuizStatusID<>0 --not Unassigned (0)
and cam.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_Unassigned */

/*
1.4. Not Started Modules (1) (CurrentAssignedModules- StartedModules)
All currently assigned modules that don''t have any activity is Not Started (1)
*/
-- mikev(1): added QuizCompletionDate
/* UNITTEST: Status_NotStarted */
insert into
#tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate
)
select
cam.UserID,
cam.ModuleID,
1  as QuizStatusID, --Not Started (1)
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate
from
#tblCurrentAssignedModules cam
left join
#tblStartedModules sm
on
sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
sm.moduleID is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_NotStarted */
/*
EXPIRED NEW CONTENT IS NOW A MANUAL PROCESS
1.5. Started Modules
a)If the last quiz is inactive, the status is Expired (New Content)(5)
b)If the last quiz is past the current quiz frequency, the status is Expired (Time Expired)(4)
c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
If user Failed the quiz, the status is Failed (3)
If user Passed the quiz, the status is Passed (2)
*/

--	  	a)If the last quiz is inactive, the status is Expired (New Content)(5)


--		b)If the last quiz is past the current quiz frequency, the status is Expired (Time Expired)(4)
-- mikev(1): added QuizCompletionDate. Added criteria
/* UNITTEST: Status_TimeExpired */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate
)
select cam.UserID,
cam.ModuleID,
4  as QuizStatusID, --  Expired (Time Expired)(4)
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate
from #tblCurrentAssignedModules cam
inner join #tblStartedModules sm
on sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
(
(
cam.QuizCompletionDate is null
and DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID))) <= 0
)
or
(
isnull(DateDiff(day, getutcdate(), cam.QuizCompletionDate), 1) <= 0
)
)
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
/* /UNITTEST: Status_TimeExpired */

--		c)If the last quiz is during the current quiz frequency, get the current pass mark, and check the quiz status
--			If user Failed the quiz, the status is Failed (3)
--			If user Passed the quiz, the status is Passed (2)

-- mikev(1): added QuizCompletionDate and changed logic of criteria to use the date before the frequency
/* UNITTEST: Status_PassFail */
insert into #tblCurrentUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate,
QuizScore,
QuizSessionID
)
select cam.UserID,
cam.ModuleID,
case
when sm.QuizScore>=cam.QuizPassMark then 2 -- Passed (2)
else	3  --Failed (3)
end  as QuizStatusID,
cam.QuizFrequency,
cam.QuizPassMark,
cam.QuizCompletionDate,
sm.QuizScore,
sm.QuizSessionID
from #tblCurrentAssignedModules cam
inner join #tblStartedModules sm
on sm.UserID = cam.UserID
and sm.ModuleID = cam.ModuleID
where
not (
cam.QuizCompletionDate is null
and DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID))) <= 0
)
and cam.QuizCompletionDate is null
and cam.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
and (select top 1 QuizStatusID from tblUserQuizStatus where ModuleID = cam.ModuleID and UserID = cam.UserID order by UserQuizStatusID Desc) NOT IN (5)

/* /UNITTEST: Status_PassFail */
/*
2. Update User Quiz status
----------------------------
If the last quiz status for each user is not the same as the current status, add the new status
*/


/* UNITTEST: CourseStatus */
-- mikev(1): added cursor for quizcompletiondate
declare @cursor_UserID 	        int
declare @cursor_ModuleID 	    int
declare @cursor_QuizStatusID 	int
declare @cursor_QuizFrequency 	int
declare @cursor_QuizPassMark	int
declare @cursor_QuizCompletionDate	DateTime
declare @cursor_QuizScore	    int
declare @cursor_QuizSessionID   varchar(50)
declare @cursor_UserQuizStatusID int

-- mikev(1): added quizcompletiondate
declare @LastUser int
declare @LastCourse int
declare @LastQuizStatusID int
declare @cursor_CourseID int
set @LastUser = -1
set @LastCourse = -1
set @LastQuizStatusID = -1
DECLARE CurrentUserQuizStatus CURSOR
FOR


select
cs.UserID,
cs.ModuleID,
cs.QuizStatusID,
cs.QuizFrequency,
cs.QuizPassMark,
cs.QuizCompletionDate,
cs.QuizScore,
cs.QuizSessionID,
s.UserQuizStatusID,
Module.CourseID
from -- Any UserModules with current access but no tblUserQuizStatus record
#tblCurrentUserQuizStatus cs
inner join tblModule Module on module.moduleID = cs.ModuleID
left join
(  -- The UserModule quiz status for the latest quiz attempt 
	select
	QuizStatus.UserQuizStatusID
	, QuizStatus.UserID
	, QuizStatus.ModuleID
	, m.CourseID
	, QuizStatus.QuizStatusID
	, QuizStatus.QuizFrequency
	, QuizStatus.QuizPassMark
	, QuizStatus.QuizSessionID
	, QuizStatus.QuizScore
	, QuizStatus.DateCreated

	from
	tblUserQuizStatus QuizStatus
	inner join tblModule m on m.ModuleID = QuizStatus.ModuleID
	inner join
	(
		select
		max(UserQuizStatusID) UserQuizStatusID --UserQuizStatusID is identity
		from
		tblUserQuizStatus
		WHERE
		tblUserQuizStatus.UserID in (select UserID from tblUser where OrganisationID = @OrgID)
		group by
		UserID,moduleID
	) currentStatus
	on QuizStatus.UserQuizStatusID = currentStatus.UserQuizStatusID
	where m.active = 1
) s
on cs.userID = s.UserID
and cs.ModuleID = s.ModuleID
and cs.QuizStatusID = s.QuizStatusID
where
s.UserQuizStatusID is null
order by cs.UserID, cs.QuizStatusID, Module.CourseID
-- ordered so we can update course status on the last module in the course rather than for every module in the course

Open CurrentUserQuizStatus



FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizCompletionDate,@cursor_QuizScore,@cursor_QuizSessionID, @cursor_UserQuizStatusID, @cursor_CourseID
set @LastCourse = @cursor_CourseID
set @LastUser = @cursor_UserID
set @LastQuizStatusID = @cursor_QuizStatusID
WHILE @@FETCH_STATUS = 0
BEGIN

insert into tblUserQuizStatus
(
UserID,
ModuleID,
QuizStatusID,
QuizFrequency,
QuizPassMark,
QuizCompletionDate,
QuizScore,
QuizSessionID
)
values
(
@cursor_UserID,
@cursor_ModuleID,
@cursor_QuizStatusID,
@cursor_QuizFrequency,
@cursor_QuizPassMark,
@cursor_QuizCompletionDate,
@cursor_QuizScore,
@cursor_QuizSessionID
)


-- don''t update the course status for every module in the course - once per course is enough
-- do update the course status on every change in QuizStatus
if (@LastCourse != @cursor_CourseID) or (@LastUser != @cursor_UserID) or (@LastQuizStatusID != @cursor_QuizStatusID) EXEC prcUserQuizStatus_UpdateCourseStatus @cursor_UserID, @cursor_ModuleID

set @LastCourse = @cursor_CourseID
set @LastUser = @cursor_UserID
set @LastQuizStatusID = @cursor_QuizStatusID

FETCH NEXT FROM CurrentUserQuizStatus
Into
@cursor_UserID,@cursor_ModuleID,@cursor_QuizStatusID,@cursor_QuizFrequency,
@cursor_QuizPassMark,@cursor_QuizCompletionDate,@cursor_QuizScore,@cursor_QuizSessionID, @cursor_UserQuizStatusID, @cursor_CourseID


END
-- final course may not be done so update just to be safe
if (@LastUser != -1 ) EXEC prcUserQuizStatus_UpdateCourseStatus @cursor_UserID, @cursor_ModuleID

-- Finished CurrentUserQuizStatus
CLOSE CurrentUserQuizStatus
DEALLOCATE CurrentUserQuizStatus




--***********************************************************************************************************
--              AT RISK OF EXPIRY
--***********************************************************************************************************


DECLARE @DaysWarningBeforeExpiry int
SELECT @DaysWarningBeforeExpiry = DaysWarningBeforeExpiry FROM tblOrganisation where OrganisationID = @OrgID
IF (@DaysWarningBeforeExpiry IS NULL)
BEGIN
	DECLARE @QuizExpiryDate DateTime
	SELECT @QuizExpiryDate = dateadd(d,-30,QuizDueDate) FROM tblOrganisation where OrganisationID = @OrgID
	
	delete from tblQuizExpiryAtRisk where OrganisationID = @OrgID
	and not exists (select @OrgID,cam.UserID,
	cam.ModuleID, DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and dbo.udfGetSaltOrgDate(@OrgID) < @QuizExpiryDate
		and tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID
	))



	insert into tblQuizExpiryAtRisk
	(
	OrganisationID,
	UserID,
	ModuleID,
	DaysToExpiry
	)
	select @OrgID,cam.UserID,
	cam.ModuleID, 30
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and dbo.udfGetSaltOrgDate(@OrgID) < @QuizExpiryDate
	)
	and not exists
	(SELECT * FROM tblQuizExpiryAtRisk 
	where 	tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID)
END





IF (@DaysWarningBeforeExpiry IS NOT NULL)
BEGIN
	delete from tblQuizExpiryAtRisk where OrganisationID = @OrgID
	and not exists (select @OrgID,cam.UserID,
	cam.ModuleID, DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and DateDiff(day, dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)),dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID)) <= @DaysWarningBeforeExpiry
		and tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID
	))



	insert into tblQuizExpiryAtRisk
	(
	OrganisationID,
	UserID,
	ModuleID,
	DaysToExpiry
	)
	select @OrgID,cam.UserID,
	cam.ModuleID, 
	DateDiff(day,dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID), 
	dateadd(month, cam.QuizFrequency, 
	dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID)))
	from #tblCurrentAssignedModules cam
	inner join #tblStartedModules sm
	on sm.UserID = cam.UserID
	and sm.ModuleID = cam.ModuleID
	where
	(
		cam.QuizCompletionDate is null 
		and DateDiff(day, dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID),dateadd(month, cam.QuizFrequency, dbo.udfUTCtoDaylightSavingTime(sm.DateTimeCompleted,@OrgID))) <= @DaysWarningBeforeExpiry
	)
	and not exists
	(SELECT * FROM tblQuizExpiryAtRisk 
	where 	tblQuizExpiryAtRisk.UserID = cam.UserID
		and tblQuizExpiryAtRisk.ModuleID = cam.ModuleID
		and tblQuizExpiryAtRisk.OrganisationID = @OrgID)
END

--***********************************************************************************************************





drop table  #tblCurrentUserQuizStatus

drop table #tblCurrentAssignedModules

drop table #tblStartedModules
/* /UNITTEST: CourseStatus */


/* UNITTEST: Licensing */
EXEC prcDatabaseMail_SetupProfile -- incase email address etc has changed, re-setup.

-- Check who is missing license for current period, includes period turn over
declare @lic_CourseLicensingID int, @lic_UserID int
DECLARE LicensingLoop CURSOR
FOR
SELECT DISTINCT tblCourseLicensing.CourseLicensingID, vwUserModuleAccess.UserID
FROM tblCourseLicensing
INNER JOIN vwUserModuleAccess ON tblCourseLicensing.CourseID = vwUserModuleAccess.CourseID
AND tblCourseLicensing.OrganisationID = vwUserModuleAccess.OrganisationID
INNER JOIN tblUser ON vwUserModuleAccess.UserID = tblUser.UserID
LEFT OUTER JOIN	tblCourseLicensingUser ON tblCourseLicensing.CourseLicensingID = tblCourseLicensingUser.CourseLicensingID
WHERE tblCourseLicensing.DateStart <= GETUTCDATE()
AND tblCourseLicensing.DateEnd >= GETUTCDATE()
AND tblCourseLicensingUser.CourseLicensingID IS NULL
AND tblUser.Active = 1
AND vwUserModuleAccess.OrganisationID = @OrgID
Open LicensingLoop
FETCH NEXT FROM LicensingLoop
Into
@lic_CourseLicensingID, @lic_UserID
WHILE @@FETCH_STATUS = 0
BEGIN
IF NOT EXISTS(SELECT CourseLicensingID FROM tblCourseLicensingUser WHERE CourseLicensingID = @lic_CourseLicensingID and UserID = @lic_UserID)
BEGIN
INSERT INTO tblCourseLicensingUser(CourseLicensingID, UserID) VALUES (@lic_CourseLicensingID, @lic_UserID)
END
FETCH NEXT FROM LicensingLoop
Into
@lic_CourseLicensingID, @lic_UserID
END

CLOSE LicensingLoop
DEALLOCATE LicensingLoop



-- WARNING EMAILS
-- License Warning
declare @licenseWarnEmail nvarchar(4000)
declare @licenseWarnEmail_Subject nvarchar(4000)
declare @emailLicenseWarnLicRecipients nvarchar(512)
declare @warn_lic_CourseName nvarchar(200),
@warn_lic_CourseLicensingID int,
@warn_lic_LicenseNumber int,
@warn_lic_LicenseWarnNumber int,
@warn_lic_RepNameSalt nvarchar(200),
@warn_lic_RepEmailSalt nvarchar(200),
@warn_lic_RepNameOrg nvarchar(200),
@warn_lic_RepEmailOrg nvarchar(200),
@warn_lic_LangCode nvarchar(10),
@warn_lic_LicensesUsed int,
@warn_lic_LicenseWarnEmail bit,
@warn_lic_OrganisationName nvarchar(50)

DECLARE LicenceNumberLoop CURSOR
FOR
SELECT
c.Name, l.CourseLicensingID, l.LicenseNumber, l.LicenseWarnNumber, l.RepNameSalt, l.RepEmailSalt,
l.RepNameOrg, l.RepEmailOrg, l.LangCode, COUNT(u.CourseLicensingUserID) AS LicensesUsed,
l.LicenseWarnEmail, OrganisationName
FROM
tblCourseLicensing l
INNER JOIN tblCourseLicensingUser u ON l.CourseLicensingID = u.CourseLicensingID
INNER JOIN tblCourse c ON l.CourseID = c.CourseID
LEFT JOIN tblOrganisation o ON l.OrganisationID = o.OrganisationID
WHERE
l.OrganisationID = @OrgID
GROUP BY
OrganisationName, l.CourseLicensingID, l.RepNameSalt, l.RepEmailSalt, l.RepNameOrg, l.RepEmailOrg, c.Name, l.LicenseNumber,
l.LicenseWarnNumber, l.LicenseWarnEmail, l.LangCode
HAVING
COUNT(u.CourseLicensingUserID) >= l.LicenseWarnNumber
AND l.LicenseWarnEmail = 1

Open LicenceNumberLoop
FETCH NEXT FROM LicenceNumberLoop
Into @warn_lic_CourseName,
@warn_lic_CourseLicensingID,
@warn_lic_LicenseNumber,
@warn_lic_LicenseWarnNumber,
@warn_lic_RepNameSalt,
@warn_lic_RepEmailSalt,
@warn_lic_RepNameOrg,
@warn_lic_RepEmailOrg,
@warn_lic_LangCode,
@warn_lic_LicensesUsed,
@warn_lic_LicenseWarnEmail,
@warn_lic_OrganisationName

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get License Warning text in desired language.
SELECT     @licenseWarnEmail = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_lic_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_LicenseWarn'') AND (tblLangValue.Active = 1)

SELECT     @licenseWarnEmail_Subject = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_lic_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_LicenseWarn_Subject'') AND (tblLangValue.Active = 1)

-- {0} is receipient name, {1} is the license warning amount, {2} course name, {3} license limit, {4} name of contact person
-- {5} is organisation name
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{0}'', @warn_lic_RepNameOrg)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{1}'', @warn_lic_LicenseWarnNumber)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{2}'', @warn_lic_CourseName)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{3}'', @warn_lic_LicenseNumber)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{4}'', @warn_lic_RepNameSalt)
set @licenseWarnEmail = REPLACE(@licenseWarnEmail, ''{5}'', @warn_lic_OrganisationName)

set @licenseWarnEmail_Subject = REPLACE(@licenseWarnEmail_Subject, ''{0}'', @warn_lic_CourseName)
set @licenseWarnEmail_Subject = REPLACE(@licenseWarnEmail_Subject, ''{1}'', @warn_lic_OrganisationName)

select @emailLicenseWarnLicRecipients = @warn_lic_RepEmailOrg +'';''+@warn_lic_RepEmailSalt

--EXEC msdb.dbo.sp_send_dbmail
--@recipients = @emailLicenseWarnLicRecipients,
--@body = @licenseWarnEmail,
--@subject = @licenseWarnEmail_Subject,
--@profile_name = ''Salt_MailAccount''

-- Log emails sent
--exec prcEMail_LogSentEmail @toEmail = @warn_lic_RepEmailOrg, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @licenseWarnEmail_Subject, @body = @licenseWarnEmail, @organisationID = @OrgID
--exec prcEMail_LogSentEmail @toEmail = @warn_lic_RepEmailSalt, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @licenseWarnEmail_Subject, @body = @licenseWarnEmail, @organisationID = @OrgID

print ''queued numLics warning mail to : '' + @emailLicenseWarnLicRecipients

-- Unset flag and record date email sent
UPDATE tblCourseLicensing SET DateLicenseWarnEmailSent = getutcdate(), LicenseWarnEmail = 0 WHERE CourseLicensingID = @warn_lic_CourseLicensingID

FETCH NEXT FROM LicenceNumberLoop
Into @warn_lic_CourseName,
@warn_lic_CourseLicensingID,
@warn_lic_LicenseNumber,
@warn_lic_LicenseWarnNumber,
@warn_lic_RepNameSalt,
@warn_lic_RepEmailSalt,
@warn_lic_RepNameOrg,
@warn_lic_RepEmailOrg,
@warn_lic_LangCode,
@warn_lic_LicensesUsed,
@warn_lic_LicenseWarnEmail,
@warn_lic_OrganisationName
END

CLOSE LicenceNumberLoop
DEALLOCATE LicenceNumberLoop
-- /License Warning


-- Expiry Warning
declare @expiryWarnEmail nvarchar(4000)
declare @expiryWarnEmail_Subject nvarchar(4000)
declare @emailLicenseWarnExpRecipients nvarchar(512)
DECLARE @warn_exp_CourseLicensingID int,
@warn_exp_CourseName nvarchar(200),
@warn_exp_DateWarn datetime,
@warn_exp_ExpiryWarnEmail bit,
@warn_exp_DateEnd datetime,
@warn_exp_RepNameSalt nvarchar(200),
@warn_exp_RepEmailSalt nvarchar(200),
@warn_exp_RepNameOrg nvarchar(200),
@warn_exp_RepEmailOrg nvarchar(200),
@warn_exp_LangCode nvarchar(10),
@warn_exp_OrganisationName nvarchar(50)

DECLARE LicenceExpiryLoop CURSOR
FOR
SELECT
l.CourseLicensingID, c.Name, l.DateWarn, l.ExpiryWarnEmail, l.DateEnd, l.RepNameSalt,
l.RepEmailSalt, l.RepNameOrg, l.RepEmailOrg, l.LangCode, OrganisationName
FROM
tblCourseLicensing l
INNER JOIN tblCourse c ON l.CourseID = c.CourseID
LEFT JOIN tblOrganisation o ON l.OrganisationID = o.OrganisationID
WHERE
l.DateWarn < GETUTCDATE()
AND l.ExpiryWarnEmail = 1
AND l.OrganisationID = @OrgID

Open LicenceExpiryLoop
FETCH NEXT FROM LicenceExpiryLoop
Into @warn_exp_CourseLicensingID,
@warn_exp_CourseName,
@warn_exp_DateWarn,
@warn_exp_ExpiryWarnEmail,
@warn_exp_DateEnd,
@warn_exp_RepNameSalt,
@warn_exp_RepEmailSalt,
@warn_exp_RepNameOrg,
@warn_exp_RepEmailOrg,
@warn_exp_LangCode,
@warn_exp_OrganisationName

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get Expiry Warning text in desired language.
SELECT     @expiryWarnEmail = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_exp_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_ExpiryWarn'') AND (tblLangValue.Active = 1)

SELECT     @expiryWarnEmail_Subject = tblLangValue.LangEntryValue
FROM         tblLang INNER JOIN
tblLangValue ON tblLang.LangID = tblLangValue.LangID INNER JOIN
tblLangResource ON tblLangValue.LangResourceID = tblLangResource.LangResourceID INNER JOIN
tblLangInterface ON tblLangValue.LangInterfaceID = tblLangInterface.LangInterfaceID
WHERE     (tblLang.LangCode = @warn_exp_LangCode) AND (tblLangInterface.LangInterfaceName = ''/ContentAdministration/Licensing/Default.aspx'') AND
(tblLangResource.LangResourceName = ''Email_ExpiryWarn_Subject'') AND (tblLangValue.Active = 1)

-- {0} Receipient Name, {1} number days till expiry, {2} course name, {3} expiry date, {4} Salt rep name
-- {5} Organisation Name
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{0}'', @warn_exp_RepNameOrg)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{1}'', DATEDIFF(dd,dbo.udfUTCtoDaylightSavingTime(getUTCdate(),@OrgID),dbo.udfUTCtoDaylightSavingTime(@warn_exp_DateEnd,@OrgID)))
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{2}'', @warn_exp_CourseName)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{3}'', CONVERT(CHAR(10), dbo.udfUTCtoDaylightSavingTime(@warn_exp_DateEnd,@OrgID), 103))
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{4}'', @warn_exp_RepNameSalt)
set @expiryWarnEmail = REPLACE(@expiryWarnEmail, ''{5}'', @warn_exp_OrganisationName)

set @expiryWarnEmail_Subject = REPLACE(@expiryWarnEmail_Subject, ''{0}'', @warn_exp_CourseName)
set @expiryWarnEmail_Subject = REPLACE(@expiryWarnEmail_Subject, ''{1}'', @warn_exp_OrganisationName)

select @emailLicenseWarnExpRecipients = @warn_exp_RepEmailOrg +'';''+@warn_exp_RepEmailSalt

--EXEC msdb.dbo.sp_send_dbmail
--@recipients = @emailLicenseWarnExpRecipients,
--@body = @expiryWarnEmail,
--@subject = @expiryWarnEmail_Subject,
--@profile_name = ''Salt_MailAccount''

-- Log emails sent
--exec prcEMail_LogSentEmail @toEmail = @warn_exp_RepEmailOrg, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @expiryWarnEmail_Subject, @body = @expiryWarnEmail, @organisationID = @OrgID
--exec prcEMail_LogSentEmail @toEmail = @warn_exp_RepEmailSalt, @toName = null, @fromEmail = ''support@blakedawson.com'', @fromName = ''Blake Dawson'', @subject = @expiryWarnEmail_Subject, @body = @expiryWarnEmail, @organisationID = @OrgID

print ''queued expiry mail to : '' + @emailLicenseWarnExpRecipients
-- Unset flag and record date email sent
UPDATE tblCourseLicensing SET DateExpiryWarnEmailSent = getutcdate(), ExpiryWarnEmail = 0 WHERE CourseLicensingID = @warn_exp_CourseLicensingID


FETCH NEXT FROM LicenceExpiryLoop
Into @warn_exp_CourseLicensingID,
@warn_exp_CourseName,
@warn_exp_DateWarn,
@warn_exp_ExpiryWarnEmail,
@warn_exp_DateEnd,
@warn_exp_RepNameSalt,
@warn_exp_RepEmailSalt,
@warn_exp_RepNameOrg,
@warn_exp_RepEmailOrg,
@warn_exp_LangCode,
@warn_exp_OrganisationName
END

CLOSE LicenceExpiryLoop
DEALLOCATE LicenceExpiryLoop
-- /Expiry Warning
/* /UNITTEST: Licensing */


/* UNITTEST: ModuleNightly */
-- START Course status reconcile. If a module has been made active or inactive to run through all user and ensure that their course status is correct.
-- AS PER BUSINESS requirement
-- Get all changed modules
declare @c_CourseID int, @c_ModuleID int
DECLARE UpdatedModuleLOOP CURSOR
FOR
SELECT CourseID, ModuleID FROM tblModule WHERE(DateUpdated > GETUTCDATE() - 2)
Open UpdatedModuleLOOP

FETCH NEXT FROM UpdatedModuleLOOP
Into
@c_CourseID, @c_ModuleID

WHILE @@FETCH_STATUS = 0
BEGIN
-- Get all users related to this module
declare @c_UserID int
DECLARE UserLOOP CURSOR
FOR
SELECT UserID FROM tblUserModuleAccess WHERE ModuleID = @c_ModuleID
Open UserLOOP


FETCH NEXT FROM UserLOOP
Into
@c_UserID

WHILE @@FETCH_STATUS = 0
BEGIN
EXEC prcUserQuizStatus_UpdateCourseStatus @c_UserID, @c_ModuleID
FETCH NEXT FROM UserLOOP
Into
@c_UserID
END

CLOSE UserLOOP
DEALLOCATE UserLOOP

FETCH NEXT FROM UpdatedModuleLOOP
Into
@c_CourseID, @c_ModuleID
END

CLOSE UpdatedModuleLOOP
DEALLOCATE UpdatedModuleLOOP
/* /UNITTEST: ModuleNightly */




/* UNITTEST: ExtendComplianceDate */
update tblOrganisation
set DefaultQuizCompletionDate = dateadd(year, 1, [DefaultQuizCompletionDate])
where DefaultQuizCompletionDate < getutcdate() and OrganisationID = @OrgID

update tblUnitRule
set QuizCompletionDate = dateadd(year, 1, [QuizCompletionDate])
where QuizCompletionDate < getutcdate() and UnitID IN (select UnitID from tblUnit where OrganisationID = @OrgID)
/* /UNITTEST: ExtendComplianceDate */


-- END Course status reconcile.


update tblOrganisation set CourseStatusLastUpdated = dbo.udfUTCtoDaylightSavingTime(getutcdate(),@OrgID) where OrganisationID = @OrgID

update tblModuleStatusUpdateHistory
set FinishTime = getutcdate()
where ModuleStatusUpdateHistoryID = @intHistoryID


SET QUOTED_IDENTIFIER OFF
' 
END
GO



IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_CourseStatusSearch]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_CourseStatusSearch]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_CourseStatusSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		File:
**		Name: prcReport_CourseStatusSearch
**		Desc: Given a list of unit IDs, course IDs,
**
**		This template can be customized:
**
**		Return values:
**
**		Called by:
**
**		Parameters:
**		Input							Output
**     ----------							-----------
**
**		Auth:
**		Date:
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**		23/07/2009	Mark Donald			Add @classificationID parameter and use
**										it to filter the insert into @Users
**		17/08/2009	Mark Donald			Change column order of ''fail option''
**										select statement to match others
**
*******************************************************************************/

--exec prcReport_CourseStatusSearch 109, ''4463,4464,4465,4469,4478,4479'', ''92'', 3, ''1997-01-01'',''2011-07-01'', 0, 0
CREATE       Procedure [prcReport_CourseStatusSearch]
(
	@organisationID		int,
	@unitIDs 		varchar(8000),
	@courseIDs 		varchar(8000),
	@courseModuleStatus	int,
	@dateFromOrg 		datetime,
	@dateToOrg 		datetime,
	@IncludeInactive int,
	@classificationID int
)
AS

begin
	------------------------------------------
	DECLARE @dateFrom 		datetime
	DECLARE @dateTo 		datetime
	SET @dateFrom = dbo.udfDaylightSavingTimeToUTC(@dateFromOrg,@OrganisationID)
	SET @dateTo = dbo.udfDaylightSavingTimeToUTC(@dateToOrg,@OrganisationID)

	Set Nocount On

	Declare
	@CONST_INCOMPLETE     	int,
	@CONST_COMPLETE     	int,
	@CONST_FAILD            int,
	@CONST_NOTSTARTED 	    int,
	@CONST_EXPIRED_TIMELAPSED		int,
	@CONST_EXPIRED_NEWCONTENT		int

	set @CONST_INCOMPLETE	= 0
	set @CONST_COMPLETE	= 1
	set @CONST_FAILD	= 2
	set @CONST_NOTSTARTED	= 3
	set @CONST_EXPIRED_TIMELAPSED   = 4
	set @CONST_EXPIRED_NEWCONTENT	= 5

	DECLARE @Units TABLE
	(
		UnitID INT PRIMARY KEY(UnitID)
	)

	DECLARE @Courses TABLE
	(
		CourseID INT PRIMARY KEY(CourseID)
	)

	DECLARE @CoursesWithAccess 	TABLE (CourseID INT PRIMARY KEY(CourseID))
	DECLARE @UserModuleWithAccess TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
	DECLARE @AllModules TABLE(ModuleID INT PRIMARY KEY(ModuleID))
	DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))
	DECLARE @UsersNQuizStatus
	TABLE
	(
		UserID	INT,
		ModuleID INT,
		LatestQuizID INT,
		QuizStatusID INT,
		QuizScore INT
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	DECLARE @UsersQuizStatusNOTSTARTED
	TABLE
	(
		UserID	INT,
		ModuleID INT,
		LatestQuizID INT,
		QuizStatusID INT,
		QuizScore INT
		PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
	)

	INSERT INTO @Courses SELECT * FROM dbo.udfCsvToInt(@courseIDs)

	INSERT INTO @Units SELECT * FROM  dbo.udfCsvToInt(@unitIDs)

	--Get Rid of courses which do not have access to specified org
	INSERT INTO @CoursesWithAccess
	SELECT A.CourseID FROM @Courses A, tblOrganisationCourseAccess B, tblCourse C
	WHERE A.CourseID = B.GrantedCourseID AND B.OrganisationID = @organisationID AND
	A.CourseID = C.CourseID AND C.Active = 1

	--Get All the users for all specfied units, matching Custom Classification option (if provided)
	INSERT INTO @Users
	SELECT
	DISTINCT A.UserID, A.UnitiD
	FROM
	tblUser A
	join @Units B on A.UnitID = B.UnitID
	join tblUnit C on B.UnitID = C.UnitID AND C.Active = 1
	LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
	WHERE
	A.Active = CASE @IncludeInactive WHEN 0 THEN 1 ELSE A.Active END
	AND ((@classificationID =0) OR (classificationID = @classificationID))
	--If classification is Any (0), This will find users of any Custom Classification



	if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
	begin -- completed / -- InComplete
		--------------------
		-- Completed --
		--------------------
		-- A user is completed if they became complete and remained completed in the period of interest
		-- the query only needs to check to see status at the max date in this period as a line item
		-- as tblUserCourseStatus is only writen to when an event occours that would
		-- change the status.
		-- When "Course/Module Status" is set to "Complete"
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Course
		-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question
		--------------------
		-- InComplete
		--------------------
		-- A user is in-completed if for any reason they are not complete but do have access to the course
		-- This will find users that:
		-- - Belong to any of the Units in @unitIDs
		-- - AND are currently assigned Modules from the selected Courses
		-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
		-- - AND the event that made them complete happened some time in the time-period in question

		--Find the latest status of courses
		SELECT
			A.UserID, D.UnitID,
			D.FirstName,
			D.LastName,
			case when D.Active = 1 then ''''  else ''(i)'' end as Flag,
			F.HierarchyName AS ''UnitPathWay'',
			dbo.udfUTCtoDaylightSavingTime( C.DateCreated , @organisationID)as ''Date'',
			D.Username as ''UserName'',
			D.Email as ''Email'',
			D.ExternalID as ''ExternalID'',
			E.[Name] as ''CourseName'',
			dbo.udfUTCtoDaylightSavingTime(D.DateCreated, @organisationID)as ''DateCreated'',
			case when D.Active =0 then coalesce(dbo.udfUTCtoDaylightSavingTime(D.DateArchived,@organisationid ),dbo.udfUTCtoDaylightSavingTime(D.DateUpdated,@organisationid)) end  as ''DateArchived''
		FROM
			(SELECT
				A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
				FROM
				tblUserCourseStatus A, @CoursesWithAccess B
				WHERE
				A.DateCreated < DATEADD(DD, 1, @dateTo)
				and
				A.CourseID = B.CourseID
				GROUP BY
				A.UserID, A.CourseID
			) A,
			 @Users B, tblUserCourseStatus C, tblUser D, tblCourse E, tblUnitHierarchy F
		WHERE
			A.UserID = B.UserID AND B.UserID = C.UserID AND
			A.LatestCourseStatus = C.UserCourseStatusID AND
			(C.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo)) AND
			C.CourseStatusID = case @courseModuleStatus
			when @CONST_COMPLETE then 2   -- Complete
			when @CONST_INCOMPLETE then 1 -- InComplete
			end AND
			A.UserID = D.UserID AND A.CourseID = E.CourseID AND
			D.UnitID = F.UnitID
		ORDER BY
			CourseName, UnitPathWay, LastName, FirstName

	end -- completed / -- InComplete


	if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
	begin -- Failed
		--------------------
		-- Failed  --
		--------------------
		-- When "Course/Module Status" is set to "Failed"
		-- This will find users that:
		--  - Belong to any of the Units in @unitIDs
		--  - AND are currently assigned Modules from the selected Courses
		--  - AND took a quiz, for a Module within the selected Course, within the date range of DateCreated in UserQuizStatus and failed it
		--  - AND who currently have a status other than "Passed" for that same quiz
		--------------------

		--Find All Modules for all units with access

		INSERT INTO @UserModuleWithAccess
		SELECT DISTINCT A.UserID, A.ModuleID, A.UnitID FROM
		(
		SELECT A.UserID, A.ModuleID, A.UnitID
		FROM vwUserModuleAccess A where courseid in (SELECT courseid from @Courses) )A, @Users B
		Where A.UserID = B.UserID

		--Find the latest status of all quiz for all the modules
		INSERT INTO @UsersNQuizStatus
		SELECT DISTINCT
			A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
		FROM
		(
			SELECT
				A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
			FROM
				@UserModuleWithAccess A, tblUserQuizStatus B
			WHERE
				A.UserID = B.UserID AND A.ModuleID = B.ModuleID
			GROUP BY
				A.UserID, A.ModuleID) A,
		tblUserQuizStatus B
		WHERE
			A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
			A.LatestQuizID = B.UserQuizStatusID AND
			(B.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo))

		INSERT INTO @UsersQuizStatusNOTSTARTED
		SELECT * FROM @UsersNQuizStatus WHERE QuizStatusID = case @courseModuleStatus
		when @CONST_FAILD then 3   -- Failed
		when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
		when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
	end

	--Get Data in report format
	SELECT DISTINCT
		A.UserID, 
		B.UnitID AS ''Unit'' ,
		B.FirstName, 
		B.LastName,
		case when B.Active = 1 then ''''  else ''(i)'' end  as Flag,
		E.HierarchyName AS ''UnitPathWay'', 
		dbo.udfUTCtoDaylightSavingTime( C.DateCreated,@organisationID) AS ''Date'',
		B.UserName,
		B.Email, 
		B.ExternalID,C.Name AS ''CourseName'', 
		dbo.udfUTCtoDaylightSavingTime(B.DateCreated,@organisationID) AS ''DateCreated'',
		case when B.Active =0 then coalesce(dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID), dbo.udfUTCtoDaylightSavingTime(B.DateUpdated, @OrganisationID)) end as ''DateArchived''
	FROM
	(
		select distinct userid, moduleid from @UsersQuizStatusNOTSTARTED) A,
	tblUser B, tblCourse C, tblModule D, tblUnitHierarchy E
	WHERE
		A.UserID = B.UserID AND B.Active = 1 AND
		A.ModuleID = D.ModuleID AND
		B.UnitID = E.UnitID AND
		D.CourseID = C.CourseID AND C.Active = 1 AND D.Active = 1
	ORDER BY
		CourseName, UnitPathWay, LastName, FirstName

	end --/ Failed


	-- Not started --

	if @courseModuleStatus = @CONST_NOTSTARTED
	begin -- Not started - Any
	--------------------
	-- Not started  --
	--------------------
	-- When "Course/Module Status" is set to "Not Started"
	-- This will find users that:
	--  - Belong to any of the Units in @unitIDs
	--  - AND are currently assigned Modules from the selected Courses
	--  - AND who have not started ANY of the quizes they have access to in this course within the selected date range(DateCreated in vwUserQuizStatus)
	--------------------


	--Find All Modules for all units with access

	INSERT INTO @UserModuleWithAccess
	SELECT DISTINCT A.UserID, A.ModuleID, A.UnitID FROM
	(
	SELECT A.UserID, A.ModuleID, A.UnitID
	FROM vwUserModuleAccess A where courseid in (SELECT courseid from @Courses) )A, @Users B
	Where A.UserID = B.UserID

	--Find the latest status of all quiz for all the modules
	INSERT INTO @UsersNQuizStatus
	SELECT  DISTINCT
	A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
	FROM
	(
	SELECT
	A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
	FROM
	@UserModuleWithAccess A, tblUserQuizStatus B
	WHERE
	A.UserID = B.UserID AND A.ModuleID = B.ModuleID
	GROUP BY
	A.UserID, A.ModuleID) A, tblUserQuizStatus B
	WHERE
	A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
	A.LatestQuizID = B.UserQuizStatusID AND
	(B.DateCreated BETWEEN @dateFrom AND dateadd(d,1,@dateTo))


	--Get User with Quiz NOT STARTED
	INSERT INTO @UsersQuizStatusNOTSTARTED
	SELECT * FROM @UsersNQuizStatus WHERE QuizStatusID NOT IN (2,3,4,5) AND
	UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3,4,5))


	--Get Data in report format
	SELECT DISTINCT
	A.UserID, 
	B.UnitID ,
	B.FirstName, 
	B.LastName,
	case when B.Active = 1 then '''' else ''(i)'' end  as Flag,
	dbo.udfGetUnitPathway(B.UnitID) AS ''UnitPathWay'', 
	dbo.udfUTCtoDaylightSavingTime(C.DateCreated,@organisationID) AS ''Date'',
	B.UserName, 
	B.Email, 
	B.ExternalID,
	C.Name AS ''CourseName'',
	dbo.udfUTCtoDaylightSavingTime(B.DateCreated,@OrganisationID) as ''DateCreated'',
	case when B.Active =0 then coalesce(dbo.udfUTCtoDaylightSavingTime(B.DateArchived,@OrganisationID),dbo.udfUTCtoDaylightSavingTime(B.DateUpdated,@OrganisationID)) end as ''DateArchived''
	FROM
	(select distinct userid, moduleid from @UsersQuizStatusNOTSTARTED) A,
	tblUser B, tblCourse C, tblModule D, tblUnitHierarchy E
	WHERE
	A.UserID = B.UserID AND B.Active = 1 AND
	A.ModuleID = D.ModuleID AND B.UnitID = E.UnitID AND
	D.CourseID = C.CourseID AND C.Active = 1 AND D.Active = 1
	ORDER BY
	CourseName, UnitPathWay, LastName, FirstName

	end --/ Not started - Any
END
' 
END
GO


IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_CompletedUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_CompletedUsers]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_CompletedUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'








/*Summary:
Given a user id returns the list of courses / modules and the latest results for that user
If the User id is ommited it returns results for all users
Returns:
Course ID

Called By:
Home.aspx via Businessservices.Report.GetCompletedUsersReport
Calls:
udfReport_CompletUsers_logic
udfReport_IncompletUsers_logic
Remarks:


Author:
Stephen Kennedy-Clark
Date Created: 18 Feb 2004

Modification History
-----------------------------------------------------------
v#	Author		Date			Description
#1  Liz Dionisio(UW)	8/11/2005		Added Username, Email and ExternalID to returned recordset
#2  Mark Donald	24/07/2009		Add LastCompleted column to incomplete users select statement

prcReport_CompletedUsers @unitIDs=''1,2,3,4'' , @courseID=1 , @completed = 0

--------------------

**/

CREATE          Proc [prcReport_CompletedUsers]

(
@organisationID Integer,		-- Organisation of the current user
@unitIDs varchar(MAX) = '''',	-- string of unit id''s
@courseID int,			-- course ID to restrict search to
@effectiveDate datetime = Null,	-- Effective date as at when to run the report
@completed bit = 0 		-- Completed or incompleted flag
-- 1 = True = completed users
-- 0 = false (default) = not comleted or INcompleted users
)

AS
------------------------------------------
Set Nocount On
If @completed = 1
Begin
SELECT
f.userid, unitid, firstname, lastname, unitpathway,
dbo.udfUTCtoDaylightSavingTime(max(q.datecreated), @organisationID) as date, --date
username, email, externalid
FROM
dbo.udfreport_completeuserslogic(@organisationid, @unitids, @courseid, @effectivedate) f,
tbluserquizstatus q,
tblmodule m
WHERE
m.courseid = @courseid
AND q.moduleid = m.moduleid
AND q.userid = f.userid
AND quizstatusid = 2 -- passed
GROUP BY
f.userid, unitid, firstname, lastname, unitpathway, username, email, externalid
ORDER BY
unitpathway, lastname, firstname
End
Else
Begin
Select
userID
, unitID
, FirstName
, LastName
, UnitPathway
, LastCompleted
, Username
, Email
, ExternalID
From
dbo.udfReport_IncompleteUsersLogic(@organisationID, @unitIDs, @courseID,@effectiveDate)
Order By
UnitPathway, LastName, FirstName
End
' 
END
GO


/* fixed email report */

/****** Object:  StoredProcedure [dbo].[prcReport_EmailReportDistinctUsers]    Script Date: 07/12/2011 17:34:48 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_EmailReportDistinctUsers]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcReport_EmailReportDistinctUsers]
GO

/****** Object:  StoredProcedure [dbo].[prcReport_EmailReportDistinctUsers]    Script Date: 07/12/2011 17:34:48 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_EmailReportDistinctUsers]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
Used to build the CC list on step 2 of the report

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportDistinctUsers
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
CREATE        Proc [dbo].[prcReport_EmailReportDistinctUsers]
(
@organisationID		int,
@unitIDs 			varchar(MAX),
@courseIDs 			varchar(8000),
@classificationID 	int,
@courseModuleStatus	int,
@quizDateFromOrg 		datetime,
@quizDateToOrg 		datetime,
@includeInactive	int
)
AS
------------------------------------------
Set Nocount On

DECLARE @quizDateFrom 		datetime
DECLARE @quizDateTo 		datetime
SET @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFromOrg,@OrganisationID)
SET @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateToOrg,@OrganisationID)




Declare
@CONST_INCOMPLETE     	int,
@CONST_COMPLETE     	int,
@CONST_FAILD            int,
@CONST_NOTSTARTED 	    int,
@CONST_UNKNOWN 	        int,
@CONST_EXPIRED_TIMELAPSED int,
@CONST_EXPIRED_NEWCONTENT int

set @CONST_INCOMPLETE	= 0
set @CONST_COMPLETE	    = 1
set @CONST_FAILD		= 2
set @CONST_NOTSTARTED	= 3
set @CONST_EXPIRED_TIMELAPSED	= 4
set @CONST_EXPIRED_NEWCONTENT  = 5

DECLARE @Units TABLE (UnitID INT)
DECLARE @Courses TABLE (CourseID INT)
DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
DECLARE @UsersNQuizStatus TABLE (
UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
)
DECLARE @UsersQuizStatusNOTSTARTED TABLE (
UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
)

INSERT INTO
@Courses
SELECT
*
FROM
dbo.udfCsvToInt(@courseIDs)

INSERT INTO
@Units
SELECT
*
FROM
dbo.udfCsvToInt(@unitIDs)

--Get Rid of courses which do not have access to specified org
INSERT INTO
@CoursesWithAccess
SELECT
A.CourseID, [name]
FROM
@Courses A, tblOrganisationCourseAccess B, tblCourse C
WHERE
A.CourseID = B.GrantedCourseID
AND B.OrganisationID = @organisationID
AND A.CourseID = C.CourseID
AND C.Active = 1

--Get All the users for all specfied units
INSERT INTO
@Users
SELECT
DISTINCT A.UserID, A.UnitiD
FROM
tblUser A
join  @Units B on A.UnitID = B.UnitID
join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
WHERE
@includeinactive =1 or A.Active = 1 -- show all or only active users



if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
begin -- completed / -- InComplete
--------------------
-- Completed --
--------------------
-- A user is completed if they became complete and remained completed in the period of interest
-- the query only needs to check to see status at the max date in this period as a line item
-- as tblUserCourseStatus is only writen to when an event occours that would
-- change the status.
-- When "Course/Module Status" is set to "Complete"
-- This will find users that:
-- - Belong to any of the Units in @unitIDs
-- - AND are currently assigned Modules from the selected Course
-- - AND have the Custom Classification option (if provided)
-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
-- - AND the event that made them complete happened some time in the time-period in question
--------------------
-- InComplete
--------------------
-- A user is in-completed if for any reason they are not complete but do have access to the course
-- This will find users that:
-- - Belong to any of the Units in @unitIDs
-- - AND are currently assigned Modules from the selected Course
-- - AND have the Custom Classification option (if provided)
-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
-- - AND the event that made them complete happened some time in the time-period in question

SELECT
DISTINCT A.UserID, F.HierarchyName, A.FirstName, A.LastName, dbo.udfUTCtoDaylightSavingTime(A.DateCreated, @organisationID) as DateCreated, dbo.udfUTCtoDaylightSavingTime(A.DateArchived, @organisationID) as DateArchived
FROM
(SELECT
A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
D.DateCreated as DateCreated, D.DateArchived as DateArchived, A.CourseID
FROM
(SELECT
A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
FROM
tblUserCourseStatus A, @CoursesWithAccess B
WHERE
A.DateCreated < DATEADD(DD, 1, @quizDateTo)
and A.CourseID = B.CourseID
GROUP BY
A.UserID, A.CourseID
) A, @Users B, tblUserCourseStatus C, tblUser D
WHERE
A.UserID = B.UserID
AND B.UserID = C.UserID
AND A.LatestCourseStatus = C.UserCourseStatusID
AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
AND C.CourseStatusID = case @courseModuleStatus
when @CONST_COMPLETE then 2   -- Complete
when @CONST_INCOMPLETE then 1 -- InComplete
end
AND A.UserID = D.UserID
) A
LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
WHERE
--If classification is Any (0), This will find users of any Custom Classification
(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
ORDER BY
F.HierarchyName, A.LastName, A.FirstName
END -- completed / -- InComplete


if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
begin -- Failed
--------------------
-- Failed  --
--------------------
-- When "Course/Module Status" is set to "Failed"
-- This will find users that:
--  - Belong to any of the Units in @unitIDs
--  - AND are currently assigned Modules from the selected Course
--  - AND have the Custom Classification option
--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
--  - AND who currently have a status other than "Passed" for that same quiz
--------------------

INSERT INTO
@UserModuleWithAccess
SELECT
DISTINCT A.UserID, A.ModuleID, A.UnitID
FROM
(SELECT
A.UserID, A.ModuleID, A.UnitID
FROM
vwUserModuleAccess A
where
courseid in (SELECT courseid from @Courses)
)A, @Users B
Where
A.UserID = B.UserID

--Find the latest status of all quiz for all the modules
INSERT INTO
@UsersNQuizStatus
SELECT
DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
FROM
(SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
GROUP BY
A.UserID, A.ModuleID
) A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
AND A.LatestQuizID = B.UserQuizStatusID

INSERT INTO
@UsersQuizStatusNOTSTARTED
SELECT
*
FROM
@UsersNQuizStatus
WHERE
QuizStatusID = case @courseModuleStatus
when @CONST_FAILD then 3   -- Failed
when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
end

--Get Data in report format
SELECT
DISTINCT A.UserID, C.HierarchyName, B.FirstName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated,
dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived
FROM
(select
distinct userid, moduleid
from
@UsersQuizStatusNOTSTARTED
) A, tblUser B, tblModule D, tblUnitHierarchy C
WHERE
A.UserID = B.UserID
AND B.UnitID = C.UnitID
AND A.ModuleID = D.ModuleID
AND D.Active = 1
ORDER BY
C.HierarchyName, B.LastName + case when B.Active <> 1 then ''(i)'' else '''' end, B.FirstName
end --/ Failed


-- Not started --

if @courseModuleStatus = @CONST_NOTSTARTED
begin -- Not started - Any
--------------------
-- Not started  --
--------------------
-- When "Course/Module Status" is set to "Not Started"
-- This will find users that:
--  - Belong to any of the Units in @unitIDs
--  - AND are currently assigned Modules from the selected Course
--  - AND have the Custom Classification option
--  - AND who have not started ANY of the quizes they have access to in this course
--------------------

INSERT INTO
@UserModuleWithAccess
SELECT
DISTINCT A.UserID, A.ModuleID, A.UnitID
FROM
(SELECT
A.UserID, A.ModuleID, A.UnitID
FROM
vwUserModuleAccess A
where
courseid in (SELECT courseid from @Courses)
) A, @Users B
Where
A.UserID = B.UserID

--Find the latest status of all quiz for all the modules
INSERT INTO
@UsersNQuizStatus
SELECT
DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
FROM
(SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
GROUP BY
A.UserID, A.ModuleID
) A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
AND A.LatestQuizID = B.UserQuizStatusID
AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

--select * from @UsersNQuizStatus

--Get User with Quiz NOT STARTED
INSERT INTO
@UsersQuizStatusNOTSTARTED
SELECT
*
FROM
@UsersNQuizStatus
WHERE
QuizStatusID NOT IN (2,3)
AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

--select * from @UsersQuizStatusNOTSTARTED
--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

--Get Data in report format
SELECT
DISTINCT A.UserID, B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
A.FirstName,
dbo.udfUTCtoDaylightSavingTime(A.DateCreated, @OrganisationID) as DateCreated,
dbo.udfUTCtoDaylightSavingTime(A.DateArchived, @OrganisationID) as DateArchived
FROM
(SELECT
DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active, B.DateCreated, B.DateArchived, courseid
FROM
(SELECT
DISTINCT userid, moduleid
FROM
@UsersQuizStatusNOTSTARTED
) A, tblUser B, tblModule D
WHERE
A.UserID = B.UserID
AND A.ModuleID = D.ModuleID
AND D.Active = 1
) A
LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
WHERE
--If classification is Any (0), This will find users of any Custom Classification
@classificationID =0 OR tblUserClassification.classificationID = @classificationID
ORDER BY
B.HierarchyName, A.LastName+ case when A.Active <> 1 then ''(i)'' else '''' end, A.FirstName

end --/ Not started - Any


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcReport_EmailReportUserSearch]    Script Date: 07/12/2011 17:35:15 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcReport_EmailReportUserSearch]
GO

/****** Object:  StoredProcedure [dbo].[prcReport_EmailReportUserSearch]    Script Date: 07/12/2011 17:35:15 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_EmailReportUserSearch]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
/*
The e-mail report allows an administrator to e-mail users
who have failed or not completed their quizzes.
It can also email administrators notifying them of
users that they are responsible for who have failed or not
completed their quizzes.

Quiz Status
QuizStatusID Status
------------ --------------------------------------------------
0            Unassigned
1            Not Started
2            Passed
3            Failed
4            Expired (Time Elapsed)
5            Expired (New Content)

Course Status
CourseStatusID Status
-------------- --------------------------------------------------
0              Unassigned
1              InComplete
2              Complete

CourseModuleStatus enum
--------------------------------------------------
Complete	= 1,
Failed		= 2,
NotStarted	= 3,
Unknown		= 4

When "Course/Module Status" is set to "Complete"
This will find users that:
- Belong to any of the Units in @unitIDs
- AND are currently assigned Modules from the selected Course
- AND have the Custom Classification option
- AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
- AND the event that made them complete happened some time in the time-period in question

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 0,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''

exec prcReport_EmailReportUserSearch
@organisationID = 3,
@unitIDs = ''5,6,7'',
@courseID = 5,
@classificationID = 1,
@courseModuleStatus = 3,
@quizDateFrom = ''Jan  1 2004 12:00:00:000AM'',
@quizDateTo = ''Sep 17 2004 11:59:59:000PM''


*/
CREATE        Proc [dbo].[prcReport_EmailReportUserSearch]
(
@organisationID		int,
@unitIDs 			varchar(MAX),
@courseIDs 			varchar(8000),
@classificationID 	int,
@courseModuleStatus	int,
@quizDateFromOrg 		datetime,
@quizDateToOrg 		datetime,
@includeInactive	int
)
AS
------------------------------------------
Set Nocount On
DECLARE @quizDateFrom 		datetime
DECLARE @quizDateTo 		datetime
SET @quizDateFrom = dbo.udfDaylightSavingTimeToUTC(@quizDateFromOrg,@OrganisationID)
SET @quizDateTo = dbo.udfDaylightSavingTimeToUTC(@quizDateToOrg,@OrganisationID)


Declare
@CONST_INCOMPLETE     	int,
@CONST_COMPLETE     	int,
@CONST_FAILD            int,
@CONST_NOTSTARTED 	    int,
@CONST_UNKNOWN 	        int,
@CONST_EXPIRED_TIMELAPSED int,
@CONST_EXPIRED_NEWCONTENT int

set @CONST_INCOMPLETE	= 0
set @CONST_COMPLETE	    = 1
set @CONST_FAILD		= 2
set @CONST_NOTSTARTED	= 3
set @CONST_EXPIRED_TIMELAPSED	= 4
set @CONST_EXPIRED_NEWCONTENT  = 5

DECLARE @Units TABLE (UnitID INT)
DECLARE @Courses TABLE (CourseID INT)
DECLARE @CoursesWithAccess TABLE (CourseID INT PRIMARY KEY, [name] nvarchar(100))
DECLARE @UserModuleWithAccess TABLE (UserID INT, ModuleID INT, UnitID INT, PRIMARY KEY(UserID, ModuleID, UnitID))
DECLARE @AllModules TABLE (ModuleID INT PRIMARY KEY(ModuleID))
DECLARE @Users TABLE (UserID INT, UnitID INT PRIMARY KEY(UserID, UnitID))
DECLARE @UsersNQuizStatus TABLE (
UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
)
DECLARE @UsersQuizStatusNOTSTARTED TABLE (
UserID	INT, ModuleID INT, LatestQuizID INT, QuizStatusID INT, QuizScore INT,
PRIMARY KEY(UserID, ModuleID, LatestQuizID, QuizStatusID)
)

INSERT INTO
@Courses
SELECT
*
FROM
dbo.udfCsvToInt(@courseIDs)

INSERT INTO
@Units
SELECT
*
FROM
dbo.udfCsvToInt(@unitIDs)

--Get Rid of courses which do not have access to specified org
INSERT INTO
@CoursesWithAccess
SELECT
A.CourseID, [name]
FROM
@Courses A, tblOrganisationCourseAccess B, tblCourse C
WHERE
A.CourseID = B.GrantedCourseID
AND B.OrganisationID = @organisationID
AND A.CourseID = C.CourseID
AND C.Active = 1

--Get All the users for all specfied units
INSERT INTO
@Users
SELECT
DISTINCT A.UserID, A.UnitiD
FROM
tblUser A
join  @Units B on A.UnitID = B.UnitID
join  tblUnit C on B.UnitID = C.UnitID  AND C.Active = 1
WHERE
@includeinactive =1 or A.Active = 1 -- show all or only active users



if @courseModuleStatus = @CONST_COMPLETE or @courseModuleStatus = @CONST_INCOMPLETE
begin -- completed / -- InComplete
--------------------
-- Completed --
--------------------
-- A user is completed if they became complete and remained completed in the period of interest
-- the query only needs to check to see status at the max date in this period as a line item
-- as tblUserCourseStatus is only writen to when an event occours that would
-- change the status.
-- When "Course/Module Status" is set to "Complete"
-- This will find users that:
-- - Belong to any of the Units in @unitIDs
-- - AND are currently assigned Modules from the selected Course
-- - AND have the Custom Classification option (if provided)
-- - AND have (at the end of the time-period in question) got a status of Complete in tblUserCourseStatus
-- - AND the event that made them complete happened some time in the time-period in question
--------------------
-- InComplete
--------------------
-- A user is in-completed if for any reason they are not complete but do have access to the course
-- This will find users that:
-- - Belong to any of the Units in @unitIDs
-- - AND are currently assigned Modules from the selected Course
-- - AND have the Custom Classification option (if provided)
-- - AND have (at the end of the time-period in question) got a status of Incomplete in tblUserCourseStatus
-- - AND the event that made them complete happened some time in the time-period in question

SELECT
DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(A.courseid AS varchar(10)) userid
FROM
(SELECT
A.UserID, D.UnitID, D.FirstName, D.LastName + case when D.Active <> 1 then ''(i)'' else '''' end as ''LastName'',
dbo.udfUTCtoDaylightSavingTime(D.DateCreated, @organisationID) as DateCreated, 
dbo.udfUTCtoDaylightSavingTime(D.DateArchived, @organisationID) as DateArchived, A.CourseID
FROM
(SELECT
A.UserID, A.CourseID, MAX(A.UserCourseStatusID) AS ''LatestCourseStatus''
FROM
tblUserCourseStatus A, @CoursesWithAccess B
WHERE
A.DateCreated < DATEADD(DD, 1, @quizDateTo)
and A.CourseID = B.CourseID
GROUP BY
A.UserID, A.CourseID
) A, @Users B, tblUserCourseStatus C, tblUser D
WHERE
A.UserID = B.UserID
AND B.UserID = C.UserID
AND A.LatestCourseStatus = C.UserCourseStatusID
AND (C.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)
AND C.CourseStatusID = case @courseModuleStatus
when @CONST_COMPLETE then 2   -- Complete
when @CONST_INCOMPLETE then 1 -- InComplete
end
AND A.UserID = D.UserID
) A
LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
LEFT JOIN tblUnitHierarchy F ON F.UnitID = A.UnitID
WHERE
--If classification is Any (0), This will find users of any Custom Classification
(@classificationID =0 OR tblUserClassification.classificationID = @classificationID)
AND A.UserID IN (select UserID from tblUser where OrganisationID = @organisationID and Active = 1)
END -- completed / -- InComplete


if @courseModuleStatus = @CONST_FAILD or @courseModuleStatus = @CONST_EXPIRED_TIMELAPSED or @courseModuleStatus = @CONST_EXPIRED_NEWCONTENT
begin -- Failed
--------------------
-- Failed  --
--------------------
-- When "Course/Module Status" is set to "Failed"
-- This will find users that:
--  - Belong to any of the Units in @unitIDs
--  - AND are currently assigned Modules from the selected Course
--  - AND have the Custom Classification option
--  - AND took a quiz, for a Module within the selected Course, within the date range and failed it
--  - AND who currently have a status other than "Passed" for that same quiz
--------------------

INSERT INTO
@UserModuleWithAccess
SELECT
DISTINCT A.UserID, A.ModuleID, A.UnitID
FROM
(SELECT
A.UserID, A.ModuleID, A.UnitID
FROM
vwUserModuleAccess A
where
courseid in (SELECT courseid from @Courses)
)A, @Users B
Where
A.UserID = B.UserID

--Find the latest status of all quiz for all the modules
INSERT INTO
@UsersNQuizStatus
SELECT
DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
FROM
(SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
GROUP BY
A.UserID, A.ModuleID
) A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
AND A.LatestQuizID = B.UserQuizStatusID

INSERT INTO
@UsersQuizStatusNOTSTARTED
SELECT
*
FROM
@UsersNQuizStatus
WHERE
QuizStatusID = case @courseModuleStatus
when @CONST_FAILD then 3   -- Failed
when @CONST_EXPIRED_TIMELAPSED then 4 -- Expired time lapsed
when @CONST_EXPIRED_NEWCONTENT then 5 -- Expired new content
end

--Get Data in report format
SELECT
DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
FROM
(select
distinct userid, moduleid
from
@UsersQuizStatusNOTSTARTED
) A, tblUser B, tblModule D, tblUnitHierarchy C
WHERE
A.UserID = B.UserID
AND B.UnitID = C.UnitID
AND A.ModuleID = D.ModuleID
AND D.Active = 1
end --/ Failed


-- Not started --

if @courseModuleStatus = @CONST_NOTSTARTED
begin -- Not started - Any
--------------------
-- Not started  --
--------------------
-- When "Course/Module Status" is set to "Not Started"
-- This will find users that:
--  - Belong to any of the Units in @unitIDs
--  - AND are currently assigned Modules from the selected Course
--  - AND have the Custom Classification option
--  - AND who have not started ANY of the quizes they have access to in this course
--------------------

INSERT INTO
@UserModuleWithAccess
SELECT
DISTINCT A.UserID, A.ModuleID, A.UnitID
FROM
(SELECT
A.UserID, A.ModuleID, A.UnitID
FROM
vwUserModuleAccess A
where
courseid in (SELECT courseid from @Courses)
) A, @Users B
Where
A.UserID = B.UserID

--Find the latest status of all quiz for all the modules
INSERT INTO
@UsersNQuizStatus
SELECT
DISTINCT A.UserID, A.ModuleID, A.LatestQuizID, B.QuizStatusID, B.QuizScore
FROM
(SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
GROUP BY
A.UserID, A.ModuleID
) A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID
AND A.ModuleID = B.ModuleID
AND A.LatestQuizID = B.UserQuizStatusID
AND (B.DateCreated BETWEEN @quizDateFrom AND @quizDateTo)

--select * from @UsersNQuizStatus

--Get User with Quiz NOT STARTED
INSERT INTO
@UsersQuizStatusNOTSTARTED
SELECT
*
FROM
@UsersNQuizStatus
WHERE
QuizStatusID NOT IN (2,3)
AND UserID NOT IN (SELECT UserID FROM @UsersNQuizStatus WHERE QuizStatusID IN (2,3))

--select * from @UsersQuizStatusNOTSTARTED
--select distinct userid,moduleid from @UsersQuizStatusNOTSTARTED

--Get Data in report format
SELECT
DISTINCT cast(A.UserID AS varchar(10)) + '':'' + cast(courseid AS varchar(10)) userid
FROM
(SELECT
DISTINCT A.UserID, B.UnitID, B.FirstName, B.LastName, B.active,
dbo.udfUTCtoDaylightSavingTime(B.DateCreated, @OrganisationID) as DateCreated,
dbo.udfUTCtoDaylightSavingTime(B.DateArchived, @OrganisationID) as DateArchived,
courseid
FROM
(SELECT
DISTINCT userid, moduleid
FROM
@UsersQuizStatusNOTSTARTED
) A, tblUser B, tblModule D
WHERE
A.UserID = B.UserID
AND A.ModuleID = D.ModuleID
AND D.Active = 1
) A
LEFT JOIN tblUserClassification ON tblUserClassification.UserID = A.UserID
AND tblUserClassification.classificationID = isnull( @classificationID, tblUserClassification.classificationID )
LEFT JOIN tblUnitHierarchy B ON B.UnitID = A.UnitID
WHERE
--If classification is Any (0), This will find users of any Custom Classification
@classificationID =0 OR tblUserClassification.classificationID = @classificationID

end --/ Not started - Any


' 
END
GO


/****** Object:  StoredProcedure [dbo].[prcReport_Warning]    Script Date: 07/12/2011 17:35:30 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_Warning]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[prcReport_Warning]
GO

/****** Object:  StoredProcedure [dbo].[prcReport_Warning]    Script Date: 07/12/2011 17:35:30 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[prcReport_Warning]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'/******************************************************************************
**		Name: prcReport_Warning
**
**		Called by:
**
**		Auth: Mark Donald
**		Date: 7 Dec 2009
*******************************************************************************
**		Change History
*******************************************************************************
**		Date:		Author:				Description:
**
*******************************************************************************/


CREATE PROCEDURE [dbo].[prcReport_Warning]
(
@organisationID int,
@unitIDs varchar(8000),
@courseIDs varchar(8000),
@classificationID int,
@warningPeriod int,
@warningUnit varchar(2)
)
AS
SET NOCOUNT ON;

DECLARE @Units TABLE (UnitID INT PRIMARY KEY(UnitID))
DECLARE @Courses TABLE(CourseID INT PRIMARY KEY(CourseID))
DECLARE @CoursesWithAccess 	TABLE (CourseID INT PRIMARY KEY(CourseID))
DECLARE @Users TABLE(UserID INT , UnitID INT PRIMARY KEY(UserID, UnitID))
DECLARE @tblCurrentAssignedModules TABLE (
CourseID int,
UserID int,
UnitID int,
ModuleID int,
QuizFrequency int,
QuizCompletionDate datetime
)
DECLARE @tblStartedModules TABLE (
UserID int,
ModuleID int,
DateTimeCompleted datetime
)

INSERT INTO
@Courses
SELECT
*
FROM
dbo.udfCsvToInt(@courseIDs)

INSERT INTO
@Units
SELECT
*
FROM
dbo.udfCsvToInt(@unitIDs)

-- Get users for specfied units, matching Custom Classification option (if provided)
INSERT INTO @Users
SELECT
DISTINCT A.UserID, A.UnitiD
FROM
tblUser A
JOIN @Units B on A.UnitID = B.UnitID
JOIN tblUnit C on B.UnitID = C.UnitID AND C.Active = 1
LEFT JOIN tblUserClassification uc ON uc.UserID  = A.UserID
WHERE
A.Active = 1
AND ((@classificationID =0) OR (classificationID = @classificationID))
--If classification is Any (0), This will find users of any Custom Classification

-- Get compliance rules for in-scope modules
INSERT INTO @tblCurrentAssignedModules
SELECT
CourseID, UserID, um.UnitID, um.ModuleID, QuizFrequency, QuizCompletionDate
FROM
(SELECT
tU.UserID, tU.UnitID, tM.ModuleID
FROM
dbo.tblUser tU
INNER JOIN dbo.tblOrganisationCourseAccess tOCA ON tOCA.OrganisationID = tU.OrganisationID
INNER JOIN dbo.tblCourse tC ON tC.CourseID = tOCA.GrantedCourseID
INNER JOIN dbo.tblModule tM ON tM.CourseID = tC.CourseID AND tM.Active = 1
LEFT OUTER JOIN dbo.tblUserModuleAccess tUsrMA ON tUsrMA.UserID = tU.UserID
AND tUsrMA.ModuleID = tM.ModuleID
LEFT OUTER JOIN dbo.tblUnitModuleAccess tUnitMA ON tUnitMA.UnitID = tU.UnitID
AND tUnitMA.DeniedModuleID = tM.ModuleID
WHERE
tU.OrganisationID = @organisationID
AND	tU.Active = 1
AND tu.UnitID IS NOT NULL
AND dbo.udfUserCourseComplete(tu.userid, tm.courseid) = 1
AND ((tUnitMA.DeniedModuleID IS NULL AND tUsrMA.ModuleID IS NULL)
OR tUsrMA.Granted=1)
) um
INNER JOIN (
SELECT
u.UnitID, m.CourseID, m.ModuleID,
CASE
WHEN (
ur.QuizFrequency IS NULL
AND ur.QuizCompletionDate IS NULL
AND o.DefaultQuizCompletionDate IS NULL
) THEN
o.DefaultQuizFrequency
ELSE
ur.QuizFrequency
END AS QuizFrequency,
CASE
WHEN (
ur.QuizFrequency IS NULL
AND ur.QuizCompletionDate IS NULL
AND o.DefaultQuizCompletionDate IS NOT NULL
) THEN
o.DefaultQuizCompletionDate
ELSE
ur.QuizCompletionDate
END AS QuizCompletionDate
FROM
tblOrganisationCourseAccess c
INNER JOIN tblModule m ON m.CourseID = c.GrantedCourseID
INNER JOIN tblOrganisation o ON o.OrganisationID = c.OrganisationID -- default compliance rules
INNER JOIN tblUnit u ON u.OrganisationID = c.OrganisationID
LEFT JOIN tblUnitRule ur ON ur.ModuleID = m.ModuleID AND ur.UnitID = u.unitID -- unit specific rules
WHERE o.OrganisationID = @organisationID
) umr ON umr.ModuleID  = um.ModuleID
AND umr.UnitID = um.UnitID
AND um.UnitID IN (SELECT DISTINCT UnitID FROM @users)
AND um.UserID IN (SELECT DISTINCT UserID FROM @users)
AND umr.CourseID IN (SELECT CourseID FROM @courses)

-- Get module completion details
INSERT INTO @tblStartedModules
SELECT
um.userID, um.moduleID, qs.DateTimeCompleted
FROM
@tblCurrentAssignedModules um
INNER JOIN (
SELECT
um.userID, um.moduleID, max(DateTimeCompleted) AS DateTimeCompleted
FROM
@tblCurrentAssignedModules um
INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
INNER JOIN tblQuizSession qs ON qs.QuizID= q.quizID
AND qs.userID = um.userID
AND qs.DateTimeCompleted IS NOT NULL
GROUP BY
um.userID, um.moduleID
) AS LastQuizDate ON
LastQuizDate.userID = um.userID
AND LastQuizDate.ModuleID = um.ModuleID
INNER JOIN tblQuiz q ON q.ModuleID = um.ModuleID
INNER JOIN tblQuizSession qs ON
qs.QuizID= q.quizID
AND qs.userID = um.userID
AND qs.DateTimeCompleted = LastQuizDate.DateTimeCompleted

-- User/course combos where the courses are about to be marked incomplete due to module expiry
BEGIN
SELECT
c.[name] as CourseName, 
HierarchyName AS UnitPathway, 
LastName, 
FirstName,
ExternalID, 
Email, 
UserName, 
dbo.udfUTCtoDaylightSavingTime(max(DateTimeCompleted), @organisationID) AS CompletionDate,
dbo.udfUTCtoDaylightSavingTime(min(isnull(QuizCompletionDate, dateadd(month, QuizFrequency, DateTimeCompleted))), @organisationID) AS ExpiryDate
FROM
@tblCurrentAssignedModules cam
INNER JOIN @tblStartedModules sm ON sm.UserID = cam.UserID AND sm.ModuleID = cam.ModuleID,
tblCourse c,
tblUser u,
tblUnitHierarchy h
WHERE
c.CourseID = cam.CourseID
AND u.UserID = cam.UserID
AND h.UnitID = cam.UnitID
GROUP BY
c.[name], HierarchyName,  LastName, FirstName, ExternalID, Email, Username
HAVING
min(isnull(
QuizCompletionDate,
dateadd(month, QuizFrequency, DateTimeCompleted)
)) < CASE @warningUnit
WHEN ''mm'' THEN
dateadd(mm, @warningPeriod, getutcdate())
ELSE
dateadd(dd, @warningPeriod, getutcdate())
END
ORDER BY
CourseName, UnitPathway, LastName, FirstName
END
' 
END
GO

/* ---------------------------------------------------------- */

/* fixed historic admin report */
/****** Object:  UserDefinedFunction [dbo].[udfReport_HistoricAdminSummaryOptimised]    Script Date: 07/13/2011 18:09:24 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[udfReport_HistoricAdminSummaryOptimised]
GO

/****** Object:  UserDefinedFunction [dbo].[udfReport_HistoricAdminSummaryOptimised]    Script Date: 07/13/2011 18:09:24 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[udfReport_HistoricAdminSummaryOptimised]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
BEGIN
execute dbo.sp_executesql @statement = N'


/****** Object:  User Defined Function dbo.udfReport_HistoricAdminSummary    Script Date: 20/04/2004 8:25:58 AM ******/
/*Summary:
Get the Current or historic user module status  based on the search criteria
See the remarks below.
Returns: table
Called By: Current historic Admin Report
Calls:
Remarks:
1. Get User and course List based on search criteria
1.1 Get Unit List
1.1.1 If unit ids are passed in, convert the CSV format to a table
1.1.2 If no unit is selected, get a list of of all units that the admin user has permission to access
1.2 Get User list Based on the first name and last name in the search cirteria
1.3 Get Course list Based on the selected course in the search criteria and Used can select multiple Courses
2. Get the User Quiz and Lesson status up to the effective date
2.1 If there is no effective date is passed in, get the current module status
2.2 If there is effective date, get the module status up to the effective date
3.  Get a list of the user''s quiz and lesson historic status
Author: Jack Liu
Date Created: 1 Mar 2004
Modification History
-----------------------------------------------------------
v#	Author		Date				Description
#1.1	Usman Tjiudri	10/11/2005	Performance tuning:
- use temp-table to populate Unit Pathway
- join the temp-table to populate tblResult
instead of using udfGetUnitPathway function in the join.
#2.0	Serguei Chkaroupine 28/02/06 -New insert statement for histric admin report
- it will insert all lessons that match current quizmodule pair
- Current admin report performance fix. Added WHERE statement to
most of the insert statements.
#3	Mark Donald	27/07/2009			add userName and userEmail params
#4	William Tio	01/12/2009
- remove the wrong logic to exclude the user quiz/lesson status
- replace with ''not exists''

select * from dbo.udfReport_HistoricAdminSummary(3, '''', ''1,2,3,4'','''','''',NULL,NULL,''20040222'',4)
--------------------
**/

CREATE                Function [dbo].[udfReport_HistoricAdminSummaryOptimised]
(
@organisationID 	Int,
@unitIDs			Varchar(8000),
@courseIDs			Varchar(8000),
@userFirstName		Varchar(50),
@userLastName		Varchar(50),
@userName			Varchar(100),
@userEmail			Varchar(100),
@effectiveDate 		Datetime,
@adminUserID		Int,
@classificationID 	Int,
@defaultDate		DateTime,
@inclInactive		int
)
Returns @tblResult Table
(
-- General
Unit			nVarchar(200),
[User]			nVarchar(100),
Course			nVarchar(100),
Module			nVarchar(100),
[Sequence]		Int,
-- Quiz Specific
QuizStatus		Varchar(50),
QuizScore		Int,
QuizStatusDate	Datetime,
-- Lesson Specific
LessonStatus	Varchar(50),
-- Hidden
UnitID			Int,
UserID			Int,
UserName		nVarchar(100),
ExternalID		nVarchar(50),
CourseID		Int,
ModuleID		Int,
Active	int
)
As Begin

--Variables declarations
DECLARE @UserTypeID 	INT
DECLARE @tblUnit 				Table(UnitID INT PRIMARY KEY(UnitID))
DECLARE @tblUser 				Table(UserID INT, UnitID INT, Active INT)
DECLARE @tblCourse 				Table(CourseID INT, [Name] NVARCHAR(100) PRIMARY KEY(CourseID))
DECLARE @CoursesWithAccess 		TABLE (CourseID INT PRIMARY KEY(CourseID))
DECLARE @UserModuleWithAccess 	TABLE(UserID INT, ModuleID INT, UnitID INT PRIMARY KEY(UserID, ModuleID, UnitID))
DECLARE @AllModules 			TABLE(ModuleID INT PRIMARY KEY(ModuleID))
DECLARE @tblUserQuizStatus 		Table
(
[UserQuizStatusID] [int] Not Null,
[UserID] [int] Not Null,
[ModuleID] [int] Not Null,
[QuizStatusID] [int] Not Null,
[QuizScore] [int] Null,
[DateCreated] [datetime] Not Null
)
DECLARE @tblUserLessonStatus 	Table
(
[UserLessonStatusID] [int] ,
[UserID] [int] ,
[ModuleID] [int] ,
[LessonStatusID] [int] ,
[DateCreated] [datetime]
)
DECLARE @vwUserModuleAccess table
(
UserID INT not null,
FirstName varchar(255),
LastName varchar(255),
UnitID INT,
OrganisationID INT,
ModuleID INT,
CourseID INT,
CourseName nvarchar(100),
[Name] nvarchar(100),
Sequence INT,
Description nvarchar(1000)
)

DECLARE @tblOrganisationCourseAccess table
(
OrganisationID int,
GrantedCourseID int
)
---------------------------------------------------------------------------------------------

--set the default date depending on effective date
set @defaultdate = coalesce (@effectivedate,@defaultdate)
---------------------------------------------------------------------------------------------

--Check If Unit ID is specified
IF @unitIDs IS NULL
BEGIN
--Check User Type
SELECT
@UserTypeID = UserTypeID
FROM
tblUser
WHERE UserID = @adminUserID

--Get all units in Organisation if user is Salt Admin(1) or Org admin (2)
IF (@UserTypeID = 1 Or @UserTypeID = 2)
BEGIN
INSERT INTO
@tblUnit (UnitID)
SELECT
UnitID
FROM
tblUnit
WHERE OrganisationID = @OrganisationID
END

--Get units that the user is admministrator if user is Unit Admin(3)
IF (@UserTypeID = 3)
BEGIN
INSERT INTO
@tblUnit (UnitID)
SELECT
U.UnitID
FROM
tblUnit U INNER JOIN tblUnitAdministrator UA ON
UA.UnitID = U.UnitID AND
UA.UserID = @adminUserID
WHERE
U.OrganisationID = @OrganisationID
END
END
ELSE
BEGIN
--Seperate comma seperated values as Table rows
INSERT INTO @tblUnit SELECT * FROM  dbo.udfCsvToInt(@unitIDs)
END
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--FirstName, Last Name, etc specified in search criteria
IF (@userFirstName IS NULL) 	SET @userFirstName = ''''
IF (@userLastName IS NULL) 		SET @userLastName = ''''
IF (@userName IS NULL) 			SET @userName = ''''
IF (@userEmail IS NULL) 		SET @userEmail = ''''

INSERT INTO
@tblUser (UserID, UnitID, Active)
SELECT DISTINCT
U.UserID, U.UnitID, U.Active
FROM
tblUser U INNER JOIN @tblUnit UN ON	U.UnitID = UN.UnitID
and datediff(day,U.datecreated,@defaultdate)>=0-- created on or b4 specified date
LEFT JOIN tblUserClassification UC ON UC.UserID  = U.UserID
WHERE
U.FirstName Like ''%'' + @userFirstName + ''%'' AND
LastName Like ''%'' + @userLastName + ''%'' AND
UserName Like ''%'' + @userName + ''%'' AND
Email Like ''%'' + @userEmail + ''%'' AND
--AND have the Custom Classification option
--If classification is Any (0), This will find users of any Custom Classification
((@classificationID = 0) OR (UC.classificationID = @classificationID)) AND
--inclInactive = 0: do not include inactive user
--inclInactive = 1: include inactive user
(U.Active = CASE @inclInactive WHEN 0 THEN 1 ELSE U.Active END) AND
(U.OrganisationID = @OrganisationID)

---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- Search criteria contains Course ID''s
INSERT INTO
@tblCourse (CourseID, [Name])
SELECT
C.CourseID, C.[Name]
FROM
dbo.udfCsvToInt(@courseIDs) CA INNER JOIN tblCourse C ON
CA.intValue = C.CourseID AND C.Active = 1

-- added to deal with past courses - adds past course to intermediate @tblOrganisationCourseAccess table
-- to mimic it being a current course so results will be returned
insert into
@tblOrganisationCourseAccess (OrganisationID, GrantedCourseID)
select
@Organisationid, C.CourseID
from
dbo.udfCsvToInt(@courseIDs) CA inner join tblCourse C on
CA.intValue = C.CourseID and C.Active = 1

INSERT INTO @vwUserModuleAccess   SELECT   tU.UserID, tU.FirstName, tU.LastName, tU.UnitID, tU.OrganisationID, tM.ModuleID, tM.CourseID, tC.Name AS CourseName, tM.Name, tM.Sequence,
tM.Description
FROM         tblUser AS tU INNER JOIN
@tblUser tbU on tbU.UserID = tU.UserID
inner join
@tblOrganisationCourseAccess AS tOCA ON tOCA.OrganisationID = tU.OrganisationID INNER JOIN
tblCourse AS tC ON tC.CourseID = tOCA.GrantedCourseID INNER JOIN
tblModule AS tM ON tM.CourseID = tC.CourseID AND tM.Active = 1 LEFT OUTER JOIN
tblUserModuleAccess AS tUsrMA ON tUsrMA.UserID = tU.UserID AND tUsrMA.ModuleID = tM.ModuleID LEFT OUTER JOIN
tblUnitModuleAccess AS tUnitMA ON tUnitMA.UnitID = tU.UnitID AND tUnitMA.DeniedModuleID = tM.ModuleID
WHERE     tM.CourseID in (SELECT courseid from @tblCourse ) AND (tU.UnitID IS NOT NULL) AND (tUnitMA.DeniedModuleID IS NULL) AND (tUsrMA.ModuleID IS NULL) OR
(tUsrMA.Granted = 1)
--select * from @vwUserModuleAccess where UnitID is null

INSERT INTO @UserModuleWithAccess
SELECT DISTINCT UserID, ModuleID, UnitID FROM @vwUserModuleAccess where UnitID is not null

INSERT INTO @tblUserQuizStatus
(
[UserQuizStatusID],
[UserID],
[ModuleID],
[QuizStatusID],
[QuizScore],
[DateCreated]
)
SELECT
A.[UserQuizStatusID],
A.[UserID],
A.[ModuleID],
A.[QuizStatusID],
A.[QuizScore],
A.[DateCreated]
FROM
(
SELECT
A.UserID, A.ModuleID, MAX(B.UserQuizStatusID) AS ''LatestQuizID''
FROM
@UserModuleWithAccess A, tblUserQuizStatus B
WHERE
A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND B.QuizStatusID <> 0
AND DateDiff(day, B.DateCreated, @effectiveDate)>=0
GROUP BY
A.UserID, A.ModuleID
) B, tblUserQuizStatus A, @tblUser C
WHERE
A.UserQuizStatusID = B.LatestQuizID AND B.UserID = C.UserID AND A.UserID = C.UserID
-- li June 2008:
-- User who has access to a module but doesn''t have a record in tblUserQuizStatus is a new user
-- this logic will include new user in the current and historic admin report before user quiz status
-- is updated by overnight job

INSERT INTO @tblUserQuizStatus
(
[UserQuizStatusID],
[UserID],
[ModuleID],
[QuizStatusID],
[QuizScore],
[DateCreated]
)
SELECT
0, -- UserQuizStatusID
A.[UserID],
A.[ModuleID],
1, -- QuizStatus: Not Started
null, -- QuizScore
@defaultDate -- DateCreated (here set to @defaultdate which is passed in as getDate())
FROM @UserModuleWithAccess A
join  @tblUser B on A.UserID = B.UserID
-- User doesn''t have quiz activities
/* WT: this part is replaced with not exists, the logic below will subtract userid with moduleid
where  A.UserID  + ''-'' + A.MODULEID NOT IN
(	Select D.UserID + ''-'' + D.Moduleid
from @tblUserQuizStatus D
where datediff(day, d.datecreated, @defaultdate)>=0)*/
where not exists
(	Select D.UserID, D.Moduleid
from @tblUserQuizStatus D
where datediff(day, d.datecreated, @defaultdate)>=0
and D.Userid=B.userid and D.moduleid=A.moduleid
)
-- end logic for including new user''s quiz status



Insert Into @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
Select
A.[UserLessonStatusID],
A.[UserID],
A.[ModuleID],
A.[LessonStatusID],
A.[DateCreated]
FROM
(
SELECT
B.UserID, B.ModuleID, MAX(B.UserLessonStatusID) AS ''LatestLessonStatusID''
FROM
@UserModuleWithAccess A, tblUserLessonStatus B
WHERE
A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND
DateDiff(day, B.DateCreated, @effectiveDate)>=0 AND
B.LessonStatusID <> 0 --Unassigned
GROUP BY
B.UserID, B.ModuleID
) B, tblUserLessonStatus A, @tblUser C
WHERE
A.UserLessonStatusID = B.LatestLessonStatusID AND B.UserID = C.UserID AND A.UserID = C.UserID

-- start logic for including new user''s lesson status
INSERT INTO @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
SELECT
0, -- UserLessonStatusID
A.[UserID],
A.[ModuleID],
1, -- LessonStatus: Not Started
@defaultDate -- DateCreated (here set to @defaultdate which is passed in as getDate())
FROM @UserModuleWithAccess A
join  @tblUser B on A.UserID = B.UserID
where
-- User doesn''t have lesson activities for the date entered
/* WT: this part is replaced with not exists, the logic below will subtract userid with moduleid
A.UserID + ''-'' + A.Moduleid NOT IN
(	Select D.UserID + ''-'' + D.Moduleid
from @tblUserLessonStatus D
where datediff(day, d.datecreated, @defaultdate)>=0 )*/
not exists
(	Select D.UserID, D.Moduleid
from @tblUserLessonStatus D
where datediff(day, d.datecreated, @defaultdate)>=0
and D.Userid=B.userid and D.moduleid=A.moduleid
)
-- end logic for including new user''s lesson status

---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- This part fixes migration issue (note this will affect historic admin report only as it does supply effective date)
-- It will insert userid, moduleid and earliest lesson status for each quiz that does not have lesson record yet
-- into @tblUserLessonStatus
Insert Into @tblUserLessonStatus
(
[UserLessonStatusID],
[UserID],
[ModuleID],
[LessonStatusID],
[DateCreated]
)
SELECT 1,
A.[UserID],
A.[ModuleID],
B.LessonStatusID,
A.DateCreated
FROM (
SELECT
A.UserID, A.ModuleID, MIN(A.DateCreated) AS ''DateCreated''
FROM
tblUserLessonStatus A, @tblUser B
WHERE
A.UserID = B.UserID
GROUP BY
A.UserID, A.ModuleID
) A , tblUserLessonStatus B WHERE

A.UserID = B.UserID AND A.ModuleID = B.ModuleID AND A.DateCreated = B.DateCreated AND
(CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)))
NOT IN (SELECT CAST(A.UserID AS VARCHAR(10)) + CAST(A.ModuleID AS VARCHAR(10)) FROM @tblUserLessonStatus)


---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
Insert Into @tblResult
(
Unit,
[User],
Course,
Module,
[Sequence],
QuizStatus,
QuizStatusDate,	-- These columns have been reordered
QuizScore,	    -- These columns have been reordered
LessonStatus,
UnitID,
UserID,
UserName,
ExternalID,
CourseID,
ModuleID
)
Select distinct
-- General
up.HierarchyName 				As Unit, -- Unit Name
[User] = CASE u.Active when 0 then u.LastName + '' '' + u.FirstName + ''(i)'' ELSE u.LastName + '' '' + u.FirstName End , -- User Full Name
c.Name			  				As Course, -- Course Name
m.Name			  				As Module, -- Module Name
m.Sequence						As Sequence,
-- Quiz Specific
qs.Status						As QuizStatus,
dbo.udfUTCtoDaylightSavingTime(uqs.DateCreated, @organisationID) as QuizStatusDate,	-- These columns have been reordered
uqs.QuizScore 				    as QuizScore,		-- These columns have been reordered
-- Lesson Specific
ls.status 						As LessonStatus,
-- Hidden
u.UnitID						As UnitID,
u.UserID						As UserID,
u.UserName						As UserName,
u.ExternalID						As ExternalID,
c.CourseID						As CourseID,
m.ModuleID						As ModuleID
--u.Active						As Active
From @tblUserQuizStatus uqs
Inner Join tblQuizStatus qs On qs.QuizStatusID = uqs.QuizStatusID
inner Join @tblUser us 	On us.UserID = uqs.UserID
Inner Join tblUser u On u.UserID = us.UserID
INNER Join tblUnitHierarchy up On up.UnitID = u.UnitID
INNER Join tblModule m On m.ModuleID = uqs.ModuleID
INNER Join @tblCourse c On c.CourseID = m.CourseID
INNER Join @tblUserLessonStatus uls On uls.UserID = u.UserID And uls.ModuleID = m.ModuleID
INNER Join tblLessonStatus ls On ls.LessonStatusID = uls.LessonStatusID
where @effectivedate is null or (datediff(day,uqs.datecreated,@effectivedate)>=0 and datediff(day, uls.datecreated, @effectivedate)>=0)
RETURN
END
' 
END

GO























/* ------------------------------------------------------------ */

/* Fix bug Titles of screens not proper */

-- Tuesday, 2 August 2011 - 10:22:28 AM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgMailSetup.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'pagTitle'), 
					'Organisation Mail Setup', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Tuesday, 2 August 2011 - 10:24:53 AM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/TimeZone.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'pagTitle'), 
					'Time Zones', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Tuesday, 2 August 2011 - 10:25:41 AM
INSERT INTO tblLangValue(LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)
					SELECT (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU'), 
					(SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/TimeZoneEdit.aspx'), 
					(SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'pagTitle'), 
					'Edit User Defined TimeZone', 1, 1, getdate(), newid();SELECT @@IDENTITY AS [@@IDENTITY]


-- Tuesday, 2 August 2011 - 10:29:33 AM
UPDATE tblLangValue set LangEntryValue = 'Edit TimeZones Daylight Saving Rules', DateModified = getdate() 
					WHERE LangID = (SELECT LangID FROM tblLang WHERE LangCode = 'en-AU')
						AND LangInterfaceID = (SELECT LangInterfaceID FROM tblLangInterface WHERE LangInterfaceName = '/Administration/Organisation/OrgEditTimezoneDaylightRules.aspx')
						AND LangResourceID = (SELECT LangResourceID FROM tblLangResource WHERE LangResourceName = 'pagTitle')
GO				

/* -------------------------------------------------------- */
update  tblLangInterface set LangInterfaceName = '/Restricted/Login.aspx' where LangInterfaceName = '/Login.aspx'
GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle'), N'Summary Report', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblUnits'), N'Units<BR>(Blank for all units)', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCourses'), N'Course', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblHistoric'), N'Historic Date', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReportType')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReportType'), N'Report Type', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnRunReport'), N'Run Report', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset'), N'Reset', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.1'), N'Table', 1, 1, getdate(), newid()end 



GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.2'), N'Stacked Column Chart', 1, 1, getdate(), newid()end 


GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.3'), N'Stacked Bar Chart', 1, 1, getdate(), newid()end 

GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optReportType.4'), N'Pie Chart', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.Date'), N'The effective date must be valid and cannot be greater than today', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoUnit'), N'No units exist within this organisation', 1, 1, getdate(), newid()end 



GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblError.NoCourse'), N'No courses exist within this organisation.', 1, 1, getdate(), newid()end 
GO

INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('optPeriodType.4', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('optPeriodType.3', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('optPeriodType.2', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]
INSERT INTO tblLangResource (LangResourceName, Comment, UserCreated, DateCreated, RecordLock) VALUES('optPeriodType.1', '', 1, getdate(), newid());SELECT @@IDENTITY AS [@@IDENTITY]


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.1'), N'Day', 1, 1, getdate(), newid()end 
GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.2'), N'Week', 1, 1, getdate(), newid()end 
GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.3'), N'Month', 1, 1, getdate(), newid()end 
GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optPeriodType.4'), N'Year', 1, 1, getdate(), newid()end 
GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblCustomClassification'), N'Grouping Option', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblAny')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblAny'), N'Any', 1, 1, getdate(), newid()end 
GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.1'), N'Complete', 1, 1, getdate(), newid()end 

GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.2'), N'Incomplete', 1, 1, getdate(), newid()end 

GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.3'), N'Fail', 1, 1, getdate(), newid()end 

GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.4')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.4'), N'Not Started', 1, 1, getdate(), newid()end 

GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.5')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.5'), N'Expired (Time Elapsed)', 1, 1, getdate(), newid()end 


GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.6')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'optStatus.6'), N'Expired (New Content)', 1, 1, getdate(), newid()end 
GO



If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.1'), N'Unit/User', 1, 1, getdate(), newid()end 

GO

If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'radGroupBy.2'), N'Course', 1, 1, getdate(), newid()end 

GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ConfirmMessage'), N'Are you sure you want to delete this schedule?', 1, 1, getdate(), newid()end 

GO


If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.1'), N'Last Name', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.2'), N'Quiz Score', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.3')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lstWithinUserSort.3'), N'Quiz Date', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblSortBy')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblSortBy'), N'Sort By<br>(Within Course)', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.2'), N'Historic ', 1, 1, getdate(), newid()end 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblPageTitle.1'), N'Current ', 1, 1, getdate(), newid()end 
GO
if not exists (select * from tblLangResource where LangResourceName = N'lblReportPeriodic') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblReportPeriodic', '', '', 1, 1, null, getdate(), '10 Aug 2011 18:06:42', null, newid()) 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblReportPeriodic')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = 'GLOBAL.UserControls.ReportsMenu.ascx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblReportPeriodic'), N'Report Subscription', 1, 1, getdate(), newid()end 
GO

if not exists (select * from tblLangResource where LangResourceName = N'ScheduleTitle') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'ScheduleTitle', '', '', 1, 1, null, getdate(), '15 Aug 2011 18:06:42', null, newid()) 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'ScheduleTitle')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'ScheduleTitle'), N'Title ', 1, 1, getdate(), newid()end 
GO
if not exists (select * from tblLangResource where LangResourceName = N'btnReset2') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnReset2', '', '', 1, 1, null, getdate(), '18 Aug 2011 18:06:42', null, newid()) 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnReset2')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnReset2'), N'Reset', 1, 1, getdate(), newid()end 
GO
if not exists (select * from tblLangResource where LangResourceName = N'btnSend') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'btnSend', '', '', 1, 1, null, getdate(), '18 Aug 2011 18:06:42', null, newid()) 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'btnSend')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'btnSend'), N'Send', 1, 1, getdate(), newid()end 
GO
if not exists (select * from tblLangResource where LangResourceName = N'lblEndOn') insert into tblLangResource (LangResourceName, ResourceType, Comment, UserCreated, UserModified, UserDeleted, DateCreated, DateModified, DateDeleted, RecordLock) values (N'lblEndOn', '', '', 1, 1, null, getdate(), '30 Nov 2008 18:06:42', null, newid()) 
GO
If not exists (select * from tblLangValue where LangID = 2 and LangInterfaceID = (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx') and LangResourceID = (select LangResourceID from tblLangResource where LangResourceName = 'lblEndOn')) begin insert into tblLangValue (LangID, LangInterfaceID, LangResourceID, LangEntryValue, Active, UserCreated, DateCreated, RecordLock)  select 2, (select LangInterfaceID from tblLangInterface where LangInterfaceName = '/Reporting/PeriodicReport.aspx'),  (select LangResourceID from tblLangResource where LangResourceName = 'lblEndOn'), N'End On', 1, 1, getdate(), newid()end 
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetCPDReportName]') AND type in (N'P', N'PC'))
DROP PROCEDURE [prcReport_GetCPDReportName]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[prcReport_GetCPDReportName]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE   Procedure [prcReport_GetCPDReportName]
(
 @OrgID int
)

As

select CPDReportName from tblorganisation where OrganisationID= @OrgID
' 
END
GO




